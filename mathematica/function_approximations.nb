(* Content-type: application/vnd.wolfram.mathematica *)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "FunctionApproximations`"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestApprox", "[",
   RowBox[{"f_", ",",
    RowBox[{"{",
     RowBox[{"x_", ",",
      RowBox[{"{",
       RowBox[{"x0_", ",", "x1_"}], "}"}]}], "}"}], ",",
    RowBox[{"opt", ":",
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=",
  RowBox[{"Module", "[",
   RowBox[{
    RowBox[{"{", "approx", "}"}], ",", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"approx", "=",
      RowBox[{"Flatten", "[",
       RowBox[{
        RowBox[{"Table", "[",
         RowBox[{
          RowBox[{"Quiet", "@",
           RowBox[{"MiniMaxApproximation", "[",
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",",
             RowBox[{"{",
              RowBox[{"x", ",",
               RowBox[{"{",
                RowBox[{"x0", ",", "x1"}], "}"}], ",", "n", ",", "m"}], "}"}],
              ",", "opt"}], "]"}]}], ",",
          RowBox[{"{",
           RowBox[{"n", ",", "1", ",", "9"}], "}"}], ",",
          RowBox[{"{",
           RowBox[{"m", ",", "0", ",", "9"}], "}"}]}], "]"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";",
     "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"SortBy", "[",
        RowBox[{
         RowBox[{"Max", "[",
          RowBox[{"#", "\[LeftDoubleBracket]",
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "&"}],
        "]"}], "[", "approx", "]"}], "\[LeftDoubleBracket]",
      RowBox[{"1", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[2]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chebyshevApprox", "[",
    RowBox[{"f_", ",",
     RowBox[{"{",
      RowBox[{"x_", ",", "x0_", ",", "x1_"}], "}"}], ",",
     RowBox[{"opt", ":",
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=",
   RowBox[{"Module", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"c", ",", "xRange"}], "}"}], ",", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"xRange", "=",
       RowBox[{"x1", "-", "x0"}]}], ";", "\[IndentingNewLine]",
      RowBox[{"c", "=",
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{
          FractionBox["2", "\[Pi]"],
          RowBox[{"NIntegrate", "[",
           RowBox[{
            RowBox[{
             RowBox[{"f", "[",
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "x"}], "+", "x0", "+", "x1"}],
               RowBox[{"x0", "-", "x1"}]], "]"}], " ",
             FractionBox[
              RowBox[{"ChebyshevT", "[",
               RowBox[{"n", ",", "x"}], "]"}],
              SqrtBox[
               RowBox[{"1", "-",
                SuperscriptBox["x", "2"]}]]]}], ",",
            RowBox[{"{",
             RowBox[{"x", ",",
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",",
            RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]}], ",",
         RowBox[{"{",
          RowBox[{"n", ",", "0", ",", "9"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"c", ".",
        RowBox[{"Table", "[",
         RowBox[{
          RowBox[{"ChebyshevT", "[",
           RowBox[{"n", ",", "x"}], "]"}], ",",
          RowBox[{"{",
           RowBox[{"n", ",", "0", ",", "9"}], "}"}]}], "]"}]}], "-",
       FractionBox[
        RowBox[{"First", "[", "c", "]"}], "2"]}]}]}], "\[IndentingNewLine]",
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[3]:="],

Cell[CellGroupData[{

Cell[TextData[{
 "Bose\[LongDash]Einstein: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Li", "3"], "(",
    SuperscriptBox["e", "\[Mu]\[Beta]"], ")"}], TraditionalForm]],
  ExpressionUUID->"ba7eb778-5491-4248-bf7b-e2aa684fbe96"]
}], "Section"],

Cell[TextData[{
 "Approximation of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Li", "3"], "(",
    SuperscriptBox["e", "\[Mu]\[Beta]"], ")"}], TraditionalForm]],
  ExpressionUUID->"f6a649dd-b396-4ab3-a87a-68fa487de850"],
 " that appears Bose\[LongDash]Einstein statistics.  We need only worry about \
the cases where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]\[Beta]", "\[LessEqual]", "0"}], TraditionalForm]],
  ExpressionUUID->"eca835ff-1f47-4af7-bfc5-eecbbf2301af"],
 " (as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "1a3340ff-db77-4022-b45a-c7dfa655af9a"],
 " corresponds to a Bose\[LongDash]Einstein condensate which we have to \
handle separately); however, due to the way Mathematica handles the expansion \
of the PolyLog functions, we instead approximate the function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Li", "3"], "(",
    SuperscriptBox["e",
     RowBox[{"-", "x"}]], ")"}], TraditionalForm]],ExpressionUUID->
  "014a76ec-e751-43cb-81df-dbe9a364e256"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[GreaterEqual]", "0"}], TraditionalForm]],ExpressionUUID->
  "452de9bb-5a34-448b-8ada-be7a6b8300ca"],
 "."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exact", "[", "x_", "]"}], "=",
   RowBox[{"PolyLog", "[",
    RowBox[{"3", ",",
     SuperscriptBox["E",
      RowBox[{"-", "x"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", ">", "0"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xs", "=",
   RowBox[{"SetPrecision", "[",
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{
      "0.22", ",", "0.28", ",", "0.36", ",", "0.45", ",", "0.56", ",", "0.69",
        ",", "0.84", ",", "\[IndentingNewLine]", "1.01", ",", "1.20", ",",
       "1.42", ",", "1.65", ",", "1.9", ",", "\[IndentingNewLine]", "2.18",
       ",", "2.51", ",", "2.85"}], "}"}], ",", "\[IndentingNewLine]",
     "\[Infinity]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fn", "[", "0", "]"}], "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{"Series", "[",
     RowBox[{
      RowBox[{"exact", "[", "x", "]"}], ",",
      RowBox[{"{",
       RowBox[{"x", ",", "0", ",", "9"}], "}"}]}], "]"}], "//", "Normal"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"exact", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "\[Infinity]", ",", "9"}], "}"}]}], "]"}], "//",
     "Normal"}], "//", "ExpandAll"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[",
        RowBox[{"i", "-", "1"}], "]"}], "[", "x_", "]"}], "=",
      RowBox[{
       RowBox[{"MiniMaxApproximation", "[",
        RowBox[{
         RowBox[{"exact", "[", "x", "]"}], ",",
         RowBox[{"{",
          RowBox[{"x", ",",
           RowBox[{"{",
            RowBox[{
             RowBox[{"xs", "\[LeftDoubleBracket]",
              RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",",
             RowBox[{
             "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "}"}], ",", "9", ",", "0"}], "}"}], ",",
         RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}],
       "\[LeftDoubleBracket]",
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}],
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"i", ",", "2", ",",
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "x_", "]"}], "=",
    RowBox[{"Piecewise", "[",
     RowBox[{"Join", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{"{",
          RowBox[{
           RowBox[{
            RowBox[{"fn", "[",
             RowBox[{"i", "-", "1"}], "]"}], "[", "x", "]"}], ",",
           RowBox[{"x", "<",
            RowBox[{
            "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",",
         RowBox[{"{",
          RowBox[{"i", ",",
           RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"{", "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{
          RowBox[{
           RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
          "True"}], "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"LogLogPlot", "[",
   RowBox[{
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"exact", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"0.5",
       RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",",
      RowBox[{"1.5",
       RowBox[{"xs", "\[LeftDoubleBracket]",
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"PlotRange", "\[Rule]",
     RowBox[{"{",
      RowBox[{"All", ",",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "20"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",",
    "\[IndentingNewLine]",
    RowBox[{"Epilog", "\[Rule]",
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{"1", ",",
           RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[", "x", "]"}],
     RowBox[{"f", "[", "x", "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"0.5",
      RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
     ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[761]:="]
}]],

Cell[BoxData[{
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"CoefficientList", "[",
    RowBox[{
     RowBox[{
      RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",", "x"}], "]"}], ",",
   "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], ",", "x"}], "]"}],
     ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"CoefficientList", "[",
    RowBox[{
     RowBox[{
      RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
     RowBox[{"Exp", "[",
      RowBox[{"-", "x"}], "]"}]}], "]"}], ",", "20"}], "]"}]}], "Input",
 CellLabel->
  "In[351]:="],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"PolyLog", "[",
       RowBox[{"3", ",",
        RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}], "}"}], ",",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"Join", "[",
       RowBox[{
        RowBox[{"-",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]]}], ",",
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", ">", "1000000"}]}], "\[Rule]", "\[Infinity]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", "<",
      RowBox[{"-", "1000000"}]}]}], "\[Rule]", "0"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Export", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"FileNameJoin", "[",
    RowBox[{"{",
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",",
      "\"\<test\>\"", ",", "\"\<data\>\"", ",",
      "\"\<polylog_bose_einstein.csv\>\""}], "}"}], "]"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{"%", ",", "20"}], "]"}], ",", "\"\<CSV\>\"", ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]",
    RowBox[{"{",
     RowBox[{"\"\<x\>\"", ",", "\"\<polylog\>\""}], "}"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}],
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[958]:="]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[{
 "Fermi\[LongDash]Dirac: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-",
    RowBox[{
     SubscriptBox["Li", "3"], "(",
     RowBox[{"-",
      SuperscriptBox["e", "\[Mu]\[Beta]"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"0a1ee3ea-a3ac-418b-b2fd-f6aaf2ca4957"]
}], "Section"],

Cell[TextData[{
 "Approximation of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-",
    RowBox[{
     SubscriptBox["Li", "3"], "(",
     RowBox[{"-",
      SuperscriptBox["e", "\[Mu]\[Beta]"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"91ce7bd0-8ba3-4cb8-b69a-ce339e9702e2"],
 " that appears Fermi\[LongDash]Dirac statistics.  Unlike with \
Bose\[LongDash]Einstein, this approximation is valid for all values of ",
 Cell[BoxData[
  FormBox["\[Mu]\[Beta]", TraditionalForm]],ExpressionUUID->
  "7bdae13f-5003-43a7-806d-112f9966ba96"],
 " (that is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[Element]",
    TemplateBox[{},
     "Reals"]}], TraditionalForm]],ExpressionUUID->
  "138c6551-9844-4755-945e-32f06e4ab829"],
 ")."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exact", "[", "x_", "]"}], "=",
   RowBox[{"-",
    RowBox[{"PolyLog", "[",
     RowBox[{"3", ",",
      RowBox[{"-",
       SuperscriptBox["E", "x"]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]",

 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xs", "=",
   RowBox[{"SetPrecision", "[",
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"-", "2.6"}], ",",
       RowBox[{"-", "2.15"}], ",", "\[IndentingNewLine]",
       RowBox[{"-", "1.67"}], ",",
       RowBox[{"-", "1.25"}], ",", "\[IndentingNewLine]",
       RowBox[{"-", "0.8"}], ",",
       RowBox[{"-", "0.3"}], ",", "\[IndentingNewLine]", "0.1", ",", "0.6",
       ",", "\[IndentingNewLine]", "1.1", ",", "1.65", ",", "2.05", ",",
       "\[IndentingNewLine]", "2.5"}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", "\[Infinity]"}], "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fn", "[", "0", "]"}], "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"exact", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"-", "\[Infinity]"}], ",", "9"}], "}"}]}], "]"}], "//",
     "Normal"}], "//", "ExpandAll"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"exact", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "\[Infinity]", ",", "9"}], "}"}]}], "]"}], "//",
     "Normal"}], "//", "ExpandAll"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[",
        RowBox[{"i", "-", "1"}], "]"}], "[", "x_", "]"}], "=",
      RowBox[{
       RowBox[{"MiniMaxApproximation", "[",
        RowBox[{
         RowBox[{"exact", "[", "x", "]"}], ",",
         RowBox[{"{",
          RowBox[{"x", ",",
           RowBox[{"{",
            RowBox[{
             RowBox[{"xs", "\[LeftDoubleBracket]",
              RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",",
             RowBox[{
             "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "}"}], ",", "9", ",", "0"}], "}"}], ",",
         RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}],
       "\[LeftDoubleBracket]",
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}],
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"i", ",", "2", ",",
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "x_", "]"}], "=",
    RowBox[{"Piecewise", "[",
     RowBox[{"Join", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{"{",
          RowBox[{
           RowBox[{
            RowBox[{"fn", "[",
             RowBox[{"i", "-", "1"}], "]"}], "[", "x", "]"}], ",",
           RowBox[{"x", "<",
            RowBox[{
            "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",",
         RowBox[{"{",
          RowBox[{"i", ",",
           RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"{", "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{
          RowBox[{
           RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
          "True"}], "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"LogLogPlot", "[",
  RowBox[{
   RowBox[{"Abs", "[",
    RowBox[{
     FractionBox[
      RowBox[{"exact", "[",
       RowBox[{"-", "x"}], "]"}],
      RowBox[{"f", "[",
       RowBox[{"-", "x"}], "]"}]], "-", "1"}], "]"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     SuperscriptBox["10",
      RowBox[{"-", "2"}]], ",",
     RowBox[{
      RowBox[{"-", "1.5"}],
      RowBox[{
      "xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}],
    ",", "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "\[Rule]",
    RowBox[{"{",
     RowBox[{"All", ",",
      RowBox[{"{",
       RowBox[{
        SuperscriptBox["10",
         RowBox[{"-", "20"}]], ",",
        SuperscriptBox["10",
         RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{"InfiniteLine", "[",
      RowBox[{
       RowBox[{"Log", "@",
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
       RowBox[{"{",
        RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[",
      RowBox[{"-", "x"}], "]"}],
     RowBox[{"f", "[",
      RowBox[{"-", "x"}], "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     SuperscriptBox["10",
      RowBox[{"-", "2"}]], ",",
     RowBox[{
      RowBox[{"-", "1.5"}],
      RowBox[{
      "xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}],
    ",", "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}], "\[IndentingNewLine]",
 RowBox[{"LogLogPlot", "[",
  RowBox[{
   RowBox[{"Abs", "[",
    RowBox[{
     FractionBox[
      RowBox[{"exact", "[", "x", "]"}],
      RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     SuperscriptBox["10",
      RowBox[{"-", "2"}]], ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "\[Rule]",
    RowBox[{"{",
     RowBox[{"All", ",",
      RowBox[{"{",
       RowBox[{
        SuperscriptBox["10",
         RowBox[{"-", "20"}]], ",",
        SuperscriptBox["10",
         RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{"InfiniteLine", "[",
      RowBox[{
       RowBox[{"Log", "@",
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
       RowBox[{"{",
        RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[", "x", "]"}],
     RowBox[{"f", "[", "x", "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     SuperscriptBox["10",
      RowBox[{"-", "2"}]], ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[942]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"CoefficientList", "[",
    RowBox[{
     RowBox[{
      RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
     RowBox[{"Exp", "[", "x", "]"}]}], "]"}], ",", "20"}],
  "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], ",", "x"}], "]"}],
     ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"CoefficientList", "[",
    RowBox[{
     RowBox[{
      RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
     RowBox[{"Exp", "[",
      RowBox[{"-", "x"}], "]"}]}], "]"}], ",", "20"}], "]"}]}], "Input",
 CellLabel->
  "In[926]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"-",
       RowBox[{"PolyLog", "[",
        RowBox[{"3", ",",
         RowBox[{"-",
          RowBox[{"Exp", "[", "x", "]"}]}]}], "]"}]}]}], "}"}], ",",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"Join", "[",
       RowBox[{
        RowBox[{"-",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]]}], ",",
        SuperscriptBox["10",
         RowBox[{"Subdivide", "[",
          RowBox[{
           RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]], ",",
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", ">", "1000000"}]}], "\[Rule]", "\[Infinity]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", "<",
      RowBox[{"-", "1000000"}]}]}], "\[Rule]", "0"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{"Infinity", "\[Rule]", "\"\<NaN\>\""}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Export", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"FileNameJoin", "[",
    RowBox[{"{",
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",",
      "\"\<test\>\"", ",", "\"\<data\>\"", ",",
      "\"\<polylog_fermi_dirac.csv\>\""}], "}"}], "]"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{"%", ",", "20"}], "]"}], ",", "\"\<CSV\>\"", ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]",
    RowBox[{"{",
     RowBox[{"\"\<x\>\"", ",", "\"\<polylog\>\""}], "}"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}],
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[966]:="]
}]]
}]],

Cell[CellGroupData[{

Cell["Bessel", "Section"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "0"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"07eec357-d0df-4ae0-b30d-2b5ac1d00388"]], \
"Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exact", "[", "x_", "]"}], "=",
    RowBox[{"BesselK", "[",
     RowBox[{"0", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"$Assumptions", "=",
     RowBox[{"x", ">", "0"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"xs", "=",
    RowBox[{"SetPrecision", "[",
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]",
       RowBox[{
       "1.6", ",", "2.5", ",", "3.8", ",", "5.7", ",", "8.5", ",",
        "\[IndentingNewLine]", "12.5", ",", "18", ",", "25.5", ",", "36.3",
        ",", "50"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
       "\[Infinity]"}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "0", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",",
           RowBox[{"-", "\[Infinity]"}], ",", "9"}], "}"}]}], "]"}], "//",
       "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[",
         RowBox[{"i", "-", "1"}], "]"}], "[", "x_", "]"}], "=",
       RowBox[{
        RowBox[{"outer", "[",
         RowBox[{
          RowBox[{"MiniMaxApproximation", "[",
           RowBox[{
            RowBox[{
             RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
             RowBox[{"exact", "[",
              RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
            RowBox[{"{",
             RowBox[{"\[FormalX]", ",",
              RowBox[{
               RowBox[{"InverseFunction", "[", "inner", "]"}], "[",
               RowBox[{"{",
                RowBox[{
                 RowBox[{"xs", "\[LeftDoubleBracket]",
                  RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",",
                 RowBox[{
                 "xs", "\[LeftDoubleBracket]", "i",
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "9", ",",
              "0"}], "}"}], ",",
            RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}],
          "\[LeftDoubleBracket]",
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "/.",
        RowBox[{"\[FormalX]", "\[Rule]",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x",
          "]"}]}]}]}], ";"}], "\[IndentingNewLine]", ",",
     "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"i", ",", "2", ",",
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",", "\[Infinity]", ",", "9"}], "}"}]}],
        "]"}], "//", "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "x_", "]"}], "=",
    RowBox[{"Piecewise", "[",
     RowBox[{"Join", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{"{",
          RowBox[{
           RowBox[{
            RowBox[{"fn", "[",
             RowBox[{"i", "-", "1"}], "]"}], "[", "x", "]"}], ",",
           RowBox[{"x", "<",
            RowBox[{
            "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",",
         RowBox[{"{",
          RowBox[{"i", ",",
           RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"{", "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{
          RowBox[{
           RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
          "True"}], "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"LogLogPlot", "[",
   RowBox[{
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"exact", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"0.5",
       RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",",
      RowBox[{"1.5",
       RowBox[{"xs", "\[LeftDoubleBracket]",
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"PlotRange", "\[Rule]",
     RowBox[{"{",
      RowBox[{"All", ",",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "20"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",",
    "\[IndentingNewLine]",
    RowBox[{"Epilog", "\[Rule]",
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{"1", ",",
           RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[", "x", "]"}],
     RowBox[{"f", "[", "x", "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"0.5",
      RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
     ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[1002]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
       RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "2",
     "\[RightDoubleBracket]"}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "0"],
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "1",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]}], "Input",
 CellLabel->
  "In[1013]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(",
       FractionBox[
        RowBox[{"Exp", "[",
         RowBox[{"-", "x"}], "]"}],
        SqrtBox["x"]], ")"}],
      RowBox[{"-", "1"}]],
     RowBox[{
      RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}]}], ",",
    SuperscriptBox["x",
     RowBox[{"-", "1"}]]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]], "Input",
 CellLabel->
  "In[1015]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", "p_", "]"}],
          SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "p"}]}], ",",
       RowBox[{"Log", "[", "x", "]"}]}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "p_", "]"}],
        SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "n"}]}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}]}], "Input",
 CellLabel->
  "In[1016]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"exact", "[", "x", "]"}]}], "}"}], ",",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"Join", "[",
       RowBox[{
        SuperscriptBox["10",
         RowBox[{"Subdivide", "[",
          RowBox[{
           RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]], ",",
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", ">", "1000000"}]}], "\[Rule]", "\[Infinity]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", "<",
      RowBox[{"-", "1000000"}]}]}], "\[Rule]", "0"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Export", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"FileNameJoin", "[",
    RowBox[{"{",
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",",
      "\"\<test\>\"", ",", "\"\<data\>\"", ",", "\"\<bessel_k0.csv\>\""}],
     "}"}], "]"}], ",", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"N", "[",
     RowBox[{"%", ",", "20"}], "]"}], "/.",
    RowBox[{
     RowBox[{"ComplexInfinity", "|", "Infinity", "|", "Indeterminate"}],
     "\[Rule]", "\"\<NaN\>\""}]}], ",", "\"\<CSV\>\"", ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]",
    RowBox[{"{",
     RowBox[{"\"\<x\>\"", ",", "\"\<bessel\>\""}], "}"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}],
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[1018]:="]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "1"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"0549d4f7-0461-4bce-b0c0-bb844cc1eb67"]], \
"Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exact", "[", "x_", "]"}], "=",
    RowBox[{"BesselK", "[",
     RowBox[{"1", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"$Assumptions", "=",
     RowBox[{"x", ">", "0"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"xs", "=",
    RowBox[{"SetPrecision", "[",
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]",
       RowBox[{
       "1.85", ",", "2.75", ",", "4.05", ",", "6.", ",", "9.", ",",
        "\[IndentingNewLine]", "13.25", ",", "19", ",", "26.75", ",", "37.65",
         ",", "50"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[Infinity]"}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "0", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",",
           RowBox[{"-", "\[Infinity]"}], ",", "9"}], "}"}]}], "]"}], "//",
       "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[",
         RowBox[{"i", "-", "1"}], "]"}], "[", "x_", "]"}], "=",
       RowBox[{
        RowBox[{"outer", "[",
         RowBox[{
          RowBox[{"MiniMaxApproximation", "[",
           RowBox[{
            RowBox[{
             RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
             RowBox[{"exact", "[",
              RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
            RowBox[{"{",
             RowBox[{"\[FormalX]", ",",
              RowBox[{
               RowBox[{"InverseFunction", "[", "inner", "]"}], "[",
               RowBox[{"{",
                RowBox[{
                 RowBox[{"xs", "\[LeftDoubleBracket]",
                  RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",",
                 RowBox[{
                 "xs", "\[LeftDoubleBracket]", "i",
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "9", ",",
              "0"}], "}"}], ",",
            RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}],
          "\[LeftDoubleBracket]",
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "/.",
        RowBox[{"\[FormalX]", "\[Rule]",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x",
          "]"}]}]}]}], ";"}], "\[IndentingNewLine]", ",",
     "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"i", ",", "2", ",",
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",", "\[Infinity]", ",", "9"}], "}"}]}],
        "]"}], "//", "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "x_", "]"}], "=",
    RowBox[{"Piecewise", "[",
     RowBox[{"Join", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{"{",
          RowBox[{
           RowBox[{
            RowBox[{"fn", "[",
             RowBox[{"i", "-", "1"}], "]"}], "[", "x", "]"}], ",",
           RowBox[{"x", "<",
            RowBox[{
            "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",",
         RowBox[{"{",
          RowBox[{"i", ",",
           RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"{", "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{
          RowBox[{
           RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
          "True"}], "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"LogLogPlot", "[",
   RowBox[{
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"exact", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"0.5",
       RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",",
      RowBox[{"1.5",
       RowBox[{"xs", "\[LeftDoubleBracket]",
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"PlotRange", "\[Rule]",
     RowBox[{"{",
      RowBox[{"All", ",",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "20"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",",
    "\[IndentingNewLine]",
    RowBox[{"Epilog", "\[Rule]",
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{"1", ",",
           RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[", "x", "]"}],
     RowBox[{"f", "[", "x", "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"0.5",
      RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
     ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[1022]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     FractionBox["1", "x"],
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "2",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"x", " ",
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "1",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]}], "Input",
 CellLabel->
  "In[1033]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(",
       FractionBox[
        RowBox[{"Exp", "[",
         RowBox[{"-", "x"}], "]"}],
        SqrtBox["x"]], ")"}],
      RowBox[{"-", "1"}]],
     RowBox[{
      RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}]}], ",",
    SuperscriptBox["x",
     RowBox[{"-", "1"}]]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]], "Input",
 CellLabel->
  "In[1035]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", "p_", "]"}],
          SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "p"}]}], ",",
       RowBox[{"Log", "[", "x", "]"}]}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "p_", "]"}],
        SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "n"}]}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}]}], "Input",
 CellLabel->
  "In[1036]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"BesselK", "[",
       RowBox[{"1", ",", "x"}], "]"}]}], "}"}], ",",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"Join", "[",
       RowBox[{
        SuperscriptBox["10",
         RowBox[{"Subdivide", "[",
          RowBox[{
           RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]], ",",
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", ">", "1000000"}]}], "\[Rule]", "\[Infinity]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", "<",
      RowBox[{"-", "1000000"}]}]}], "\[Rule]", "0"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Export", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"FileNameJoin", "[",
    RowBox[{"{",
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",",
      "\"\<test\>\"", ",", "\"\<data\>\"", ",", "\"\<bessel_k1.csv\>\""}],
     "}"}], "]"}], ",", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"N", "[",
     RowBox[{"%", ",", "20"}], "]"}], "/.",
    RowBox[{
     RowBox[{"ComplexInfinity", "|", "Infinity", "|", "Indeterminate"}],
     "\[Rule]", "\"\<NaN\>\""}]}], ",", "\"\<CSV\>\"", ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]",
    RowBox[{"{",
     RowBox[{"\"\<x\>\"", ",", "\"\<bessel\>\""}], "}"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}],
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[1038]:="]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "2"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"671d77d8-5a7c-463a-9324-e54535f5746d"]], \
"Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exact", "[", "x_", "]"}], "=",
    RowBox[{"BesselK", "[",
     RowBox[{"2", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"$Assumptions", "=",
     RowBox[{"x", ">", "0"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"xs", "=",
    RowBox[{"SetPrecision", "[",
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]",
       RowBox[{
       "2.1", ",", "3", ",", "4.3", ",", "6.3", ",", "9.5", ",",
        "\[IndentingNewLine]", "14", ",", "20", ",", "28", ",", "39", ",",
        "50"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
      "\[Infinity]"}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "0", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",",
           RowBox[{"-", "\[Infinity]"}], ",", "9"}], "}"}]}], "]"}], "//",
       "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[",
         RowBox[{"i", "-", "1"}], "]"}], "[", "x_", "]"}], "=",
       RowBox[{
        RowBox[{"outer", "[",
         RowBox[{
          RowBox[{"MiniMaxApproximation", "[",
           RowBox[{
            RowBox[{
             RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
             RowBox[{"exact", "[",
              RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
            RowBox[{"{",
             RowBox[{"\[FormalX]", ",",
              RowBox[{
               RowBox[{"InverseFunction", "[", "inner", "]"}], "[",
               RowBox[{"{",
                RowBox[{
                 RowBox[{"xs", "\[LeftDoubleBracket]",
                  RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",",
                 RowBox[{
                 "xs", "\[LeftDoubleBracket]", "i",
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "9", ",",
              "0"}], "}"}], ",",
            RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}],
          "\[LeftDoubleBracket]",
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "/.",
        RowBox[{"\[FormalX]", "\[Rule]",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x",
          "]"}]}]}]}], ";"}], "\[IndentingNewLine]", ",",
     "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"i", ",", "2", ",",
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",", "\[Infinity]", ",", "9"}], "}"}]}],
        "]"}], "//", "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "x_", "]"}], "=",
    RowBox[{"Piecewise", "[",
     RowBox[{"Join", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{"{",
          RowBox[{
           RowBox[{
            RowBox[{"fn", "[",
             RowBox[{"i", "-", "1"}], "]"}], "[", "x", "]"}], ",",
           RowBox[{"x", "<",
            RowBox[{
            "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",",
         RowBox[{"{",
          RowBox[{"i", ",",
           RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"{", "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{
          RowBox[{
           RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
          "True"}], "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"LogLogPlot", "[",
   RowBox[{
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"exact", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"0.5",
       RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",",
      RowBox[{"1.5",
       RowBox[{"xs", "\[LeftDoubleBracket]",
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"PlotRange", "\[Rule]",
     RowBox[{"{",
      RowBox[{"All", ",",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "20"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",",
    "\[IndentingNewLine]",
    RowBox[{"Epilog", "\[Rule]",
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{"1", ",",
           RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[", "x", "]"}],
     RowBox[{"f", "[", "x", "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"0.5",
      RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
     ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[1042]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     FractionBox["1",
      SuperscriptBox["x", "2"]],
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "2",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"],
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "1",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]}], "Input",
 CellLabel->
  "In[1053]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(",
       FractionBox[
        RowBox[{"Exp", "[",
         RowBox[{"-", "x"}], "]"}],
        SqrtBox["x"]], ")"}],
      RowBox[{"-", "1"}]],
     RowBox[{
      RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}]}], ",",
    SuperscriptBox["x",
     RowBox[{"-", "1"}]]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]], "Input",
 CellLabel->
  "In[1055]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", "p_", "]"}],
          SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "p"}]}], ",",
       RowBox[{"Log", "[", "x", "]"}]}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "p_", "]"}],
        SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "n"}]}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}]}], "Input",
 CellLabel->
  "In[1056]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"exact", "[", "x", "]"}]}], "}"}], ",",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"Join", "[",
       RowBox[{
        SuperscriptBox["10",
         RowBox[{"Subdivide", "[",
          RowBox[{
           RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]], ",",
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", ">", "1000000"}]}], "\[Rule]", "\[Infinity]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", "<",
      RowBox[{"-", "1000000"}]}]}], "\[Rule]", "0"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Export", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"FileNameJoin", "[",
    RowBox[{"{",
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",",
      "\"\<test\>\"", ",", "\"\<data\>\"", ",", "\"\<bessel_k2.csv\>\""}],
     "}"}], "]"}], ",", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"N", "[",
     RowBox[{"%", ",", "20"}], "]"}], "/.",
    RowBox[{
     RowBox[{"ComplexInfinity", "|", "Infinity", "|", "Indeterminate"}],
     "\[Rule]", "\"\<NaN\>\""}]}], ",", "\"\<CSV\>\"", ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]",
    RowBox[{"{",
     RowBox[{"\"\<x\>\"", ",", "\"\<bessel\>\""}], "}"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}],
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[1058]:="]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "3"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"d9ab6dc8-3f30-43a7-b2ae-ce72f2c940bc"]], \
"Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exact", "[", "x_", "]"}], "=",
    RowBox[{"BesselK", "[",
     RowBox[{"3", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"$Assumptions", "=",
     RowBox[{"x", ">", "0"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"xs", "=",
    RowBox[{"SetPrecision", "[",
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]",
       RowBox[{
       "2.4", ",", "3.3", ",", "4.5", ",", "6.2", ",", "8.9", ",",
        "\[IndentingNewLine]", "10.0", ",", "15.5", ",", "22", ",", "30", ",",
         "40", ",", "50"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[Infinity]"}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "0", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",",
           RowBox[{"-", "\[Infinity]"}], ",", "9"}], "}"}]}], "]"}], "//",
       "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[",
         RowBox[{"i", "-", "1"}], "]"}], "[", "x_", "]"}], "=",
       RowBox[{
        RowBox[{"outer", "[",
         RowBox[{
          RowBox[{"MiniMaxApproximation", "[",
           RowBox[{
            RowBox[{
             RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
             RowBox[{"exact", "[",
              RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
            RowBox[{"{",
             RowBox[{"\[FormalX]", ",",
              RowBox[{
               RowBox[{"InverseFunction", "[", "inner", "]"}], "[",
               RowBox[{"{",
                RowBox[{
                 RowBox[{"xs", "\[LeftDoubleBracket]",
                  RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",",
                 RowBox[{
                 "xs", "\[LeftDoubleBracket]", "i",
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "9", ",",
              "0"}], "}"}], ",",
            RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}],
          "\[LeftDoubleBracket]",
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "/.",
        RowBox[{"\[FormalX]", "\[Rule]",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x",
          "]"}]}]}]}], ";"}], "\[IndentingNewLine]", ",",
     "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"i", ",", "2", ",",
       RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";",
  RowBox[{"inner", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x_", "]"}], "=",
    RowBox[{
     RowBox[{"outer", "[",
      RowBox[{
       RowBox[{"Series", "[",
        RowBox[{
         RowBox[{
          RowBox[{"InverseFunction", "[", "outer", "]"}], "[",
          RowBox[{"exact", "[",
           RowBox[{"inner", "[", "\[FormalX]", "]"}], "]"}], "]"}], ",",
         RowBox[{"{",
          RowBox[{"\[FormalX]", ",", "\[Infinity]", ",", "9"}], "}"}]}],
        "]"}], "//", "Normal"}], "]"}], "/.",
     RowBox[{"\[FormalX]", "\[Rule]",
      RowBox[{
       RowBox[{"InverseFunction", "[", "inner", "]"}], "[", "x", "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "x_", "]"}], "=",
    RowBox[{"Piecewise", "[",
     RowBox[{"Join", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{"{",
          RowBox[{
           RowBox[{
            RowBox[{"fn", "[",
             RowBox[{"i", "-", "1"}], "]"}], "[", "x", "]"}], ",",
           RowBox[{"x", "<",
            RowBox[{
            "xs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",",
         RowBox[{"{",
          RowBox[{"i", ",",
           RowBox[{"Length", "[", "xs", "]"}]}], "}"}]}], "]"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"{", "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{
          RowBox[{
           RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}], ",",
          "True"}], "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"LogLogPlot", "[",
   RowBox[{
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"exact", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"0.5",
       RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",",
      RowBox[{"1.5",
       RowBox[{"xs", "\[LeftDoubleBracket]",
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",",
    "\[IndentingNewLine]",
    RowBox[{"PlotRange", "\[Rule]",
     RowBox[{"{",
      RowBox[{"All", ",",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "20"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "10"}]]}], "}"}]}], "}"}]}], ",",
    "\[IndentingNewLine]",
    RowBox[{"Epilog", "\[Rule]",
     RowBox[{"{", "\[IndentingNewLine]",
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{"1", ",",
           RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]",
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"LogLinearPlot", "[",
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exact", "[", "x", "]"}],
     RowBox[{"f", "[", "x", "]"}]], "-", "1"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"0.5",
      RowBox[{"xs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
     ",",
     RowBox[{"1.5",
      RowBox[{"xs", "\[LeftDoubleBracket]",
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",
   RowBox[{"MaxRecursion", "\[Rule]", "10"}], ",", "\[IndentingNewLine]",
   RowBox[{"Epilog", "\[Rule]",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",

      RowBox[{"InfiniteLine", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"1", ",",
          RowBox[{
           RowBox[{"-", "2"}], "$MachineEpsilon"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[1062]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     FractionBox["1",
      SuperscriptBox["x", "3"]],
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "2",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "3"], " ",
     RowBox[{
      RowBox[{"CoefficientList", "[",
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "0", "]"}], "[", "x", "]"}], ",",
        RowBox[{"Log", "[", "x", "]"}]}], "]"}], "\[LeftDoubleBracket]", "1",
      "\[RightDoubleBracket]"}]}], ",",
    SuperscriptBox["x", "2"]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]}], "Input",
 CellLabel->
  "In[1073]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(",
       FractionBox[
        RowBox[{"Exp", "[",
         RowBox[{"-", "x"}], "]"}],
        SqrtBox["x"]], ")"}],
      RowBox[{"-", "1"}]],
     RowBox[{
      RowBox[{"fn", "[", "\[Infinity]", "]"}], "[", "x", "]"}]}], ",",
    SuperscriptBox["x",
     RowBox[{"-", "1"}]]}], "]"}], "//",
  RowBox[{
   RowBox[{"N", "[",
    RowBox[{"#", ",", "20"}], "]"}], "&"}]}]], "Input",
 CellLabel->
  "In[1075]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", "p_", "]"}],
          SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "p"}]}], ",",
       RowBox[{"Log", "[", "x", "]"}]}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"N", "[",
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[", "i", "]"}], "[", "x", "]"}], "/.",
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "p_", "]"}],
        SuperscriptBox["x", "n_"]}], "\[RuleDelayed]", "n"}]}], ",",
     RowBox[{"{",
      RowBox[{"i", ",",
       RowBox[{
        RowBox[{"Length", "[", "xs", "]"}], "-", "1"}]}], "}"}]}], "]"}], ",",
    "20"}], "]"}]}], "Input",
 CellLabel->
  "In[1076]:="]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"exact", "[", "x", "]"}]}], "}"}], ",",
    RowBox[{"{",
     RowBox[{"x", ",",
      RowBox[{"Join", "[",
       RowBox[{
        SuperscriptBox["10",
         RowBox[{"Subdivide", "[",
          RowBox[{
           RowBox[{"-", "20"}], ",", "20", ",", "1000"}], "]"}]], ",",
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", ">", "1000000"}]}], "\[Rule]", "\[Infinity]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"%", "/.",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], "/;",
     RowBox[{"x", "<",
      RowBox[{"-", "1000000"}]}]}], "\[Rule]", "0"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Export", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"FileNameJoin", "[",
    RowBox[{"{",
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",",
      "\"\<test\>\"", ",", "\"\<data\>\"", ",", "\"\<bessel_k3.csv\>\""}],
     "}"}], "]"}], ",", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"N", "[",
     RowBox[{"%", ",", "20"}], "]"}], "/.",
    RowBox[{
     RowBox[{"ComplexInfinity", "|", "Infinity", "|", "Indeterminate"}],
     "\[Rule]", "\"\<NaN\>\""}]}], ",", "\"\<CSV\>\"", ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<HeaderLines\>\"", "\[Rule]",
    RowBox[{"{",
     RowBox[{"\"\<x\>\"", ",", "\"\<bessel\>\""}], "}"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}],
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[1078]:="]
}]]
}]]
}]]
}]
(* End of Notebook Content *)
