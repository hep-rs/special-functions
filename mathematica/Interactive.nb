(* Content-type: application/vnd.wolfram.mathematica *)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[",
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"<<", "RustApproximation`"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Bessel", "Section"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["I", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"343415f9-c850-459c-8d39-2f139b620a05"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselI", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{
      SuperscriptBox["x",
       RowBox[{"-", "n"}]],
      RowBox[{"f", "[", "x", "]"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "n"],
          RowBox[{"lower", "/",
           RowBox[{"f", "[", "x", "]"}]}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\n",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{
   RowBox[{
    RowBox[{"Re", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "//",
    "FullSimplify"}], "//", "ExpandAll"}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "20", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\n"}], "\[IndentingNewLine]",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[",
      RowBox[{"-", "x"}], "]"}], " ",
     RowBox[{"Sqrt", "[", "x", "]"}], " ", "upper"}], ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["J", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"1c6af4e8-40f5-4d24-ba68-b0de3fd53d74"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "6"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselJ", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{
      SuperscriptBox["x",
       RowBox[{"-", "n"}]],
      RowBox[{"f", "[", "x", "]"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "n"],
          RowBox[{"lower", "/",
           RowBox[{"f", "[", "x", "]"}]}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"upperAmpSq", "=",
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"BesselJ", "[",
          RowBox[{"n", ",", "x"}], "]"}], "2"], "+",
        SuperscriptBox[
         RowBox[{"BesselY", "[",
          RowBox[{"n", ",", "x"}], "]"}], "2"]}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "\[Infinity]", ",", "20"}], "}"}]}], "]"}]}], "//",
    "Simplify"}], "//", "ExpandAll"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"upperPhase", "=",
   RowBox[{
    RowBox[{"x", "-",
     RowBox[{
      RowBox[{"(",
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "n"}], "+",
        FractionBox["1", "4"]}], ")"}], "\[Pi]"}], "+",
     FractionBox[
      RowBox[{"\[Mu]", "-", "1"}],
      RowBox[{"2",
       RowBox[{"(",
        RowBox[{"4", "x"}], ")"}]}]], "+",
     FractionBox[
      RowBox[{
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "1"}], ")"}],
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "25"}], ")"}]}],
      RowBox[{"6",
       SuperscriptBox[
        RowBox[{"(",
         RowBox[{"4", "x"}], ")"}], "3"]}]], "+",
     FractionBox[
      RowBox[{
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "1"}], ")"}],
       RowBox[{"(",
        RowBox[{
         SuperscriptBox["\[Mu]", "2"], "-",
         RowBox[{"114", "\[Mu]"}], "+", "1073"}], ")"}]}],
      RowBox[{"5",
       SuperscriptBox[
        RowBox[{"(",
         RowBox[{"4", "x"}], ")"}], "5"]}]], "+",
     FractionBox[
      RowBox[{
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "1"}], ")"}],
       RowBox[{"(",
        RowBox[{
         RowBox[{"5",
          SuperscriptBox["\[Mu]", "3"]}], "-",
         RowBox[{"1535",
          SuperscriptBox["\[Mu]", "2"]}], "+",
         RowBox[{"54703", "\[Mu]"}], "-", "375733"}], ")"}]}],
      RowBox[{"14",
       SuperscriptBox[
        RowBox[{"(",
         RowBox[{"4", "x"}], ")"}], "7"]}]]}], "/.",
    RowBox[{"{",
     RowBox[{"\[Mu]", "->",
      RowBox[{"4",
       SuperscriptBox["n", "2"]}]}], "}"}]}]}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"upper", "=",
   RowBox[{
    SqrtBox["upperAmpSq"],
    RowBox[{"Cos", "[", "upperPhase", "]"}]}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"N", "[",
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"BesselJZero", "[",
        RowBox[{"n", ",", "k"}], "]"}], "+",
       RowBox[{"BesselJZero", "[",
        RowBox[{"n", ",",
         RowBox[{"k", "+", "1"}]}], "]"}]}], "2"], ",",
     RowBox[{"2", "$MachinePrecision"}]}], "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"PrintTemporary", "[",
   RowBox[{"Dynamic", "[",
    RowBox[{"Row", "[",
     RowBox[{"{",
      RowBox[{
      "\"\<k = \>\"", ",", "k", ",", "\"\<\\t x = \>\"", ",", "xUpper"}],
      "}"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"While", "[", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox["upper",
         RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ">",
      RowBox[{"SetPrecision", "[",
       RowBox[{
        FractionBox["$MachineEpsilon", "100"], ",", "\[Infinity]"}], "]"}]}],
     "/.",
     RowBox[{"x", "\[Rule]", "xUpper"}]}], ",", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"k", "++"}], ";", "\[IndentingNewLine]",
     RowBox[{"xUpper", "=",
      RowBox[{"N", "[",
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"BesselJZero", "[",
           RowBox[{"n", ",", "k"}], "]"}], "+",
          RowBox[{"BesselJZero", "[",
           RowBox[{"n", ",",
            RowBox[{"k", "+", "1"}]}], "]"}]}], "2"], ",",
        RowBox[{"2", "$MachinePrecision"}]}], "]"}]}], ";"}]}],
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"CoefficientList", "[",
  RowBox[{
   RowBox[{"x", " ", "upperAmpSq"}], ",",
   FractionBox["1",
    SuperscriptBox["x", "2"]]}], "]"}], "\[IndentingNewLine]",
 RowBox[{"CoefficientList", "[",
  RowBox[{
   RowBox[{"x",
    RowBox[{"(",
     RowBox[{"upperPhase", "-",
      RowBox[{"(",
       RowBox[{"x", "-",
        RowBox[{
         RowBox[{"(",
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], "n"}], "+",
           FractionBox["1", "4"]}], ")"}], "\[Pi]"}]}], ")"}]}], ")"}]}], ",",
   FractionBox["1",
    SuperscriptBox["x", "2"]]}], "]"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Length", "[", "splits", "]"}]}], "Input"],

Cell[CellGroupData[{


}]]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"e7580b00-1056-400e-a432-00bca498e8c7"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselK", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"{",
   RowBox[{"lowerPoly", ",", "lowerLn"}], "}"}], "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",",
    RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "n"], "lowerPoly"}], ",",
    SuperscriptBox["x", "2"]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     SuperscriptBox["x",
      RowBox[{"-", "n"}]], "lowerLn"}], ",",
    SuperscriptBox["x", "2"]}], "]"}]}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\n"}], "\[IndentingNewLine]",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], " ",
     RowBox[{"Sqrt", "[", "x", "]"}], " ", "upper"}], ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{


}]]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogLogPlot", "[",
  RowBox[{
   RowBox[{"Evaluate", "@",
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"Normal", "@",
        RowBox[{"Series", "[",
         RowBox[{
          RowBox[{"f", "[", "x", "]"}], ",",
          RowBox[{"{",
           RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     FractionBox["xLower", "2"], ",", "xLower"}], "}"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"Evaluate", "@",
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"Normal", "@",
        RowBox[{"Series", "[",
         RowBox[{
          RowBox[{"f", "[", "x", "]"}], ",",
          RowBox[{"{",
           RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
   "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",",
     FractionBox["xLower", "2"], ",", "xLower"}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]",
    RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Show", "[", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"ParallelTable", "[",
       RowBox[{
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"Abs", "[",
           RowBox[{
            FractionBox[
             RowBox[{"outer", "@",
              RowBox[{
               RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
               RowBox[{"inner", "@", "x"}], "]"}]}],
             RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"Subdivide", "[",
           RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
       "]"}], ",", "\[IndentingNewLine]",
      RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
      RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]", "]"}], ",",
     "\[IndentingNewLine]",
    RowBox[{"LogLogPlot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"Evaluate", "@",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"Normal", "@",
           RowBox[{"Series", "[",
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",",
             RowBox[{"{",
              RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        FractionBox["xLower", "2"], ",", "xLower"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}],
     ",", "\[IndentingNewLine]",
    RowBox[{"LogLogPlot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"Evaluate", "@",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"Normal", "@",
           RowBox[{"Series", "[",
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",",
             RowBox[{"{",
              RowBox[{"x", ",", "\[Infinity]", ",", "10"}], "}"}]}], "]"}]}],

          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "xUpper", ",",
        RowBox[{"2", "xUpper"}]}], "}"}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}],
     ",", "\[IndentingNewLine]",
    RowBox[{"PlotRange", "->",
     RowBox[{"Log", "@",
      RowBox[{"{",
       RowBox[{
        RowBox[{"{",
         RowBox[{
          FractionBox["xLower", "20"], ",",
          RowBox[{"2", "xUpper"}]}], "}"}], ",",
        RowBox[{"{",
         RowBox[{
          SuperscriptBox["10",
           RowBox[{"-", "30"}]], ",",
          RowBox[{"2", "$MachineEpsilon"}]}], "}"}]}], "}"}]}]}]}],
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    SubscriptBox["K", "1"],
    SubscriptBox["K", "2"]],
   RowBox[{"(", "x", ")"}]}],
  TraditionalForm]],ExpressionUUID->"981cd629-7574-40fb-bbf0-fd0e86be639c"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   FractionBox[
    RowBox[{"BesselK", "[",
     RowBox[{"1", ",", "x"}], "]"}],
    RowBox[{"BesselK", "[",
     RowBox[{"2", ",", "x"}], "]"}]]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{
    RowBox[{"x", "/", "50"}], "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"{",
    RowBox[{"lowerPoly", ",", "lowerLn", ",", "lowerLn2"}], "}"}], "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{
     RowBox[{
      RowBox[{"x", "^",
       RowBox[{"-", "1"}]}], " ", "lower"}], ",",
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], ";"}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lowerPoly", ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^",
      RowBox[{"-", "2"}]}], " ", "lowerLn"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn2", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^",
      RowBox[{"-", "6"}]}], " ", "lowerLn2"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\n", "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "large", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"upper", ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["Y", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"241d4c45-4b52-4e7b-846d-1646b32644ae"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "6"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselY", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\n",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"{",
    RowBox[{"lowerPoly", ",", "lowerLn"}], "}"}], "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{"lower", ",",
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], ";"}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "n"}], " ", "lowerPoly"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^",
      RowBox[{"(",
       RowBox[{"-", "n"}], ")"}]}], " ", "lowerLn"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"upperAmpSq", "=",
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"BesselJ", "[",
          RowBox[{"n", ",", "x"}], "]"}], "2"], "+",
        SuperscriptBox[
         RowBox[{"BesselY", "[",
          RowBox[{"n", ",", "x"}], "]"}], "2"]}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "\[Infinity]", ",", "20"}], "}"}]}], "]"}]}], "//",
    "Simplify"}], "//", "ExpandAll"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"upperPhase", "=",
   RowBox[{
    RowBox[{"x", "-",
     RowBox[{
      RowBox[{"(",
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "n"}], "+",
        FractionBox["1", "4"]}], ")"}], "\[Pi]"}], "+",
     FractionBox[
      RowBox[{"\[Mu]", "-", "1"}],
      RowBox[{"2",
       RowBox[{"(",
        RowBox[{"4", "x"}], ")"}]}]], "+",
     FractionBox[
      RowBox[{
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "1"}], ")"}],
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "25"}], ")"}]}],
      RowBox[{"6",
       SuperscriptBox[
        RowBox[{"(",
         RowBox[{"4", "x"}], ")"}], "3"]}]], "+",
     FractionBox[
      RowBox[{
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "1"}], ")"}],
       RowBox[{"(",
        RowBox[{
         SuperscriptBox["\[Mu]", "2"], "-",
         RowBox[{"114", "\[Mu]"}], "+", "1073"}], ")"}]}],
      RowBox[{"5",
       SuperscriptBox[
        RowBox[{"(",
         RowBox[{"4", "x"}], ")"}], "5"]}]], "+",
     FractionBox[
      RowBox[{
       RowBox[{"(",
        RowBox[{"\[Mu]", "-", "1"}], ")"}],
       RowBox[{"(",
        RowBox[{
         RowBox[{"5",
          SuperscriptBox["\[Mu]", "3"]}], "-",
         RowBox[{"1535",
          SuperscriptBox["\[Mu]", "2"]}], "+",
         RowBox[{"54703", "\[Mu]"}], "-", "375733"}], ")"}]}],
      RowBox[{"14",
       SuperscriptBox[
        RowBox[{"(",
         RowBox[{"4", "x"}], ")"}], "7"]}]]}], "/.",
    RowBox[{"{",
     RowBox[{"\[Mu]", "->",
      RowBox[{"4",
       SuperscriptBox["n", "2"]}]}], "}"}]}]}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{
     SqrtBox["upperAmpSq"],
     RowBox[{"Sin", "[", "upperPhase", "]"}]}]}], ";"}],
  "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"N", "[",
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"BesselYZero", "[",
        RowBox[{"n", ",", "k"}], "]"}], "+",
       RowBox[{"BesselYZero", "[",
        RowBox[{"n", ",",
         RowBox[{"k", "+", "1"}]}], "]"}]}], "2"], ",",
     RowBox[{"2", "$MachinePrecision"}]}], "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"PrintTemporary", "[",
   RowBox[{"Dynamic", "[",
    RowBox[{"Row", "[",
     RowBox[{"{",
      RowBox[{
      "\"\<k = \>\"", ",", "k", ",", "\"\<\\t x = \>\"", ",", "xUpper"}],
      "}"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"While", "[", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox["upper",
         RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ">",
      RowBox[{"SetPrecision", "[",
       RowBox[{
        FractionBox["$MachineEpsilon", "100"], ",", "\[Infinity]"}], "]"}]}],
     "/.",
     RowBox[{"x", "\[Rule]", "xUpper"}]}], ",", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"k", "++"}], ";", "\[IndentingNewLine]",
     RowBox[{"xUpper", "=",
      RowBox[{"N", "[",
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"BesselYZero", "[",
           RowBox[{"n", ",", "k"}], "]"}], "+",
          RowBox[{"BesselYZero", "[",
           RowBox[{"n", ",",
            RowBox[{"k", "+", "1"}]}], "]"}]}], "2"], ",",
        RowBox[{"2", "$MachinePrecision"}]}], "]"}]}], ";"}]}],
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"upperAmpSq", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"x", " ", "upperAmpSq"}], ",",
    FractionBox["1",
     SuperscriptBox["x", "2"]]}], "]"}]}], "\[IndentingNewLine]",
 RowBox[{"upperPhase", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"x",
     RowBox[{"(",
      RowBox[{"upperPhase", "-",
       RowBox[{"(",
        RowBox[{"x", "-",
         RowBox[{
          RowBox[{"(",
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], "n"}], "+",
            FractionBox["1", "4"]}], ")"}], "\[Pi]"}]}], ")"}]}], ")"}]}],
    ",",
    FractionBox["1",
     SuperscriptBox["x", "2"]]}], "]"}]}]}], "Input"]
}]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upper", "=",
   RowBox[{
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}], "//",
    "ExpToTrig"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Echo", "[",
   RowBox[{
    RowBox[{"Dynamic", "[", "k", "]"}], ",", "\"\<k = \>\""}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{
      FractionBox["1", "2"],
      RowBox[{"(",
       RowBox[{
        RowBox[{"BesselYZero", "[",
         RowBox[{"n", ",", "k"}], "]"}], "+",
        RowBox[{"BesselYZero", "[",
         RowBox[{"n", ",",
          RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", "100"}], "]"}]}],
  ";"}], "\n",
 RowBox[{"While", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"(",
     RowBox[{
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox["upper",
         RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ">",
      RowBox[{"SetPrecision", "[",
       RowBox[{
        FractionBox["$MachineEpsilon", "100"], ",", "\[Infinity]"}], "]"}]}],
     ")"}], "/.",
    RowBox[{"x", "\[Rule]", "xUpper"}]}], ",", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"k", "++"}], ";", "\[IndentingNewLine]",
    RowBox[{"xUpper", "=",
     RowBox[{"N", "[",
      RowBox[{
       RowBox[{
        FractionBox["1", "2"],
        RowBox[{"(",
         RowBox[{
          RowBox[{"BesselYZero", "[",
           RowBox[{"n", ",", "k"}], "]"}], "+",
          RowBox[{"BesselYZero", "[",
           RowBox[{"n", ",",
            RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", "100"}],
      "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\n"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", "x", "]"}], " ", "upper"}], ",",
      RowBox[{"1", "/", "x"}]}], "]"}]}], ";"}], "\n",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"For", " ", "some", " ", "reason"}], ",",
    RowBox[{"these", " ", "should", " ", "be", " ", "cos",
     RowBox[{"(", "x", ")"}], " ", "and", " ", "sin",
     RowBox[{"(", "x", ")"}]}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"upperCos", "=",
  RowBox[{"Coefficient", "[",
   RowBox[{"upper", ",",
    RowBox[{"Cos", "[", "x", "]"}]}], "]"}]}], "\n",
 RowBox[{"upperSin", "=",
  RowBox[{"Coefficient", "[",
   RowBox[{"upper", ",",
    RowBox[{"Sin", "[", "x", "]"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"Length", "[", "splits", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Other", "Section"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\[CapitalGamma]", "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"7ee92670-55f8-4994-95d4-d53b73c2866b"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"Gamma", "[", "x", "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"x", " ",
      RowBox[{"f", "[", "x", "]"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"(",
           RowBox[{"x", " ",
            RowBox[{"f", "[", "x", "]"}]}], ")"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",", "x"}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], "/",
      RowBox[{"(",
       RowBox[{
        RowBox[{"Sqrt", "[", "x", "]"}], " ",
        RowBox[{"Exp", "[",
         RowBox[{
          RowBox[{"(",
           RowBox[{
            RowBox[{"Log", "[", "x", "]"}], "-", "1"}], ")"}], "x"}], "]"}]}],
        ")"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"(",
           RowBox[{
            RowBox[{"f", "[", "x", "]"}], "/",
            RowBox[{"(",
             RowBox[{
              RowBox[{"Sqrt", "[", "x", "]"}], " ",
              RowBox[{"Exp", "[",
               RowBox[{
                RowBox[{"(",
                 RowBox[{
                  RowBox[{"Log", "[", "x", "]"}], "-", "1"}], ")"}], "x"}],
               "]"}]}], ")"}]}], ")"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "\n",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"upper", ",",
    FractionBox["1", "x"]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"HarmonicNumber", "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"473d1321-df6f-4992-9911-dfd6480b5398"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"HarmonicNumber", "[", "x", "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\n",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",", "x"}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "\n",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"upper", "-",
     RowBox[{"Log", "[", "x", "]"}]}], ",",
    FractionBox["1", "x"]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{
      RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
      RowBox[{"f", "[",
       RowBox[{
        RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"inner", "@", "xLower"}], ",",
       RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["Li", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"69fe7eb8-71a6-417c-b118-550478702dc7"]], \
"Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[",
   RowBox[{"-", "7.2443596007499*^-10"}], "]"}], "//", "CForm"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[",
  RowBox[{"x", "-", "1"}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[",
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"x", "+", "1"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input"]
}]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "<", "1"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"PolyLog", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        RowBox[{"-", "2"}], ",",
        RowBox[{"-", "Infinity"}], ",", "1"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"-", "Infinity"}], ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\n",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"lower", "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{"lower", ",",
     RowBox[{"Log", "[",
      RowBox[{"-", "x"}], "]"}]}], "]"}]}], ";"}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"First", "@", "lower"}], ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{
   RowBox[{"{", "0", "}"}], "~", "Join", "~",
   RowBox[{"Rest", "@", "lower"}]}]}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mid", "=",
   RowBox[{"Normal", "@",
    RowBox[{"Series", "[",
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",",
      RowBox[{"{",
       RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xMidLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox["mid",
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        RowBox[{"-", "2"}], ",",
        RowBox[{"-", "\[Infinity]"}], ",", "0"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xMidUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox["mid",
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        FractionBox["1", "2"], ",", "0", ",", "1"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Print", "[",
   RowBox[{
    RowBox[{
    "StringTemplate", "[", "\"\<Lower approximation valid from `` to ``.\>\"",
      "]"}], "[",
    RowBox[{
     RowBox[{"N", "[",
      RowBox[{"xMidLower", ",", "4"}], "]"}], ",",
     RowBox[{"N", "[",
      RowBox[{"xMidUpper", ",", "4"}], "]"}]}], "]"}], "]"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"CoefficientList", "[",
  RowBox[{"mid", ",", "x"}], "]"}], "\[IndentingNewLine]"}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "1", ",", "10"}], "}"}]}],
    "]"}]}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        FractionBox["1", "2"], ",",
        RowBox[{"-", "\[Infinity]"}], ",", "1"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "1"}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"{",
    RowBox[{"upperPoly", ",", "upperLn"}], "}"}], "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{"upper", ",",
     RowBox[{"Log", "[",
      RowBox[{"1", "-", "x"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{"upperPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"upperPoly", "/.",
     RowBox[{"x", "\[Rule]",
      RowBox[{"x", "+", "1"}]}]}], ",", "x"}], "]"}]}], "\[IndentingNewLine]",
 RowBox[{"upperLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"upperLn", "/.",
     RowBox[{"x", "\[Rule]",
      RowBox[{"x", "+", "1"}]}]}], ",", "x"}], "]"}]}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"splits", "=",
    RowBox[{"ChebyshevSplits", "[",
     RowBox[{
      RowBox[{
       RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
       RowBox[{"f", "[",
        RowBox[{
         RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
      ",",
      RowBox[{"{",
       RowBox[{"x", ",",
        RowBox[{"inner", "@", "xLower"}], ",",
        RowBox[{"inner", "@", "xMidLower"}]}], "}"}]}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xMidLower", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]}], "Input"],

Cell[CellGroupData[{


}]]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"splits", "=",
    RowBox[{"ChebyshevSplits", "[",
     RowBox[{
      RowBox[{
       RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
       RowBox[{"f", "[",
        RowBox[{
         RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
      ",",
      RowBox[{"{",
       RowBox[{"x", ",",
        RowBox[{"inner", "@", "xMidUpper"}], ",",
        RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xMidUpper", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]}], "Input"],

Cell[CellGroupData[{


}]]
}]]
}]],

Cell[CellGroupData[{

Cell["LogDiff", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[",
   RowBox[{"a_", ",", "b_"}], "]"}], ":=",
  RowBox[{"Re", "@",
   RowBox[{"Log", "[",
    FractionBox[
     RowBox[{"a", "+", "b"}],
     RowBox[{"a", "-", "b"}]], "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Series", "[",
   RowBox[{
    RowBox[{"f", "[",
     RowBox[{"a", ",", "b"}], "]"}], ",",
    RowBox[{"{",
     RowBox[{"a", ",", "\[Infinity]", ",", "20"}], "}"}]}], "]"}], "//",
  "Normal"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[",
      RowBox[{"a", ",", "b"}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"b", ",", "\[Infinity]", ",", "20"}], "}"}]}], "]"}], "//",
   "Normal"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{"Sum", "[",
  RowBox[{
   RowBox[{"2",
    FractionBox[
     SuperscriptBox["x",
      RowBox[{
       RowBox[{"2", "n"}], "+", "1"}]],
     RowBox[{
      RowBox[{"2", "n"}], "+", "1"}]]}], ",",
   RowBox[{"{",
    RowBox[{"n", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"Evaluate", "@",
    RowBox[{"{", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox[
         RowBox[{"Normal", "@",
          RowBox[{"Series", "[",
           RowBox[{
            RowBox[{"f", "[",
             RowBox[{"1", ",", "x"}], "]"}], ",",
            RowBox[{"{",
             RowBox[{"x", ",", "\[Infinity]", ",", "50"}], "}"}]}], "]"}]}],
         RowBox[{"f", "[",
          RowBox[{"1", ",", "x"}], "]"}]], "-", "1"}], "]"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox[
         RowBox[{"2",
          RowBox[{"ArcTanh", "[",
           RowBox[{"1", "/", "x"}], "]"}]}],
         RowBox[{"f", "[",
          RowBox[{"1", ",", "x"}], "]"}]], "-", "1"}], "]"}]}],
     "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",", "2", ",",
     SuperscriptBox["10", "5"]}], "}"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Particle Statistics", "Section"],

Cell[CellGroupData[{

Cell["Massless Number Density", "Subsection"],

Cell[CellGroupData[{

Cell["Bose-Einstein", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   RowBox[{"1", "/",
    RowBox[{"(",
     RowBox[{
      RowBox[{"Exp", "[",
       RowBox[{"u", "-", "x"}], "]"}], "-", "1"}], ")"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], "=",
  RowBox[{
   RowBox[{"Re", "@",
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ",
       RowBox[{"u", "^", "2"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], "/",
   RowBox[{"(",
    RowBox[{"2", " ",
     RowBox[{"Pi", "^", "2"}]}], ")"}]}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{"lower", "=",
    RowBox[{"Simplify", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}]}], "\n",

   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "2"}], ",",
          RowBox[{"-", "Infinity"}], ",", "0"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
   "\[IndentingNewLine]", "\n",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "small", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"lower", "=",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{"lower", ",",
       RowBox[{"Exp", "[", "x", "]"}]}], "]"}], "//",
     "FullSimplify"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "approximation", " ", "for", " ", "large", " ",
    "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Simplify", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}]}],
   "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
       RowBox[{
       "StringTemplate", "[",
        "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], "]"}], ",", "\[Infinity]"}],
     "]"}], ";"}], "\n", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "large", " ",
     RowBox[{"x", "."}]}], "*)"}], "\[IndentingNewLine]",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"upper", ",", "x"}], "]"}]}], "\[IndentingNewLine]",
   RowBox[{"upperExp", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{"upper", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       ",",
      RowBox[{"Exp", "[",
       RowBox[{"-", "x"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
   RowBox[{"upperPoly", "=",
    RowBox[{
     RowBox[{"{", "0", "}"}], "~", "Join", "~",
     RowBox[{"Rest", "@", "upper"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell["Fermi-Dirac", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   RowBox[{"1", "/",
    RowBox[{"(",
     RowBox[{
      RowBox[{"Exp", "[",
       RowBox[{"u", "-", "x"}], "]"}], "+", "1"}], ")"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ",
       RowBox[{"u", "^", "2"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}], "/",
    RowBox[{"(",
     RowBox[{"2", " ",
      RowBox[{"Pi", "^", "2"}]}], ")"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "approximation", " ", "for", " ", "small", " ",
    "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{"lower", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{
          RowBox[{"SetPrecision", "[",
           RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}], "/",
          "100"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "2"}], ",",
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"-", "Infinity"}], ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "small", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"lower", "=",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{"lower", ",",
       RowBox[{"Exp", "[", "x", "]"}]}], "]"}], "//", "N"}]}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",",
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "0"}], "]"}], "]"}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "large", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"upper", ",", "x"}], "]"}]}], "\n",
   RowBox[{"upperExp", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{"upper", "[",
       RowBox[{"[", "1", "]"}], "]"}], ",",
      RowBox[{"Exp", "[",
       RowBox[{"-", "x"}], "]"}]}], "]"}]}], "\n",
   RowBox[{"upperPoly", "=",
    RowBox[{
     RowBox[{"{", "0", "}"}], "~", "Join", "~",
     RowBox[{"Rest", "@", "upper"}]}]}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ParallelTable", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"Abs", "[",
          RowBox[{
           FractionBox[
            RowBox[{"outer", "@",
             RowBox[{
              RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
              RowBox[{"inner", "@", "x"}], "]"}]}],
            RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"Subdivide", "[",
          RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
      "]"}], ",", "\[IndentingNewLine]",
     RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
     RowBox[{"PlotRange", "->",
      RowBox[{"{",
       RowBox[{
        RowBox[{"{",
         RowBox[{
          RowBox[{"2", "xLower"}], ",",
          RowBox[{"2", "xUpper"}]}], "}"}], ",",
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{
           SuperscriptBox["10",
            RowBox[{"-", "25"}]], ",",
           SuperscriptBox["10",
            RowBox[{"-", "14"}]]}], "}"}]}]}], "}"}]}]}],
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"LogPlot", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"Evaluate", "@",
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox[
         RowBox[{"Normal", "@",
          RowBox[{"Series", "[",
           RowBox[{
            RowBox[{"f", "[", "x", "]"}], ",",
            RowBox[{"{",
             RowBox[{"x", ",",
              RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}],
         RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
     "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"2", "xLower"}], ",", "xLower"}], "}"}], ",",
     "\[IndentingNewLine]",
     RowBox[{"PlotRange", "->",
      RowBox[{"{",
       RowBox[{
        RowBox[{"{",
         RowBox[{
          RowBox[{"2", "xLower"}], ",",
          RowBox[{"2", "xUpper"}]}], "}"}], ",",
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{
           SuperscriptBox["10",
            RowBox[{"-", "25"}]], ",",
           SuperscriptBox["10",
            RowBox[{"-", "14"}]]}], "}"}]}]}], "}"}]}], ",",
     "\[IndentingNewLine]",
     RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "\[IndentingNewLine]",
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"LogPlot", "[", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"Evaluate", "@",
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox[
         RowBox[{"Normal", "@",
          RowBox[{"Series", "[",
           RowBox[{
            RowBox[{"f", "[", "x", "]"}], ",",
            RowBox[{"{",
             RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}],
         RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
     "\[IndentingNewLine]",
     RowBox[{"{",
      RowBox[{"x", ",", "xUpper", ",",
       RowBox[{"2", "xUpper"}]}], "}"}], ",", "\[IndentingNewLine]",
     RowBox[{"PlotRange", "->",
      RowBox[{"{",
       RowBox[{
        RowBox[{"{",
         RowBox[{
          RowBox[{"2", "xLower"}], ",",
          RowBox[{"2", "xUpper"}]}], "}"}], ",",
        RowBox[{"Log", "@",
         RowBox[{"{",
          RowBox[{
           SuperscriptBox["10",
            RowBox[{"-", "25"}]], ",",
           SuperscriptBox["10",
            RowBox[{"-", "14"}]]}], "}"}]}]}], "}"}]}], ",",
     "\[IndentingNewLine]",
     RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "\[IndentingNewLine]",
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        RowBox[{"2", "xLower"}], ",",
        RowBox[{"2", "xUpper"}]}], "}"}], ",",
      RowBox[{"Log", "@",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "25"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "14"}]]}], "}"}]}]}], "}"}]}]}], "\[IndentingNewLine]",
   "]"}]], "Input"]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Normalized Massless Number Density", "Subsection"],

Cell[CellGroupData[{

Cell["Bose Einstein", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], "=",
  RowBox[{
   RowBox[{"Re", "@",
    RowBox[{"PolyLog", "[",
     RowBox[{"3", ",",
      RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}], "/",
   RowBox[{"Zeta", "[", "3", "]"}]}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{"lower", "=",
    RowBox[{"Simplify", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}]}], "\n",

   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "2"}], ",",
          RowBox[{"-", "Infinity"}], ",", "0"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"-", "Infinity"}], ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
   "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "small", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"lower", "=",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{"lower", ",",
       RowBox[{"Exp", "[", "x", "]"}]}], "]"}], "//",
     "FullSimplify"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "approximation", " ", "for", " ", "large", " ",
    "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Simplify", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}]}],
   "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
       RowBox[{
       "StringTemplate", "[",
        "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], "]"}], ",", "\[Infinity]"}],
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "large", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"upper", ",", "x"}], "]"}]}], "\[IndentingNewLine]",
   RowBox[{"upperExp", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{"upper", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       ",",
      RowBox[{"Exp", "[",
       RowBox[{"-", "x"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
   RowBox[{"upperPoly", "=",
    RowBox[{
     RowBox[{"{", "0", "}"}], "~", "Join", "~",
     RowBox[{"Rest", "@", "upper"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell["Fermi-Dirac", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], "/",
     RowBox[{"(",
      RowBox[{"3", " ",
       RowBox[{"Zeta", "[", "3", "]"}]}], ")"}]}],
    RowBox[{"PolyLog", "[",
     RowBox[{"3", ",",
      RowBox[{"-",
       RowBox[{"Exp", "[", "x", "]"}]}]}], "]"}]}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "approximation", " ", "for", " ", "small", " ",
    "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{"lower", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "2"}], ",",
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"-", "Infinity"}], ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
   "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "small", " ",
     RowBox[{"x", "."}]}], "*)"}], "\[IndentingNewLine]",
   RowBox[{"lower", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"lower", ",",
      RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",",
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "0"}], "]"}], "]"}], ";"}],
   "\n", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "large", " ",
     RowBox[{"x", "."}]}], "*)"}], "\[IndentingNewLine]",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"upper", ",", "x"}], "]"}]}], "\n",
   RowBox[{"upperExp", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{"upper", "[",
       RowBox[{"[", "1", "]"}], "]"}], ",",
      RowBox[{"Exp", "[",
       RowBox[{"-", "x"}], "]"}]}], "]"}]}], "\n",
   RowBox[{"upperPoly", "=",
    RowBox[{
     RowBox[{"{", "0", "}"}], "~", "Join", "~",
     RowBox[{"Rest", "@", "upper"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Massive Number Density", "Subsection"],

Cell[CellGroupData[{

Cell["Bose-Einstein", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   FractionBox["1",
    RowBox[{
     SuperscriptBox["E",
      RowBox[{"x", " ", "u"}]], "-", "1"}]]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{
    FractionBox["1",
     RowBox[{"2",
      SuperscriptBox["\[Pi]", "2"]}]],
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", "$MachinePrecision"}]}]}], "\[IndentingNewLine]",
     "]"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "20"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{"fit", "=",
    RowBox[{"NonlinearModelFit", "[",
     RowBox[{"data", ",",
      RowBox[{
       FractionBox["1",
        SuperscriptBox["x", "3"]],
       RowBox[{"(",
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "3", "]"}], "/",
          RowBox[{"Pi", "^", "2"}]}], "+",
         RowBox[{
          SuperscriptBox["x", "2"],
          RowBox[{"(",
           RowBox[{"b", "+",
            RowBox[{"c", " ",
             RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]}], ")"}]}], ",",
      RowBox[{"{",
       RowBox[{"b", ",", "c"}], "}"}], ",", "x"}], "]"}]}],
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "MachinePrecision"}], "]"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lower", "=",
   RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"PrecisionGoal", "\[Rule]", "3"}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{"Print", "[",
   RowBox[{
    RowBox[{
    "StringTemplate", "[", "\"\<Lower approximation valid from `` to ``.\>\"",
      "]"}], "[",
    RowBox[{"0", ",",
     RowBox[{"N", "[",
      RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}]}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], " ", "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{
        FractionBox["1",
         RowBox[{"2",
          SuperscriptBox["\[Pi]", "2"]}]],
        FractionBox[
         RowBox[{"BesselK", "[",
          RowBox[{"2", ",", "x"}], "]"}], "x"]}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
        RowBox[{"PrecisionGoal", "\[Rule]", "3"}], ",", "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
    ";"}], "\n", "\[IndentingNewLine]",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", "x", "]"}],
       SqrtBox["x"], " ", "upper"}], ",",
      RowBox[{"1", "/", "x"}]}], "]"}]}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"upper", "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        SuperscriptBox["\[Pi]", "2"]}]],
      FractionBox[
       RowBox[{"BesselK", "[",
        RowBox[{"2", ",", "x"}], "]"}], "x"]}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"2", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[CellGroupData[{


}]]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->",
    RowBox[{"{",
     RowBox[{
      RowBox[{"{",
       RowBox[{
        FractionBox["xLower", "2"], ",",
        RowBox[{"2", "xUpper"}]}], "}"}], ",",
      RowBox[{"Log", "@",
       RowBox[{"{",
        RowBox[{
         SuperscriptBox["10",
          RowBox[{"-", "25"}]], ",",
         SuperscriptBox["10",
          RowBox[{"-", "14"}]]}], "}"}]}]}], "}"}]}]}], "\[IndentingNewLine]",
   "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Fermi-Dirac", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   FractionBox["1",
    RowBox[{
     SuperscriptBox["E",
      RowBox[{"x", " ", "u"}]], "+", "1"}]]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{
    FractionBox["1",
     RowBox[{"2",
      SuperscriptBox["\[Pi]", "2"]}]],
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"MaxRecursion", "\[Rule]", "100"}], ",", "\[IndentingNewLine]",

      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"3", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "20"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"fit", "=",
     RowBox[{"NonlinearModelFit", "[",
      RowBox[{"data", ",",
       RowBox[{
        FractionBox["1",
         SuperscriptBox["x", "3"]],
        RowBox[{"(",
         RowBox[{
          FractionBox[
           RowBox[{"3",
            RowBox[{"Zeta", "[", "3", "]"}]}],
           RowBox[{"4",
            SuperscriptBox["\[Pi]", "2"]}]], "-",
          RowBox[{"b", " ",
           SuperscriptBox["x", "2"]}], "+",
          RowBox[{"c", " ",
           SuperscriptBox["x", "4"]}]}], ")"}]}], ",",
       RowBox[{"{",
        RowBox[{"b", ",", "c"}], "}"}], ",", "x"}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lower", "=",
   RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Print", "[",
   RowBox[{"Dynamic", "[", "xMon", "]"}], "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"PrecisionGoal", "\[Rule]", "3"}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"3", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"StepMonitor", ":>",
       RowBox[{"(",
        RowBox[{"xMon", "=", "x"}], ")"}]}]}], "\[IndentingNewLine]",
     "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{"Print", "[",
   RowBox[{
    RowBox[{
    "StringTemplate", "[", "\"\<Lower approximation valid from `` to ``.\>\"",
      "]"}], "[",
    RowBox[{"0", ",",
     RowBox[{"N", "[",
      RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{


}]]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"upper", "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        SuperscriptBox["\[Pi]", "2"]}]],
      FractionBox[
       RowBox[{"BesselK", "[",
        RowBox[{"2", ",", "x"}], "]"}], "x"]}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"3", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[CellGroupData[{


}]]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetPrecision", "[",
    RowBox[{"0.09134537117517981", ",", "\[Infinity]"}], "]"}], " ",
   SuperscriptBox[
    RowBox[{"SetPrecision", "[",
     RowBox[{"0.000010000000000000001", ",", "\[Infinity]"}], "]"}],
    RowBox[{"-", "3"}]]}], "//", "CForm"}]], "Input"]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Normalized Massive Number Density", "Subsection"],

Cell[CellGroupData[{

Cell["Bose-Einstein", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ClearAll", "[", "f", "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   FractionBox["1",
    RowBox[{
     SuperscriptBox["E",
      RowBox[{"x", " ", "u"}]], "-", "1"}]]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f0", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{"Quiet", "@",
    RowBox[{"NIntegrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalization", "[", "x_", "]"}], "=",
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       FractionBox["1",
        RowBox[{
         SuperscriptBox["E",
          RowBox[{"x", " ", "u"}]], "-", "1"}]],
       SuperscriptBox["u", "2"]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   FractionBox[
    RowBox[{"f0", "[", "x", "]"}],
    RowBox[{"normalization", "[", "x", "]"}]]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"fit", "=",
     RowBox[{"NonlinearModelFit", "[",
      RowBox[{"data", ",",
       RowBox[{"1", "+",
        RowBox[{
         SuperscriptBox["x", "2"],
         RowBox[{"(",
          RowBox[{"a", "+",
           RowBox[{"b", " ",
            RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]}], ",",
       RowBox[{"{",
        RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"lower", "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"2", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"upper", "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        RowBox[{"Zeta", "[", "3", "]"}]}]],
      SuperscriptBox["x", "2"],
      RowBox[{"BesselK", "[",
       RowBox[{"2", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"2", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Identity"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell["Fermi-Dirac", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ClearAll", "[", "f", "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"UsingFermiDirac", "=", "False"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   FractionBox["1",
    RowBox[{
     SuperscriptBox["E",
      RowBox[{"x", " ", "u"}]], "+", "1"}]]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f0", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{"Quiet", "@",
    RowBox[{"NIntegrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"2", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalization", "[", "x_", "]"}], "=",
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       FractionBox["1",
        RowBox[{
         SuperscriptBox["E",
          RowBox[{"x", " ", "u"}]], "-", "1"}]],
       SuperscriptBox["u", "2"]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   FractionBox[
    RowBox[{"f0", "[", "x", "]"}],
    RowBox[{"normalization", "[", "x", "]"}]]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"fit", "=",
     RowBox[{"NonlinearModelFit", "[",
      RowBox[{"data", ",",
       RowBox[{
        FractionBox["3", "4"], "-",
        RowBox[{"a", " ",
         SuperscriptBox["x", "2"]}], "+",
        RowBox[{"b", " ",
         SuperscriptBox["x", "4"]}]}], ",",
       RowBox[{"{",
        RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"lower", "[", "x_", "]"}], "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"lower", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"2", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        RowBox[{"Zeta", "[", "3", "]"}]}]],
      SuperscriptBox["x", "2"],
      RowBox[{"BesselK", "[",
       RowBox[{"2", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"2", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"outer", "=", "Exp"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"inner", "=", "Log"}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"InverseFunction", "[", "outer", "]"}], "@",
        RowBox[{"f", "[",
         RowBox[{
          RowBox[{"InverseFunction", "[", "inner", "]"}], "@", "x"}], "]"}]}],
        ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"inner", "@", "xLower"}], ",",
         RowBox[{"inner", "@", "xUpper"}]}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"Length", "[", "splits", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{"outer", "@",
           RowBox[{
            RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[",
            RowBox[{"inner", "@", "x"}], "]"}]}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]]
}]]
}]]
}]
(* End of Notebook Content *)
