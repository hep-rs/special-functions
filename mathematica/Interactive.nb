(* Content-type: application/vnd.wolfram.mathematica *)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[",
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"<<", "RustApproximation`"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Bessel", "Section"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["I", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"343415f9-c850-459c-8d39-2f139b620a05"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselI", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{
      SuperscriptBox["x",
       RowBox[{"-", "n"}]],
      RowBox[{"f", "[", "x", "]"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "n"],
          RowBox[{"lower", "/",
           RowBox[{"f", "[", "x", "]"}]}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\n",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{
   RowBox[{
    RowBox[{"Re", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "//",
    "FullSimplify"}], "//", "ExpandAll"}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "20", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "\n",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[",
      RowBox[{"-", "x"}], "]"}], " ",
     RowBox[{"Sqrt", "[", "x", "]"}], " ", "upper"}], ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Identity", "[", "xLower", "]"}], ",",
       RowBox[{"Identity", "[", "xUpper", "]"}]}], "}"}]}], "]"}]}],
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",", "\[IndentingNewLine]",
     RowBox[{
      FractionBox[
       SuperscriptBox["E", "x"],
       SqrtBox["x"]],
      RowBox[{"FromDigits", "[",
       RowBox[{
        RowBox[{"Reverse", "@", "upper"}], ",",
        FractionBox["1", "x"]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xUpper", ",",
     RowBox[{"2", "xUpper"}]}], "}"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["J", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"1c6af4e8-40f5-4d24-ba68-b0de3fd53d74"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselJ", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{
      SuperscriptBox["x",
       RowBox[{"-", "n"}]],
      RowBox[{"f", "[", "x", "]"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "n"],
          RowBox[{"lower", "/",
           RowBox[{"f", "[", "x", "]"}]}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"N", "[",
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"BesselJZero", "[",
        RowBox[{"n", ",", "k"}], "]"}], "+",
       RowBox[{"BesselJZero", "[",
        RowBox[{"n", ",",
         RowBox[{"k", "+", "1"}]}], "]"}]}], "2"], ",", "100"}], "]"}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"While", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[",
         RowBox[{
          FractionBox["upper",
           RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ">",
        RowBox[{"SetPrecision", "[",
         RowBox[{
          FractionBox["$MachineEpsilon", "100"], ",", "\[Infinity]"}],
         "]"}]}], "/.",
       RowBox[{"x", "\[Rule]", "xUpper"}]}], ",", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"k", "++"}], ";", "\[IndentingNewLine]",
       RowBox[{"xUpper", "=",
        RowBox[{"N", "[",
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"BesselJZero", "[",
             RowBox[{"n", ",", "k"}], "]"}], "+",
            RowBox[{"BesselJZero", "[",
             RowBox[{"n", ",",
              RowBox[{"k", "+", "1"}]}], "]"}]}], "2"], ",", "100"}], "]"}]}],
        ";"}]}], "\[IndentingNewLine]", "]"}],
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"upper", "=",
   RowBox[{"TrigExpand", "[", "upper", "]"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{"upperCos", "=",
  RowBox[{"CoefficientList", "[", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", "x", "]"}],
     RowBox[{"Coefficient", "[",
      RowBox[{"upper", ",",
       RowBox[{"Cos", "[", "x", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]",

    FractionBox["1", "x"]}], "]"}]}], "\[IndentingNewLine]",
 RowBox[{"upperSin", "=",
  RowBox[{"CoefficientList", "[", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", "x", "]"}], " ",
     RowBox[{"Coefficient", "[",
      RowBox[{"upper", ",",
       RowBox[{"Sin", "[", "x", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]",

    FractionBox["1", "x"]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"Identity", "@",
      RowBox[{"f", "[", "x", "]"}]}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Identity", "[", "xLower", "]"}], ",",
       RowBox[{"Identity", "[", "xUpper", "]"}]}], "}"}]}], "]"}]}],
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"Exp", "@", "x"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"e7580b00-1056-400e-a432-00bca498e8c7"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "9"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselK", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\n",
 RowBox[{
  RowBox[{"{",
   RowBox[{"lowerPoly", ",", "lowerLn"}], "}"}], "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",",
    RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], "\n",
 RowBox[{
  RowBox[{"(*",
   RowBox[{"lowerPoly", "=",
    RowBox[{
     RowBox[{
      RowBox[{"CoefficientList", "[", " ",
       RowBox[{"lowerPoly", ",",
        SuperscriptBox["x",
         RowBox[{"-", "2"}]]}], "]"}], "\n", "lowerLn"}], "=",
     RowBox[{"CoefficientList", "[",
      RowBox[{"lowerLn", ",",
       RowBox[{"x", "^", "2"}]}], "]"}]}]}], "*)"}]}]}], "Input",ExpressionUUI\
D->"e9eb6442-7fbe-4e61-a47f-8c0e3eb50bbd"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\n"}], "\[IndentingNewLine]",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], " ",
     RowBox[{"Sqrt", "[", "x", "]"}], " ", "upper"}], ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Identity", "[", "xLower", "]"}], ",",
       RowBox[{"Identity", "[", "xUpper", "]"}]}], "}"}], ",",
     RowBox[{"MaxRecursion", "\[Rule]", "16"}]}], "]"}]}], ";"}]], "Input",Exp\
ressionUUID->"adefb422-12ac-4984-8efc-a141578318f9"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"Log", "@",
    RowBox[{"f", "[",
     RowBox[{"Exp", "@", "x"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"Log", "@", "xLower"}], ",",
     RowBox[{"Log", "@", "xUpper"}]}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    SubscriptBox["K", "1"],
    SubscriptBox["K", "2"]],
   RowBox[{"(", "x", ")"}]}],
  TraditionalForm]],ExpressionUUID->"981cd629-7574-40fb-bbf0-fd0e86be639c"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   FractionBox[
    RowBox[{"BesselK", "[",
     RowBox[{"1", ",", "x"}], "]"}],
    RowBox[{"BesselK", "[",
     RowBox[{"2", ",", "x"}], "]"}]]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{
    RowBox[{"x", "/", "50"}], "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]", "\n",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"{",
    RowBox[{"lowerPoly", ",", "lowerLn", ",", "lowerLn2"}], "}"}], "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{
     RowBox[{
      RowBox[{"x", "^",
       RowBox[{"-", "1"}]}], " ", "lower"}], ",",
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], ";"}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lowerPoly", ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^",
      RowBox[{"-", "2"}]}], " ", "lowerLn"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn2", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^",
      RowBox[{"-", "6"}]}], " ", "lowerLn2"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]", "\n",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "large", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"upper", ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"f", "[",
      RowBox[{"Exp", "@", "x"}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Log", "[", "xLower", "]"}], ",",
       RowBox[{"Log", "[", "xUpper", "]"}]}], "}"}]}], "]"}]}],
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"Exp", "@", "x"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"Log", "@", "xLower"}], ",",
     RowBox[{"Log", "@", "xUpper"}]}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["Y", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"241d4c45-4b52-4e7b-846d-1646b32644ae"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"BesselY", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"{",
    RowBox[{"lowerPoly", ",", "lowerLn"}], "}"}], "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{"lower", ",",
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], ";"}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "n"}], " ", "lowerPoly"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{
     RowBox[{"x", "^",
      RowBox[{"(",
       RowBox[{"-", "n"}], ")"}]}], " ", "lowerLn"}], ",",
    RowBox[{"x", "^", "2"}]}], "]"}]}]}], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upper", "=",
   RowBox[{
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}], "//",
    "ExpToTrig"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Echo", "[",
   RowBox[{
    RowBox[{"Dynamic", "[", "k", "]"}], ",", "\"\<k = \>\""}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{
      FractionBox["1", "2"],
      RowBox[{"(",
       RowBox[{
        RowBox[{"BesselYZero", "[",
         RowBox[{"n", ",", "k"}], "]"}], "+",
        RowBox[{"BesselYZero", "[",
         RowBox[{"n", ",",
          RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", "100"}], "]"}]}],
  ";"}], "\n",
 RowBox[{"While", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"(",
     RowBox[{
      RowBox[{"Abs", "[",
       RowBox[{
        FractionBox["upper",
         RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ">",
      RowBox[{"SetPrecision", "[",
       RowBox[{
        FractionBox["$MachineEpsilon", "100"], ",", "\[Infinity]"}], "]"}]}],
     ")"}], "/.",
    RowBox[{"x", "\[Rule]", "xUpper"}]}], ",", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"k", "++"}], ";", "\[IndentingNewLine]",
    RowBox[{"xUpper", "=",
     RowBox[{"N", "[",
      RowBox[{
       RowBox[{
        FractionBox["1", "2"],
        RowBox[{"(",
         RowBox[{
          RowBox[{"BesselYZero", "[",
           RowBox[{"n", ",", "k"}], "]"}], "+",
          RowBox[{"BesselYZero", "[",
           RowBox[{"n", ",",
            RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", "100"}],
      "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", "x", "]"}], " ", "upper"}], ",",
      RowBox[{"1", "/", "x"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"For", " ", "some", " ", "reason"}], ",",
    RowBox[{"these", " ", "should", " ", "be", " ", "cos",
     RowBox[{"(", "x", ")"}], " ", "and", " ", "sin",
     RowBox[{"(", "x", ")"}]}]}], "*)"}]}], "\n",
 RowBox[{"upperCos", "=",
  RowBox[{"Coefficient", "[",
   RowBox[{"upper", ",",
    RowBox[{"Cos", "[", "x", "]"}]}], "]"}]}], "\n",
 RowBox[{"upperSin", "=",
  RowBox[{"Coefficient", "[",
   RowBox[{"upper", ",",
    RowBox[{"Sin", "[", "x", "]"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}],
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"Log", "@",
    RowBox[{"f", "[",
     RowBox[{"Exp", "@", "x"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"Log", "@", "xLower"}], ",",
     RowBox[{"Log", "@", "xUpper"}]}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Other", "Section"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"HarmonicNumber", "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"473d1321-df6f-4992-9911-dfd6480b5398"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"HarmonicNumber", "[", "x", "]"}]}], ";"}]}], "Input",ExpressionUUI\
D->"59e3ace0-6834-44a6-9dc1-57a877bbaf99"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{"0", ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{"lower", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{"lower", ",", "x"}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"4", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}],
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "Infinity"}], "]"}], "]"}],
   ";"}], "\n"}], "\[IndentingNewLine]",
 RowBox[{"upper", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"upper", "-",
     RowBox[{"Log", "[", "x", "]"}]}], ",",
    FractionBox["1", "x"]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}],
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"LogLogPlot", "[",
  RowBox[{
   RowBox[{"Abs", "[",
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[", "x", "]"}],
      RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "50"}]}], "]"}]], "Input",Expression\
UUID->"4b9ab9a8-f6ba-4787-b8c3-9d65e0f77b8b"]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["Li", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"69fe7eb8-71a6-417c-b118-550478702dc7"]], \
"Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "<", "1"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   RowBox[{"PolyLog", "[",
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"lower", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}], "\n",
 RowBox[{
  RowBox[{"xLower", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"lower", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        RowBox[{"-", "2"}], ",",
        RowBox[{"-", "Infinity"}], ",", "1"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"-", "Infinity"}], ",",
      RowBox[{"N", "[",
       RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
    "for", " ", "small", " ",
    RowBox[{"x", "."}]}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"lower", "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{"lower", ",",
     RowBox[{"Log", "[",
      RowBox[{"-", "x"}], "]"}]}], "]"}]}], ";"}], "\n",
 RowBox[{"lowerPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"First", "@", "lower"}], ",",
    RowBox[{"1", "/", "x"}]}], "]"}]}], "\n",
 RowBox[{"lowerLn", "=",
  RowBox[{
   RowBox[{"{", "0", "}"}], "~", "Join", "~",
   RowBox[{"Rest", "@", "lower"}]}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{"upper", "=",
  RowBox[{"Normal", "@",
   RowBox[{"Series", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "1", ",", "10"}], "}"}]}],
    "]"}]}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"xUpper", "=",
   RowBox[{"x", "/.",
    RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[",
        RowBox[{
         RowBox[{"upper", "/",
          RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
       RowBox[{"SetPrecision", "[",
        RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
      "\[IndentingNewLine]",
      RowBox[{"{",
       RowBox[{"x", ",",
        FractionBox["1", "2"], ",",
        RowBox[{"-", "\[Infinity]"}], ",", "1"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]",
       RowBox[{"5", " ", "$MachinePrecision"}]}], ",", "\[IndentingNewLine]",

      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}],
  ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[",
    RowBox[{
     RowBox[{
     "StringTemplate", "[",
      "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
     RowBox[{
      RowBox[{"N", "[",
       RowBox[{"xUpper", ",", "4"}], "]"}], ",", "1"}], "]"}], "]"}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"{",
    RowBox[{"upperPoly", ",", "upperLn"}], "}"}], "=",
   RowBox[{"CoefficientList", "[",
    RowBox[{"upper", ",",
     RowBox[{"Log", "[",
      RowBox[{"1", "-", "x"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{"upperPoly", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"upperPoly", "/.",
     RowBox[{"x", "\[Rule]",
      RowBox[{"x", "+", "1"}]}]}], ",", "x"}], "]"}]}], "\[IndentingNewLine]",
 RowBox[{"upperLn", "=",
  RowBox[{"CoefficientList", "[",
   RowBox[{
    RowBox[{"upperLn", "/.",
     RowBox[{"x", "\[Rule]",
      RowBox[{"x", "+", "1"}]}]}], ",", "x"}], "]"}]}]}], "Input",ExpressionUU\
ID->"1787aee1-bfb3-4480-a87a-40b8367c28ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "=",
   RowBox[{"ChebyshevSplits", "[",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}],
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"{",
    RowBox[{"f", "[", "x", "]"}], "}"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Particle Statistics", "Section"],

Cell[CellGroupData[{

Cell["Massless Number Density", "Subsection"],

Cell[CellGroupData[{

Cell["Bose Einstein", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\n"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   RowBox[{"1", "/",
    RowBox[{"(",
     RowBox[{
      RowBox[{"Exp", "[",
       RowBox[{"u", "-", "x"}], "]"}], "-", "1"}], ")"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{"Re", "@",
     RowBox[{"Integrate", "[",
      RowBox[{
       RowBox[{
        RowBox[{"ps", "[",
         RowBox[{"x", ",", "u"}], "]"}], " ",
        RowBox[{"u", "^", "2"}]}], ",",
       RowBox[{"{",
        RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], "/",
    RowBox[{"(",
     RowBox[{"2", " ",
      RowBox[{"Pi", "^", "2"}]}], ")"}]}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{"lower", "=",
    RowBox[{"Simplify", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}]}], "\n",

   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "2"}], ",",
          RowBox[{"-", "Infinity"}], ",", "0"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}], "\n",
   "\n",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "small", " ",
     RowBox[{"x", "."}]}], "*)"}], "\[IndentingNewLine]",
   RowBox[{"lower", "=",
    RowBox[{
     RowBox[{"CoefficientList", "[",
      RowBox[{"lower", ",",
       RowBox[{"Exp", "[", "x", "]"}]}], "]"}], "//",
     "FullSimplify"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "approximation", " ", "for", " ", "large", " ",
    "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Simplify", "@",
     RowBox[{"Normal", "@",
      RowBox[{"Series", "[",
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}]}],
   "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
       RowBox[{
       "StringTemplate", "[",
        "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], "]"}], ",", "\[Infinity]"}],
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "large", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"upper", ",", "x"}], "]"}]}], "\[IndentingNewLine]",
   RowBox[{"upperExp", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{"upper", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       ",",
      RowBox[{"Exp", "[",
       RowBox[{"-", "x"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
   RowBox[{"upperPoly", "=",
    RowBox[{
     RowBox[{"{", "0", "}"}], "~", "Join", "~",
     RowBox[{"Rest", "@", "upper"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"splits", "=",
    RowBox[{"ChebyshevSplits", "[",
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",",
      RowBox[{"{",
       RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}],
   ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[", "x", "]"}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell["Fermi-Dirac", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=",
    RowBox[{"x", "\[Element]", "Reals"}]}], ";"}],
  "\[IndentingNewLine]"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   RowBox[{"1", "/",
    RowBox[{"(",
     RowBox[{
      RowBox[{"Exp", "[",
       RowBox[{"u", "-", "x"}], "]"}], "+", "1"}], ")"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=",
   RowBox[{
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ",
       RowBox[{"u", "^", "2"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}], "/",
    RowBox[{"(",
     RowBox[{"2", " ",
      RowBox[{"Pi", "^", "2"}]}], ")"}]}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "approximation", " ", "for", " ", "small", " ",
    "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{"lower", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"-", "Infinity"}], ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",",
          RowBox[{"-", "2"}], ",",
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"-", "Infinity"}], ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "small", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"lower", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"lower", ",",
      RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"upper", "=",
    RowBox[{"Normal", "@",
     RowBox[{"Series", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "Infinity", ",", "10"}], "}"}]}], "]"}]}]}], "\n",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"upper", "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",",
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "0"}], "]"}], "]"}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Write", " ", "out", " ", "the", " ", "approximation", " ", "valid", " ",
     "for", " ", "large", " ",
     RowBox[{"x", "."}]}], "*)"}], "\n",
   RowBox[{"upper", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{"upper", ",", "x"}], "]"}]}], "\n",
   RowBox[{"upperExp", "=",
    RowBox[{"CoefficientList", "[",
     RowBox[{
      RowBox[{"upper", "[",
       RowBox[{"[", "1", "]"}], "]"}], ",",
      RowBox[{"Exp", "[",
       RowBox[{"-", "x"}], "]"}]}], "]"}]}], "\n",
   RowBox[{"upperPoly", "=",
    RowBox[{
     RowBox[{"{", "0", "}"}], "~", "Join", "~",
     RowBox[{"Rest", "@", "upper"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"splits", "=",
    RowBox[{"ChebyshevSplits", "[",
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",",
      RowBox[{"{",
       RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}],
   ";"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{"Plot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], ",", "\[IndentingNewLine]",
     RowBox[{
      RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[", "x", "]"}]}],
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   "\[IndentingNewLine]",
   RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "\[IndentingNewLine]",
  "]"}], "\[IndentingNewLine]",
 RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]",
  RowBox[{
   RowBox[{"ParallelTable", "[",
    RowBox[{
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Abs", "[",
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"ChebyshevEval", "[", "splits", "]"}], "[", "x", "]"}],
          RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], "}"}], ",",
     RowBox[{"{",
      RowBox[{"x", ",",
       RowBox[{"Subdivide", "[",
        RowBox[{"xLower", ",", "xUpper", ",", "2048"}], "]"}]}], "}"}]}],
    "]"}], ",", "\[IndentingNewLine]",
   RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]",
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]",
  "]"}]}], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Number Density", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"UsingFermiDirac", "=", "False"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"If", "[",
   RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ps", "[",
      RowBox[{"x_", ",", "u_"}], "]"}], "=",
     FractionBox["1",
      RowBox[{
       SuperscriptBox["E",
        RowBox[{"x", " ", "u"}]], "+", "1"}]]}], "\[IndentingNewLine]", ",",
    "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ps", "[",
      RowBox[{"x_", ",", "u_"}], "]"}], "=",
     FractionBox["1",
      RowBox[{
       SuperscriptBox["E",
        RowBox[{"x", " ", "u"}]], "-", "1"}]]}]}], "\[IndentingNewLine]",
   "]"}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{
    FractionBox["1",
     RowBox[{"2",
      SuperscriptBox["\[Pi]", "2"]}]],
    RowBox[{"Quiet", "@",
     RowBox[{"NIntegrate", "[",
      RowBox[{
       RowBox[{
        RowBox[{"ps", "[",
         RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
        RowBox[{"Sqrt", "[",
         RowBox[{
          RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
       RowBox[{"{",
        RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"Method", "\[Rule]",
        RowBox[{"{",
         RowBox[{"\"\<DoubleExponential\>\"", ",",
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
         "}"}]}], ",", "\[IndentingNewLine]",
       RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
       RowBox[{"AccuracyGoal", "\[Rule]", "300"}]}], "]"}]}]}]}],
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"If", "[",
     RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{
          FractionBox["1",
           SuperscriptBox["x", "3"]],
          RowBox[{"(",
           RowBox[{"a", "-",
            RowBox[{"b", " ",
             SuperscriptBox["x", "2"]}], "+",
            RowBox[{"c", " ",
             SuperscriptBox["x", "4"]}]}], ")"}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "x"}], "]"}]}],
      RowBox[{"(*", " ",
       RowBox[{"Fermi", "-", "Dirac"}], " ", "*)"}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{
          FractionBox["1",
           SuperscriptBox["x", "3"]],
          RowBox[{"(",
           RowBox[{"a", "+",
            RowBox[{
             SuperscriptBox["x", "2"],
             RowBox[{"(",
              RowBox[{"b", "+",
               RowBox[{"c", " ",
                RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]}], ")"}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "x"}], "]"}]}]}],
     RowBox[{"(*", " ",
      RowBox[{"Bose", "-", "Einstein"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ";"}], "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"lower", "[", "x_", "]"}], "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"lower", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        SuperscriptBox["\[Pi]", "2"]}]],
      FractionBox[
       RowBox[{"BesselK", "[",
        RowBox[{"2", ",", "x"}], "]"}], "x"]}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"approx", " ", "=", " ",
     RowBox[{"ChebyshevEval", "[", "splits", "]"}]}], ";"}]}]}]], "Input",Expr\
essionUUID->"502b3042-da08-45d5-a534-3ac957ce383e"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"Log10", "@",
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"approx", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]], "Input",Expressio\
nUUID->"a73ae84f-f550-4032-83f9-d11ee3152af4"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DiscretePlot", "[",
  RowBox[{
   RowBox[{"Log", "@",
    RowBox[{"f", "[",
     RowBox[{"Exp", "[", "x", "]"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"Subdivide", "[",
      RowBox[{
       RowBox[{"Log", "@", "0.00026"}], ",",
       RowBox[{"Log", "@", "34.98"}], ",", "20"}], "]"}]}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell["Normalized Number Density", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ClearAll", "[", "f", "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"UsingFermiDirac", "=", "False"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"If", "[",
   RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ps", "[",
      RowBox[{"x_", ",", "u_"}], "]"}], "=",
     FractionBox["1",
      RowBox[{
       SuperscriptBox["E",
        RowBox[{"x", " ", "u"}]], "+", "1"}]]}], "\[IndentingNewLine]", ",",
    "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ps", "[",
      RowBox[{"x_", ",", "u_"}], "]"}], "=",
     FractionBox["1",
      RowBox[{
       SuperscriptBox["E",
        RowBox[{"x", " ", "u"}]], "-", "1"}]]}]}], "\[IndentingNewLine]",
   "]"}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f0", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{"Quiet", "@",
    RowBox[{"NIntegrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
      RowBox[{"AccuracyGoal", "\[Rule]", "300"}]}], "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalization", "[", "x_", "]"}], "=",
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       FractionBox["1",
        RowBox[{
         SuperscriptBox["E",
          RowBox[{"x", " ", "u"}]], "-", "1"}]],
       SuperscriptBox["u", "2"]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   FractionBox[
    RowBox[{"f0", "[", "x", "]"}],
    RowBox[{"normalization", "[", "x", "]"}]]}], ";"}]}], "Input",ExpressionUU\
ID->"3ff4d852-ea66-423f-9d17-6e7bf7794f8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"If", "[",
     RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{
          FractionBox["3", "4"], "-",
          RowBox[{"a", " ",
           SuperscriptBox["x", "2"]}], "+",
          RowBox[{"b", " ",
           SuperscriptBox["x", "4"]}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}],
      RowBox[{"(*", " ",
       RowBox[{"Fermi", "-", "Dirac"}], " ", "*)"}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{"1", "+",
          RowBox[{
           SuperscriptBox["x", "2"],
           RowBox[{"(",
            RowBox[{"a", "+",
             RowBox[{"b", " ",
              RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}]}],
     RowBox[{"(*", " ",
      RowBox[{"Bose", "-", "Einstein"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ";"}], "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"lower", "[", "x_", "]"}], "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"lower", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        RowBox[{"Zeta", "[", "3", "]"}]}]],
      SuperscriptBox["x", "2"],
      RowBox[{"BesselK", "[",
       RowBox[{"2", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"approx", " ", "=", " ",
     RowBox[{"ChebyshevEval", "[", "splits", "]"}]}], ";"}]}]}]], "Input",Expr\
essionUUID->"d496fb40-fe46-4b66-9db3-f42f1ef092f4"],

Cell[BoxData[
 RowBox[{"LogPlot", "[",
  RowBox[{
   RowBox[{"Abs", "[",
    RowBox[{
     FractionBox[
      RowBox[{"approx", "[", "x", "]"}],
      RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]], "Input",Expressio\
nUUID->"4e5484e1-e915-4426-8755-daff1e10db73"],

Cell[BoxData[
 RowBox[{"DiscretePlot", "[",
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",",
     RowBox[{"Subdivide", "[",
      RowBox[{"xLower", ",", "xUpper", ",", "20"}], "]"}]}], "}"}]}],
  "]"}]], "Input"]
}]]
}]]
}]
(* End of Notebook Content *)
