(* Content-type: application/vnd.wolfram.mathematica *)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[",
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"<<", "RustApproximation`"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["K", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"a5cbb71f-e98a-4063-89a3-66938055a859"]], \
"Section"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[CellGroupData[{

Cell[, "Subsection"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["Li", "n"], "(", "x", ")"}],
  TraditionalForm]],ExpressionUUID->"277781f1-239d-4b3e-a232-a6f6c5510bac"]], \
"Section"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"],

Cell[, "Input"]
}]],

Cell[CellGroupData[{

Cell["Particle Statistics", "Section"],

Cell[CellGroupData[{

Cell["Number Density", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", "\[GreaterEqual]", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   FractionBox["1",
    RowBox[{
     SuperscriptBox["E",
      RowBox[{"x", " ", "u"}]], "-", "1"}]]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ps", "'"}], "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[",
      RowBox[{"1", ",", "0"}], "]"}], "[", "ps", "]"}], "[",
    RowBox[{"x", ",", "u"}], "]"}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{
    FractionBox["1",
     RowBox[{"2",
      SuperscriptBox["\[Pi]", "2"]}]],
    RowBox[{"Quiet", "@",
     RowBox[{"NIntegrate", "[",
      RowBox[{
       RowBox[{
        RowBox[{"ps", "[",
         RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
        RowBox[{"Sqrt", "[",
         RowBox[{
          RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
       RowBox[{"{",
        RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"Method", "\[Rule]",
        RowBox[{"{",
         RowBox[{"\"\<DoubleExponential\>\"", ",",
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
         "}"}]}], ",", "\[IndentingNewLine]",
       RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
       RowBox[{"AccuracyGoal", "\[Rule]", "300"}]}], "]"}]}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "'"}], "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{
    FractionBox["1",
     RowBox[{"2",
      SuperscriptBox["\[Pi]", "2"]}]],
    RowBox[{"Quiet", "@",
     RowBox[{"NIntegrate", "[",
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ps", "'"}], "[",
         RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
        RowBox[{"Sqrt", "[",
         RowBox[{
          RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
       RowBox[{"{",
        RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"Method", "\[Rule]",
        RowBox[{"{",
         RowBox[{"\"\<DoubleExponential\>\"", ",",
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
         "}"}]}], ",", "\[IndentingNewLine]",
       RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
       RowBox[{"AccuracyGoal", "\[Rule]", "300"}]}], "]"}]}]}]}],
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell["0th Derivative", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"fit", "=",
     RowBox[{"NonlinearModelFit", "[",
      RowBox[{"data", ",",
       RowBox[{"a", " ",
        SuperscriptBox["x",
         RowBox[{"-", "3"}]]}], ",",
       RowBox[{"{", "a", "}"}], ",", "x"}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"lower", "[", "x_", "]"}], "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"lower", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     RowBox[{
      FractionBox["1",
       RowBox[{"2",
        SuperscriptBox["\[Pi]", "2"]}]],
      FractionBox[
       RowBox[{"BesselK", "[",
        RowBox[{"2", ",", "x"}], "]"}], "x"]}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
       RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}], ",",
       RowBox[{"AccuracyGoal", "\[Rule]",
        RowBox[{"Min", "[",
         RowBox[{
          RowBox[{"10", "^",
           RowBox[{"(",
            RowBox[{"-", "30"}], ")"}]}], ",",
          RowBox[{"GeometricMean", "[",
           RowBox[{"f", "[",
            RowBox[{"{",
             RowBox[{"xLower", ",", "xUpper"}], "}"}], "]"}], "]"}]}],
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"approx", " ", "=", " ",
     RowBox[{"ChebyshevEval", "[", "splits", "]"}]}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"Log10", "@",
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"approx", "[", "x", "]"}],
       RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]], "Input"]
}]],

Cell[CellGroupData[{

Cell["1st Derivative", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{
          RowBox[{"f", "'"}], "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"fit", "=",
     RowBox[{"NonlinearModelFit", "[",
      RowBox[{"data", ",",
       RowBox[{"a", " ",
        SuperscriptBox["x",
         RowBox[{"-", "4"}]]}], ",",
       RowBox[{"{", "a", "}"}], ",", "x"}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\n", "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"lower", "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{"lower", "/",
            RowBox[{
             RowBox[{"f", "'"}], "[", "x", "]"}]}], "-", "1"}], "]"}],
         "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     RowBox[{
      RowBox[{"-",
       FractionBox["1",
        RowBox[{"2",
         SuperscriptBox["\[Pi]", "2"]}]]}],
      FractionBox[
       RowBox[{
        RowBox[{"x", " ",
         RowBox[{"BesselK", "[",
          RowBox[{"1", ",", "x"}], "]"}]}], "+",
        RowBox[{"3",
         RowBox[{"BesselK", "[",
          RowBox[{"2", ",", "x"}], "]"}]}]}],
       SuperscriptBox["x", "2"]]}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{
             RowBox[{"f", "'"}], "[", "x", "]"}]}], "-", "1"}], "]"}],
         "\[Equal]",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[",
      RowBox[{
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
       RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}], ",",
       RowBox[{"AccuracyGoal", "\[Rule]",
        RowBox[{"Min", "[",
         RowBox[{
          RowBox[{"10", "^",
           RowBox[{"(",
            RowBox[{"-", "30"}], ")"}]}], ",",
          RowBox[{"GeometricMean", "[",
           RowBox[{"f", "[",
            RowBox[{"{",
             RowBox[{"xLower", ",", "xUpper"}], "}"}], "]"}], "]"}]}],
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"approx", " ", "=", " ",
     RowBox[{"ChebyshevEval", "[", "splits", "]"}]}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[",
  RowBox[{
   RowBox[{"Log10", "@",
    RowBox[{"Abs", "[",
     RowBox[{
      FractionBox[
       RowBox[{"approx", "[", "x", "]"}],
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}]], "-", "1"}], "]"}]}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]], "Input"]
}]]
}]],

Cell[CellGroupData[{

Cell["Normalized Number Density", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=",
   RowBox[{"x", ">", "0"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"ClearAll", "[", "f", "]"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"UsingFermiDirac", "=", "False"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"If", "[",
   RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ps", "[",
      RowBox[{"x_", ",", "u_"}], "]"}], "=",
     FractionBox["1",
      RowBox[{
       SuperscriptBox["E",
        RowBox[{"x", " ", "u"}]], "+", "1"}]]}], "\[IndentingNewLine]", ",",
    "\[IndentingNewLine]",
    RowBox[{
     RowBox[{"ps", "[",
      RowBox[{"x_", ",", "u_"}], "]"}], "=",
     FractionBox["1",
      RowBox[{
       SuperscriptBox["E",
        RowBox[{"x", " ", "u"}]], "-", "1"}]]}]}], "\[IndentingNewLine]",
   "]"}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ps", "'"}], "[",
    RowBox[{"x_", ",", "u_"}], "]"}], "=",
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[",
      RowBox[{"1", ",", "0"}], "]"}], "[", "ps", "]"}], "[",
    RowBox[{"x", ",", "u"}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f0", "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{"Quiet", "@",
    RowBox[{"NIntegrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ps", "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
      RowBox[{"AccuracyGoal", "\[Rule]", "300"}]}], "]"}]}]}], ";"}], "\n",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f0", "'"}], "[",
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=",
   RowBox[{"Quiet", "@",
    RowBox[{"NIntegrate", "[",
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ps", "'"}], "[",
        RowBox[{"x", ",", "u"}], "]"}], " ", "u", " ",
       RowBox[{"Sqrt", "[",
        RowBox[{
         RowBox[{"u", "^", "2"}], "-", "1"}], "]"}]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",",
      "\[IndentingNewLine]",
      RowBox[{"Method", "\[Rule]",
       RowBox[{"{",
        RowBox[{"\"\<DoubleExponential\>\"", ",",
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
        "}"}]}], ",", "\[IndentingNewLine]",
      RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
      RowBox[{"AccuracyGoal", "\[Rule]", "300"}]}], "]"}]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalization", "[", "x_", "]"}], "=",
    RowBox[{"Integrate", "[",
     RowBox[{
      RowBox[{
       FractionBox["1",
        RowBox[{
         SuperscriptBox["E",
          RowBox[{"x", " ", "u"}]], "-", "1"}]],
       SuperscriptBox["u", "2"]}], ",",
      RowBox[{"{",
       RowBox[{"u", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], ":=",
   FractionBox[
    RowBox[{"f0", "[", "x", "]"}],
    RowBox[{"normalization", "[", "x", "]"}]]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell["0th Derivative", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{"f", "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"If", "[",
     RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{
          FractionBox["75", "100"], "-",
          RowBox[{"a", " ",
           SuperscriptBox["x", "2"]}], "+",
          RowBox[{"b", " ",
           SuperscriptBox["x", "4"]}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}],
      RowBox[{"(*", " ",
       RowBox[{"Fermi", "-", "Dirac"}], " ", "*)"}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{"1", "+",
          RowBox[{
           SuperscriptBox["x", "2"],
           RowBox[{"(",
            RowBox[{"a", "+",
             RowBox[{"b", " ",
              RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}]}],
     RowBox[{"(*", " ",
      RowBox[{"Bose", "-", "Einstein"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ";"}], "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"lower", "[", "x_", "]"}], "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"lower", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     FractionBox[
      RowBox[{"BesselK", "[",
       RowBox[{"2", ",", "x"}], "]"}], "x"]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{"f", "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Upper approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{"fLog", "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"AccuracyGoal", "\[Rule]", "200"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"approx", " ", "=", " ",
     RowBox[{"ChebyshevEval", "[", "splits", "]"}]}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"LogPlot", "[",
  RowBox[{
   RowBox[{"Abs", "[",
    RowBox[{
     FractionBox[
      RowBox[{"approx", "[", "x", "]"}],
      RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]], "Input",Expressio\
nUUID->"4e5484e1-e915-4426-8755-daff1e10db73"]
}]],

Cell[CellGroupData[{

Cell["1st Derivative", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "small", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"data", "=",
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{"{",
        RowBox[{"x", ",",
         RowBox[{
          RowBox[{"f", "'"}], "[", "x", "]"}]}], "}"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",",
         SuperscriptBox["10",
          RowBox[{"Subdivide", "[",
           RowBox[{
            RowBox[{"-", "30"}], ",",
            RowBox[{"-", "20"}], ",", "10"}], "]"}]]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"If", "[",
     RowBox[{"UsingFermiDirac", ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", "x"}], "+",
          RowBox[{"b", " ",
           SuperscriptBox["x", "3"]}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}],
      RowBox[{"(*", " ",
       RowBox[{"Fermi", "-", "Dirac"}], " ", "*)"}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]",
      RowBox[{"fit", "=",
       RowBox[{"NonlinearModelFit", "[",
        RowBox[{"data", ",",
         RowBox[{"x",
          RowBox[{"(",
           RowBox[{"a", "+",
            RowBox[{"b", " ",
             RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}], ",",
         RowBox[{"{",
          RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}]}],
     RowBox[{"(*", " ",
      RowBox[{"Bose", "-", "Einstein"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ";"}], "\[IndentingNewLine]",
   RowBox[{"N", "[",
    RowBox[{
     RowBox[{"fit", "[", "\"\<ParameterTable\>\"", "]"}], ",",
     "$MachinePrecision"}], "]"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"lower", "[", "x_", "]"}], "=",
     RowBox[{"fit", "[", "\"\<BestFit\>\"", "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xLower", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"lower", "[", "x", "]"}], "/",
            RowBox[{
             RowBox[{"f", "'"}], "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{"0", ",",
       RowBox[{"N", "[",
        RowBox[{"xLower", ",", "4"}], "]"}]}], "]"}], "]"}],
    ";"}]}]}]], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ",
   RowBox[{
   "Find", " ", "the", " ", "series", " ", "approximation", " ", "for", " ",
    "large", " ", "x"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"upper", "[", "x_", "]"}], "=",
     RowBox[{"-",
      FractionBox[
       RowBox[{
        RowBox[{"x", " ",
         RowBox[{"BesselK", "[",
          RowBox[{"1", ",", "x"}], "]"}]}], "+",
        RowBox[{"3", " ",
         RowBox[{"BesselK", "[",
          RowBox[{"2", ",", "x"}], "]"}]}]}],
       SuperscriptBox["x", "2"]]}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"xUpper", "=",
     RowBox[{"x", "/.",
      RowBox[{"FindRoot", "[", "\[IndentingNewLine]",
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[",
          RowBox[{
           RowBox[{
            RowBox[{"upper", "[", "x", "]"}], "/",
            RowBox[{
             RowBox[{"f", "'"}], "[", "x", "]"}]}], "-", "1"}], "]"}], "-",
         RowBox[{"SetPrecision", "[",
          RowBox[{"$MachineEpsilon", ",", "Infinity"}], "]"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"{",
         RowBox[{"x", ",", "2", ",", "0", ",", "Infinity"}], "}"}], ",",
        "\[IndentingNewLine]",
        RowBox[{"WorkingPrecision", "\[Rule]",
         RowBox[{"5", " ", "$MachinePrecision"}]}], ",",
        "\[IndentingNewLine]",
        RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}]}], ";"}],
   "\n",
   RowBox[{
    RowBox[{"Print", "[",
     RowBox[{
      RowBox[{
      "StringTemplate", "[",
       "\"\<Lower approximation valid from `` to ``.\>\"", "]"}], "[",
      RowBox[{
       RowBox[{"N", "[",
        RowBox[{"xUpper", ",", "4"}], "]"}], ",", "\[Infinity]"}], "]"}],
     "]"}], ";"}]}]}]], "Input"]
}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Subdivide", " ", "the", " ", "remaining", " ", "interval", " ", "using",
    " ", "Chebyshev", " ", "polynomials"}], "*)"}], "\n",
  RowBox[{
   RowBox[{
    RowBox[{"splits", "=",
     RowBox[{"ChebyshevSplits", "[", "\[IndentingNewLine]",
      RowBox[{
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}], ",",
       RowBox[{"{",
        RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"PrecisionGoal", "\[Rule]", "$MachinePrecision"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"WorkingPrecision", "\[Rule]", "400"}], ",",
       "\[IndentingNewLine]",
       RowBox[{"AccuracyGoal", "\[Rule]", "200"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"approx", " ", "=", " ",
     RowBox[{"ChebyshevEval", "[", "splits", "]"}]}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"LogPlot", "[",
  RowBox[{
   RowBox[{"Abs", "[",
    RowBox[{
     FractionBox[
      RowBox[{"approx", "[", "x", "]"}],
      RowBox[{"f", "[", "x", "]"}]], "-", "1"}], "]"}], ",",
   RowBox[{"{",
    RowBox[{"x", ",", "xLower", ",", "xUpper"}], "}"}], ",",
   RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]], "Input",Expressio\
nUUID->"2a027048-f503-4c87-9770-c1c854cc8792"]
}]]
}]]
}]]
}]
(* End of Notebook Content *)
