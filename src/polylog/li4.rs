#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            -1.8940656589944918,
            -1.,
            -0.0625,
            -0.012345679012345678,
            -0.00390625,
            -0.0016,
            -0.0007716049382716049,
            -0.00041649312786339027,
            -0.000244140625,
            -0.00015241579027587258,
            -0.0001,
        ],
    ) + polynomial(
        (-x).ln(),
        &[0., 0., -0.8224670334241131, 0., -0.041666666666666664],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 11] = [
    &[
        -5.209846764501067,
        1.6971571020492762,
        0.041378129980093784,
        0.0023097987792010184,
        0.00017725803755478848,
        0.000016145176674617348,
        1.638386926956416e-6,
        1.7918174538364605e-7,
        2.070668698804098e-8,
        2.4966024418842777e-9,
        3.113412454764214e-10,
        3.99091348290465e-11,
        5.234247969689005e-12,
        6.99930456089323e-13,
        9.51657021635983e-14,
        1.3127428488100979e-14,
        1.833924300425253e-15,
        2.59090519310121e-16,
        3.697105321818773e-17,
        5.32313497188378e-18,
        7.726630746344983e-19,
        1.1298095990944429e-19,
        1.6631525423065074e-20,
        2.4633502403548996e-21,
        3.669215529373726e-22,
        5.49394537557183e-23,
        8.265936149679769e-24,
        1.2492437414145877e-24,
        1.895903676169699e-25,
        2.888546535171946e-26,
        4.4170090885201384e-27,
        6.777430881300901e-28,
        1.0432798342002978e-28,
        1.610847289611303e-29,
        2.4943172020400532e-30,
        3.872798041133793e-31,
        6.028530911508413e-32,
        9.407065128965935e-33,
        1.471295081878552e-33,
        2.3062124649806974e-34,
        3.6224904607016746e-35,
        5.7013976443100684e-36,
        8.990469937588677e-37,
        1.4203004930137645e-37,
        2.2490384424933955e-38,
        3.6527434320057455e-39,
        5.656603384292952e-40,
    ],
    &[
        -2.4734889070485306,
        1.0139765965954621,
        0.01954411180009826,
        0.0009455578517790652,
        0.00006549410631292262,
        5.508775480182694e-6,
        5.23907578393891e-7,
        5.4256393083947486e-8,
        5.982963625674887e-9,
        6.924234844129723e-10,
        8.327542251418153e-11,
        1.0334063041425818e-11,
        1.3162813657899549e-12,
        1.7139750683373251e-13,
        2.274438996644822e-14,
        3.0681083021051128e-15,
        4.1986742610815307e-16,
        5.819341444838918e-17,
        8.157403256580568e-18,
        1.155149279980845e-18,
        1.6508216057678125e-19,
        2.3788513237617875e-20,
        3.453974372880136e-21,
        5.049828163270912e-22,
        7.430111868143104e-23,
        1.0996639429496627e-23,
        1.6363631277522088e-24,
        2.4472851700172857e-25,
        3.677246565490045e-26,
        5.549550160806272e-27,
        8.409432463133692e-28,
        1.2791992705879564e-28,
        1.9528609743095049e-29,
        2.9913972071503193e-30,
        4.596872698691625e-31,
        7.085321825687663e-32,
        1.0952033591147304e-32,
        1.6974735915318055e-33,
        2.6376938553286855e-34,
        4.10869028185681e-35,
        6.414882575330825e-36,
        1.0037663407604541e-36,
        1.5739501436681828e-37,
        2.473026207125061e-38,
        3.895460858142375e-39,
        6.293271517797899e-40,
        9.700183181068355e-41,
    ],
    &[
        -0.8652189929906406,
        0.5818265887667848,
        0.00841673504808816,
        0.00034165991517329643,
        0.00002092870205368648,
        1.6043057698614697e-6,
        1.4176172028644445e-7,
        1.3823773280924074e-8,
        1.4494144358272762e-9,
        1.606771311160173e-10,
        1.8616922255648708e-11,
        2.2359975631770275e-12,
        2.7668647796066166e-13,
        3.5110078333615903e-14,
        4.552202241325614e-15,
        6.013100846828623e-16,
        8.073167269819801e-17,
        1.0995668117049598e-17,
        1.5168277402067426e-18,
        2.116428094237901e-19,
        2.9835095550254414e-20,
        4.245055771612092e-21,
        6.091230669729029e-22,
        8.807933082242853e-23,
        1.2826609076656057e-23,
        1.880068552459711e-24,
        2.772316984078447e-25,
        4.110805794522442e-26,
        6.127087035608614e-27,
        9.176352292127904e-28,
        1.3804998850635164e-28,
        2.0855839626514606e-29,
        3.1632277401346676e-30,
        4.815501231796515e-31,
        7.356422467623683e-32,
        1.1275086308715603e-32,
        1.733493499032206e-33,
        2.6730135042143534e-34,
        4.133232704236307e-35,
        6.40806091530392e-36,
        9.95988654770282e-37,
        1.5517445182449244e-37,
        2.42312108502916e-38,
        3.792097609856689e-39,
        5.950300919030598e-40,
        9.575949030067193e-41,
        1.471002120767387e-41,
    ],
    &[
        0.04396786012202014,
        0.3217740146783779,
        0.0032977631600515055,
        0.0001083075321968913,
        5.747183496046699e-6,
        3.9699959841769057e-7,
        3.241032767169172e-8,
        2.969445616163965e-9,
        2.960296142870558e-10,
        3.1476812248966817e-11,
        3.5214213631617996e-12,
        4.104789564774168e-13,
        4.9498205711199586e-14,
        6.1410827892575386e-15,
        7.805789577897785e-16,
        1.0130869187692243e-16,
        1.3389348054834106e-17,
        1.7980192132811655e-18,
        2.4488152450854267e-19,
        3.377369660427559e-20,
        4.710846904411171e-21,
        6.637993871187021e-22,
        9.440154479281382e-23,
        1.3538419780084894e-23,
        1.9565526795123227e-24,
        2.847581924447447e-25,
        4.171389557265289e-26,
        6.1473969710920646e-27,
        9.109977846492455e-28,
        1.3570274212638894e-28,
        2.03119790378235e-29,
        3.054009198945437e-30,
        4.611245811689068e-31,
        6.990092680204047e-32,
        1.063558500037159e-32,
        1.62390143346393e-33,
        2.4876644166509345e-34,
        3.8227762149483886e-35,
        5.891804770520691e-36,
        9.1061190673441e-37,
        1.4111462188923313e-37,
        2.1923365771282076e-38,
        3.4141772665101616e-39,
        5.329240445215285e-40,
        8.341518808540891e-41,
        1.3390936072662547e-41,
        2.0525740346558336e-42,
    ],
    &[
        0.5404896896513643,
        0.1724855424763363,
        0.001178820500475902,
        0.00003012245600502386,
        1.3582732630987724e-6,
        8.393230591145271e-8,
        6.325303183595894e-9,
        5.459129159995049e-10,
        5.197065689567821e-11,
        5.327720345068461e-12,
        5.786354649270084e-13,
        6.581983358366404e-14,
        7.775821924311924e-15,
        9.480416388519571e-16,
        1.1870913849982696e-16,
        1.5207325197008156e-17,
        1.987020649072209e-18,
        2.641506246161584e-19,
        3.5654206343699e-20,
        4.8779662804782334e-21,
        6.754796225789653e-22,
        9.455874520168335e-23,
        1.3367609705546102e-23,
        1.9066774901465875e-24,
        2.741778169225257e-25,
        3.9721158501269334e-26,
        5.79408459765217e-27,
        8.505311997588252e-28,
        1.255836627654928e-28,
        1.8643636509761374e-29,
        2.7817548484140104e-30,
        4.170138555422975e-31,
        6.279029731260915e-32,
        9.493461436293952e-33,
        1.4409112628957733e-33,
        2.194981144530752e-34,
        3.355167337921575e-35,
        5.1452202894525773e-36,
        7.914500898914583e-37,
        1.220962505380202e-37,
        1.8887535076016141e-38,
        2.9294240658696758e-39,
        4.5547823542107925e-40,
        7.09881319621073e-41,
        1.109515358395282e-41,
        1.7785682531264655e-42,
        2.722758598752845e-43,
    ],
    &[
        0.8040405093460563,
        0.09023515404694966,
        0.00038740126818390564,
        7.396911335187343e-6,
        2.7896357629617667e-7,
        1.5396251783050816e-8,
        1.0764614340644665e-9,
        8.817634164322587e-11,
        8.081450858148892e-12,
        8.050715185377569e-13,
        8.551328224079348e-14,
        9.55619331169373e-15,
        1.1127781324364964e-15,
        1.340601418380088e-16,
        1.661850396835595e-17,
        2.1107763467344864e-18,
        2.737712620271429e-19,
        3.6161723613825634e-20,
        4.8535667011093394e-21,
        6.607303580085161e-22,
        9.10897777739923e-23,
        1.2700803869614888e-23,
        1.789065213541326e-24,
        2.543544794635759e-25,
        3.646794828156759e-26,
        5.269004478377031e-27,
        7.6668372270034e-28,
        1.122876494912176e-28,
        1.6544780886982995e-29,
        2.4513881755650433e-30,
        3.651019732325045e-31,
        5.464038685046165e-32,
        8.214336417848579e-33,
        1.240124319660088e-33,
        1.8796564206262575e-34,
        2.859624006591301e-35,
        4.365784952180582e-36,
        6.687324884502917e-37,
        1.0275430858947391e-37,
        1.5835523104547502e-38,
        2.4472732180972937e-39,
        3.792173584236138e-40,
        5.891046627140804e-41,
        9.173773865422428e-42,
        1.4326814686391882e-42,
        2.294793835923817e-43,
        3.510612301528041e-44,
    ],
    &[
        0.9409417911880252,
        0.04638785925777521,
        0.00011839942949376174,
        1.622514986249497e-6,
        5.061649801958465e-8,
        2.5077795497413845e-9,
        1.643676969708148e-10,
        1.2919449844954487e-11,
        1.1513634358592618e-12,
        1.1242558134966915e-13,
        1.1764997580113291e-14,
        1.2997465276212823e-15,
        1.4998112007467068e-16,
        1.793628853504066e-17,
        2.209978772430618e-18,
        2.7927200416916116e-19,
        3.6065635287174997e-20,
        4.746115888365406e-21,
        6.349588523696813e-22,
        8.619405854430082e-23,
        1.1853167262819039e-23,
        1.6490258050294328e-24,
        2.3182220686607616e-25,
        3.2899330163069755e-26,
        4.709250630734904e-27,
        6.794005081562743e-28,
        9.872476431810212e-29,
        1.444119854277216e-29,
        2.125380317591022e-30,
        3.1457932416273238e-31,
        4.6806759962800963e-32,
        6.998657189697074e-33,
        1.0512527014783651e-33,
        1.5858348957635356e-34,
        2.4018804637700777e-35,
        3.651590125011733e-36,
        5.57126462972936e-37,
        8.528620939546023e-38,
        1.3097142005491693e-38,
        2.0173112745234173e-39,
        3.1160164380974323e-40,
        4.826074688604692e-41,
        7.49372409167481e-42,
        1.166440825075796e-42,
        1.8208858315703586e-43,
        2.9153911265728413e-44,
        4.4584017908855124e-45,
    ],
    &[
        1.0109880598801744,
        0.023572129512985863,
        0.00003411008054068754,
        3.2268619047865645e-7,
        8.282542772635524e-9,
        3.725360555515762e-10,
        2.3206583203405246e-11,
        1.7711971072284284e-12,
        1.5494134528450338e-13,
        1.4939875211847363e-14,
        1.549348357560524e-15,
        1.700111510080192e-16,
        1.951546424568437e-17,
        2.3241407787397566e-18,
        2.8539238922316583e-19,
        3.5963171424857954e-20,
        4.633332374883363e-21,
        6.084970896597084e-22,
        8.126552626823087e-23,
        1.101478569752807e-23,
        1.5126935009593042e-24,
        2.10197759819361e-25,
        2.951857588916994e-26,
        4.185181367115159e-27,
        5.985578927052232e-28,
        8.628633603559173e-29,
        1.252951141821968e-29,
        1.8315947011424998e-30,
        2.6940393567544433e-31,
        3.9852807946724043e-32,
        5.926753020341385e-33,
        8.857650375847778e-34,
        1.329905781280471e-34,
        2.0053702493779426e-35,
        3.036144782558929e-36,
        4.614218274284928e-37,
        7.037598417723728e-38,
        1.0769927806468884e-38,
        1.6534145221936553e-39,
        2.5459896405402506e-40,
        3.9315937540198895e-41,
        6.08771419835283e-42,
        9.450502392755233e-43,
        1.470693298219963e-43,
        2.295350335892886e-44,
        3.674268451183928e-45,
        5.617886150920599e-46,
    ],
    &[
        1.0464781550281628,
        0.011892856665753057,
        9.390402635570121e-6,
        5.912508825636511e-8,
        1.2490693092288443e-9,
        5.1803196501789365e-11,
        3.1111415644760675e-12,
        2.3297753094588245e-13,
        2.015284713799292e-14,
        1.9290686083314316e-15,
        1.9904114639876003e-16,
        2.1759652892202046e-17,
        2.4906767790979495e-18,
        2.9595633471356365e-19,
        3.627621808203212e-20,
        4.564471824738885e-21,
        5.873324471229617e-22,
        7.705282325273e-23,
        1.0281119613654908e-23,
        1.3924063888944135e-24,
        1.910905206511078e-25,
        2.653686069271168e-26,
        3.724597876068948e-27,
        5.278196051273549e-28,
        7.545459600104178e-29,
        1.0872964050709649e-29,
        1.5782728851500614e-30,
        2.3063913456477367e-31,
        3.391369886129283e-32,
        5.015431137748339e-33,
        7.456819201952686e-34,
        1.1141689327282533e-34,
        1.6724629987931238e-35,
        2.52138980171515e-36,
        3.8166617040865626e-37,
        5.799365754076965e-38,
        8.843678107703321e-39,
        1.3531681901049568e-39,
        2.0770901592228407e-40,
        3.1979271636595165e-41,
        4.9376729603214654e-42,
        7.644565891710508e-43,
        1.1865915433521318e-43,
        1.8463707513965692e-44,
        2.8813671599359875e-45,
        4.6118355888121724e-46,
        7.050748187989439e-47,
    ],
    &[
        1.064353372400614,
        0.005975400758361054,
        2.500847511009822e-6,
        1.0134534103198328e-8,
        1.771654837387839e-10,
        6.893403260955475e-12,
        4.041168756116862e-13,
        2.992116260651036e-14,
        2.5718992561826413e-15,
        2.4520973048138195e-16,
        2.5232084141557245e-17,
        2.753009756331799e-18,
        3.1464926528339997e-19,
        3.7344901002411947e-20,
        4.573192985211889e-21,
        5.749827465188659e-22,
        7.393839197694252e-23,
        9.69479739650483e-24,
        1.2929693259419866e-24,
        1.7504039015580022e-25,
        2.401362375737429e-26,
        3.333745221921836e-27,
        4.677799288432013e-28,
        6.627346948927041e-29,
        9.47202117878588e-30,
        1.3646363308586993e-30,
        1.9804827946621417e-31,
        2.8936695033074185e-32,
        4.2542608736198026e-33,
        6.290651325280759e-34,
        9.351560255879069e-35,
        1.3971043357882507e-35,
        2.0969371218031324e-36,
        3.160991644677234e-37,
        4.784367429155034e-38,
        7.269116037394236e-39,
        1.1084006146978516e-39,
        1.6958233076985946e-40,
        2.6028624445075365e-41,
        4.0071294251920587e-42,
        6.1866818510526856e-43,
        9.577684707258537e-44,
        1.4865607593656613e-44,
        2.3129986689084423e-45,
        3.6093693768916634e-46,
        5.776743043342682e-47,
        8.831286619272733e-48,
    ],
    &[
        1.0763246107266726,
        0.005995959182965694,
        2.647587209360269e-6,
        1.5411587171356406e-8,
        6.811721045520666e-10,
        9.085013806825277e-11,
        2.0419274820460962e-11,
        6.150375128323266e-12,
        2.240885998671266e-12,
        9.347618285181205e-13,
        4.3174200846308213e-13,
        2.1597854435713232e-13,
        1.152299030640662e-13,
        6.483424820312092e-14,
        3.814573247255614e-14,
        2.3315157691856838e-14,
        1.4727386073052642e-14,
        9.573932906298493e-15,
        6.383306365587692e-15,
        4.3527066451083424e-15,
        3.0282994772333903e-15,
        2.1453105181236005e-15,
        1.544856254870208e-15,
        1.1291524726469807e-15,
        8.366262348910272e-16,
        6.276922918267393e-16,
        4.764141767494596e-16,
        3.655003827195861e-16,
        2.8323725290648976e-16,
        2.2157190817579386e-16,
        1.7489222944088772e-16,
        1.3923741029586003e-16,
        1.1177917693455352e-16,
        9.047595084493448e-17,
        7.383920410145872e-17,
        6.077363832673541e-17,
        5.0466592896756206e-17,
        4.2310698204185255e-17,
        3.58492510923616e-17,
        3.0737301676888603e-17,
        2.6713729247903967e-17,
        2.358109517522681e-17,
        2.1191070025142785e-17,
        1.943391549567118e-17,
        1.8230971334031624e-17,
        1.752942590421606e-17,
        8.649442323605068e-18,
    ],
];

pub const SPLITS: [f64; 12] = [
    -9.233897644626804,
    -4.116948822313402,
    -1.558474411156701,
    -0.2792372055783506,
    0.36038139721082474,
    0.6801906986054124,
    0.8400953493027061,
    0.9200476746513531,
    0.9600238373256765,
    0.9800119186628383,
    0.9900059593314191,
    1.,
];
