#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.,
            1.,
            0.001953125,
            0.00005080526342529086,
            3.814697265625e-6,
            5.12e-7,
            9.92290301275212e-8,
            2.478093222249005e-8,
            7.450580596923828e-9,
            2.581174791713197e-9,
            1e-9,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.,
            -1.9924660037052955,
            0.,
            -0.32851703043247826,
            0.,
            -0.015783880491620765,
            0.,
            -0.00032637580691433066,
            0.,
            -2.7557319223985893e-6,
        ],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -2.2174843005034344,
        1.0672344563301062,
        0.0009800536492750647,
        9.639456237967648e-6,
        2.2887488843421305e-7,
        8.553433501238021e-9,
        4.215726286291528e-10,
        2.505456950353394e-11,
        1.7051181611870512e-12,
        1.2862990273594173e-13,
        1.052324603054836e-14,
        9.193321580788635e-16,
        8.479931720866382e-17,
        8.188231011261479e-18,
        8.222063382852209e-19,
        8.540423279859903e-20,
        9.137830261699202e-21,
        1.003605488854187e-21,
        1.128202930195481e-22,
        1.2949848278956175e-23,
        1.5146212584983917e-24,
        1.8019488090652729e-25,
        2.1773167575656014e-26,
        2.668513222379067e-27,
        3.3134849699131156e-28,
        4.16416374050371e-29,
        5.291850790020461e-30,
        6.794809406355628e-31,
        8.8090002639401e-32,
        1.1523306995906705e-32,
        1.5201198387078277e-33,
        2.0211646016133235e-34,
        2.7073390160072686e-35,
        3.6518511795516686e-36,
        4.9584005339149514e-37,
        6.774407221563996e-38,
        9.310178959683088e-39,
        1.2866757617505372e-39,
        1.7876485826285657e-40,
        2.496226006338465e-41,
        3.502430038752116e-42,
        4.9367533501637906e-43,
        6.988906566484008e-44,
        9.935553478925189e-45,
        1.4186870587883685e-45,
        2.073909772714984e-46,
        2.921661276904394e-47,
    ],
    &[
        -0.07475269013314134,
        1.075618414670451,
        0.0011262888845685794,
        0.00001569082176476955,
        6.358678987788077e-7,
        4.6766038716228556e-8,
        5.0646677267035145e-9,
        7.222613597814572e-10,
        1.2680453375155334e-10,
        2.622756183768946e-11,
        6.198449078073451e-12,
        1.636994888400006e-12,
        4.750744449138882e-13,
        1.495429515727733e-13,
        5.0531214592853156e-14,
        1.8175811488931027e-14,
        6.911303445568331e-15,
        2.7621256387530134e-15,
        1.154560036475788e-15,
        5.026436372804401e-16,
        2.2709367905784334e-16,
        1.0614174198001429e-16,
        5.1180933886636636e-17,
        2.5399038680385864e-17,
        1.2944321992871283e-17,
        6.761794316809122e-18,
        3.614266158108035e-18,
        1.9737130395117578e-18,
        1.0996364330742724e-18,
        6.242636907564651e-19,
        3.6069796721415163e-19,
        2.1189628093361284e-19,
        1.2644288942641533e-19,
        7.657399598757273e-20,
        4.7026674716833986e-20,
        2.9267230521262964e-20,
        1.8447537249186648e-20,
        1.1771378122040554e-20,
        7.602823691237781e-21,
        4.971848036893206e-21,
        3.2960820656522272e-21,
        2.222006771375203e-21,
        1.5331499308891772e-21,
        1.0964391059429598e-21,
        8.306380107927281e-22,
        6.878265048040663e-22,
        3.2141723875185687e-22,
    ],
];

pub const SPLITS: [f64; 3] = [-3.303558298018915, -1.1517791490094575, 1.];
