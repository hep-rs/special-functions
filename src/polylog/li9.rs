use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.,
            1.,
            0.001953125,
            0.00005080526342529086,
            3.814697265625e-6,
            5.12e-7,
            9.92290301275212e-8,
            2.478093222249005e-8,
            7.450580596923828e-9,
            2.581174791713197e-9,
            1e-9,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.,
            -1.9924660037052955,
            0.,
            -0.32851703043247826,
            0.,
            -0.015783880491620765,
            0.,
            -0.00032637580691433066,
            0.,
            -2.7557319223985893e-6,
        ],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 1] = [&[
    -1.145070868660732,
    2.142780129595644,
    0.0041949348838866835,
    0.00009749237596469626,
    5.976236862577514e-6,
    6.181827891726475e-7,
    8.918971952613595e-8,
    1.6254850413227456e-8,
    3.5293650324497866e-9,
    8.791448462745331e-10,
    2.447971288490295e-10,
    7.478366427311673e-11,
    2.471577588507629e-11,
    8.74197429169972e-12,
    3.28090855029494e-12,
    1.2975517689606603e-12,
    5.376913860776703e-13,
    2.32359679788061e-13,
    1.0429630074127769e-13,
    4.845875870553336e-14,
    2.3237531832650268e-14,
    1.1471172689799239e-14,
    5.816331123580981e-15,
    3.023096921765462e-15,
    1.607871981180553e-15,
    8.737037307050146e-16,
    4.8437013713032735e-16,
    2.7361420795968567e-16,
    1.5730708034933608e-16,
    9.195014026030893e-17,
    5.459308787894638e-17,
    3.2894763338104514e-17,
    2.0099033000182752e-17,
    1.2444259614394331e-17,
    7.802351528752181e-18,
    4.9510355435539694e-18,
    3.1781695316721294e-18,
    2.0631623328699254e-18,
    1.3544028664362815e-18,
    8.995424843188948e-19,
    6.053032510383407e-19,
    4.140146604941029e-19,
    2.8975931601890846e-19,
    2.1011546979846023e-19,
    1.612099988858997e-19,
    1.3476881860589572e-19,
    6.320575977610572e-20,
]];

pub const SPLITS: [f64; 2] = [-3.303558298018915, 1.];
