#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            -1.9924660037052955,
            -1.,
            -0.00390625,
            -0.00015241579027587258,
            -0.0000152587890625,
            -2.56e-6,
            -5.953741807651273e-7,
            -1.7346652555743034e-7,
            -5.960464477539063e-8,
            -2.3230573125418773e-8,
            -1e-8,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.,
            0.,
            -0.9855510912974347,
            0.,
            -0.07891940245810382,
            0.,
            -0.0022846306484003145,
            0.,
            -0.0000248015873015873,
        ],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -2.7509947018893364,
        1.2364264322352698,
        0.002428068639637532,
        0.0000361563511620704,
        1.1340659474217226e-6,
        5.2240142640831705e-8,
        3.04543122225113e-9,
        2.0832193977383946e-10,
        1.600523802202959e-11,
        1.3434329444468257e-12,
        1.2091968282203774e-13,
        1.1517905330652708e-14,
        1.1498280083014227e-15,
        1.1942171434094725e-16,
        1.283054884991464e-17,
        1.419554052096848e-18,
        1.6114453369675865e-19,
        1.8712623737179764e-20,
        2.2173198815726266e-21,
        2.675398428166126e-22,
        3.2812876222397796e-23,
        4.084470513005293e-24,
        5.153389258302913e-25,
        6.58294440591286e-26,
        8.50518076901299e-27,
        1.1104547084540981e-27,
        1.4639749408382241e-28,
        1.9475144938374493e-29,
        2.6125984970621153e-30,
        3.532382317191209e-31,
        4.811137183837914e-32,
        6.598048314689298e-33,
        9.107345712448438e-34,
        1.2647758799521538e-34,
        1.7665734259046092e-35,
        2.4809021041141268e-36,
        3.502046863058633e-37,
        4.967675068631458e-38,
        7.079404394175468e-39,
        1.0133371849512126e-39,
        1.4565774113167904e-40,
        2.10208669058354e-41,
        3.0452731376045744e-42,
        4.42783022773565e-43,
        6.463478638893988e-44,
        9.662459425244165e-45,
        1.3890299081629102e-45,
    ],
    &[
        -0.257046004643607,
        1.2580185664756476,
        0.0030289482178505567,
        0.00007110143813104259,
        4.244425776405207e-6,
        4.2632850454129705e-7,
        6.005892079294011e-8,
        1.0767164956529215e-8,
        2.3167382489880676e-9,
        5.757590593925338e-10,
        1.6091358181131799e-10,
        4.959938261092249e-11,
        1.6615009419307085e-11,
        5.9799103389988895e-12,
        2.291395923454222e-12,
        9.279041408512272e-13,
        3.9468563784280185e-13,
        1.7543871714959212e-13,
        8.114210060776686e-14,
        3.890505573208556e-14,
        1.9276004871586414e-14,
        9.84173593143149e-15,
        5.165496581081731e-15,
        2.781027597172828e-15,
        1.5329368208097959e-15,
        8.636382358831637e-16,
        4.96556008081e-16,
        2.909646355626771e-16,
        1.7354518385736176e-16,
        1.0524487060510073e-16,
        6.482849049250218e-17,
        4.0523639227746917e-17,
        2.5684238066658858e-17,
        1.649356942480679e-17,
        1.0724169321087658e-17,
        7.05616288262435e-18,
        4.696157500579197e-18,
        3.160731808921114e-18,
        2.15155671797915e-18,
        1.4823306311626537e-18,
        1.0354521111882969e-18,
        7.360051263941608e-19,
        5.359654032776568e-19,
        4.045282684376614e-19,
        3.221621467422925e-19,
        2.7697800429836345e-19,
        1.3129376008343786e-19,
    ],
];

pub const SPLITS: [f64; 3] = [-4.0413315338482585, -1.520665766924129, 1.];
