#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.,
            1.,
            0.0078125,
            0.0004572473708276177,
            0.00006103515625,
            0.0000128,
            3.5722450845907635e-6,
            1.2142656789020123e-6,
            4.76837158203125e-7,
            2.0907515812876897e-7,
            1e-7,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.,
            -1.9711021825948694,
            0.,
            -0.3156776098324153,
            0.,
            -0.013707783890401887,
            0.,
            -0.0001984126984126984,
        ],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        -3.3748944076714347,
        1.4228900590219014,
        0.005738234012920997,
        0.0001251545555109495,
        5.068473961493639e-6,
        2.830601116101149e-7,
        1.9272293974336007e-8,
        1.5020758194703278e-9,
        1.2919466356899364e-10,
        1.1980875736214772e-11,
        1.1792039122791564e-12,
        1.2181344389908414e-13,
        1.3098883929236332e-14,
        1.457114096256065e-15,
        1.668639012592351e-16,
        1.9595860987205016e-17,
        2.352579894689061e-18,
        2.8799878836775655e-19,
        3.587393098850711e-20,
        4.5387077265068234e-21,
        5.823584866107155e-22,
        7.568118829792373e-23,
        9.9503006417046e-24,
        1.3222391658276695e-24,
        1.7743405851024647e-25,
        2.402641564307388e-26,
        3.280766512662519e-27,
        4.514786115467834e-28,
        6.258108055337247e-29,
        8.733433301104395e-30,
        1.2265224667065936e-30,
        1.7327856087480724e-31,
        2.4617210696823222e-32,
        3.515742914938172e-33,
        5.046047290550437e-34,
        7.276522585664289e-35,
        1.0539664466034097e-35,
        1.5330649060577264e-36,
        2.238892889329162e-37,
        3.282163027118665e-38,
        4.829056358529765e-39,
        7.129622439167983e-40,
        1.0560997495369513e-40,
        1.5693458232652364e-41,
        2.3402063422193442e-42,
        3.575072914607136e-43,
        5.240705806277524e-44,
    ],
    &[
        -1.2174044103386208,
        0.7305089381613086,
        0.0018051514704946273,
        0.000028249237227114373,
        8.979019235125893e-7,
        4.153800577942283e-8,
        2.4271929042472543e-9,
        1.66455428488039e-10,
        1.2832379487431615e-11,
        1.0818796821615486e-12,
        9.790316562822189e-14,
        9.383953349484416e-15,
        9.433756562244815e-16,
        9.873114458392585e-17,
        1.069478777298914e-17,
        1.1935330834109275e-18,
        1.367164623341865e-19,
        1.6025141808635196e-20,
        1.9172241461413938e-21,
        2.3361745180740044e-22,
        2.8940818240920305e-23,
        3.639270596837934e-24,
        4.6390931092758715e-25,
        5.987703147135717e-26,
        7.817220472279537e-27,
        1.0313805792183398e-27,
        1.374087674937856e-28,
        1.8472745396319906e-29,
        2.5043513788862196e-30,
        3.4218377167119233e-31,
        4.7097930378740373e-32,
        6.52712205500208e-33,
        9.104099523297807e-34,
        1.2775615853715976e-34,
        1.80303836746163e-35,
        2.5583966059866638e-36,
        3.6487444626207097e-37,
        5.228953425479627e-38,
        7.527903106730908e-39,
        1.0884827367321403e-39,
        1.5803929064697201e-40,
        2.303663167272901e-41,
        3.370573214248963e-42,
        4.949367010815962e-43,
        7.296003328681909e-44,
        1.1017941054789953e-44,
        1.5985998545405806e-45,
    ],
    &[
        -0.11451505699414846,
        0.37107031339705354,
        0.0005296690948516847,
        5.55454408358772e-6,
        1.3100858934742078e-7,
        4.810975353258966e-9,
        2.3373695705245936e-10,
        1.3777620905618285e-11,
        9.357286347304956e-13,
        7.082549983082801e-14,
        5.8399570545283465e-15,
        5.161222565845187e-16,
        4.830600021023962e-17,
        4.7444719504122215e-18,
        4.855402874117047e-19,
        5.148284071950091e-20,
        5.630171623365356e-21,
        6.326785294667511e-22,
        7.282893520156274e-23,
        8.565609381486106e-24,
        1.0270524800990303e-24,
        1.2531201139301247e-25,
        1.553307042680522e-26,
        1.953342819790531e-27,
        2.489003619132578e-28,
        3.21020370051368e-29,
        4.186859585868594e-30,
        5.517318938694568e-31,
        7.340514432161836e-32,
        9.853546459207504e-33,
        1.3337203228970604e-33,
        1.8193121268769976e-34,
        2.4998066908019163e-35,
        3.458347100966771e-36,
        4.815231417886729e-37,
        6.745140183027291e-38,
        9.502599350710229e-39,
        1.3459718494735373e-39,
        1.9162270508262917e-40,
        2.7413241786370886e-41,
        3.9397620339267644e-42,
        5.68692279033513e-43,
        8.243111847562823e-44,
        1.1995845048597314e-44,
        1.753108805947371e-45,
        2.6247015059463427e-46,
        3.779177835106241e-47,
    ],
    &[
        0.6321058808409454,
        0.3756203185769384,
        0.0006137049018169844,
        8.985475570909614e-6,
        3.580305949637176e-7,
        2.6131825083837275e-8,
        2.8857787819515754e-9,
        4.3158699763098293e-10,
        8.139928805278091e-11,
        1.8435498785791608e-11,
        4.84062935263023e-12,
        1.4355887775139114e-12,
        4.714221451957672e-13,
        1.6878275402496497e-13,
        6.508278722925923e-14,
        2.676362428351655e-14,
        1.1643229662060758e-14,
        5.323154150592254e-15,
        2.5434616161990017e-15,
        1.2641927394745313e-15,
        6.510407176687072e-16,
        3.462030032543438e-16,
        1.895414802090199e-16,
        1.0656593102684722e-16,
        6.139067165690146e-17,
        3.6166174210385125e-17,
        2.175025770297696e-17,
        1.3332696159944547e-17,
        8.31890490702782e-18,
        5.276853115487869e-18,
        3.399117682100963e-18,
        2.2213213776455903e-18,
        1.4713930561257188e-18,
        9.871472021740107e-19,
        6.703224140579823e-19,
        4.604741165381803e-19,
        3.198862289082857e-19,
        2.2470824720729023e-19,
        1.5966907043959135e-19,
        1.148786834336487e-19,
        8.386711962700142e-20,
        6.236736664712292e-20,
        4.7552030399442883e-20,
        3.7550903261417424e-20,
        3.1145409131694144e-20,
        2.757696670913099e-20,
        1.3215677840206566e-20,
    ],
];

pub const SPLITS: [f64; 5] = [
    -4.947453297099445,
    -1.9737266485497225,
    -0.48686332427486123,
    0.2565683378625694,
    1.,
];
