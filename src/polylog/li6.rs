#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            -1.9711021825948694,
            -1.,
            -0.015625,
            -0.0013717421124828531,
            -0.000244140625,
            -0.000064,
            -0.00002143347050754458,
            -8.499859752314087e-6,
            -3.814697265625e-6,
            -1.8816764231589208e-6,
            -1e-6,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.,
            0.,
            -0.9470328294972459,
            0.,
            -0.06853891945200943,
            0.,
            -0.001388888888888889,
        ],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        -4.0651714933870595,
        1.6032126566764389,
        0.012579319544047163,
        0.0003880509744771067,
        0.0000198409678663863,
        1.322367026429386e-6,
        1.0390623324539128e-7,
        9.140291751516544e-9,
        8.732784609919237e-10,
        8.888442931685576e-11,
        9.512155716942215e-12,
        1.0603657390658065e-12,
        1.2228135532290233e-13,
        1.45115609301319e-14,
        1.76498760044225e-15,
        2.1929592055555364e-16,
        2.7761185204310305e-17,
        3.572937576080792e-18,
        4.666722465257729e-19,
        6.1764740514301e-20,
        8.272809036876051e-21,
        1.1201349097959085e-21,
        1.5317179732341694e-22,
        2.113577548675269e-23,
        2.9408496249238764e-24,
        4.123485583881588e-25,
        5.822997630985891e-26,
        8.277508340411623e-27,
        1.183932811690203e-27,
        1.7031479847406568e-28,
        2.4632948224509565e-29,
        3.580757816801433e-30,
        5.229945041191024e-31,
        7.672972183314445e-32,
        1.1304865907227613e-32,
        1.6722552959837474e-33,
        2.483037666360455e-34,
        3.7001815390990566e-35,
        5.532783537454225e-36,
        8.299902902766196e-37,
        1.248947125744764e-37,
        1.884927217679368e-38,
        2.8527704177467622e-39,
        4.329243041030848e-40,
        6.590243497550155e-41,
        1.0281260325191367e-41,
        1.535828644376506e-42,
    ],
    &[
        -1.6078746224035299,
        0.8453884805800549,
        0.004392688048603257,
        0.00010392714031731674,
        4.3891940593865596e-6,
        2.5224444343141025e-7,
        1.757356515983957e-8,
        1.3976559897824811e-9,
        1.2248364076434397e-10,
        1.1562530377557464e-11,
        1.157779315663583e-12,
        1.2162436238510223e-13,
        1.3295544572954547e-14,
        1.5031228533686537e-15,
        1.7489997340081937e-16,
        2.086529556085835e-17,
        2.5441899457166497e-18,
        3.1626899033728906e-19,
        3.999669436366054e-20,
        5.1366117913334904e-21,
        6.688919683033788e-22,
        8.820585469729667e-23,
        1.1765584525305148e-23,
        1.5859158015951138e-24,
        2.158369933766358e-25,
        2.9636278815601284e-26,
        4.102832973239371e-27,
        5.723327718568963e-28,
        8.040583702243476e-29,
        1.1370874636804288e-29,
        1.6180095458145776e-30,
        2.3156909216480687e-31,
        3.3322639670840843e-32,
        4.819679830733181e-33,
        7.004703833326225e-34,
        1.0226751549750617e-34,
        1.499529683792357e-35,
        2.207717427193005e-36,
        3.262963543622111e-37,
        4.840357023534784e-38,
        7.205453413223167e-39,
        1.0761972276614817e-39,
        1.6125089059270182e-40,
        2.423452744940298e-41,
        3.654647479933121e-42,
        5.6479646362599515e-43,
        8.366614629888811e-44,
    ],
    &[
        -0.3219507815660696,
        0.43742066720597467,
        0.0014099111546443486,
        0.000024096245140677337,
        8.042022853868066e-7,
        3.860766877773537e-8,
        2.3312989892356337e-9,
        1.6492766738969502e-10,
        1.3104315793984346e-11,
        1.1379942055357759e-12,
        1.0602222141507994e-13,
        1.0457296024610297e-14,
        1.0812931767158648e-15,
        1.1633882993269586e-16,
        1.2948995178122722e-17,
        1.4841241183682846e-18,
        1.7450409143485569e-19,
        2.0985209020814332e-20,
        2.5744847366677235e-21,
        3.2152228233026047e-22,
        4.0802908739229696e-23,
        5.2536338746271934e-24,
        6.8539225329001485e-25,
        9.049565358248662e-26,
        1.2080565677297468e-26,
        1.6290442336586858e-27,
        2.2172999752940924e-28,
        3.044108023089555e-29,
        4.212795750914676e-30,
        5.873734077864523e-31,
        8.246597505300221e-32,
        1.1653495406431511e-32,
        1.6568425776847426e-33,
        2.3691298496794913e-34,
        3.4059033273896163e-35,
        4.921273588553704e-36,
        7.1449893531364035e-37,
        1.0420575501208047e-37,
        1.5263143146619466e-38,
        2.2447219139547932e-39,
        3.3140478643225483e-40,
        4.910780802495957e-41,
        7.302334827810361e-42,
        1.0894974626421857e-42,
        1.631500971932045e-43,
        2.5037329736513e-44,
        3.6859671791786655e-45,
    ],
    &[
        0.5653000583253638,
        0.45016887539050654,
        0.0018205082448626612,
        0.0000499120767101074,
        3.2734944038296673e-6,
        3.618293622869268e-7,
        5.693271476906928e-8,
        1.15750334916555e-8,
        2.8594000485663065e-9,
        8.231836870475567e-10,
        2.6810089501663837e-10,
        9.664515813237806e-11,
        3.7926376781103195e-11,
        1.5995434141990735e-11,
        7.176722861802282e-12,
        3.3976554373166483e-12,
        1.68600065237263e-12,
        8.721029421406661e-13,
        4.680691981435591e-13,
        2.596558450222259e-13,
        1.48387198970099e-13,
        8.711111095083947e-14,
        5.2404094512384965e-14,
        3.223634013468398e-14,
        2.023974649378026e-14,
        1.2948835294316395e-14,
        8.429327908518524e-15,
        5.576133636425132e-15,
        3.7441606072996474e-15,
        2.549261439599184e-15,
        1.7584079559013671e-15,
        1.2277872142956658e-15,
        8.672078082909197e-16,
        6.192509133339666e-16,
        4.468444481495765e-16,
        3.257361271185289e-16,
        2.3986406312753927e-16,
        1.7846853307336022e-16,
        1.342657758470271e-16,
        1.0227883566702411e-16,
        7.90804581549088e-17,
        6.229784393235393e-17,
        5.0286054625170616e-17,
        4.191162158978356e-17,
        3.6409420590891395e-17,
        3.328942005188603e-17,
        1.6139316411180228e-17,
    ],
];

pub const SPLITS: [f64; 5] = [
    -6.066481965674086,
    -2.533240982837043,
    -0.7666204914185215,
    0.11668975429073924,
    1.,
];
