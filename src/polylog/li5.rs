use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.,
            1.,
            0.03125,
            0.00411522633744856,
            0.0009765625,
            0.00032,
            0.0001286008230452675,
            0.000059499018266198606,
            0.000030517578125,
            0.000016935087808430286,
            0.00001,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.,
            -1.8940656589944918,
            0.,
            -0.27415567780803773,
            0.,
            -0.008333333333333333,
        ],
    )
}

pub fn upper(_: f64) -> f64 {
    panic!("Polylogs are invalid for x > 1.")
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        -4.738989140465593,
        1.724287353663998,
        0.024683306907324974,
        0.0010405952801194557,
        0.00006578692440397724,
        5.157850061346743e-6,
        4.62716232500063e-7,
        4.5550645551169485e-8,
        4.8005521465130315e-9,
        5.331289328895789e-10,
        6.172109846309855e-11,
        7.391831249115962e-12,
        9.10569614138281e-13,
        1.1487662903126911e-13,
        1.4792318774994124e-14,
        1.9388992808983723e-15,
        2.581306995432013e-16,
        3.484251037363655e-17,
        4.761186381312124e-18,
        6.578246730590173e-19,
        9.179721154824833e-20,
        1.2926304927313578e-20,
        1.8352705108520898e-21,
        2.625465444515957e-22,
        3.782072921634389e-23,
        5.483260157257917e-24,
        7.997007769562273e-25,
        1.172769627834335e-25,
        1.7287432922125444e-26,
        2.5605520804920664e-27,
        3.8096857205262214e-28,
        5.692156279299295e-29,
        8.538612875721183e-30,
        1.2856450630135359e-30,
        1.9426165321996583e-31,
        2.9451124633866996e-32,
        4.47908022000699e-33,
        6.832463835799623e-34,
        1.0452067237609913e-34,
        1.6032567607739652e-35,
        2.4656082170312046e-36,
        3.801134236968789e-37,
        5.87384223162739e-38,
        9.097289146811761e-39,
        1.4127943074939477e-39,
        2.2494250314382965e-40,
        3.42213453085734e-41,
    ],
    &[
        -2.0449923288215777,
        0.953454532572832,
        0.009862921699800704,
        0.00033987792622355097,
        0.000018597123242814776,
        1.3035696286552145e-6,
        1.0676483512518611e-7,
        9.736750867922738e-9,
        9.60990168116301e-10,
        1.007832576176952e-10,
        1.1091520191372e-11,
        1.269536791001375e-12,
        1.5013283566928675e-13,
        1.825113983318463e-14,
        2.2718338330921334e-15,
        2.8865039403136696e-16,
        3.733984320628052e-17,
        4.907608979969125e-18,
        6.541977777971972e-19,
        8.831896339761098e-20,
        1.2060468445834163e-20,
        1.6640879516130532e-21,
        2.317873660966329e-22,
        3.256537268648232e-23,
        4.611793106378909e-24,
        6.579032330647545e-25,
        9.449185147873272e-26,
        1.3656980706602892e-26,
        1.985424342367989e-27,
        2.9021507460097788e-28,
        4.26384128194056e-29,
        6.294447650809994e-30,
        9.333911272969442e-31,
        1.3899665398520476e-31,
        2.0781400280815588e-32,
        3.118739022257456e-33,
        4.6970898300912966e-34,
        7.098117123752545e-35,
        1.07608620990328e-35,
        1.6363318196963094e-36,
        2.495467839299447e-37,
        3.816184479606602e-38,
        5.8512454374537e-39,
        8.994206673274174e-40,
        1.3866200201548384e-40,
        2.1915784465450928e-41,
        3.3125043456735796e-42,
    ],
    &[
        -0.5731055160497919,
        0.5117074801651958,
        0.0035903252072411037,
        0.00009648006449995368,
        4.425646334191011e-6,
        2.713870482248501e-7,
        1.999089867513121e-8,
        1.671615722266254e-9,
        1.534191644471139e-10,
        1.512278174033196e-11,
        1.5774094550389118e-12,
        1.7226929203989676e-13,
        1.9543779777671408e-14,
        2.289530747216819e-15,
        2.7567304622368177e-16,
        3.398912098889527e-17,
        4.2783846314737534e-18,
        5.484595976081714e-19,
        7.145721216824205e-20,
        9.445783520037642e-21,
        1.2649913109918869e-21,
        1.7141674140211636e-22,
        2.3478378020129023e-23,
        3.2473308375628257e-24,
        4.531834639235319e-25,
        6.376743254959855e-26,
        9.041190391923573e-27,
        1.290949675729472e-27,
        1.855374431639506e-28,
        2.68285128111839e-29,
        3.9014699335834454e-30,
        5.703842301414593e-31,
        8.380505670314448e-32,
        1.2371017501244905e-32,
        1.8342295604654363e-33,
        2.7309003899336414e-34,
        4.0818954233393723e-35,
        6.123923954702655e-36,
        9.219872663131075e-37,
        1.3927369864613354e-37,
        2.110522776814336e-38,
        3.2078992064169823e-39,
        4.889889219097931e-40,
        7.474333898280205e-41,
        1.1460812406605287e-41,
        1.8016139081145054e-42,
        2.7101036230291208e-43,
    ],
    &[
        0.2092094519439836,
        0.2680883778018616,
        0.0011953215570056697,
        0.000023745525334132912,
        8.815355117784956e-7,
        4.6269629816225076e-8,
        3.0261163643452528e-9,
        2.303842206066856e-10,
        1.9600192790404747e-11,
        1.8148441787523962e-12,
        1.7961952814810297e-13,
        1.8759292827877175e-14,
        2.047897134795111e-15,
        2.3200905367436024e-16,
        2.712584847232189e-17,
        3.2585619155825953e-18,
        4.0076553398272674e-19,
        5.0317310536398795e-20,
        6.433781139565836e-21,
        8.361164883734261e-22,
        1.1025141621571804e-22,
        1.4729651400472887e-23,
        1.9913795894597377e-24,
        2.721471793145431e-25,
        3.7560970897234856e-26,
        5.231161492522107e-27,
        7.346410365535644e-28,
        1.0396596130272934e-28,
        1.4818349559587646e-29,
        2.1260874710201066e-30,
        3.069287999659802e-31,
        4.4564762872856216e-32,
        6.505524972387384e-33,
        9.544742652959681e-34,
        1.4070345070400217e-34,
        2.0834500386876086e-35,
        3.098052234418843e-36,
        4.625091719906709e-37,
        6.930822675219584e-38,
        1.0423083999939335e-38,
        1.5728071379885072e-39,
        2.380944051232872e-40,
        3.615343521252831e-41,
        5.505779624841593e-42,
        8.412472759307348e-43,
        1.3177674110101255e-43,
        1.9761374967068547e-44,
    ],
    &[
        0.6161308052160525,
        0.13797544984142088,
        0.00036742367672078436,
        5.092388221597536e-6,
        1.4738871090850176e-7,
        6.490051325260122e-9,
        3.736267662324131e-10,
        2.5854666278953842e-11,
        2.0437921336834413e-12,
        1.7858737894594493e-13,
        1.6869126454239187e-14,
        1.6955938109549847e-15,
        1.7928630075778666e-16,
        1.9770799153694897e-17,
        2.258799875569403e-18,
        2.6598341781413983e-19,
        3.214830467320736e-20,
        3.974969645256821e-21,
        5.014047060346461e-22,
        6.437704409289658e-23,
        8.397119770499954e-24,
        1.1109184671281433e-24,
        1.4886239816349365e-25,
        2.0179991986846958e-26,
        2.7646567355145977e-27,
        3.8243184539017833e-28,
        5.337228557617967e-29,
        7.509711346331494e-30,
        1.0646516172589307e-30,
        1.5199494368397458e-31,
        2.184106893060556e-32,
        3.157543760979567e-33,
        4.590734685732695e-34,
        6.709891341184515e-35,
        9.85614152982281e-36,
        1.4545444114192937e-36,
        2.156042985595817e-37,
        3.2091499410510556e-38,
        4.795407125947284e-39,
        7.19237842839024e-40,
        1.0825475386196936e-40,
        1.6348242717902617e-41,
        2.4766976043562013e-42,
        3.763493905023481e-43,
        5.738357135899778e-44,
        8.97019000157061e-45,
        1.3427347332132814e-45,
    ],
    &[
        0.8245354290313613,
        0.07016127946949823,
        0.00010571880026295393,
        9.631531912598444e-7,
        2.0917937733006496e-8,
        7.601363784087236e-10,
        3.8427197342758075e-11,
        2.429018649771233e-12,
        1.798923946074688e-13,
        1.4974468475589783e-14,
        1.3628210382180054e-15,
        1.3303462500890254e-16,
        1.3739728957088924e-17,
        1.4862433269670447e-18,
        1.6710078395661064e-19,
        1.9412181861775692e-20,
        2.319269782641138e-21,
        2.839125206744537e-22,
        3.550195520906063e-23,
        4.523399582351025e-24,
        5.860225500282347e-25,
        7.70611453915053e-26,
        1.0270183671901436e-26,
        1.3854327189949718e-27,
        1.8896271900771558e-28,
        2.603347583152416e-29,
        3.61982697612818e-30,
        5.07599765048909e-31,
        7.173787634171828e-32,
        1.0212131550108405e-32,
        1.4635228992127012e-33,
        2.110550549952321e-34,
        3.061422568753602e-35,
        4.464963590007475e-36,
        6.545321358158241e-37,
        9.641115809991382e-38,
        1.4265392776422976e-38,
        2.119764974766048e-39,
        3.162540443417131e-40,
        4.736244493097365e-41,
        7.118599326842746e-42,
        1.073586143777794e-42,
        1.6243770396261372e-43,
        2.4653617035847897e-44,
        3.7547170743545093e-45,
        5.862688583786407e-46,
        8.767034765437135e-47,
    ],
    &[
        0.9657454482480345,
        0.07106064451265036,
        0.00012007357233447085,
        1.5214690176566016e-6,
        6.100450384537434e-8,
        5.322648379523244e-9,
        7.833291564447208e-10,
        1.6394614041378517e-10,
        4.383995547743966e-11,
        1.4007876890707901e-11,
        5.1217188251615695e-12,
        2.0811818430289165e-12,
        9.20700764586844e-13,
        4.3683279954592875e-13,
        2.1977951166886223e-13,
        1.1623584003701972e-13,
        6.417707083888535e-14,
        3.678755911186095e-14,
        2.179414464844497e-14,
        1.3294505697608618e-14,
        8.324124083340474e-15,
        5.33567273394507e-15,
        3.4933575123664716e-15,
        2.33161189723918e-15,
        1.5837918685640386e-15,
        1.0932817751160386e-15,
        7.659518716027127e-16,
        5.440237198130919e-16,
        3.9133855734611244e-16,
        2.8485980507389264e-16,
        2.0966641405848595e-16,
        1.5594454988763255e-16,
        1.1714683091151925e-16,
        8.884677849278352e-17,
        6.801459637770735e-17,
        5.255253628668621e-17,
        4.0992685406883594e-17,
        3.229786600547892e-17,
        2.5728898896301326e-17,
        2.0755141322738966e-17,
        1.6993602226280012e-17,
        1.4167167792921297e-17,
        1.207577434832626e-17,
        1.057648218207685e-17,
        9.569779787519431e-18,
        8.990358276047419e-18,
        4.400606220377446e-18,
    ],
];

pub const SPLITS: [f64; 8] = [
    -7.4624813228459805,
    -3.2312406614229903,
    -1.1156203307114951,
    -0.05781016535574757,
    0.4710949173221262,
    0.7355474586610631,
    0.8677737293305315,
    1.,
];
