#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    x.recip()
        * polynomial(
            x,
            &[
                1.,
                -0.5772156649015329,
                0.989055995327973,
                -0.907479076080886,
                0.9817280868344,
                -0.981995068903145,
                0.993149114621276,
                -0.996001760442432,
                0.998105693783129,
                -0.999025267621955,
                0.999515656072777,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.sqrt()
        * (x * (x.ln() - 1.0)).exp()
        * polynomial(
            x.recip(),
            &[
                0.0,
                2.506628274631001,
                0.2088856895525834,
                0.008703570398024307,
                -0.006721090474029882,
                -0.0005752012381101712,
                0.001965294881583203,
                0.0001747825212045591,
                -0.001484341135158276,
                -0.0001296375732112554,
                0.002104311229753206,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        1.726464144520494,
        -1.527463564012656,
        0.00943060854246944,
        0.01318569813624873,
        0.00558664508412498,
        0.001504104374467998,
        0.0002905046453761779,
        0.0000409535288341242,
        4.026552513069559e-6,
        2.547767123720937e-7,
        1.905498512413397e-8,
        5.452078273911517e-9,
        1.110633444098433e-9,
        5.119938076886616e-11,
        -2.641608952516854e-11,
        -5.760974815338189e-12,
        3.781107142118968e-14,
        2.198055387518788e-13,
        3.611887117668446e-14,
        -1.961120092765954e-15,
        -1.696963902314016e-15,
        -2.257291523802531e-16,
        2.384945325152345e-17,
        1.280506984999336e-17,
        1.404385732340209e-18,
        -2.309659097668442e-19,
        -9.52201414093527e-20,
        -8.599058728259956e-21,
        2.035249045983735e-21,
        6.825780409986263e-22,
        5.09515741802249e-23,
    ],
    &[
        5.728595419706884,
        9.38197391162978,
        5.232855580465188,
        1.677433171314328,
        0.3866722153429386,
        0.06843039341081355,
        0.00983629652269177,
        0.001191771556001471,
        0.0001235289692771075,
        0.0000112691140284388,
        9.39438664985366e-7,
        6.529246206805003e-8,
        4.115029703422715e-9,
        4.631182137323991e-10,
        -1.651521114499428e-12,
        -5.148390769611709e-12,
        2.019197490752198e-12,
        -4.715262061226905e-14,
        -9.39665910014291e-14,
        1.844637696881433e-14,
        1.933803346836693e-15,
        -1.282943746933341e-15,
        9.44834018333226e-17,
        5.423343285191881e-17,
        -1.285047670978978e-17,
        -1.098421893510068e-18,
        8.3232604474121e-19,
        -5.004637540055014e-20,
        -3.783776991560801e-20,
        6.731011939560224e-21,
        1.145623471374482e-21,
    ],
];

pub const SPLITS: [f64; 3] = [-3.275178410138578, -0.3189540509182786, 2.637270308302021];
