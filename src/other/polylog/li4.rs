#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            -1.894065658994492,
            -1.,
            -0.0625,
            -0.01234567901234568,
            -0.00390625,
            -0.0016,
            -0.0007716049382716049,
            -0.0004164931278633903,
            -0.000244140625,
            -0.0001524157902758726,
            -0.0001,
        ],
    ) + polynomial(
        (-x).ln(),
        &[0.0, 0.0, -0.8224670334241132, 0.0, -0.04166666666666667],
    )
}

pub fn upper(x: f64) -> f64 {
    if x == 1.0 {
        return 1.082323233711138;
    }

    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.082323233711138,
            1.202056903159594,
            0.2214385818443161,
            -0.1162258434820262,
            0.05758055484887188,
            -0.02900559166595327,
            0.01418764713508712,
            -0.006028318183603879,
            0.001332628810720929,
            0.001448207632398665,
            -0.003117737499542576,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                0.0,
                -0.1666666666666667,
                0.25,
                -0.2916666666666667,
                0.3125,
                -0.3222222222222222,
                0.3256944444444444,
                -0.3255180776014109,
                0.3231646825396825,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 14] = [
    &[
        -6.071195813576371,
        0.8050497150822387,
        0.00867537141112303,
        0.0002094132014971287,
        6.881552451654208e-6,
        2.6688277251463e-7,
        1.148898336385421e-8,
        5.316210644458559e-10,
        2.594205757330337e-11,
        1.318742312066273e-12,
        6.925122135132793e-14,
        3.734245703923913e-15,
        2.058526387604688e-16,
        1.156155034540441e-17,
        6.598300108431401e-19,
        3.818460901272729e-20,
        2.236879508648128e-21,
        1.32459895944506e-22,
        7.919641283240859e-24,
        4.776149137439227e-25,
        2.902936449815526e-26,
        1.776937657602266e-27,
        1.094742181288381e-28,
        6.784554966787445e-30,
        4.227607191474363e-31,
        2.64758510938288e-32,
        1.665812837961242e-33,
        1.052640340142789e-34,
        6.678672728468655e-36,
        4.270666000925262e-37,
        2.718227863718206e-38,
    ],
    &[
        -4.382064720281745,
        0.8869140630300216,
        0.01209330338963492,
        0.0003847945884473765,
        0.00001696318495120912,
        8.912779540746979e-7,
        5.231258463678776e-8,
        3.315125611560866e-9,
        2.222905033850458e-10,
        1.556739992552154e-11,
        1.128546472060191e-12,
        8.415200125582438e-14,
        6.42391264869141e-15,
        5.002181925612443e-16,
        3.96205741036013e-17,
        3.184993136640091e-18,
        2.593775540030982e-19,
        2.136694584796997e-20,
        1.778268354931667e-21,
        1.493623001588736e-22,
        1.264986050731269e-23,
        1.079440747424554e-24,
        9.27454226542237e-26,
        8.018925678252106e-27,
        6.973491647783909e-28,
        6.096788580671352e-29,
        5.356697266689736e-30,
        4.728087683638761e-31,
        4.191377427041367e-32,
        3.75983695301404e-33,
        3.331983932167513e-34,
    ],
    &[
        -3.001265860175611,
        0.4854805732664833,
        0.004177090001432451,
        0.00008782594545544365,
        2.610346909988546e-6,
        9.35168713269691e-8,
        3.76972669022878e-9,
        1.649021704367095e-10,
        7.66116431234088e-12,
        3.728117537380789e-13,
        1.882294284700528e-14,
        9.79347064770059e-16,
        5.224530474785845e-17,
        2.846741976656423e-18,
        1.579548541408357e-19,
        8.903499216406551e-21,
        5.088471676193801e-22,
        2.943870846168979e-23,
        1.721776494282369e-24,
        1.016891389015931e-25,
        6.058960297072573e-27,
        3.639085002830472e-28,
        2.201657471662701e-29,
        1.340921539759339e-30,
        8.217102639466192e-32,
        5.063948009603439e-33,
        3.137125628284232e-34,
        1.952916887683993e-35,
        1.221253471466734e-36,
        7.699732968435691e-38,
        4.835131083921976e-39,
    ],
    &[
        -1.992929196868225,
        0.524007628367897,
        0.005565223468250864,
        0.0001517726679922159,
        5.984528957619772e-6,
        2.881021489556168e-7,
        1.573537462593089e-8,
        9.38009072314323e-10,
        5.963938433249218e-11,
        3.984733182577065e-12,
        2.769393732303569e-13,
        1.987575739659383e-14,
        1.465100907858312e-15,
        1.104647009412979e-16,
        8.491623760566346e-18,
        6.638236905725702e-19,
        5.266289591025591e-20,
        4.232556854060069e-21,
        3.441339964839213e-22,
        2.827207559977121e-23,
        2.344498445149197e-24,
        1.960759423213343e-25,
        1.652541417571042e-26,
        1.402646534777052e-27,
        1.198289143119558e-28,
        1.029845161756355e-29,
        8.899873139529206e-31,
        7.730785079233031e-32,
        6.747789051217498e-33,
        5.961363289003637e-34,
        5.207522138891716e-35,
    ],
    &[
        -1.184081251009315,
        0.2809171864294252,
        0.001831754429560943,
        0.00003242495194692033,
        8.516901801372758e-7,
        2.771723157762837e-8,
        1.033026316479325e-9,
        4.229486514832192e-11,
        1.855710895223236e-12,
        8.586694905316365e-14,
        4.144513371297493e-15,
        2.070350735137341e-16,
        1.064165797760639e-17,
        5.60326608011576e-19,
        3.011853713243661e-20,
        1.648116593799421e-21,
        9.16077671739336e-23,
        5.162608425928509e-24,
        2.94533667093311e-25,
        1.698913992021994e-26,
        9.8970202441742e-28,
        5.817387383242408e-29,
        3.447396798424417e-30,
        2.058208527140557e-31,
        1.23724413825241e-32,
        7.484356196853095e-34,
        4.553848794093466e-35,
        2.78575562931372e-36,
        1.712730061232126e-37,
        1.061998413931818e-38,
        6.563093110750828e-40,
    ],
    &[
        -0.6061622729971256,
        0.2974128259370967,
        0.002326775757053033,
        0.00005241012277050427,
        1.803008230115057e-6,
        7.813591251437704e-8,
        3.919214655641287e-9,
        2.175297847856206e-10,
        1.300657533912405e-11,
        8.233951007585894e-13,
        5.453867360570109e-14,
        3.747719596736512e-15,
        2.655009445735081e-16,
        1.929840646050078e-17,
        1.433873737886001e-18,
        1.085785831628452e-19,
        8.35945135706529e-21,
        6.53063879051027e-22,
        5.168525421735997e-23,
        4.138218212795157e-24,
        3.34802861602025e-25,
        2.734389793989908e-26,
        2.252440301295939e-27,
        1.870006134924952e-28,
        1.563672527437998e-29,
        1.316170169627656e-30,
        1.114605367818233e-31,
        9.49242688912097e-33,
        8.126984106884795e-34,
        7.043578230955678e-35,
        6.041788131324188e-36,
    ],
    &[
        -0.1506513449237317,
        0.1564354321390055,
        0.0007286024480822763,
        0.00001043039124555722,
        2.357367539899699e-7,
        6.840309013293345e-9,
        2.324934736147819e-10,
        8.814755279680656e-12,
        3.620807463268147e-13,
        1.581315689540474e-14,
        7.248699704252896e-16,
        3.455719068040347e-17,
        1.701777111799742e-18,
        8.612102978454877e-20,
        4.460792013167387e-21,
        2.35735640770948e-22,
        1.267741656750429e-23,
        6.923296414150862e-25,
        3.832768531087099e-26,
        2.147797275691715e-27,
        1.216791331888227e-28,
        6.96178688380053e-30,
        4.018933357769939e-31,
        2.339066999241478e-32,
        1.371564763820408e-33,
        8.097825160103913e-35,
        4.811343669448195e-36,
        2.875437975323357e-37,
        1.72783900431137e-38,
        1.047333311002877e-39,
        6.33154432016503e-41,
    ],
    &[
        0.1684983791412165,
        0.1628419418367772,
        0.000882200742532749,
        0.00001571681187687348,
        4.584130464566021e-7,
        1.753212380171058e-8,
        7.95850383560021e-10,
        4.065368242538065e-11,
        2.263678695788574e-12,
        1.346060771280077e-13,
        8.428939153018287e-15,
        5.503163414291454e-16,
        3.718722506876747e-17,
        2.586421424065439e-18,
        1.843541502203809e-19,
        1.342053935471526e-20,
        9.9507423022869e-22,
        7.497794515971862e-23,
        5.730557605294008e-24,
        4.435782402193134e-25,
        3.472825911204011e-26,
        2.74693763961196e-27,
        2.193055237432684e-28,
        1.765726599531103e-29,
        1.432699609001846e-30,
        1.170760844237607e-31,
        9.62983677556639e-33,
        7.968775839226191e-34,
        6.631556353718681e-35,
        5.586309271630046e-36,
        4.662481149039182e-37,
    ],
    &[
        0.4162654597473871,
        0.08428696064603682,
        0.0002630695452627871,
        2.906789082685801e-6,
        5.480577864596999e-8,
        1.387731333547766e-9,
        4.23197306465342e-11,
        1.466009992413526e-12,
        5.571033818344088e-14,
        2.270948922619879e-15,
        9.78012875770393e-17,
        4.402143621964157e-18,
        2.054612661984067e-19,
        9.88434649683961e-21,
        4.878804405848644e-22,
        2.461758516277793e-23,
        1.266123158816734e-24,
        6.62174406649671e-26,
        3.514657873647682e-27,
        1.890154392540901e-28,
        1.028527719043769e-29,
        5.656263165139572e-31,
        3.140516025417565e-32,
        1.758946156844626e-33,
        9.93014655110835e-35,
        5.647064964514994e-36,
        3.232963496531194e-37,
        1.862369141375017e-38,
        1.079005519763046e-39,
        6.306286339697758e-41,
        3.678703285423155e-42,
    ],
    &[
        0.5870665880082436,
        0.08654850640637927,
        0.0003043567289043127,
        4.079821152452533e-6,
        9.75458467712382e-8,
        3.214195367332457e-9,
        1.295562466821205e-10,
        5.9905174653457e-12,
        3.058343825160366e-13,
        1.682331077058796e-14,
        9.80789133696333e-16,
        5.990036141701701e-17,
        3.800034288493673e-18,
        2.488178346128416e-19,
        1.673328136704534e-20,
        1.151365273777878e-21,
        8.08053370292605e-23,
        5.770006566427308e-24,
        4.183396195555396e-25,
        3.074361796878971e-26,
        2.286805653815127e-27,
        1.719575712056806e-28,
        1.305800836925572e-29,
        1.000470832474431e-30,
        7.727936262785353e-32,
        6.013909358677142e-33,
        4.712193147218456e-34,
        3.715619885391416e-35,
        2.947094652174548e-36,
        2.365203609414868e-37,
        1.883489699695689e-38,
    ],
    &[
        0.7627763709941465,
        0.08921210872301337,
        0.0003655753907907393,
        6.41218845378557e-6,
        2.16298392591383e-7,
        1.051015202655074e-8,
        6.411289186619479e-10,
        4.557572660484972e-11,
        3.613060606040807e-12,
        3.106694945071608e-13,
        2.84412745377952e-14,
        2.73659583138903e-15,
        2.74172446628415e-16,
        2.840301495228429e-17,
        3.026372378898855e-18,
        3.302892818098601e-19,
        3.679996194294398e-20,
        4.174680030272588e-21,
        4.811423840368917e-22,
        5.623572674405111e-23,
        6.655492239866489e-24,
        7.965616264251438e-25,
        9.63060668806685e-26,
        1.175095499785397e-26,
        1.445848454525325e-27,
        1.79263842084989e-28,
        2.23826321242321e-29,
        2.812808545265594e-30,
        3.55695446748388e-31,
        4.594719012191159e-32,
        5.776419844754059e-33,
    ],
    &[
        0.8980470269756599,
        0.04579450866129648,
        0.0001094453756774894,
        1.300764962268431e-6,
        3.309953473217621e-8,
        1.290668114535917e-9,
        6.534376645397569e-11,
        3.928017159152625e-12,
        2.662243773517781e-13,
        1.970328039532959e-14,
        1.559419006227904e-15,
        1.301046516434744e-16,
        1.132627781508449e-17,
        1.021112867195571e-18,
        9.47927091134069e-20,
        9.02134500954777e-21,
        8.770941086765036e-22,
        8.687221264828862e-23,
        8.745436111144275e-24,
        8.931552306202912e-25,
        9.23913571544959e-26,
        9.6675344769584e-27,
        1.022085048211793e-27,
        1.090741705442801e-28,
        1.173962468616712e-29,
        1.273400686015724e-30,
        1.391154000360261e-31,
        1.529816560895357e-32,
        1.692799998237065e-33,
        1.906786524061603e-34,
        2.106130586260472e-35,
    ],
    &[
        0.967165231304344,
        0.02324349721859447,
        0.00003081003507286026,
        2.319261418582901e-7,
        4.159603368316563e-9,
        1.214595684290524e-10,
        4.746322895292828e-12,
        2.236108833343014e-13,
        1.197531574655758e-14,
        7.036241735755525e-16,
        4.433863750395913e-17,
        2.950825653754987e-18,
        2.05174052830897e-19,
        1.478714939979907e-20,
        1.09811168657406e-21,
        8.364072832972699e-23,
        6.510764625079537e-24,
        5.164576286174587e-25,
        4.164912447208519e-26,
        3.408041929635679e-27,
        2.825081256567935e-28,
        2.36915447200225e-29,
        2.00765944519394e-30,
        1.717474619359762e-31,
        1.481911218926433e-32,
        1.28873018321453e-33,
        1.128824730473564e-34,
        9.95328902816554e-36,
        8.830582394647561e-37,
        7.941648499022731e-38,
        7.06562678257035e-39,
    ],
    &[
        1.013908474163866,
        0.0235024815698447,
        0.00003410143205330296,
        3.275184022258375e-7,
        8.640654031307863e-9,
        4.022495666653613e-10,
        2.601506534631203e-11,
        2.064291426685776e-12,
        1.878725729906511e-13,
        1.88539887895433e-14,
        2.035488025066521e-15,
        2.325561369083885e-16,
        2.779759722230834e-17,
        3.447489073902116e-18,
        4.408801553991675e-19,
        5.786201861076367e-20,
        7.764295414495612e-21,
        1.062068686880246e-21,
        1.477393438554293e-22,
        2.085787360888285e-23,
        2.983706944606326e-24,
        4.318675207119029e-25,
        6.31742676364861e-26,
        9.3300905913016e-27,
        1.389979283079111e-27,
        2.087267572894395e-28,
        3.157237425651379e-29,
        4.807816402143035e-30,
        7.370730023528298e-31,
        1.162538106247524e-31,
        1.758573394234795e-32,
    ],
];

pub const SPLITS: [f64; 15] = [
    -9.2338976446268,
    -6.684816721427354,
    -4.135735798227904,
    -2.861195336628179,
    -1.586654875028453,
    -0.949384644228591,
    -0.3121144134287283,
    0.006520701971203025,
    0.3251558173711343,
    0.4844733750711,
    0.6437909327710656,
    0.8031084904710313,
    0.8827672693210141,
    0.922596658746006,
    0.962426048170997,
];
