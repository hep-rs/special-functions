#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            -1.992466003705296,
            -1.,
            -0.00390625,
            -0.0001524157902758726,
            -0.0000152587890625,
            -2.56e-6,
            -5.953741807651273e-7,
            -1.734665255574303e-7,
            -5.960464477539062e-8,
            -2.323057312541877e-8,
            -1e-8,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.0,
            0.0,
            -0.985551091297435,
            0.0,
            -0.07891940245810383,
            0.0,
            -0.002284630648400314,
            0.0,
            -0.0000248015873015873,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.004077356197944,
            1.008349277381923,
            0.004496892301263156,
            0.0002661873256446935,
            0.00005978001618009206,
            0.00003771295008208875,
            0.00007346691048770843,
            -0.0003391635433460853,
            0.0006549281693495776,
            -0.000960897240015144,
            0.001231225889294637,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -0.0001984126984126984,
                0.0006944444444444444,
                -0.00150462962962963,
                0.002604166666666667,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        -2.764961019989005,
        1.222404554093095,
        0.002371250536443486,
        0.00003484516802445641,
        1.077866209948281e-6,
        4.894686457214649e-8,
        2.81218200056835e-9,
        1.895467981550343e-10,
        1.434709417934098e-11,
        1.186276373903739e-12,
        1.051702046048621e-13,
        9.86643417359898e-15,
        9.70021561821159e-16,
        9.92130385590522e-17,
        1.049654213459247e-17,
        1.143536269087133e-18,
        1.27818668660442e-19,
        1.461435685926847e-20,
        1.70500982484372e-21,
        2.025485145726472e-22,
        2.445775860964679e-23,
        2.99730244234158e-24,
        3.7230746700284e-25,
        4.682041715818731e-26,
        5.955221047414826e-27,
        7.654343855061565e-28,
        9.9340795340817e-29,
        1.300943809015187e-29,
        1.718566422256618e-30,
        2.327990310910898e-31,
        3.065758302718572e-32,
    ],
    &[
        -0.922023560765317,
        0.618807971787524,
        0.0006889056880172725,
        6.762551269531844e-6,
        1.543142636116523e-7,
        5.504420540670132e-9,
        2.591066803361921e-10,
        1.474376349203251e-11,
        9.63364776980797e-13,
        6.99535423561854e-14,
        5.521167826684882e-15,
        4.662428548412111e-16,
        4.164011374978131e-17,
        3.898554999062091e-18,
        3.800244982769044e-19,
        3.835956102879208e-20,
        3.99192299548071e-21,
        4.267499484739084e-22,
        4.672498099506984e-23,
        5.226592200116197e-24,
        5.960145280160032e-25,
        6.916271704806629e-26,
        8.154195052514849e-27,
        9.7541708719665e-28,
        1.182444015226078e-28,
        1.451091816944803e-29,
        1.801063825832291e-30,
        2.259049623475476e-31,
        2.862065746673653e-32,
        3.718414487308921e-33,
        4.714348041294567e-34,
    ],
    &[
        -0.1469742610264015,
        0.155591966197837,
        0.00004660167634644972,
        1.36083645860915e-7,
        9.98496697483466e-10,
        1.208801221541342e-11,
        2.005694569350149e-13,
        4.134448353796295e-15,
        9.98801096606773e-17,
        2.723718096875189e-18,
        8.17276684381487e-20,
        2.649679206873794e-21,
        9.15798388363278e-23,
        3.340090226273567e-24,
        1.275332806872303e-25,
        5.065985741901915e-27,
        2.082935946819109e-28,
        8.827867648004698e-30,
        3.843337823571244e-31,
        1.713881582108518e-32,
        7.809287376504109e-34,
        3.628222300758036e-35,
        1.715725392790674e-36,
        8.245105284982146e-38,
        4.02113183559758e-39,
        1.987857487711933e-40,
        9.95059148218104e-42,
        5.038865450227003e-43,
        2.579156487233128e-44,
        1.337028598542169e-45,
        6.957708372564086e-47,
    ],
    &[
        0.164587860990041,
        0.1559716035143829,
        0.00004833948734608101,
        1.543025140433037e-7,
        1.300127379083425e-9,
        1.877275358973266e-11,
        3.821731738096924e-13,
        9.87300753586854e-15,
        3.037781505691234e-16,
        1.06833408737918e-17,
        4.174890959057608e-19,
        1.776664261763319e-20,
        8.11158162906941e-22,
        3.928431809703801e-23,
        2.000397592740943e-24,
        1.063558526554809e-25,
        5.870954992277936e-27,
        3.349342304219501e-28,
        1.967249691702621e-29,
        1.185835121178312e-30,
        7.316176206913047e-32,
        4.609370886891561e-33,
        2.959645457507393e-34,
        1.933465230820709e-35,
        1.283173277026554e-36,
        8.640123825263741e-38,
        5.895777019403352e-39,
        4.072924435936916e-40,
        2.845991228508842e-41,
        2.020042186909905e-42,
        1.433291819136964e-43,
    ],
    &[
        0.476923918231237,
        0.1563661119081513,
        0.00005033025144571333,
        1.787264025827601e-7,
        1.79747675497532e-9,
        3.288848799626769e-11,
        8.898073192329866e-13,
        3.170234314945437e-14,
        1.384375641156642e-15,
        7.065323318532039e-17,
        4.07731369841696e-18,
        2.597973066658333e-19,
        1.79569754722814e-20,
        1.328394515764023e-21,
        1.040827062765403e-22,
        8.566431082208364e-24,
        7.357153693818826e-25,
        6.557862719721584e-26,
        6.03981789618724e-27,
        5.726420984976442e-28,
        5.571664032660391e-29,
        5.548529627114392e-30,
        5.642575117379429e-31,
        5.848361658363821e-32,
        6.167536455944024e-33,
        6.607946527052995e-34,
        7.183460427512162e-35,
        7.914356025821729e-36,
        8.829616039633037e-37,
        1.009169342958539e-37,
        1.135930492041382e-38,
    ],
    &[
        0.7116639046381752,
        0.07833634824025719,
        0.00001300985800668005,
        2.545837966110706e-8,
        1.52748418294467e-10,
        1.801425650197655e-12,
        3.360806570791036e-14,
        8.724993397447357e-16,
        2.899224713685968e-17,
        1.164207376274362e-18,
        5.423291394218221e-20,
        2.844780109940876e-21,
        1.643494169519909e-22,
        1.028322608840175e-23,
        6.878723239887491e-25,
        4.869617522742012e-26,
        3.618955552130096e-27,
        2.805077719555908e-28,
        2.25564531660726e-29,
        1.873503138981072e-30,
        1.601419729587153e-31,
        1.404376646165251e-32,
        1.260236307103142e-33,
        1.154612853994817e-34,
        1.077946046650001e-35,
        1.023776169448547e-36,
        9.87697350587947e-38,
        9.66707742634687e-39,
        9.58895383718451e-40,
        9.72696387099048e-41,
        9.77588665561082e-42,
    ],
    &[
        0.8684416787443042,
        0.07844169372827352,
        0.00001333138206710905,
        2.8245318787065e-8,
        1.996147570124386e-10,
        3.070471920736254e-12,
        8.309831985471839e-14,
        3.452021130785963e-15,
        1.992836987966789e-16,
        1.483204206950694e-17,
        1.345080078335317e-18,
        1.425035367578943e-19,
        1.709265473200797e-20,
        2.26718641295653e-21,
        3.266751919927226e-22,
        5.043636595526581e-23,
        8.255163171368783e-24,
        1.420314993774081e-24,
        2.551343974392104e-25,
        4.75859200297486e-26,
        9.17356525858242e-27,
        1.820981503456982e-27,
        3.710231546325939e-28,
        7.738475824819644e-29,
        1.648427496782776e-29,
        3.579188453168425e-30,
        7.907836488909452e-31,
        1.775418358504708e-31,
        4.055635811792921e-32,
        9.85006220353619e-33,
        2.181750158274408e-33,
    ],
];

pub const SPLITS: [f64; 8] = [
    -4.041331533848258,
    -1.549026497258219,
    -0.302873978963199,
    0.008664150610555977,
    0.3202022801843109,
    0.6317404097580659,
    0.7875094745449433,
    0.943278539331821,
];
