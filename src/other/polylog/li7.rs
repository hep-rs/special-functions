#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.0,
            1.,
            0.0078125,
            0.0004572473708276177,
            0.00006103515625,
            0.0000128,
            3.572245084590764e-6,
            1.214265678902012e-6,
            4.76837158203125e-7,
            2.09075158128769e-7,
            1e-7,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.0,
            -1.97110218259487,
            0.0,
            -0.3156776098324153,
            0.0,
            -0.01370778389040189,
            0.0,
            -0.0001984126984126984,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    if x == 1.0 {
        return 1.008349277381923;
    }

    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.008349277381923,
            1.017343061984449,
            0.00979234657946039,
            0.001037682041654449,
            0.000427684815130812,
            0.0006293662133366944,
            -0.002131756038909045,
            0.00336131229740577,
            -0.004218834990524859,
            0.004763720769847113,
            -0.005076465741826112,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -0.001388888888888889,
                0.004166666666666667,
                -0.007986111111111111,
                0.0125,
                -0.01743634259259259,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 9] = [
    &[
        -4.093466804696127,
        0.700009210823427,
        0.001322191659502056,
        0.0000129864597275875,
        2.318626702171184e-7,
        5.636787441644858e-9,
        1.656662883131308e-10,
        5.540357670615404e-12,
        2.035555953410527e-13,
        8.035225209673284e-15,
        3.356984152399089e-16,
        1.468607213861779e-17,
        6.675114619919799e-19,
        3.133451808186547e-20,
        1.512126308597382e-21,
        7.474081451516216e-23,
        3.772617560771165e-24,
        1.939926447603282e-25,
        1.014159647383693e-26,
        5.381051199898089e-28,
        2.893611758188153e-29,
        1.575027539755454e-30,
        8.668549656982956e-32,
        4.819601133823684e-33,
        2.704757040695202e-34,
        1.53103862114483e-35,
        8.73591793653122e-37,
        5.021685952408166e-38,
        2.906660482754428e-39,
        1.699133200832823e-40,
        9.92414576845402e-42,
    ],
    &[
        -2.682326113905708,
        0.7112834635151817,
        0.001504893988030619,
        0.00001788484176921732,
        4.023440824838051e-7,
        1.261719236907041e-8,
        4.856397215584307e-10,
        2.149653631904384e-11,
        1.053574042394542e-12,
        5.581487556020446e-14,
        3.144497744493351e-15,
        1.862306236461634e-16,
        1.149617363070376e-17,
        7.349410908099794e-19,
        4.841347096103167e-20,
        3.273113764790723e-21,
        2.263791306245838e-22,
        1.59750747332201e-23,
        1.147692375400788e-24,
        8.378788216054735e-26,
        6.206234275253567e-27,
        4.65781330946633e-28,
        3.537840683713179e-29,
        2.716799944589286e-30,
        2.107442368273086e-31,
        1.650036850131657e-32,
        1.303080929482031e-33,
        1.037341919006224e-34,
        8.320034971893538e-36,
        6.763742731708355e-37,
        5.461832779483599e-38,
    ],
    &[
        -1.246947071218053,
        0.7243152345884885,
        0.001769318453481749,
        0.00002728496821956964,
        8.529001197525487e-7,
        3.87531896345161e-8,
        2.222163223112189e-9,
        1.494525942356315e-10,
        1.129376981509087e-11,
        9.32987187652561e-13,
        8.270464667389096e-14,
        7.763381537879999e-15,
        7.641791292615099e-16,
        7.829562803387452e-17,
        8.301693582310997e-18,
        9.06749406235972e-19,
        1.016450224092873e-19,
        1.165841994296157e-20,
        1.364734208057607e-21,
        1.626997063020492e-22,
        1.971836725989658e-23,
        2.425651715049535e-24,
        3.024676551205496e-25,
        3.818720293697742e-26,
        4.87644758044049e-27,
        6.292848678469977e-28,
        8.199831908618021e-29,
        1.078134423022594e-29,
        1.429928301571942e-30,
        1.944954120754103e-31,
        2.571071504626727e-32,
    ],
    &[
        -0.3375492994629463,
        0.1834099744312566,
        0.0001255350766641953,
        6.066483020736655e-7,
        6.395867655851852e-9,
        1.027446649682255e-10,
        2.149974304466013e-12,
        5.396080785614767e-14,
        1.546949051202309e-15,
        4.909158305622968e-17,
        1.688099235435615e-18,
        6.195018244515933e-20,
        2.399187921889822e-21,
        9.72205403309248e-23,
        4.094881883281415e-24,
        1.783308658113869e-25,
        7.995885410895128e-27,
        3.678312099575029e-28,
        1.731080625869968e-29,
        8.314181710845878e-31,
        4.066892897479396e-32,
        2.022478666854088e-33,
        1.020999727629785e-34,
        5.225370217896161e-36,
        2.708068822309038e-37,
        1.419761432280569e-38,
        7.523102123770212e-40,
        4.025878624613079e-41,
        2.174221652276654e-42,
        1.187836110186393e-43,
        6.501791802382837e-45,
    ],
    &[
        0.03029932692794842,
        0.1844452912751386,
        0.0001335074558863789,
        7.288661072216934e-7,
        9.12724733228234e-9,
        1.803520622409934e-10,
        4.757980710128951e-12,
        1.532650429885808e-13,
        5.714514209403726e-15,
        2.382563475497495e-16,
        1.084914686406382e-17,
        5.305442427381963e-19,
        2.751831015381443e-20,
        1.499662025604879e-21,
        8.524067638744338e-23,
        5.024045117326466e-24,
        3.056150978874495e-25,
        1.911364136003383e-26,
        1.225119465925738e-27,
        8.02644425101129e-29,
        5.362895437951148e-30,
        3.647303752023565e-31,
        2.520709623581453e-32,
        1.767786255699725e-33,
        1.256464138521007e-34,
        9.04081957140704e-36,
        6.579349258985281e-37,
        4.838417186131919e-38,
        3.592952315606678e-39,
        2.707571465591816e-40,
        2.034179770628681e-41,
    ],
    &[
        0.4002876301624123,
        0.1855511427836473,
        0.0001432743820159216,
        9.11937803130026e-7,
        1.438072873640568e-8,
        3.794552921651947e-10,
        1.395995682201183e-11,
        6.475091408053963e-13,
        3.560708185160013e-14,
        2.229798329440957e-15,
        1.546631205961496e-16,
        1.164852705557267e-17,
        9.38728074364069e-19,
        8.004862432894881e-20,
        7.160780574788919e-21,
        6.674118082973671e-22,
        6.445741885851259e-23,
        6.421810615200211e-24,
        6.575783303860743e-25,
        6.899351936465631e-26,
        7.398022648736242e-27,
        8.0893572679841e-28,
        9.00294585162971e-29,
        1.018171283919521e-29,
        1.168445866042419e-30,
        1.35897378809343e-31,
        1.600134071411356e-32,
        1.905587299085836e-33,
        2.293788998736224e-34,
        2.829056170442476e-35,
        3.417322414699757e-36,
    ],
    &[
        0.6791624555953669,
        0.0932174232197166,
        0.00003808104834740366,
        1.40778086263837e-7,
        1.420159452741954e-9,
        2.6049410351925e-11,
        7.113147696692035e-13,
        2.573117208666483e-14,
        1.144840475045882e-15,
        5.96070253087709e-17,
        3.508095010778605e-18,
        2.276548518994032e-19,
        1.599460237853461e-20,
        1.200001803158367e-21,
        9.51278567132728e-23,
        7.902337835244289e-24,
        6.833862035397905e-25,
        6.119731021749893e-26,
        5.650253371848944e-27,
        5.35936234212688e-28,
        5.206720023581364e-29,
        5.167984827069003e-30,
        5.229353099637193e-31,
        5.384451215109688e-32,
        5.632587743069821e-33,
        5.977840288495403e-34,
        6.428694476095987e-35,
        6.998098784367144e-36,
        7.705012351566555e-37,
        8.678045928488882e-38,
        9.62353000388705e-39,
    ],
    &[
        0.8191330329776442,
        0.04672476784564596,
        9.85689893709019e-6,
        2.00619348511e-8,
        1.208751686636568e-10,
        1.438000627662838e-12,
        2.735988077414254e-14,
        7.294930415579092e-16,
        2.49366612872739e-17,
        1.027673941072907e-18,
        4.890096792068403e-20,
        2.60516672288899e-21,
        1.519387331836449e-22,
        9.54083108347852e-24,
        6.369638630252701e-25,
        4.477459093777632e-26,
        3.288685533255665e-27,
        2.508673582733477e-28,
        1.977695793683392e-29,
        1.604785872157237e-30,
        1.335874053663653e-31,
        1.137598942324161e-32,
        9.88690615647444e-34,
        8.751912012430021e-35,
        7.877053236722102e-36,
        7.197659089799686e-37,
        6.668341126210425e-38,
        6.25671520084951e-39,
        5.939866781634094e-40,
        5.753110615786446e-41,
        5.52334831956074e-42,
    ],
    &[
        0.912662211035024,
        0.0468046213487966,
        0.00001011033505249218,
        2.227090229281006e-8,
        1.585460560698205e-10,
        2.48749132934489e-12,
        6.977122854188806e-14,
        3.013681917739197e-15,
        1.790664697520986e-16,
        1.347360495761935e-17,
        1.210526369865357e-18,
        1.246012665343269e-19,
        1.426860967080821e-20,
        1.779676475681534e-21,
        2.380123453271483e-22,
        3.373062399673146e-23,
        5.019522033155516e-24,
        7.787735712153684e-25,
        1.252551667695408e-25,
        2.078792847434879e-26,
        3.54660695092058e-27,
        6.200625246211874e-28,
        1.107981550567039e-28,
        2.018986852959522e-29,
        3.744631393523698e-30,
        7.057409776259261e-31,
        1.349659660770987e-31,
        2.615960945762806e-32,
        5.140710789883868e-33,
        1.059760848016389e-33,
        2.042104579807948e-34,
    ],
];

pub const SPLITS: [f64; 10] = [
    -4.947453297099445,
    -3.472605294948821,
    -1.997757292798197,
    -0.5229092906475732,
    -0.1541972901099172,
    0.2145147104277387,
    0.5832267109653947,
    0.7675827112342227,
    0.8597607113686367,
    0.951938711503051,
];
