#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.0,
            1.,
            0.03125,
            0.00411522633744856,
            0.0009765625,
            0.00032,
            0.0001286008230452675,
            0.00005949901826619861,
            0.000030517578125,
            0.00001693508780843029,
            1e-5,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.0,
            -1.894065658994492,
            0.0,
            -0.2741556778080377,
            0.0,
            -0.008333333333333333,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    if x == 1.0 {
        return 1.03692775514337;
    }

    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.03692775514337,
            1.082323233711138,
            0.05986683472422805,
            0.03390163746528666,
            -0.04406602230280489,
            0.03843559547868495,
            -0.03107689113952597,
            0.02469588802778074,
            -0.01960636540836974,
            0.0156276477617174,
            -0.01251904811295835,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                0.0,
                0.0,
                -0.04166666666666667,
                0.08333333333333333,
                -0.1180555555555556,
                0.1458333333333333,
                -0.1678819444444444,
                0.1854166666666667,
                -0.1994268077601411,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 13] = [
    &[
        -5.610941591815487,
        0.8339209078509447,
        0.005386640431355926,
        0.000099503795966124,
        2.719162769598326e-6,
        9.14311487511066e-8,
        3.499736803490599e-9,
        1.464616532655632e-10,
        6.543963220911789e-12,
        3.074515005942466e-13,
        1.503247560991202e-14,
        7.592633435659677e-16,
        3.939926743105378e-17,
        2.091748594712351e-18,
        1.132519938287172e-19,
        6.236980953085574e-21,
        3.486470098480585e-22,
        1.974846141081036e-23,
        1.131864567999197e-24,
        6.556107066981256e-26,
        3.833918841358737e-27,
        2.261535200912759e-28,
        1.344612997302717e-29,
        8.052623321462828e-31,
        4.85480415269994e-32,
        2.944952121595636e-33,
        1.796636129481467e-34,
        1.101899743208768e-35,
        6.791624614725719e-37,
        4.221603551695629e-38,
        2.615149716232573e-39,
    ],
    &[
        -3.895587525741414,
        0.8827077330251747,
        0.006922090610026282,
        0.0001642136535508501,
        5.908644465008158e-6,
        2.652724368249904e-7,
        1.367957599368476e-8,
        7.76115365893684e-10,
        4.723132329250091e-11,
        3.033303816511937e-12,
        2.03313608652267e-13,
        1.411053551510836e-14,
        1.008097660301218e-15,
        7.380827733185549e-17,
        5.518713418567145e-18,
        4.2023878933094e-19,
        3.251652325546968e-20,
        2.551876441157279e-21,
        2.028126311281075e-22,
        1.630226714636872e-23,
        1.323855777529946e-24,
        1.085083093322531e-25,
        8.969339801412725e-27,
        7.471786126898327e-28,
        6.268798684876932e-29,
        5.294215908449303e-30,
        4.498471953212542e-31,
        3.844026029990492e-32,
        3.302336245296481e-33,
        2.87218979788909e-34,
        2.472261597857156e-35,
    ],
    &[
        -2.543467865708119,
        0.4644826401429444,
        0.002195853626711959,
        0.00003341839994582054,
        7.936911523986916e-7,
        2.390062650857306e-8,
        8.352357573099399e-10,
        3.23440096855312e-11,
        1.35059234264631e-12,
        5.975867303164575e-14,
        2.768477436833358e-15,
        1.331506880915391e-16,
        6.606453609382621e-18,
        3.365331539745463e-19,
        1.753444393217846e-20,
        9.31671826768323e-22,
        5.036044090733228e-23,
        2.763806716922209e-24,
        1.537439978363122e-25,
        8.656764667485829e-27,
        4.927938964537456e-28,
        2.833256573408839e-29,
        1.643750233999942e-30,
        9.61574494334194e-32,
        5.668082991651513e-33,
        3.364644089082847e-34,
        2.010316597278894e-35,
        1.208397543575994e-36,
        7.304664360911442e-38,
        4.455319174942791e-39,
        2.710475825649569e-40,
    ],
    &[
        -1.595483849223471,
        0.483914847178143,
        0.002693500778852136,
        0.0000514626872748778,
        1.583337403454286e-6,
        6.289382447435042e-8,
        2.933416799483221e-9,
        1.528550462127188e-10,
        8.640734692594479e-12,
        5.199649707245435e-13,
        3.288092226183614e-14,
        2.164985648632294e-15,
        1.474148402112909e-16,
        1.032623397801871e-17,
        7.411275037877771e-19,
        5.432370503561517e-20,
        4.05596160368901e-21,
        3.078021927025153e-22,
        2.369983678449719e-23,
        1.848674592565639e-24,
        1.459019539347904e-25,
        1.163779537988759e-26,
        9.37297804367306e-28,
        7.615940619419836e-29,
        6.238711361894614e-30,
        5.148910529430104e-31,
        4.278979893559059e-32,
        3.578920362382874e-33,
        3.011469854754563e-34,
        2.5663872612581e-35,
        2.166994061787772e-36,
    ],
    &[
        -0.8588656409064632,
        0.2507612984692272,
        0.0008140900920493846,
        9.72907920855014e-6,
        1.94059052118933e-7,
        5.102979758144451e-9,
        1.596993334463115e-10,
        5.636149070724159e-12,
        2.172639335959369e-13,
        8.961665167587187e-15,
        3.900200441744765e-16,
        1.773066033964586e-17,
        8.357513574543993e-19,
        4.061499332033882e-20,
        2.025985940294011e-21,
        1.033719471865967e-22,
        5.379622687636131e-24,
        2.84886172596537e-25,
        1.532215201738908e-26,
        8.35583034445564e-28,
        4.614030429525397e-29,
        2.576784632091681e-30,
        1.453914487768222e-31,
        8.280889286070439e-33,
        4.757239891946839e-34,
        2.754711893645082e-35,
        1.606858798998163e-36,
        9.43683043130942e-38,
        5.577229076998157e-39,
        3.327422159830778e-40,
        1.981855137279848e-41,
    ],
    &[
        -0.3504171867412649,
        0.2578032500127586,
        0.000953703129897996,
        0.00001393183644953823,
        3.531238155699306e-7,
        1.207849039848807e-8,
        4.99226854327858e-10,
        2.351604118878451e-11,
        1.219214594244375e-12,
        6.802851059439478e-14,
        4.022827034521206e-15,
        2.493678558238629e-16,
        1.607298809239809e-17,
        1.070582119218616e-18,
        7.333698770194113e-20,
        5.146921031853588e-21,
        3.689381643349579e-22,
        2.694283206164218e-23,
        2.000345838828376e-24,
        1.507211506426814e-25,
        1.150806429592697e-26,
        8.892727883963788e-28,
        6.946957808708509e-29,
        5.481086086279147e-30,
        4.364039513836167e-31,
        3.50382589695574e-32,
        2.834960022235055e-33,
        2.310214918048791e-34,
        1.895206500026043e-35,
        1.575058165695677e-36,
        1.298551500160445e-37,
    ],
    &[
        0.0400352887652529,
        0.1319539809166834,
        0.0002751591564325831,
        2.44146650569156e-6,
        3.927841272223321e-8,
        8.760181388146966e-10,
        2.402486419121369e-11,
        7.599399233878312e-13,
        2.668386545465936e-14,
        1.014717628832892e-15,
        4.109087280843955e-17,
        1.750758075255396e-18,
        7.779141328815287e-20,
        3.580424115742605e-21,
        1.69808594242895e-22,
        8.264268267601216e-24,
        4.11354075341452e-25,
        2.08836246768037e-26,
        1.078924034662978e-27,
        5.661701478374543e-29,
        3.012849581802876e-30,
        1.623632800603982e-31,
        8.850478111247629e-33,
        4.874961762210003e-34,
        2.710909173831871e-35,
        1.520754523880334e-36,
        8.600124733996522e-38,
        4.899896307366336e-39,
        2.811088133181401e-40,
        1.62859253809411e-41,
        9.42785975423185e-43,
    ],
    &[
        0.3062458742259837,
        0.1342847082971646,
        0.000308932325488718,
        3.250967419773678e-6,
        6.498856207909512e-8,
        1.855066534061252e-9,
        6.638715679769525e-11,
        2.776548864437611e-12,
        1.301117390849016e-13,
        6.648045502299839e-15,
        3.635576395367426e-16,
        2.099983522781261e-17,
        1.268813482183558e-18,
        7.960166392129932e-20,
        5.155998891731e-21,
        3.432525555316177e-22,
        2.340203462153442e-23,
        1.6291132189635e-24,
        1.155177970083271e-25,
        8.326511065018848e-27,
        6.090437497720797e-28,
        4.514095844844444e-29,
        3.385988611332257e-30,
        2.567568205167483e-31,
        1.966394555729847e-32,
        1.519752505968584e-33,
        1.184439314944144e-34,
        9.30274526828583e-36,
        7.35930882789821e-37,
        5.898072700372223e-38,
        4.695684664830094e-39,
    ],
    &[
        0.5774250857974725,
        0.136933452342726,
        0.000355789415239607,
        4.713447430418376e-6,
        1.282973767177082e-7,
        5.253547291339925e-9,
        2.791528555978056e-10,
        1.774088181956298e-11,
        1.28360633509235e-12,
        1.024181565982055e-13,
        8.818876681568837e-15,
        8.070406766216247e-16,
        7.761864225987256e-17,
        7.779921648051266e-18,
        8.074497531235585e-19,
        8.63343764458923e-20,
        9.47154673652808e-21,
        1.062676540097486e-21,
        1.216054710746849e-22,
        1.416131526529038e-23,
        1.675078075528145e-24,
        2.009345013577722e-25,
        2.441009835054483e-26,
        2.999644199247548e-27,
        3.724881416162786e-28,
        4.669938792259917e-29,
        5.906451807990128e-30,
        7.531151596417775e-31,
        9.67764097966489e-32,
        1.272875535157527e-32,
        1.629459962648175e-33,
    ],
    &[
        0.7842179256775973,
        0.06959950548963347,
        0.000101601927803031,
        8.636181409559261e-7,
        1.686859821955702e-8,
        5.362511838865408e-10,
        2.328593786364886e-11,
        1.249839912359153e-12,
        7.802477592407261e-14,
        5.448860138466802e-15,
        4.147074904327966e-16,
        3.377946725624706e-17,
        2.906427191032548e-18,
        2.61609435310207e-19,
        2.44532901975794e-20,
        2.360093157200735e-21,
        2.341348079944154e-22,
        2.378865614678029e-23,
        2.468051957806525e-24,
        2.608295166044701e-25,
        2.802141565171188e-26,
        3.054963766980551e-27,
        3.374954635374598e-28,
        3.773369953895642e-29,
        4.264992273620361e-30,
        4.868820047767948e-31,
        5.609010065245868e-32,
        6.516139273112222e-33,
        7.630264644886404e-34,
        9.12307321090224e-35,
        1.067801304849508e-35,
    ],
    &[
        0.8890085937728386,
        0.03511613906387249,
        0.00002759862874845097,
        1.410064492834367e-7,
        1.853182180456251e-9,
        4.31979374698696e-11,
        1.453853647976368e-12,
        6.254135451373785e-14,
        3.193069210829929e-15,
        1.846647199707784e-16,
        1.173337899688539e-17,
        8.021923957056754e-19,
        5.815051007939898e-20,
        4.421591899149949e-21,
        3.498245165788078e-22,
        2.862044243633294e-23,
        2.40960621178428e-24,
        2.079575543594498e-25,
        1.833989122319912e-26,
        1.648505832744425e-27,
        1.507034936939784e-28,
        1.398658496494735e-29,
        1.315803292404811e-30,
        1.253119866063018e-31,
        1.206775585208705e-32,
        1.173997627636002e-33,
        1.152771048548192e-34,
        1.14163669131703e-35,
        1.139667133542256e-36,
        1.157592620967628e-37,
        1.159856423017224e-38,
    ],
    &[
        0.941787956524257,
        0.01764270493796718,
        7.24359883695457e-6,
        2.098564105114866e-8,
        1.73008716282788e-10,
        2.749813803200522e-12,
        6.653134526069828e-14,
        2.119762361610026e-15,
        8.149263376576708e-17,
        3.582551325192006e-18,
        1.740208113113345e-19,
        9.12830005473329e-21,
        5.089023557757331e-22,
        2.98087784540736e-23,
        1.818909370491045e-24,
        1.148704057908308e-25,
        7.470202020222679e-27,
        4.982347585876601e-28,
        3.39704185335883e-29,
        2.361438730554836e-30,
        1.669947433824193e-31,
        1.199156268029271e-32,
        8.730025647321937e-34,
        6.434891870674096e-35,
        4.796816655285057e-36,
        3.612582620325184e-37,
        2.746358080448644e-38,
        2.105908329404018e-39,
        1.627751432644855e-40,
        1.275179836561465e-41,
        9.93515567000736e-43,
    ],
    &[
        0.977132149051417,
        0.01770171297027729,
        7.514203892740792e-6,
        2.430822388938014e-8,
        2.510839578167073e-10,
        5.553732550563809e-12,
        1.998108878540621e-13,
        9.80528938398678e-15,
        5.912738932565356e-16,
        4.117863215908564e-17,
        3.187187677951525e-18,
        2.673593926306077e-19,
        2.389346135026321e-20,
        2.247240139200251e-21,
        2.204437614363363e-22,
        2.240084893568765e-23,
        2.345607643535817e-24,
        2.520324075945081e-25,
        2.769544024304759e-26,
        3.103985483466679e-27,
        3.540017001161041e-28,
        4.100540503935325e-29,
        4.816488784778451e-30,
        5.729014405339883e-31,
        6.892532156356233e-32,
        8.378866730639802e-33,
        1.028286617168383e-33,
        1.273003027316406e-34,
        1.589061369773096e-35,
        2.02954851679301e-36,
        2.528490327170241e-37,
    ],
];

pub const SPLITS: [f64; 14] = [
    -7.462481322845981,
    -5.356602880078716,
    -3.250724437311452,
    -2.19778521592782,
    -1.144845994544188,
    -0.6183763838523722,
    -0.0919067731605562,
    0.1713280321853518,
    0.4345628375312599,
    0.6977976428771679,
    0.8294150455501219,
    0.8952237468865989,
    0.928128097554837,
    0.961032448223076,
];
