#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.0,
            1.,
            0.125,
            0.03703703703703704,
            0.015625,
            0.008,
            0.00462962962962963,
            0.002915451895043732,
            0.001953125,
            0.001371742112482853,
            0.001,
        ],
    ) + polynomial(
        (-x).ln(),
        &[0.0, -1.644934066848226, 0.0, -0.1666666666666667],
    )
}

pub fn upper(x: f64) -> f64 {
    if x == 1.0 {
        return 1.202056903159594;
    }

    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.202056903159594,
            1.644934066848226,
            -0.07246703342411322,
            -0.03502197771725785,
            0.0436275943990545,
            -0.03906874218591027,
            0.03320543330307337,
            -0.02806497457723749,
            0.02387126602038893,
            -0.02049690136556617,
            0.01777304897151397,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                -0.5,
                0.5,
                -0.4583333333333333,
                0.4166666666666667,
                -0.3805555555555556,
                0.35,
                -0.3241071428571429,
                0.301984126984127,
                -0.2828968253968254,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 17] = [
    &[
        -5.901331952016631,
        0.6577808517072051,
        0.01107480969809409,
        0.0003402880982806256,
        0.00001325066875787986,
        5.869616334822452e-7,
        2.821520631810671e-8,
        1.435518706780214e-9,
        7.615824616189657e-11,
        4.172786225592199e-12,
        2.345693024217668e-13,
        1.346477562492407e-14,
        7.864779161184413e-16,
        4.661979544348748e-17,
        2.79860532875443e-18,
        1.698540555657553e-19,
        1.040844709595843e-20,
        6.432633880796495e-22,
        4.005737629445555e-23,
        2.511472181264411e-24,
        1.584304209254092e-25,
        1.005000306382984e-26,
        6.40763506365608e-28,
        4.104379034705034e-29,
        2.640294850543037e-30,
        1.705175766204145e-31,
        1.105275276659708e-32,
        7.188580323825825e-34,
        4.690226998914504e-35,
        3.082323481577855e-36,
        2.013845784611693e-37,
    ],
    &[
        -4.480899408876492,
        0.767545604705538,
        0.01699199101238438,
        0.0007043941498507371,
        0.00003741573255509959,
        2.275011800031276e-6,
        1.507226087425453e-7,
        1.059919451094751e-8,
        7.789014957367238e-10,
        5.921324013261778e-11,
        4.624578912815968e-12,
        3.692198154756616e-13,
        3.002307977479414e-14,
        2.479472602347476e-15,
        2.075107300927126e-16,
        1.75685612790919e-17,
        1.50254609184583e-18,
        1.296602054535154e-19,
        1.127844522315922e-20,
        9.88094783321846e-22,
        8.7126730139559e-23,
        7.727649079079408e-24,
        6.89067107752529e-25,
        6.17444435622558e-26,
        5.557568217944083e-27,
        5.023090140915453e-28,
        4.557454224447136e-29,
        4.149728669023763e-30,
        3.791287296553872e-31,
        3.503462290065959e-32,
        3.192791186980199e-33,
    ],
    &[
        -3.256226189927574,
        0.4457159178960151,
        0.006500962700449089,
        0.0001828239506009917,
        6.671294629258778e-6,
        2.806398801539841e-7,
        1.292228491118789e-8,
        6.336120951857428e-10,
        3.254304788568558e-11,
        1.732285602989282e-12,
        9.4871222328414e-14,
        5.317745757430494e-15,
        3.038844825877474e-16,
        1.765168121944308e-17,
        1.039801540554215e-18,
        6.200067923079577e-20,
        3.7365531139957e-21,
        2.273199576583133e-22,
        1.394595891475782e-23,
        8.620390705510079e-25,
        5.364793289091847e-26,
        3.359323235593848e-27,
        2.115367732211762e-28,
        1.338901109397802e-29,
        8.514488177655166e-31,
        5.438215321098615e-32,
        3.48739108865142e-33,
        2.24473694548855e-34,
        1.449926263612443e-35,
        9.43525701741138e-37,
        6.106788778498303e-38,
    ],
    &[
        -2.304182768419773,
        0.5088920798113348,
        0.00959906339869302,
        0.0003606003978367626,
        0.00001782915433480266,
        1.024461756291644e-6,
        6.47689599265428e-8,
        4.376308722483814e-9,
        3.105714456873237e-10,
        2.288930401752092e-11,
        1.738445670533946e-12,
        1.353121001163788e-13,
        1.074901385081697e-14,
        8.687387485161073e-16,
        7.125720387659115e-17,
        5.920175911154798e-18,
        4.974110335128085e-19,
        4.220877312853217e-20,
        3.613459874633618e-21,
        3.118017111321837e-22,
        2.709753693781108e-23,
        2.370209919700626e-24,
        2.08544406862268e-25,
        1.844788846537058e-26,
        1.639985227969629e-27,
        1.464569274787355e-28,
        1.31343156663e-29,
        1.182496958925606e-30,
        1.068558146621404e-31,
        9.76775606543276e-33,
        8.810858661548657e-34,
    ],
    &[
        -1.499987840803033,
        0.2887613100158765,
        0.003522985447220989,
        0.00008881833196960778,
        2.995517853565998e-6,
        1.18483697999667e-7,
        5.186441837619879e-9,
        2.4360488222706e-10,
        1.205253808842373e-11,
        6.206482364382063e-13,
        3.299264261254352e-14,
        1.799836108260742e-15,
        1.003210716639214e-16,
        5.694337502616776e-18,
        3.282855762540476e-19,
        1.918289572738403e-20,
        1.134222175892242e-21,
        6.776446951875812e-23,
        4.086253205193868e-24,
        2.484544044373981e-25,
        1.521978808896372e-26,
        9.38651758264264e-28,
        5.824648480516452e-29,
        3.63474654087426e-30,
        2.279902755377502e-31,
        1.43687505533837e-32,
        9.09547291797188e-34,
        5.780902837915809e-35,
        3.688186442913299e-36,
        2.371027348492457e-37,
        1.516726331812261e-38,
    ],
    &[
        -0.8901750281718312,
        0.3222633041636607,
        0.004985549013429627,
        0.0001659704317683533,
        7.528008378915079e-6,
        4.045737629087123e-7,
        2.421859183504025e-8,
        1.562502254570323e-9,
        1.065235579545351e-10,
        7.576620115527995e-12,
        5.573200081860637e-13,
        4.213141646287852e-14,
        3.258044953246404e-15,
        2.568117001004701e-16,
        2.057666139457258e-17,
        1.672163894815983e-18,
        1.375786201102451e-19,
        1.144338593048353e-20,
        9.61082016771232e-22,
        8.141866842190725e-23,
        6.951329310342937e-24,
        5.976805199267696e-25,
        5.171888094780785e-26,
        4.501589568731086e-27,
        3.939198136151496e-28,
        3.464087195718014e-29,
        3.060161373150605e-30,
        2.714740954066751e-31,
        2.417898773851554e-32,
        2.178527093690003e-33,
        1.938253638830966e-34,
    ],
    &[
        -0.3858830417862282,
        0.17858033127065,
        0.001748565228162013,
        0.00003858069405306856,
        1.184286891809686e-6,
        4.357062577387656e-8,
        1.798204200973e-9,
        8.036268708338693e-11,
        3.80773188571443e-12,
        1.886869924821626e-13,
        9.68766213942536e-15,
        5.119079010595033e-16,
        2.770188440276076e-17,
        1.529444035342151e-18,
        8.589907433056314e-20,
        4.896210082189361e-21,
        2.827021800215682e-22,
        1.650914317237205e-23,
        9.73843310921129e-25,
        5.796360219673291e-26,
        3.477981678398946e-27,
        2.102162464727687e-28,
        1.279029699012538e-29,
        7.829197274357222e-31,
        4.818979219457973e-32,
        2.981260286946267e-33,
        1.853020598641446e-34,
        1.156761684115222e-35,
        7.250399541870238e-37,
        4.579575730147691e-38,
        2.879690273022353e-39,
    ],
    &[
        -0.1109724084948494,
        0.0950770771094744,
        0.000542228705655091,
        7.210448952717705e-6,
        1.354952816484695e-7,
        3.07762330695395e-9,
        7.882138829706065e-11,
        2.19331046071245e-12,
        6.485742538738388e-14,
        2.009135322238413e-15,
        6.456565655494212e-17,
        2.137492619653938e-18,
        7.252326413049838e-20,
        2.511981185133675e-21,
        8.855164241047155e-23,
        3.169325122635536e-24,
        1.14942020821046e-25,
        4.217339956338443e-27,
        1.563402547624056e-28,
        5.849156574642955e-30,
        2.206468622724995e-31,
        8.385632139554232e-33,
        3.208539592341516e-34,
        1.235243185485837e-35,
        4.782379732678442e-37,
        1.861156810836117e-38,
        7.27768701011117e-40,
        2.85837581601622e-41,
        1.127256993884885e-42,
        4.469549466411088e-44,
        1.772848930607666e-45,
    ],
    &[
        0.08382316740066848,
        0.0998033332203787,
        0.0006441953288752319,
        9.9997524337743e-6,
        2.225187934011713e-7,
        6.03151665311612e-9,
        1.8519511256876e-10,
        6.196598298040206e-12,
        2.207815863546742e-13,
        8.252594993664726e-15,
        3.203497168066936e-16,
        1.282094748005607e-17,
        5.262090085712994e-19,
        2.205863786682401e-20,
        9.41486698794921e-22,
        4.081142018593214e-23,
        1.793117230638783e-24,
        7.972266908302258e-26,
        3.581876462969723e-27,
        1.624428390470303e-28,
        7.429056053234427e-30,
        3.423364064662035e-31,
        1.588371753249657e-32,
        7.415921029234355e-34,
        3.482252002361196e-35,
        1.643744066750912e-36,
        7.796646134442512e-38,
        3.714686367372655e-39,
        1.777206873455671e-40,
        8.555252418868616e-42,
        4.114021363210415e-43,
    ],
    &[
        0.2890133648117638,
        0.1055085128356872,
        0.0007905229533787191,
        0.00001484461845984734,
        4.073835865660311e-7,
        1.375849187744373e-8,
        5.29534424533072e-10,
        2.229419637395688e-11,
        1.002035960516557e-12,
        4.733365406613568e-14,
        2.325026555843652e-15,
        1.178612456912156e-16,
        6.131708949432808e-18,
        3.260086681598095e-19,
        1.765612120078705e-20,
        9.71534953595868e-22,
        5.420215772223724e-23,
        3.060790677311034e-24,
        1.747032821621105e-25,
        1.006723219130606e-26,
        5.85101200279152e-28,
        3.426869679083036e-29,
        2.021134870856583e-30,
        1.199642553117825e-31,
        7.16193083140768e-33,
        4.298552236800444e-34,
        2.592656162861533e-35,
        1.57085468667525e-36,
        9.55778251697063e-38,
        5.859970030827017e-39,
        3.578899527289256e-40,
    ],
    &[
        0.5070143552025397,
        0.1126828613408397,
        0.001019883545982554,
        0.00002456145226937655,
        8.89183951074019e-7,
        4.02014158530787e-8,
        2.088771011784855e-9,
        1.193325461606488e-10,
        7.302792338205437e-12,
        4.707843266135208e-13,
        3.161153232556487e-14,
        2.193232081937887e-15,
        1.563120810717144e-16,
        1.13932758147156e-17,
        8.463866756065303e-19,
        6.391212028788213e-20,
        4.895007399464596e-21,
        3.795902223616497e-22,
        2.976033165313436e-23,
        2.356109361282373e-24,
        1.881674160610766e-25,
        1.51463229693452e-26,
        1.227891445148651e-27,
        1.001896362800719e-28,
        8.223413638249991e-30,
        6.786326413476891e-31,
        5.628373165546353e-32,
        4.689543301858076e-33,
        3.924204344099049e-34,
        3.319980781507288e-35,
        2.779510825158529e-36,
    ],
    &[
        0.6801776240850968,
        0.05975481824363104,
        0.0003246869333303865,
        5.01628727978883e-6,
        1.201838176202871e-7,
        3.652248022697802e-9,
        1.286288820257791e-10,
        5.006009366299714e-12,
        2.093448671757909e-13,
        9.2413478117748e-15,
        4.255223764122733e-16,
        2.026624850423819e-17,
        9.92260178817396e-19,
        4.971398109954378e-20,
        2.539755967925276e-21,
        1.319334922394911e-22,
        6.953426916607749e-24,
        3.711387618399296e-25,
        2.003176156836019e-26,
        1.091961564067168e-27,
        6.005460441123902e-29,
        3.329275224820491e-30,
        1.859030408040918e-31,
        1.04489079972581e-32,
        5.908190693486027e-34,
        3.359077206595185e-35,
        1.919447262968401e-36,
        1.101930135943298e-37,
        6.353431038125575e-39,
        3.690275501573926e-40,
        2.136947128179402e-41,
    ],
    &[
        0.8025029840773337,
        0.0626327371138886,
        0.0003995486685356899,
        7.758176737769378e-6,
        2.413037271099098e-7,
        9.67026333756208e-9,
        4.528493765583712e-10,
        2.354410737965551e-11,
        1.319093799862036e-12,
        7.815948660496536e-14,
        4.83675584858715e-15,
        3.098720042502959e-16,
        2.042203493584505e-17,
        1.37794836529498e-18,
        9.4840604869786e-20,
        6.639520147313581e-21,
        4.716990584660442e-22,
        3.394473051472677e-23,
        2.470560432291326e-24,
        1.816279056719422e-25,
        1.34731680396703e-26,
        1.007542063307168e-27,
        7.589722863211038e-29,
        5.755290032040253e-30,
        4.390708295468071e-31,
        3.368273461856987e-32,
        2.597116825734402e-33,
        2.01194292357652e-34,
        1.565466608640305e-35,
        1.230445357967871e-36,
        9.58924686804134e-38,
    ],
    &[
        0.931319084238003,
        0.06628732946330669,
        0.000525041482407171,
        0.00001412198991467535,
        6.411153123906166e-7,
        3.841814831422632e-8,
        2.722603992154965e-9,
        2.156135140767892e-10,
        1.847152779616455e-11,
        1.677634086663453e-12,
        1.593904067086676e-13,
        1.569546259826731e-14,
        1.591219626093817e-15,
        1.652603285845308e-16,
        1.751610097104506e-17,
        1.889060465695871e-18,
        2.068075831406985e-19,
        2.293866837894287e-20,
        2.57376825327912e-21,
        2.917454969678131e-22,
        3.337315510817435e-23,
        3.848983921812759e-24,
        4.472047716856446e-25,
        5.230963582002828e-26,
        6.15622643285245e-27,
        7.285852943470142e-28,
        8.667259535555828e-29,
        1.035966739002255e-29,
        1.243962790635601e-30,
        1.52119948487676e-31,
        1.813989794787606e-32,
    ],
    &[
        1.032907247044648,
        0.03493224618928107,
        0.0001745608845375197,
        3.417307797646239e-6,
        1.20707306608693e-7,
        5.785769749712741e-9,
        3.320159363323785e-10,
        2.142035612405249e-11,
        1.499905628408334e-12,
        1.115629786205827e-13,
        8.691347465127162e-15,
        7.023651047569096e-16,
        5.847035963098059e-17,
        4.988549868574577e-18,
        4.344901156298349e-19,
        3.851497210472167e-20,
        3.466355200178491e-21,
        3.161277107620394e-22,
        2.916781959563142e-23,
        2.719078560740265e-24,
        2.558194074990216e-25,
        2.426781832812904e-26,
        2.319341392795748e-27,
        2.231696096229887e-28,
        2.160635623996869e-29,
        2.103666750572572e-30,
        2.058836557933625e-31,
        2.024606949355566e-32,
        1.999949595788113e-33,
        2.003035311036501e-34,
        1.974503753938691e-35,
    ],
    &[
        1.086003906708137,
        0.01803895688344189,
        0.00005333209208772326,
        7.006494136969155e-7,
        1.759507126484803e-8,
        6.126372871835577e-10,
        2.575714640167453e-11,
        1.222205724552415e-12,
        6.307005051108847e-14,
        3.461066629989397e-15,
        1.990706469093641e-16,
        1.188251822185777e-17,
        7.308702062564616e-19,
        4.608214468371091e-20,
        2.966619717432312e-21,
        1.943962151647645e-22,
        1.293445533313546e-23,
        8.72140571053127e-25,
        5.949799422808816e-26,
        4.101241489606102e-27,
        2.853247253475755e-28,
        2.001535158054842e-29,
        1.414606681735647e-30,
        1.006595012023209e-31,
        7.207068250422971e-33,
        5.189421130282345e-34,
        3.756083250937993e-35,
        2.731685843447395e-36,
        1.995544274304096e-37,
        1.471653278741201e-38,
        1.077722946181153e-39,
    ],
    &[
        1.122539281002987,
        0.018505262143652,
        0.00006398872215792152,
        1.13185617338076e-6,
        4.080662201624731e-8,
        2.085354899528936e-9,
        1.297425269880478e-10,
        9.14347516130116e-12,
        7.020678807839476e-13,
        5.738763209610811e-14,
        4.919919536630338e-15,
        4.379203852311809e-16,
        4.017893508687554e-17,
        3.779732962356944e-18,
        3.631071757681729e-19,
        3.551096946796876e-20,
        3.52670995696938e-21,
        3.549695861387219e-22,
        3.615093321918753e-23,
        3.720226693303858e-24,
        3.864120696397192e-25,
        4.047146099040193e-26,
        4.270811268031898e-27,
        4.537650428399342e-28,
        4.851179732733376e-29,
        5.215904107175513e-30,
        5.637365175326792e-31,
        6.122235138140282e-32,
        6.679363267725468e-33,
        7.403877408195534e-34,
        8.043308436859705e-35,
    ],
];

pub const SPLITS: [f64; 18] = [
    -11.5423320080549,
    -8.416377611106118,
    -5.290423214157335,
    -3.727446015682944,
    -2.164468817208552,
    -1.382980217971356,
    -0.6014916187341605,
    -0.2107473191155626,
    -0.01537516930626364,
    0.1799969805030353,
    0.3753691303123342,
    0.5707412801216332,
    0.6684273550262826,
    0.7661134299309321,
    0.8637995048355816,
    0.912642542287906,
    0.937064061014069,
    0.961485579740231,
];
