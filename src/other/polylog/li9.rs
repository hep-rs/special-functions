#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.0,
            1.,
            0.001953125,
            0.00005080526342529086,
            3.814697265625e-6,
            5.12e-7,
            9.92290301275212e-8,
            2.478093222249005e-8,
            7.450580596923828e-9,
            2.581174791713197e-9,
            1e-9,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.0,
            -1.992466003705296,
            0.0,
            -0.3285170304324784,
            0.0,
            -0.01578388049162077,
            0.0,
            -0.0003263758069143306,
            0.0,
            -2.755731922398589e-6,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.002008392826082,
            1.004077356197944,
            0.002135960591989244,
            0.00007499037242822299,
            0.00001030405209000613,
            3.712761564013511e-6,
            3.191523710336866e-6,
            7.759681175098176e-6,
            -0.00004608496553377315,
            0.0001054670146350001,
            -0.0001769558043687817,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -0.0000248015873015873,
                0.0000992063492063492,
                -0.0002397486772486772,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 5] = [
    &[
        -2.234815380591535,
        1.049871400767368,
        0.000947602564599641,
        9.14869947581478e-6,
        2.130184328433563e-7,
        7.801700611868594e-9,
        3.766625082878915e-10,
        2.192056329360355e-11,
        1.460466946437344e-12,
        1.078357735587356e-13,
        8.63340878704057e-15,
        7.380013749788698e-16,
        6.660076211810975e-17,
        6.29124303658336e-18,
        6.179453111718434e-19,
        6.278263642442334e-20,
        6.57001221497385e-21,
        7.057068173341462e-22,
        7.758266459401569e-23,
        8.708405322186738e-24,
        9.95994110300505e-25,
        1.15866509812982e-25,
        1.368942822598487e-26,
        1.640468989664844e-27,
        1.991620233426273e-28,
        2.447152688835453e-29,
        3.040481803887577e-30,
        3.816859526745179e-31,
        4.839034533541319e-32,
        6.290458831101457e-33,
        7.978678607135774e-34,
    ],
    &[
        -0.6563430022626333,
        0.5279032478194215,
        0.0002607978839064188,
        1.580096663888658e-6,
        2.563161328164176e-8,
        7.020250542693614e-10,
        2.662212069443916e-11,
        1.26087561836406e-12,
        7.021085959183652e-14,
        4.423088573317746e-15,
        3.071271468783857e-16,
        2.307550022480063e-17,
        1.850600697546522e-18,
        1.567907264263663e-19,
        1.392166153436093e-20,
        1.287249232664302e-21,
        1.233122448939144e-22,
        1.218698197686348e-23,
        1.238276844092316e-24,
        1.289732628360537e-25,
        1.37361271403907e-26,
        1.492759427773042e-27,
        1.652271734987298e-28,
        1.859726196939243e-29,
        2.125636637059143e-30,
        2.46417127922752e-31,
        2.894179269289104e-32,
        3.440623387748537e-33,
        4.137417928767797e-34,
        5.101761765185803e-35,
        6.165461226953447e-36,
    ],
    &[
        0.1365086629616555,
        0.2647549020896636,
        0.00006913218041810243,
        2.456839833097032e-7,
        2.578524551927453e-9,
        4.93324737333552e-11,
        1.384616762728663e-12,
        5.071262745237719e-14,
        2.258764682186085e-15,
        1.168692277762082e-16,
        6.806810856342557e-18,
        4.363315973449929e-19,
        3.027410747863364e-20,
        2.244869196020871e-21,
        1.761491986989991e-22,
        1.451215272904492e-23,
        1.247369695101148e-24,
        1.112810790616399e-25,
        1.025999036168106e-26,
        9.74118011075338e-28,
        9.49501176410913e-29,
        9.47704478026093e-30,
        9.66442071557214e-31,
        1.004999623657496e-31,
        1.063928582221085e-32,
        1.144919380723925e-33,
        1.250801568381933e-34,
        1.385650118511324e-35,
        1.555245644679287e-36,
        1.789569856704169e-37,
        2.028264358785275e-38,
    ],
    &[
        0.5339031256293151,
        0.1325880171810756,
        0.00001787209176023261,
        3.521470324250634e-8,
        2.22427759686679e-10,
        2.761208517261889e-12,
        5.357608317468267e-14,
        1.42811696909901e-15,
        4.82338080347637e-17,
        1.955133565123747e-18,
        9.15558813153866e-20,
        4.817729807421716e-21,
        2.790276783718008e-22,
        1.750744262243181e-23,
        1.175463602939242e-24,
        8.362964897266664e-26,
        6.255495065314438e-27,
        4.888010217178066e-28,
        3.96898230840638e-29,
        3.334213889033708e-30,
        2.887149809879883e-31,
        2.568885531571676e-32,
        2.342368820608189e-33,
        2.183725632687048e-34,
        2.077321774514711e-35,
        2.0128625161622e-36,
        1.983645143618724e-37,
        1.985489040180609e-38,
        2.01630216162876e-39,
        2.097261229032229e-40,
        2.161106699930317e-41,
    ],
    &[
        0.7992235206940659,
        0.1327327494564389,
        0.00001831811722513863,
        3.930314779665182e-8,
        2.950735609879233e-10,
        4.809874844819479e-12,
        1.355268784495795e-13,
        5.761725744795123e-15,
        3.36936435425419e-16,
        2.533526460979463e-17,
        2.328341974695475e-18,
        2.515933317178121e-19,
        3.102811518157321e-20,
        4.267788394403578e-21,
        6.430133702531147e-22,
        1.046254275724812e-22,
        1.817762438050771e-23,
        3.341627542963498e-24,
        6.451707430987834e-25,
        1.300272288073512e-25,
        2.721661813368118e-26,
        5.891534291450186e-27,
        1.314187416299069e-27,
        3.011566620328388e-28,
        7.071220996992388e-29,
        1.697381624517201e-29,
        4.157194982044377e-30,
        1.037349561576259e-30,
        2.643439336525381e-31,
        7.248158336392596e-32,
        1.771897669689978e-32,
    ],
];

pub const SPLITS: [f64; 6] = [
    -3.303558298018915,
    -1.186658998542609,
    -0.128209348804456,
    0.4010154760646205,
    0.6656278884991587,
    0.930240300933697,
];
