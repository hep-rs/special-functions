#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            -1.97110218259487,
            -1.,
            -0.015625,
            -0.001371742112482853,
            -0.000244140625,
            -0.000064,
            -0.00002143347050754458,
            -8.499859752314087e-6,
            -3.814697265625e-6,
            -1.881676423158921e-6,
            -1e-6,
        ],
    ) + polynomial(
        (-x).ln(),
        &[
            0.0,
            0.0,
            -0.947032829497246,
            0.0,
            -0.06853891945200943,
            0.0,
            -0.001388888888888889,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    if x == 1.0 {
        return 1.017343061984449;
    }

    let xm1 = x - 1.0;
    let ln = (-xm1).ln();
    polynomial(
        xm1,
        &[
            1.017343061984449,
            1.03692775514337,
            0.02269773928388413,
            0.004823785385486594,
            0.00485757032720672,
            -0.01103259405565969,
            0.0135164276261639,
            -0.01404093828680292,
            0.01363669589331404,
            -0.01282751308222969,
            0.01187199414277106,
        ],
    ) + ln
        * polynomial(
            xm1,
            &[
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -0.008333333333333333,
                0.02083333333333333,
                -0.03472222222222222,
                0.04861111111111111,
                -0.06186342592592593,
                0.07421875,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 11] = [
    &[
        -4.874590196860758,
        0.7843789564200544,
        0.002832863896125428,
        0.00003882023959377294,
        8.664299547279592e-7,
        2.495092001588172e-8,
        8.414382584861606e-10,
        3.161650628379096e-11,
        1.285661705096486e-12,
        5.554060022171341e-14,
        2.517128294007461e-15,
        1.186119642768537e-16,
        5.773181526082743e-18,
        2.887938080195144e-19,
        1.478939059004361e-20,
        7.729544770388923e-22,
        4.112519511908311e-23,
        2.222884080943665e-24,
        1.218527985846668e-25,
        6.764525975303001e-27,
        3.798305490919173e-28,
        2.15494669912008e-29,
        1.234192018868392e-30,
        7.129926237556745e-32,
        4.151858184352278e-33,
        2.435509979830655e-34,
        1.438441445553066e-35,
        8.549486050888919e-37,
        5.111540996171013e-38,
        3.084129002445318e-39,
        1.856846514162164e-40,
    ],
    &[
        -3.281497181002706,
        0.8091879069786628,
        0.003403000356230622,
        0.0000581904769598184,
        1.674699406866996e-6,
        6.335148146542348e-8,
        2.840095893330337e-9,
        1.430467140397353e-10,
        7.845422639896321e-12,
        4.592896448277124e-13,
        2.831442255778268e-14,
        1.820514674305832e-15,
        1.212148675810908e-16,
        8.312710799169273e-18,
        5.846866182271376e-19,
        4.203788906789563e-20,
        3.081182780018385e-21,
        2.29712732405585e-22,
        1.738755997826859e-23,
        1.334138259038506e-24,
        1.036325205594245e-25,
        8.140119900286972e-27,
        6.459197332012144e-28,
        5.173304637420508e-29,
        4.179015925176427e-30,
        3.40259132750937e-31,
        2.790752449718219e-32,
        2.304530851035996e-33,
        1.915192696857197e-34,
        1.612269928004865e-35,
        1.34567151138863e-36,
    ],
    &[
        -2.054229768162867,
        0.4156138218914967,
        0.001007755845171412,
        0.0000107016428504517,
        1.985045209798605e-7,
        4.94407427779161e-9,
        1.47950747540378e-10,
        5.021935968446335e-12,
        1.869294044903995e-13,
        7.467279732328439e-15,
        3.154674266212423e-16,
        1.394816190308489e-17,
        6.404696482545222e-19,
        3.036336297760143e-20,
        1.479394641176871e-21,
        7.381096209807666e-23,
        3.759947691957001e-24,
        1.950818991116152e-25,
        1.028852536791796e-26,
        5.506247363363859e-28,
        2.986074599388939e-29,
        1.638902088334109e-30,
        9.09390913831485e-32,
        5.09672592447517e-33,
        2.882854797608813e-34,
        1.644503243460768e-35,
        9.45479853299994e-37,
        5.475587342685815e-38,
        3.192687916726139e-39,
        1.879905060410703e-40,
        1.105735987432814e-41,
    ],
    &[
        -1.214489376348923,
        0.4242526104835154,
        0.001159289210165251,
        0.00001492602953742494,
        3.492862909394751e-7,
        1.12383896904085e-8,
        4.412512413113331e-10,
        1.986652132421289e-11,
        9.88787048846105e-13,
        5.314206876496149e-14,
        3.035237984733541e-15,
        1.821468666568415e-16,
        1.138863124415627e-17,
        7.371604336685579e-19,
        4.91503143063527e-20,
        3.362337308030953e-21,
        2.352410737831888e-22,
        1.67879554247846e-23,
        1.219393928127616e-24,
        8.998126051035716e-26,
        6.735081542620198e-27,
        5.106633004865053e-28,
        3.917645546611336e-29,
        3.037928292400562e-30,
        2.379082219388518e-31,
        1.880114595089574e-32,
        1.498318563851771e-33,
        1.203383463349266e-34,
        9.73568493995332e-36,
        7.982609241505273e-37,
        6.498785950947911e-38,
    ],
    &[
        -0.5735809982584464,
        0.2158073555296818,
        0.0003286732404429849,
        2.545804085596292e-6,
        3.747269292857558e-8,
        7.793351894534085e-10,
        2.013683635310995e-11,
        6.04183618814078e-13,
        2.022504356923064e-14,
        7.362063390276183e-16,
        2.863503233139693e-17,
        1.175338178569435e-18,
        5.044158831585086e-20,
        2.247647130763237e-21,
        1.034206980070793e-22,
        4.892612937119483e-24,
        2.371396917161272e-25,
        1.174215697139534e-26,
        5.925620446070239e-28,
        3.04151829331782e-29,
        1.585179278695482e-30,
        8.376548392200922e-32,
        4.48234214351548e-33,
        2.426186577047765e-34,
        1.327114424033646e-35,
        7.329817668356329e-37,
        4.084665024946181e-38,
        2.295154634669965e-39,
        1.299597550110646e-40,
        7.436044673953138e-42,
        4.255055173297166e-43,
    ],
    &[
        -0.1392320562169196,
        0.2185705231117125,
        0.0003634394619782921,
        3.303805085373608e-6,
        5.978449570239534e-8,
        1.574804263535997e-9,
        5.258216840319584e-11,
        2.067790435222972e-12,
        9.1668268164721e-14,
        4.453722996776377e-15,
        2.32623326867354e-16,
        1.28836727874275e-17,
        7.489825709014093e-19,
        4.535204696990355e-20,
        2.843196593033231e-21,
        1.836673580241752e-22,
        1.217873083802775e-23,
        8.263227117736666e-25,
        5.721912667238187e-26,
        4.03483802515441e-27,
        2.892007943428483e-28,
        2.103651650023966e-29,
        1.55080485817565e-30,
        1.157273702156501e-31,
        8.732980731668848e-33,
        6.657986739460027e-34,
        5.124245996651502e-35,
        3.978464765128346e-36,
        3.114167573540027e-37,
        2.47149718373217e-38,
        1.950539159662156e-39,
    ],
    &[
        0.3009554669139464,
        0.2216558534016523,
        0.0004101600975801254,
        4.609410892628587e-6,
        1.113105123106082e-7,
        4.12328326790345e-9,
        2.007624774136159e-10,
        1.181326766724384e-11,
        7.984835204312049e-13,
        5.998725028442126e-14,
        4.897189468310589e-15,
        4.27497004581484e-16,
        3.943259502968037e-17,
        3.808908114537938e-18,
        3.825902189111235e-19,
        3.97426102930115e-20,
        4.250497162157065e-21,
        4.663493758119388e-22,
        5.233265344911869e-23,
        5.991550726185431e-24,
        6.983867784048428e-25,
        8.273026945516039e-26,
        9.94435193653313e-27,
        1.211308537517092e-27,
        1.493471650892367e-28,
        1.861930186483952e-29,
        2.345130422975367e-30,
        2.981723885289479e-31,
        3.825433292858081e-32,
        5.029464223949209e-33,
        6.44233128669618e-34,
    ],
    &[
        0.6350338329739758,
        0.1121214820693972,
        0.0001146466313117659,
        8.052135268943742e-7,
        1.351157789228846e-8,
        3.765602076939371e-10,
        1.459892031214509e-11,
        7.119016216440212e-13,
        4.102565327471391e-14,
        2.68210400168786e-15,
        1.934279415073919e-16,
        1.508519057662792e-17,
        1.253863592880981e-18,
        1.098679564759988e-19,
        1.00639317242194e-20,
        9.57382938195206e-22,
        9.4091745020831e-23,
        9.51321078856816e-24,
        9.86067479370524e-25,
        1.044820783492223e-25,
        1.128981705544746e-26,
        1.241531020635194e-27,
        1.387073531853587e-28,
        1.572042242796907e-29,
        1.805054965611957e-30,
        2.097437707972443e-31,
        2.463947852774965e-32,
        2.923757883813452e-33,
        3.502488902243809e-34,
        4.293323755297533e-35,
        5.15104782130187e-36,
    ],
    &[
        0.8036555812124936,
        0.05641534858680875,
        0.00003067299115669288,
        1.26173491215491e-7,
        1.374757508887912e-9,
        2.717200443741822e-11,
        7.982302276332594e-13,
        3.089690954044941e-14,
        1.458936515434732e-15,
        7.98717578044663e-17,
        4.897143534243278e-18,
        3.28202701972254e-19,
        2.362612942591929e-20,
        1.803326506701416e-21,
        1.445217737571321e-22,
        1.206927575588262e-23,
        1.044069765124026e-24,
        9.3112242735241e-26,
        8.52768876547117e-27,
        7.995033414953041e-28,
        7.652851785974703e-29,
        7.462316893888007e-30,
        7.398633033489639e-31,
        7.446555009673036e-32,
        7.597681137261767e-33,
        7.84881390744179e-34,
        8.200991610009848e-35,
        8.658976406603262e-36,
        9.23226519477376e-37,
        1.00464558868e-37,
        1.076788025897956e-38,
    ],
    &[
        0.8883951006666165,
        0.02830132377303172,
        7.971542330550692e-6,
        1.818788860147297e-8,
        1.202265795851238e-10,
        1.574868321051269e-12,
        3.289374478160305e-14,
        9.50458158794212e-16,
        3.458293181359772e-17,
        1.488877687614009e-18,
        7.274234054829914e-20,
        3.91912906645292e-21,
        2.281750511274462e-22,
        1.414600636103685e-23,
        9.23687061167309e-25,
        6.29954013394921e-26,
        4.458179015840597e-27,
        3.257079990599271e-28,
        2.446331173185237e-29,
        1.882531813390512e-30,
        1.48009329827332e-31,
        1.186136792769363e-32,
        9.66979366690259e-34,
        8.005743567913189e-35,
        6.721358484232726e-36,
        5.715276753452262e-37,
        4.916619943996737e-38,
        4.274925818579189e-39,
        3.753904614507151e-40,
        3.352759619236825e-41,
        2.971930004273553e-42,
    ],
    &[
        0.945062236562747,
        0.02836600456158152,
        8.202549215724395e-6,
        2.041862056072844e-8,
        1.627481638615383e-10,
        2.893085309256669e-12,
        9.08701860824461e-14,
        4.240803429507503e-15,
        2.605260137298185e-16,
        1.945186383618477e-17,
        1.675603655645198e-18,
        1.608590696880795e-19,
        1.680597164050463e-20,
        1.878897516854857e-21,
        2.220274644368522e-22,
        2.747561039129176e-23,
        3.53529652500617e-24,
        4.703359082404146e-25,
        6.440930287518578e-26,
        9.04623766783154e-27,
        1.299173409281953e-27,
        1.90311232454669e-28,
        2.837592149369226e-29,
        4.298837652488086e-30,
        6.607023244995458e-31,
        1.028829082134066e-31,
        1.621314126604734e-32,
        2.583161498908148e-33,
        4.160132872440411e-34,
        6.935289201478549e-35,
        1.106325833537526e-35,
    ],
];

pub const SPLITS: [f64; 12] = [
    -6.066481965674086,
    -4.310456960266385,
    -2.554431954858685,
    -1.676419452154834,
    -0.7984069494509842,
    -0.359400698099059,
    0.07960555325286613,
    0.5186118046047913,
    0.7381149302807539,
    0.8478664931187352,
    0.902742274537726,
    0.957618055956716,
];
