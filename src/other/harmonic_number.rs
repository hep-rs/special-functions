#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x,
        &[
            0.0,
            1.644934066848226,
            -1.202056903159594,
            1.082323233711138,
            -1.03692775514337,
            1.017343061984449,
            -1.008349277381923,
            1.004077356197944,
            -1.002008392826082,
            1.000994575127818,
            -1.000494188604119,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.5772156649015329,
            0.5,
            -0.08333333333333333,
            0.0,
            0.008333333333333333,
            0.0,
            -0.003968253968253968,
            0.0,
            0.004166666666666667,
            0.0,
            -0.007575757575757576,
        ],
    ) + x.ln()
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        0.2901200223324891,
        0.3220686097572332,
        0.0910301806801651,
        0.01347676733055305,
        0.0002245691554219428,
        -0.0003411878798671472,
        -0.00006284827964257964,
        1.161560615536195e-6,
        2.483003575851866e-6,
        4.020034228654851e-7,
        -2.172482323004817e-8,
        -1.983299999223169e-8,
        -2.912900861750502e-9,
        2.346645115088972e-10,
        1.638672990253247e-10,
        2.27705984628891e-11,
        -2.17767651212491e-12,
        -1.37170822060792e-12,
        -1.869528089233015e-13,
        1.86543499785723e-14,
        1.150991185182056e-14,
        1.581443078304954e-15,
        -1.509254908792719e-16,
        -9.62318795337332e-17,
        -1.358372220738001e-17,
        1.163586554652249e-18,
        7.991080978118356e-19,
        1.172553589136454e-19,
        -8.521814932880679e-21,
        -6.521726797047332e-21,
        -1.010142636066141e-21,
    ],
    &[
        1.873673589713633,
        1.253961810882306,
        0.08301898072632274,
        -0.01359883496367598,
        0.0005647914435554174,
        0.0003026786254125815,
        -0.00007329623047233209,
        1.625376813120436e-6,
        2.788263045815278e-6,
        -5.987371048507558e-7,
        -1.962352646885012e-8,
        3.352957742512357e-8,
        -5.234214110615227e-9,
        -8.246600616496646e-10,
        4.340370411085859e-10,
        -3.067193302693438e-11,
        -1.921509817391543e-11,
        4.975917478995288e-12,
        2.940011840062672e-13,
        -3.352557180593044e-13,
        3.464746183054775e-14,
        1.438507803979644e-14,
        -4.119518813077889e-15,
        -2.595905435657091e-16,
        2.760434086343249e-16,
        -2.146223926134284e-17,
        -1.326987700255925e-17,
        2.886407119484042e-18,
        4.155314081516077e-19,
        -2.012386493544083e-19,
        1.431983856634841e-22,
    ],
];

pub const SPLITS: [f64; 3] = [-3.553858670374141, -0.4852529880513604, 2.58335269427142];
