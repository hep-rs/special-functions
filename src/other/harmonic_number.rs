#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x,
        &[
            0.0,
            1.644934066848226,
            -1.202056903159594,
            1.082323233711138,
            -1.03692775514337,
            1.017343061984449,
            -1.008349277381923,
            1.004077356197944,
            -1.002008392826082,
            1.000994575127818,
            -1.000494188604119,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            0.5772156649015329,
            0.5,
            -0.08333333333333333,
            0.0,
            0.008333333333333333,
            0.0,
            -0.003968253968253968,
            0.0,
            0.004166666666666667,
            0.0,
            -0.007575757575757576,
        ],
    ) + x.ln()
}

pub const COEFFICIENTS: [&[f64]; 9] = [
    &[
        0.3168716493279571,
        0.2546200753313155,
        -0.01494527077079252,
        0.001102363239779003,
        -0.00008748634889208608,
        7.156580599928302e-6,
        -5.937015729952655e-7,
        4.959527688286941e-8,
        -4.157712467898983e-9,
        3.492026572624239e-10,
        -2.935834512222111e-11,
        2.469548276669759e-12,
        -2.077921487096027e-13,
        1.748675215879275e-14,
        -1.471724540877131e-15,
        1.238694908384805e-16,
        -1.0425895745055e-17,
        8.775432914234668e-19,
        -7.386302641140732e-20,
        6.217094942525941e-21,
        -5.232978129777584e-22,
        4.404644879794246e-23,
        -3.70743194078059e-24,
        3.120582322669225e-25,
        -2.626625727329058e-26,
        2.210857721585168e-27,
        -1.86090166665609e-28,
        1.566340663399905e-29,
        -1.318470811089124e-30,
        1.117576868258722e-31,
        -9.34058418846686e-33,
    ],
    &[
        0.7366265691415316,
        0.1716200221731242,
        -0.007044034910313462,
        0.0003717759737396514,
        -0.0000214274436246483,
        1.285334773971514e-6,
        -7.869228715429988e-8,
        4.871808092580577e-9,
        -3.035296206735199e-10,
        1.898100296862862e-11,
        -1.189576826734051e-12,
        7.46518736929517e-14,
        -4.68854330989185e-15,
        2.94610587079442e-16,
        -1.851780844488742e-17,
        1.164156470293866e-18,
        -7.319523587800589e-20,
        4.602406604223457e-21,
        -2.8940508550557e-22,
        1.819864710290177e-23,
        -1.144403938854582e-24,
        7.196546035419243e-26,
        -4.525553232149309e-27,
        2.845908864026856e-28,
        -1.789663493717e-29,
        1.125440243617524e-30,
        -7.077402876943388e-32,
        4.450672937294954e-33,
        -2.79888040740303e-34,
        1.767028792426484e-35,
        -1.1068317366587e-36,
    ],
    &[
        1.146429514210319,
        0.2308141511678869,
        -0.01301677245632975,
        0.00095907320266431,
        -0.00007808301237839959,
        6.674605534756554e-6,
        -5.861220070106417e-7,
        5.229756001411105e-8,
        -4.712686842108156e-9,
        4.273616387454205e-10,
        -3.891411147688662e-11,
        3.553026566760518e-12,
        -3.249961028591609e-13,
        2.976383640148109e-14,
        -2.728095389895727e-15,
        2.501930224715622e-16,
        -2.295399058868284e-17,
        2.1064727027123e-18,
        -1.933446428687961e-19,
        1.774853563463501e-20,
        -1.629409050955357e-21,
        1.495971621963395e-22,
        -1.373517682539458e-23,
        1.261122691609798e-24,
        -1.157947402340378e-25,
        1.063227321687574e-26,
        -9.76264351777545e-28,
        8.964204518864381e-29,
        -8.231677455215099e-30,
        7.621686957541759e-31,
        -6.939896230133791e-32,
    ],
    &[
        1.529948860001141,
        0.1583021658341562,
        -0.006193470715378518,
        0.0003196388904089082,
        -0.00001837391370220083,
        1.116240031381192e-6,
        -7.003885593778025e-8,
        4.484867018171919e-9,
        -2.910656219412774e-10,
        1.906386366017743e-11,
        -1.256636537983347e-12,
        8.321135333063509e-14,
        -5.528102769958494e-15,
        3.68130667829595e-16,
        -2.455748166008247e-17,
        1.6402969690948e-18,
        -1.096663068746794e-19,
        7.337194882142067e-21,
        -4.911508963912588e-22,
        3.289047408613254e-23,
        -2.20319405773055e-24,
        1.476151247885543e-25,
        -9.89192030389029e-27,
        6.62955178733318e-28,
        -4.443530557844108e-29,
        2.978534227316844e-30,
        -1.996640663748289e-31,
        1.338488063104079e-32,
        -8.973270665799339e-34,
        6.042642875542587e-35,
        -4.032960626447093e-36,
    ],
    &[
        1.806464214549164,
        0.1203583543834692,
        -0.003596978565608124,
        0.0001423976698971543,
        -6.30250227307902e-6,
        2.957860308223243e-7,
        -1.437913259602854e-8,
        7.151874894154165e-10,
        -3.613218912142302e-11,
        1.845745893907586e-12,
        -9.50464306588913e-14,
        4.92354766845125e-15,
        -2.561857977761346e-16,
        1.337518224732708e-17,
        -7.001124155652841e-19,
        3.671992205559606e-20,
        -1.928887560665303e-21,
        1.014459522302813e-22,
        -5.340366185465878e-24,
        2.81337496350955e-25,
        -1.482982146055893e-26,
        7.820643498103523e-28,
        -4.125774446191098e-29,
        2.177168634438681e-30,
        -1.149149222699456e-31,
        6.066500065870789e-33,
        -3.203032476835465e-34,
        1.691348671171607e-35,
        -8.931963180420492e-37,
        4.730362799548954e-38,
        -2.491437606385324e-39,
    ],
    &[
        2.109766032130932,
        0.1780142950486873,
        -0.007892000393582213,
        0.0004647668192856293,
        -0.00003068010941527067,
        2.152665146392959e-6,
        -1.567994484111194e-7,
        1.170899151695443e-8,
        -8.897662253030463e-10,
        6.847836400154023e-11,
        -5.3206262478828e-12,
        4.164174425142321e-13,
        -3.277522543627876e-14,
        2.591128804744826e-15,
        -2.055711764395346e-16,
        1.635536925569587e-17,
        -1.304204841813733e-18,
        1.041913103765942e-19,
        -8.336212798416847e-21,
        6.677881504843797e-22,
        -5.354826608691293e-23,
        4.297454609710482e-24,
        -3.451224700030398e-25,
        2.773190325181593e-26,
        -2.229402008945042e-27,
        1.792935541810539e-28,
        -1.442380926039473e-29,
        1.160675479833364e-30,
        -9.34233861938861e-32,
        7.569207591763086e-33,
        -6.055035522639125e-34,
    ],
    &[
        2.415988427973565,
        0.1311747226843195,
        -0.004292722771295443,
        0.0001869213539746547,
        -9.13810228228917e-6,
        4.755713966351515e-7,
        -2.573089310339137e-8,
        1.429213375118867e-9,
        -8.088756036334448e-11,
        4.642087144974691e-12,
        -2.692575488050843e-13,
        1.574839893132492e-14,
        -9.27213346533561e-16,
        5.488349996134626e-17,
        -3.262839270822349e-18,
        1.946737197874056e-19,
        -1.164961804855198e-20,
        6.98869034800155e-22,
        -4.201329604311222e-23,
        2.530130397767976e-24,
        -1.52597463030303e-25,
        9.21515849717146e-27,
        -5.570936145274502e-28,
        3.370972560132093e-29,
        -2.04139187713859e-30,
        1.23706624691112e-31,
        -7.500903112347345e-33,
        4.550435242675353e-34,
        -2.761765712974148e-35,
        1.68295008012566e-36,
        -1.018364855133316e-37,
    ],
    &[
        2.742064052794636,
        0.1894449943225596,
        -0.008962420952627338,
        0.00056471435457018,
        -0.00003998631895439748,
        3.016851233446713e-6,
        -2.368434219812208e-7,
        1.910490663999579e-8,
        -1.571560084011192e-9,
        1.31192932473689e-10,
        -1.107759679069062e-11,
        9.43871996205107e-13,
        -8.10139272062944e-14,
        6.995442202101199e-15,
        -6.070693231412774e-16,
        5.290308644607765e-17,
        -4.626626929516411e-18,
        4.058468815502046e-19,
        -3.569341503092973e-20,
        3.146209782756215e-21,
        -2.778635599207288e-22,
        2.458163221577119e-23,
        -2.177871854537875e-24,
        1.932044718485381e-25,
        -1.715920622096826e-26,
        1.525504927138139e-27,
        -1.357423921595106e-28,
        1.208811925489168e-29,
        -1.077287248983299e-30,
        9.6819519377813e-32,
        -8.569802982672064e-33,
    ],
    &[
        3.065176392470228,
        0.1371743635760347,
        -0.004701483789176071,
        0.0002147265015998682,
        -0.00001102655812010426,
        6.036363479865573e-7,
        -3.440276518094731e-8,
        2.015585079626651e-9,
        -1.204816290900799e-10,
        7.312045215361061e-12,
        -4.490687442757944e-13,
        2.78429074732154e-14,
        -1.739745284901834e-15,
        1.094084172707046e-16,
        -6.917723225277821e-18,
        4.394096287825954e-19,
        -2.802112393680564e-20,
        1.792995126078688e-21,
        -1.150690656822429e-22,
        7.403958232174026e-24,
        -4.77485676388109e-25,
        3.085553691672544e-26,
        -1.997487497439705e-27,
        1.295175462704288e-28,
        -8.409948504014783e-30,
        5.46782078237033e-31,
        -3.559060372938121e-32,
        2.319034934582763e-33,
        -1.512496272721332e-34,
        9.91481867740665e-36,
        -6.449351488979807e-37,
    ],
];

pub const SPLITS: [f64; 10] = [
    0.02861401430883069,
    0.4415154008532651,
    0.8544167873976994,
    1.680219560486568,
    2.506022333575437,
    3.331825106664306,
    4.983430652842043,
    6.635036199019781,
    9.93824729137526,
    13.24145838373073,
];
