#![allow(clippy::all)]

pub fn lower(x: f64) -> f64 {
    x.powi(-3)
        * (0.0913453711751798 - 0.01755762319317072 * x.powi(2) + 0.07615935359813248 * x.powi(4))
}

pub fn upper(x: f64) -> f64 {
    0.05066059182116889 * crate::bessel::k2(x) / x
}

pub const COEFFICIENTS: [&[f64]; 15] = [
    &[
        19.64085061766939,
        -4.671156505648838,
        -4.078305860766287e-7,
        -1.791407978907077e-7,
        -6.267537507541199e-8,
        -1.812939678418539e-8,
        -4.457697254573328e-9,
        -9.51633749214833e-10,
        -1.7932517086619e-10,
        -3.02244396694779e-11,
        -4.605586310838814e-12,
        -6.401351316949225e-13,
        -8.175765486297414e-14,
        -9.65465946623937e-15,
        -1.05952296807234e-15,
        -1.08491453717237e-16,
        -1.039432282683572e-17,
        -9.32746356527789e-19,
        -7.825835394176595e-20,
        -6.096529834122214e-21,
        -4.331586614217768e-22,
        -2.680305693839574e-23,
        -1.240784916421259e-24,
        -6.567101495649571e-27,
        8.256776748378217e-27,
        1.435369547043858e-27,
        1.77915476865313e-28,
        1.883019212031521e-29,
        1.782526237541174e-30,
        1.529693374637631e-31,
        1.154780251268563e-32,
    ],
    &[
        12.63410273885002,
        -2.335595716188459,
        -6.325227352039312e-6,
        -1.564545866622787e-6,
        -2.95668466308022e-7,
        -4.512261568834706e-8,
        -5.768799807806734e-9,
        -6.340424219142744e-10,
        -6.105934400229259e-11,
        -5.225943997903139e-12,
        -4.016971215441404e-13,
        -2.792392568001256e-14,
        -1.760578487158757e-15,
        -1.003659934727608e-16,
        -5.100166415935524e-18,
        -2.217987891515571e-19,
        -7.227637440450968e-21,
        -5.677655415948461e-23,
        1.696009767300788e-23,
        1.948436075984742e-24,
        1.483646398770304e-25,
        9.12313854466193e-27,
        4.642425052536862e-28,
        1.828546875290714e-29,
        3.710977431945308e-31,
        -2.128446850750789e-32,
        -3.347192981616533e-33,
        -2.672944902749431e-34,
        -1.583180323534756e-35,
        -6.983190937304298e-37,
        -1.659566443670543e-38,
    ],
    &[
        7.962633068351273,
        -2.335978453861741,
        -0.0001421128688612353,
        -0.00003510295948664997,
        -6.61708477701962e-6,
        -1.005276640002623e-6,
        -1.274791303768539e-7,
        -1.380794860069219e-8,
        -1.295321721240869e-9,
        -1.05733536919509e-10,
        -7.447692648633475e-12,
        -4.372269513618139e-13,
        -1.900229484799049e-14,
        -2.618247547310026e-16,
        5.807930287107175e-17,
        8.222446364558621e-18,
        7.056720745640612e-19,
        4.461400667896442e-20,
        1.916925483325816e-21,
        1.633740658734988e-23,
        -6.568369784161205e-24,
        -7.604550354527874e-25,
        -4.890590894142091e-26,
        -1.422447516124767e-27,
        1.010321658225206e-28,
        1.866479292574366e-29,
        1.462107052582717e-30,
        4.653811138300746e-32,
        -5.038659074770527e-33,
        -1.089579729223941e-33,
        -1.181165005733923e-34,
    ],
    &[
        4.457296211115531,
        -1.169451197384135,
        -0.0003141625226196926,
        -0.00003991461661855199,
        -3.796362365955254e-6,
        -2.861301551215967e-7,
        -1.761711209579874e-8,
        -8.952378603551761e-10,
        -3.69881786906737e-11,
        -1.156509243316024e-12,
        -1.9276900217639e-14,
        5.869646685259102e-16,
        7.041998913553091e-17,
        3.669223307585301e-18,
        1.257298656515357e-19,
        2.411001711891459e-21,
        -2.634814326643812e-23,
        -4.212537798363455e-24,
        -1.747742803333529e-25,
        -4.277719436049424e-27,
        -1.582710279515118e-28,
        -1.888662859456613e-29,
        -1.87214262129148e-30,
        -1.270744411167417e-31,
        -5.988504538795669e-33,
        -1.608731111002852e-34,
        2.742544525602896e-36,
        6.650050083068261e-37,
        4.911974799723243e-38,
        2.467001615812788e-39,
        8.811074111924978e-41,
    ],
    &[
        2.113221480696415,
        -1.175551085360932,
        -0.001451072795219225,
        -0.0001808637848109394,
        -0.00001664276107312874,
        -1.184422613597153e-6,
        -6.583562780142063e-8,
        -2.747022395181545e-9,
        -7.036063365228657e-11,
        5.645158259340185e-13,
        1.852689775049059e-13,
        1.184116011935493e-14,
        4.518113462274174e-16,
        8.174674952030084e-18,
        -3.029552098493933e-19,
        -4.071912120986195e-20,
        -3.004264500531682e-21,
        -2.033790372164417e-22,
        -1.274079200633695e-23,
        -6.323875116625898e-25,
        -1.57338057058385e-26,
        9.94649093156501e-28,
        1.690420903339175e-28,
        1.343838365599736e-29,
        7.196688091051088e-31,
        2.320038585625359e-32,
        -2.056039490368625e-34,
        -9.75020748469311e-35,
        -8.805647327969461e-36,
        -5.438895269926287e-37,
        -2.478578194052692e-38,
    ],
    &[
        -0.2611840502920399,
        -1.202871411854851,
        -0.006359421304102174,
        -0.0007522425113521035,
        -0.0000633081451079716,
        -3.839396719463981e-6,
        -1.531837200042065e-7,
        -1.840273035128326e-9,
        2.639186234805492e-10,
        2.353238716650545e-11,
        8.984492367612625e-13,
        -1.176920271104531e-14,
        -4.808919711389915e-15,
        -4.496608449279006e-16,
        -2.694070900678509e-17,
        -7.841410089786823e-19,
        5.569313831954836e-20,
        1.093631552371774e-20,
        9.48369228549376e-22,
        4.646472900480184e-23,
        -6.1932228953283e-26,
        -2.65081664383255e-25,
        -2.936749910658252e-26,
        -1.835066641120481e-27,
        -4.475029566510467e-29,
        5.085669447829587e-30,
        8.268707984931928e-31,
        6.596777325398648e-32,
        2.90284718010484e-33,
        -4.282802375601372e-35,
        -2.128686308031056e-35,
    ],
    &[
        -2.763195522535214,
        -1.314185539820894,
        -0.02462663048225293,
        -0.002568197036030705,
        -0.0001723564024745213,
        -6.317175613067614e-6,
        4.411393358305554e-8,
        1.724444776072045e-8,
        1.623958432267745e-10,
        -1.287906822506299e-10,
        -1.352620090657347e-11,
        -3.676476667727317e-13,
        6.688591719349034e-14,
        9.80445369226197e-15,
        4.753046585413425e-16,
        -3.182280253089017e-17,
        -7.348217491885089e-18,
        -4.994870892949473e-19,
        1.07868629403243e-20,
        5.464324498245085e-21,
        4.813068870767538e-22,
        2.760954780839187e-24,
        -3.9715765926682e-24,
        -4.468322725155657e-25,
        -1.200990840728077e-26,
        2.749447259167616e-27,
        4.040359770391408e-28,
        1.838105371902149e-29,
        -1.720751552503932e-30,
        -3.543290107032168e-31,
        -2.255775560343717e-32,
    ],
    &[
        -4.862674405721506,
        -0.7717792775401448,
        -0.0144844366868833,
        -0.0006405909999819989,
        -0.00001565169440144403,
        -1.231799373757888e-7,
        -4.909813023736383e-11,
        -3.778261475039583e-10,
        -2.013142485474392e-11,
        2.36143947485561e-13,
        5.79732854991671e-14,
        1.284849548919771e-15,
        -1.095008669945211e-16,
        -7.073751596613416e-18,
        5.953059000237614e-20,
        2.12134628090291e-20,
        5.256486585047027e-22,
        -4.261554191249408e-23,
        -2.885845781741722e-24,
        2.945683826146553e-26,
        9.44414805212625e-27,
        2.252713975643891e-28,
        -2.074824627809818e-29,
        -1.374435807066386e-30,
        1.655108310526357e-32,
        4.743711812347755e-33,
        1.101413860050089e-34,
        -1.08300949024006e-35,
        -7.081732431293511e-37,
        9.46072896270442e-39,
        2.522530806658371e-39,
    ],
    &[
        -6.549593282861624,
        -0.922870372149072,
        -0.02376802742790352,
        -0.000915433181591944,
        -0.00001926646199031188,
        -2.998400684837444e-7,
        -1.516996550916511e-8,
        -4.592879329709267e-10,
        2.330567899351271e-11,
        1.410740872309791e-12,
        -5.144941456911711e-14,
        -4.748746739133497e-15,
        8.042207986798435e-17,
        1.392991359309091e-17,
        -9.5095951502467e-20,
        -4.016530367986606e-20,
        4.589174142974613e-23,
        1.241668331868681e-22,
        6.23333748048736e-25,
        -4.023203643764938e-25,
        -5.437740147257378e-27,
        1.283030225529014e-27,
        2.99992764793229e-29,
        -3.9487510120902e-30,
        -1.347319711212462e-31,
        1.188761001153874e-32,
        5.503966985030132e-34,
        -3.526063211077533e-35,
        -2.159741380028641e-36,
        1.012520881914439e-37,
        8.267125653463961e-39,
    ],
    &[
        -8.624353956434774,
        -1.162794210594695,
        -0.03687216898951543,
        -0.00129391156857651,
        -0.00002938820622018209,
        -7.088200584700858e-7,
        -1.444877045592746e-8,
        4.438258118233754e-10,
        1.099383916525844e-11,
        -1.978688379606808e-12,
        -3.500424485353157e-14,
        5.300215310943456e-15,
        7.220750203231564e-17,
        -1.171643186578944e-17,
        1.947418641700682e-20,
        2.208359896485438e-20,
        -1.073651495883893e-21,
        -4.186481827819468e-23,
        5.989166178800537e-24,
        9.22734871465431e-26,
        -2.206177211665578e-26,
        -1.425751111023538e-28,
        6.396975337189873e-29,
        -5.046269911348395e-31,
        -1.594985243732857e-31,
        5.896290700650895e-33,
        3.634052157293967e-34,
        -3.185242109821523e-35,
        -7.241612773369302e-37,
        1.271701227329973e-37,
        6.783732278223192e-40,
    ],
    &[
        -11.30050545950314,
        -1.529051814691901,
        -0.05573782202721512,
        -0.001892282572083754,
        -0.00004609831442938424,
        -9.30969038967985e-7,
        -7.141299968509889e-9,
        -1.777371337900196e-10,
        -3.41402571689515e-11,
        4.407176726552799e-13,
        9.98703267265518e-14,
        -1.870117319070645e-15,
        -2.560332525814259e-16,
        2.0312473802496e-18,
        5.031487562957843e-19,
        1.547457687253018e-20,
        -4.398386812739284e-22,
        -1.110414099753279e-22,
        -2.152019233816828e-24,
        4.161418522375093e-25,
        1.508985543803816e-26,
        -9.80936466704316e-28,
        -5.806153814902359e-29,
        8.06424872229105e-31,
        1.624728560771408e-31,
        5.434695215048882e-33,
        -3.23687146322204e-34,
        -3.502283478450626e-35,
        2.546480569560663e-37,
        1.267379842070223e-37,
        1.616276142103434e-39,
    ],
    &[
        -14.8862499289445,
        -2.07981435551555,
        -0.08352437128697658,
        -0.002791632351638702,
        -0.00006733296980401127,
        -1.250646551042525e-6,
        -2.132526503923743e-8,
        -5.72319717534236e-10,
        1.080440269264761e-11,
        6.775426913341227e-13,
        -8.368330069879925e-14,
        -1.032646661592989e-15,
        3.246863640249908e-16,
        1.654118272685376e-18,
        -1.135193039333721e-18,
        -1.264209794448392e-20,
        3.948734700541833e-21,
        9.29725494746146e-23,
        -1.342482370477371e-23,
        -4.967687806683354e-25,
        4.189206427966456e-26,
        2.158519299039872e-27,
        -1.14409147209697e-28,
        -8.106045322839146e-30,
        2.691962448083517e-31,
        2.704438826424466e-32,
        -5.76212847945994e-34,
        -8.216577328175048e-35,
        1.420025012983578e-36,
        2.387707636633064e-37,
        -5.226709423474573e-39,
    ],
    &[
        -19.83446509929001,
        -2.902427754212766,
        -0.1244164296341338,
        -0.004101541971625867,
        -0.0000985423734230312,
        -1.913979341094655e-6,
        -3.281109060513394e-8,
        -3.476893606840471e-10,
        -4.600043677748697e-12,
        -5.961469793898819e-13,
        3.2514063977343e-14,
        9.08735494014027e-16,
        -2.060275410102216e-16,
        3.595179783767438e-18,
        8.266324091463362e-19,
        -3.668677265714768e-20,
        -2.820766065251387e-21,
        1.989133504895955e-22,
        9.04625362492962e-24,
        -8.76351828607539e-25,
        -2.857908075777247e-26,
        3.382834868750116e-27,
        9.27783240353827e-29,
        -1.155547956155539e-29,
        -3.200654974405482e-31,
        3.417790341561035e-32,
        1.164673301992571e-33,
        -8.088949810605359e-35,
        -4.268816509625726e-36,
        1.065152883032672e-37,
        1.498409769549841e-38,
    ],
    &[
        -26.81153476456641,
        -4.124642218249002,
        -0.1845069643657277,
        -0.00603101907317728,
        -0.000145623676109495,
        -2.846252661102512e-6,
        -4.62093723682336e-8,
        -6.267006147666749e-10,
        -9.13246197343077e-12,
        2.214633621096911e-14,
        -5.220014668817043e-15,
        -2.269521399526156e-16,
        4.865137654539336e-17,
        -2.746358624517236e-18,
        -7.969422439704304e-20,
        2.035968004162004e-20,
        -7.274707014755379e-22,
        -6.90763511705187e-23,
        6.684860109493504e-24,
        7.779682856000312e-26,
        -3.42043418328339e-26,
        6.510718160554751e-28,
        1.360716346322034e-28,
        -5.789742854943426e-30,
        -4.706471976898295e-31,
        3.107287317263242e-32,
        1.532877847201789e-33,
        -1.38027744127013e-34,
        -5.066503638407225e-36,
        5.549031966338151e-37,
        1.78635659777863e-38,
    ],
    &[
        -36.79713140507299,
        -5.934546324274531,
        -0.2729505223281937,
        -0.008883220842269023,
        -0.0002152332554904257,
        -4.199590195523024e-6,
        -6.801119600440534e-8,
        -9.44027340103318e-10,
        -1.15543164625187e-11,
        -1.219024423932653e-13,
        -1.474891090711982e-15,
        2.297811393254525e-17,
        -3.559621365123927e-18,
        2.546911368627988e-19,
        -8.634977384456151e-21,
        -7.492689611830542e-22,
        1.403070970272197e-22,
        -9.10244193799311e-24,
        -5.78177435144896e-26,
        6.054940061663308e-26,
        -4.263568358350891e-27,
        -5.314949391684613e-29,
        2.741677670755933e-29,
        -1.31320054149464e-30,
        -7.653343312923848e-32,
        1.064209315771754e-32,
        -8.692061156799434e-35,
        -4.979515259058578e-35,
        2.300227576535399e-36,
        1.606930801920654e-37,
        -1.590091973996439e-38,
    ],
];

pub const SPLITS: [f64; 16] = [
    -8.901704839581895,
    -5.787600971143967,
    -4.230549036925003,
    -2.67349710270604,
    -1.894971135596558,
    -1.116445168487076,
    -0.3379192013775937,
    0.4406067657318883,
    0.8298697492866292,
    1.21913273284137,
    1.608395716396111,
    1.997658699950852,
    2.386921683505593,
    2.776184667060334,
    3.165447650615075,
    3.554710634169816,
];
