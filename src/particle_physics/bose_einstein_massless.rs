#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    if x == 0.0 {
        0.1217938282335731
    } else {
        let x2 = x.powi(2);
        polynomial(
            x,
            &[
                0.1217938282335731,
                -0.1666666666666667,
                0.07599088773175333,
                0.008443431970194814,
                -0.0003518096654247839,
                0.0,
                1.17269888474928e-6,
                0.0,
                -9.97192929208571e-9,
                0.0,
                1.163391750743333e-10,
            ],
        ) - x2 * x2.ln() * 0.025330295910584444
    }
}

pub fn upper(x: f64) -> f64 {
    polynomial(
        (-x).exp(),
        &[
            0.0,
            0.1013211836423378,
            0.01266514795529222,
            0.003752636431197695,
            0.001583143494411528,
            0.0008105694691387022,
            0.0004690795538997119,
            0.0002953970368581276,
            0.000197892936801441,
            0.0001389865344888035,
            0.0001013211836423378,
            0.0000761241049153552,
        ],
    )
}

pub const COEFFICIENTS: [&[f64]; 6] = [
    &[
        0.07090222570422638,
        -0.005499097445452208,
        0.0001228837995339282,
        -2.454739496999227e-6,
        5.845655244597392e-8,
        -1.822685235350112e-9,
        6.988977052102584e-11,
        -3.062502725641196e-12,
        1.468051313864864e-13,
        -7.50720509895072e-15,
        4.031211927380999e-16,
        -2.249135250266502e-17,
        1.294128587027425e-18,
        -7.637457092360266e-20,
        4.604043594124468e-21,
        -2.825950707624294e-22,
        1.761694813595603e-23,
        -1.113163124055558e-24,
        7.117572325843747e-26,
        -4.598933213918917e-27,
        2.999429957996696e-28,
        -1.972686030323446e-29,
        1.307247516635681e-30,
        -8.722308858007134e-32,
        5.856163925310658e-33,
        -3.954317941317629e-34,
        2.684129833367878e-35,
        -1.830754283642905e-36,
        1.254302694088312e-37,
        -8.670081520153876e-39,
        5.959019282696713e-40,
    ],
    &[
        0.06080352118689404,
        -0.004620247253926069,
        0.0000980690114740007,
        -1.741919145098989e-6,
        3.380784263411676e-8,
        -8.156091442493813e-10,
        2.39223516438768e-11,
        -8.01349392309833e-13,
        2.936670479448903e-14,
        -1.148011062508438e-15,
        4.71241943045537e-17,
        -2.009808299615926e-18,
        8.83974564973494e-20,
        -3.987755439576101e-21,
        1.837519042659713e-22,
        -8.621163228049854e-24,
        4.108068490431174e-25,
        -1.984124408050706e-26,
        9.69712190969286e-28,
        -4.78924514208436e-29,
        2.387514821214438e-30,
        -1.200221260834032e-31,
        6.079333335516566e-33,
        -3.100439906028298e-34,
        1.591101465351475e-35,
        -8.211986090571964e-37,
        4.260606003528588e-38,
        -2.221204060106523e-39,
        1.163172798832042e-40,
        -6.133382779379285e-42,
        3.228506608716317e-43,
    ],
    &[
        0.04874566950355413,
        -0.007233143562204598,
        0.0002912998938425218,
        -9.21890567423206e-6,
        2.910180418146227e-7,
        -1.066725845550282e-8,
        4.655912863405255e-10,
        -2.317233986004633e-11,
        1.262130440290617e-12,
        -7.334049081057533e-14,
        4.475185646810579e-15,
        -2.837313649916279e-16,
        1.855200412148006e-17,
        -1.244193570726405e-18,
        8.523298024228407e-20,
        -5.945174364511887e-21,
        4.211770250982688e-22,
        -3.024326238723789e-23,
        2.197551695694731e-24,
        -1.613626514280745e-25,
        1.195981561913018e-26,
        -8.938909668967908e-28,
        6.731720510298663e-29,
        -5.104369779622468e-30,
        3.894636818744615e-31,
        -2.988608162075775e-32,
        2.305393588620216e-33,
        -1.786966061471513e-34,
        1.39136229393996e-35,
        -1.094466428453236e-36,
        8.536840872146987e-38,
    ],
    &[
        0.03191448524180705,
        -0.00914847837909553,
        0.0006915610928377078,
        -0.00003836017623825755,
        1.898922899666351e-6,
        -9.78153168092642e-8,
        5.692117024165172e-9,
        -3.74372344011536e-10,
        2.697170809907869e-11,
        -2.074130304285321e-12,
        1.675025455820988e-13,
        -1.405569011412137e-14,
        1.216430544715191e-15,
        -1.079817010464247e-16,
        9.79144388823611e-18,
        -9.04043919253334e-19,
        8.477794839303246e-20,
        -8.058354307900433e-21,
        7.751067704922872e-22,
        -7.534155799887855e-23,
        7.392120000478854e-24,
        -7.313837497893506e-25,
        7.291316092402849e-26,
        -7.318862203160976e-27,
        7.392514753719846e-28,
        -7.509654439537376e-29,
        7.668731503125106e-30,
        -7.869084634334646e-31,
        8.111710655023786e-32,
        -8.485456014013319e-33,
        8.721666592684164e-34,
    ],
    &[
        0.01798149393793368,
        -0.005053915998718853,
        0.0003661948816200597,
        -0.00001859965297454334,
        7.779413042618431e-7,
        -3.051141347467333e-8,
        1.24691337686549e-9,
        -5.591711637904858e-11,
        2.742957688043751e-12,
        -1.439106367596789e-13,
        7.931723293888518e-15,
        -4.541640790453957e-16,
        2.681760569926918e-17,
        -1.62419526439307e-18,
        1.004796247114907e-19,
        -6.329260249539503e-21,
        4.049199301292844e-22,
        -2.625715720701404e-23,
        1.722945279767653e-24,
        -1.142477468786029e-25,
        7.646812093314336e-27,
        -5.161203619220596e-28,
        3.509961357906981e-29,
        -2.403408497322724e-30,
        1.656002916303214e-31,
        -1.147549172886465e-32,
        7.993834986001815e-34,
        -5.59543366515793e-35,
        3.934225286278603e-36,
        -2.791522591021289e-37,
        1.968497971710645e-38,
    ],
    &[
        0.01022060441827181,
        -0.002843434953893188,
        0.0002016846544150293,
        -9.80777562148239e-6,
        3.768300202477932e-7,
        -1.272753801856787e-8,
        4.167539113409512e-10,
        -1.428862776687959e-11,
        5.296416758859313e-13,
        -2.106335987845087e-14,
        8.821200768643846e-16,
        -3.838451008216966e-17,
        1.721924007819791e-18,
        -7.922072670083027e-20,
        3.722947646499642e-21,
        -1.781444952880951e-22,
        8.657577718720081e-24,
        -4.26460991511165e-25,
        2.125714143501562e-26,
        -1.070732039121151e-27,
        5.443918989944502e-29,
        -2.79112202242093e-30,
        1.441867856499869e-31,
        -7.499716998102667e-33,
        3.925288119357288e-34,
        -2.066207922406273e-35,
        1.093325271990758e-36,
        -5.813246021781208e-38,
        3.104752771046445e-39,
        -1.669873284447371e-40,
        8.963730746318332e-42,
    ],
];

pub const SPLITS: [f64; 7] = [
    0.3850679021450391,
    0.5237259150690253,
    0.6623839279930115,
    0.939699953840984,
    1.494332005536929,
    2.048964057232874,
    2.603596108928818,
];
