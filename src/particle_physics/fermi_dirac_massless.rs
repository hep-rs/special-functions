#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    polynomial(
        x.exp(),
        &[
            0.0,
            0.1013211836423378,
            -0.01266514795529222,
            0.003752636431197695,
            -0.001583143494411528,
            0.0008105694691387022,
            -0.0004690795538997119,
            0.0002953970368581276,
            -0.000197892936801441,
            0.0001389865344888035,
            -0.0001013211836423378,
            0.0000761241049153552,
        ],
    )
}

pub fn upper(x: f64) -> f64 {
    polynomial(x, &[0.0, 0.1666666666666667, 0.0, 0.01688686394038963])
        + polynomial(
            (-x).exp(),
            &[
                0.0,
                0.1013211836423378,
                -0.01266514795529222,
                0.003752636431197695,
                -0.001583143494411528,
                0.0008105694691387022,
                -0.0004690795538997119,
                0.0002953970368581276,
                -0.000197892936801441,
                0.0001389865344888035,
                -0.0001013211836423378,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        0.01531433886709083,
        0.00904978330677975,
        0.001355607069878939,
        0.0001319910934412477,
        9.03211902220178e-6,
        4.240657782914123e-7,
        1.012141832282517e-8,
        -3.118760717181667e-10,
        -4.377339879489485e-11,
        -1.683983500733835e-12,
        4.184889259752317e-14,
        8.879031138536022e-15,
        4.287484978015854e-16,
        -7.459983152785002e-18,
        -2.383440174376937e-18,
        -1.359685970745717e-19,
        1.30070368072233e-21,
        7.488962293815891e-22,
        4.911038249948698e-23,
        -9.61119016986186e-26,
        -2.597946930679736e-25,
        -1.930710327722688e-26,
        -1.018398313731405e-28,
        9.62789631252616e-29,
        8.050810157512047e-30,
        9.76919934515347e-32,
        -3.733257482508039e-32,
        -3.50374923990584e-33,
        -6.545160749595975e-35,
        1.496714835212165e-35,
        1.574426216202542e-36,
    ],
    &[
        0.05147066982736906,
        0.02938931850600941,
        0.004113252597565169,
        0.0003513116270155756,
        0.00001829429672253464,
        3.820101848900227e-7,
        -1.978920025157695e-8,
        -1.47660445035842e-9,
        2.670218549930937e-11,
        6.527627140773951e-12,
        7.397341773409431e-14,
        -2.904907798813147e-14,
        -1.289741114657178e-15,
        1.164230801481152e-16,
        1.115813015805797e-17,
        -3.166339535022408e-19,
        -7.902537569024729e-20,
        -7.202316459660734e-22,
        4.855742570167853e-22,
        2.181568070375392e-23,
        -2.49872076206278e-24,
        -2.389693434827059e-25,
        8.805191904668201e-27,
        2.008811621511762e-27,
        1.024108451557289e-29,
        -1.418509103292912e-29,
        -5.983892070899717e-31,
        8.281561166098768e-32,
        7.554815082616783e-33,
        -3.416149435018777e-34,
        -7.019923953528419e-35,
    ],
    &[
        0.1602616654896487,
        0.0844934268323534,
        0.0102250288110555,
        0.0006694732138395032,
        0.00001911956866372863,
        -3.194852088377193e-7,
        -2.441342615570185e-8,
        1.323444222686357e-9,
        5.44534976480032e-11,
        -6.493280913809508e-12,
        -9.06346124379758e-14,
        3.38849009349905e-14,
        -3.780160759089936e-16,
        -1.775773666058697e-16,
        6.862530593663232e-18,
        8.855363662434311e-19,
        -6.68281755296412e-20,
        -3.833399646037185e-21,
        5.46293965536672e-22,
        1.036584310366325e-23,
        -4.040574431243308e-24,
        4.36092963382618e-26,
        2.738848394158994e-26,
        -1.110966225585687e-27,
        -1.67053447780112e-28,
        1.311434233937255e-29,
        8.571824697489512e-31,
        -1.242700635916298e-31,
        -2.801213736405413e-33,
        1.02902283001661e-33,
        -9.58414118867434e-36,
    ],
    &[
        0.4397506846510109,
        0.2030043197990045,
        0.01981750527215857,
        0.000906021149195991,
        0.00001006335275043877,
        -4.50803104571321e-7,
        8.798468079000666e-9,
        4.894739266359456e-10,
        -5.028378240055658e-11,
        1.366445362221096e-12,
        9.37201228797318e-14,
        -1.105564782487052e-14,
        3.277434123701735e-16,
        2.6141419371524e-17,
        -3.2412666256797e-18,
        9.90970595801241e-20,
        8.868980048293034e-21,
        -1.12149758128634e-21,
        3.448259281078072e-23,
        3.40193986535462e-24,
        -4.322365767590169e-25,
        1.317644089061259e-26,
        1.419533693335566e-27,
        -1.797084504000541e-28,
        5.381632030669265e-30,
        6.297768120621056e-31,
        -7.903541862572924e-32,
        2.309613931283465e-33,
        2.927077379729717e-34,
        -3.615707457442342e-35,
        1.029624558022243e-36,
    ],
];

pub const SPLITS: [f64; 5] = [
    -2.594644812654972,
    -1.33447827921994,
    -0.0743117457849072,
    1.185854787650125,
    2.446021321085158,
];
