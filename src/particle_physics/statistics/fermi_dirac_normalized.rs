#![allow(clippy::all)]

pub fn lower(x: f64) -> f64 {
    0.75 - 0.1441585624478373 * x.powi(2) + 0.6220046255340152 * x.powi(4)
}

pub fn upper(x: f64) -> f64 {
    0.41595368629035373 * crate::bessel::k2(x) * x.powi(2)
}

pub const COEFFICIENTS: [&[f64]; 15] = [
    &[
        -0.2876825032435244,
        -7.048182019191448e-7,
        -4.08858705808081e-7,
        -1.795746957307451e-7,
        -6.282021755754395e-8,
        -1.816914622655766e-8,
        -4.466922030558057e-9,
        -9.53482880352936e-10,
        -1.796505711026717e-10,
        -3.027534877660343e-11,
        -4.612737798585407e-12,
        -6.410440868026588e-13,
        -8.186277297113136e-14,
        -9.66575956955986e-15,
        -1.060594099359551e-15,
        -1.085855796657377e-16,
        -1.040176578860932e-17,
        -9.33258999425892e-19,
        -7.828613662092852e-20,
        -6.097169424064085e-21,
        -4.330441493352889e-22,
        -2.677791421402726e-23,
        -1.237326802966944e-24,
        -6.16813780426914e-27,
        8.298066318706759e-27,
        1.439272257602351e-27,
        1.782507411422841e-28,
        1.88556403356203e-29,
        1.784098557270449e-30,
        1.530231055113717e-31,
        1.154375902133019e-32,
    ],
    &[
        -0.2876967092563747,
        -0.00001785280060357589,
        -6.337976886501643e-6,
        -1.567504447458054e-6,
        -2.961892926514389e-7,
        -4.519613193781647e-8,
        -5.777423996800078e-9,
        -6.349039074719769e-10,
        -6.11338318768091e-11,
        -5.231573291754749e-12,
        -4.020697748982964e-13,
        -2.794532049304552e-14,
        -1.761604052626639e-15,
        -1.004017564118878e-16,
        -5.100379766525413e-18,
        -2.216904583155867e-19,
        -7.214699500482338e-21,
        -5.572770786918274e-23,
        1.702944589885072e-23,
        1.952275236788137e-24,
        1.485334609484757e-25,
        9.12756248746526e-27,
        4.641063411744285e-28,
        1.825461257694873e-29,
        3.682813901799474e-31,
        -2.147275364354008e-32,
        -3.356930835277092e-33,
        -2.67636210333704e-34,
        -1.583191110241954e-35,
        -6.970248607115283e-37,
        -1.645621345591931e-38,
    ],
    &[
        -0.288011131004555,
        -0.0004012341045558571,
        -0.0001423383221739575,
        -0.00003515420039879476,
        -6.625862309842795e-6,
        -1.006470425203143e-6,
        -1.276118724952668e-7,
        -1.382015199646707e-8,
        -1.296237607966908e-9,
        -1.057859096317214e-10,
        -7.449288447426075e-12,
        -4.371274508771691e-13,
        -1.897941219076937e-14,
        -2.593651891153579e-16,
        5.827030319434628e-17,
        8.233233935640423e-18,
        7.059852354682267e-19,
        4.459477077194623e-20,
        1.912968135874926e-21,
        1.59736410121772e-23,
        -6.589462271665792e-24,
        -7.609018327935906e-25,
        -4.883870220861864e-26,
        -1.412042479022718e-27,
        1.018405898580854e-28,
        1.869371854451198e-29,
        1.459951932801934e-30,
        4.601841745057339e-32,
        -5.096207002960447e-33,
        -1.093973295620779e-33,
        -1.183310719204892e-34,
    ],
    &[
        -0.2899841193294594,
        -0.001664625908017378,
        -0.0003145693931526081,
        -0.00003996055879493547,
        -3.800149475823301e-6,
        -2.863674826718144e-7,
        -1.7628317531459e-8,
        -8.955923091702942e-10,
        -3.69903207138184e-11,
        -1.15587493520924e-12,
        -1.922411594641216e-14,
        5.895401847040942e-16,
        7.049966096469834e-17,
        3.669906104748873e-18,
        1.256373187641776e-19,
        2.404338937481661e-21,
        -2.658338253050937e-23,
        -4.215631627306362e-24,
        -1.746785620365757e-25,
        -4.279695826802496e-27,
        -1.59468112762492e-28,
        -1.900115918693983e-29,
        -1.878471014910168e-30,
        -1.272623572352267e-31,
        -5.985260977749593e-33,
        -1.600287352217806e-34,
        2.806371059170738e-36,
        6.681803470817845e-37,
        4.922422317841761e-38,
        2.468022702507428e-39,
        8.796305722414256e-41,
    ],
    &[
        -0.2984917419519689,
        -0.00777147563681719,
        -0.001452607082320972,
        -0.000181025953848036,
        -0.00001665466412714502,
        -1.185013347355589e-6,
        -6.58497795351417e-8,
        -2.746388537128637e-9,
        -7.02656901113244e-11,
        5.703862730378463e-13,
        1.854773125072599e-13,
        1.18425706918108e-14,
        4.514467288609698e-16,
        8.145074018943723e-18,
        -3.045452373486232e-19,
        -4.080635770783179e-20,
        -3.009962410969443e-21,
        -2.037190837429127e-22,
        -1.275194809054796e-23,
        -6.318528000800273e-25,
        -1.561631838882799e-26,
        1.004990044878865e-27,
        1.696291183228995e-28,
        1.34572881606655e-29,
        7.193576315511298e-31,
        2.310177476875715e-32,
        -2.142223732084519e-34,
        -9.80166876485748e-35,
        -8.827771912864335e-36,
        -5.443634511086552e-37,
        -2.475687251663432e-38,
    ],
    &[
        -0.3373594038233502,
        -0.03511605060551783,
        -0.006364456089562026,
        -0.0007526928658398117,
        -0.00006333102946603058,
        -3.839525856349039e-6,
        -1.53096766655983e-7,
        -1.832198052914822e-9,
        2.642636700981747e-10,
        2.353029581015388e-11,
        8.968295081429748e-13,
        -1.192454544366105e-14,
        -4.81853577994581e-15,
        -4.499893166981388e-16,
        -2.692413920405913e-17,
        -7.798495796592082e-19,
        5.612833758156011e-20,
        1.096195605814535e-20,
        9.4867022517424e-22,
        4.6339651623998e-23,
        -7.845809657136005e-26,
        -2.662542380890339e-25,
        -2.940526684891487e-26,
        -1.832483923544774e-27,
        -4.422108926010238e-29,
        5.132684009569628e-30,
        8.292569584879006e-31,
        6.596653716146272e-32,
        2.888123819041555e-33,
        -4.458601610226167e-35,
        -2.140636879086679e-35,
    ],
    &[
        -0.5039213327283299,
        -0.1464973115844244,
        -0.02463873781668362,
        -0.00256883036760435,
        -0.000172339641418532,
        -6.312239155328129e-6,
        4.437121823851752e-8,
        1.723111564687417e-8,
        1.593948330176392e-10,
        -1.289616804782773e-10,
        -1.351754791302355e-11,
        -3.651389864567111e-13,
        6.708653224878432e-14,
        9.80321418866865e-15,
        4.732311273940132e-16,
        -3.204378071430194e-17,
        -7.352797582810842e-18,
        -4.978514323764869e-19,
        1.101309332871148e-20,
        5.473543109517221e-21,
        4.801291847043028e-22,
        2.540242807669449e-24,
        -3.984626816465883e-24,
        -4.461253141307206e-25,
        -1.180300953481982e-26,
        2.765601649147776e-27,
        4.038036539086775e-28,
        1.819562764802593e-29,
        -1.739220594434131e-30,
        -3.545435449246629e-31,
        -2.240098205104578e-32,
    ],
    &[
        -0.8519191292761026,
        -0.1879776042860951,
        -0.01448834031932437,
        -0.0006405848325927775,
        -0.0000156456770081355,
        -1.230970975362372e-7,
        -5.984480365033498e-11,
        -3.781224694723397e-10,
        -2.010079098305091e-11,
        2.382187139046066e-13,
        5.795184404580456e-14,
        1.277562348530994e-15,
        -1.096965912630461e-16,
        -7.0578054079575e-18,
        6.071422773658602e-20,
        2.120432213804991e-20,
        5.215474314856852e-22,
        -4.272837323242714e-23,
        -2.876472131906645e-24,
        3.015020126705327e-26,
        9.4376292441436e-27,
        2.227651286148255e-28,
        -2.08146945667672e-29,
        -1.368497972279483e-30,
        1.697996377352379e-32,
        4.739169430224639e-33,
        1.085587727396398e-34,
        -1.087088684046071e-35,
        -7.04351305796695e-37,
        9.73062907277081e-39,
        2.519367792206798e-39,
    ],
    &[
        -1.371264475843509,
        -0.3390979636963437,
        -0.02377127144635266,
        -0.000915331627138386,
        -0.00001926124770489779,
        -2.999569731274588e-7,
        -1.51689432837168e-8,
        -4.581919663564213e-10,
        2.332519495107341e-11,
        1.407196564017703e-12,
        -5.156401137408755e-14,
        -4.738233504993381e-15,
        8.093061475113093e-17,
        1.390058905340049e-17,
        -9.70427468409252e-20,
        -4.008079944245507e-20,
        5.324371359192274e-23,
        1.239193853731624e-22,
        5.948304780133072e-25,
        -4.016643144561433e-25,
        -5.327876888998538e-27,
        1.281692791724378e-27,
        2.958909202031085e-29,
        -3.947797657465802e-30,
        -1.332438182245519e-31,
        1.189762398732573e-32,
        5.45092216517272e-34,
        -3.534421596974366e-35,
        -2.14113014382382e-36,
        1.017229933805336e-37,
        8.20324083578535e-39,
    ],
    &[
        -2.278501504770076,
        -0.5790415790976057,
        -0.0368737385884601,
        -0.00129373386745961,
        -0.00002938276543277588,
        -7.085969021462464e-7,
        -1.442767656302825e-8,
        4.436688076544341e-10,
        1.092862359180928e-11,
        -1.977318341846434e-12,
        -3.478212264680575e-14,
        5.29489042015279e-15,
        7.163314434433209e-17,
        -1.169494409304908e-17,
        2.043200255521581e-20,
        2.198733155201697e-20,
        -1.07345730563277e-21,
        -4.144610561136468e-23,
        5.979785705347797e-24,
        9.07163737471981e-26,
        -2.201083199958606e-26,
        -1.379585826237817e-28,
        6.374408119655942e-29,
        -5.145083137038654e-31,
        -1.585389092894873e-31,
        5.904559360264636e-33,
        3.595551950750627e-34,
        -3.179633901483635e-35,
        -7.103600599549657e-37,
        1.267310220095264e-37,
        6.362898276874595e-40,
    ],
    &[
        -3.787152180938235,
        -0.945301233674805,
        -0.05573651257318324,
        -0.001891959292934123,
        -0.00004608456168144367,
        -9.30438963527578e-7,
        -7.138427198803578e-9,
        -1.782367330324324e-10,
        -3.409351680634462e-11,
        4.426263351938885e-13,
        9.968426520962e-14,
        -1.874841616907696e-15,
        -2.555501091172135e-16,
        2.044862843582552e-18,
        5.027540212332243e-19,
        1.542595703477737e-20,
        -4.434821348268936e-22,
        -1.108798346502625e-22,
        -2.127454312932365e-24,
        4.158045014154053e-25,
        1.499847800079863e-26,
        -9.81252526962966e-28,
        -5.784228242624675e-29,
        8.134055527353132e-31,
        1.622733697275749e-31,
        5.395741932929784e-33,
        -3.24848829589347e-34,
        -3.487699053589093e-35,
        2.626686576009731e-37,
        1.263557017052026e-37,
        1.585076330306252e-39,
    ],
    &[
        -6.205369547447793,
        -1.496033220730775,
        -0.08351750520475856,
        -0.002791001900889192,
        -0.00006730811120459564,
        -1.250035873382614e-6,
        -2.131545818282404e-8,
        -5.716106678091691e-10,
        1.080444222509154e-11,
        6.751219190491534e-13,
        -8.359168821177502e-14,
        -1.023691048995308e-15,
        3.241991512015798e-16,
        1.621008302432205e-18,
        -1.133398335966069e-18,
        -1.249647327962875e-20,
        3.943169232382089e-21,
        9.22996312479994e-23,
        -1.340997135592521e-23,
        -4.938981740989033e-25,
        4.186444825152192e-26,
        2.147590863114465e-27,
        -1.144215033230896e-28,
        -8.068479547682629e-30,
        2.696030823835927e-31,
        2.692419556805952e-32,
        -5.783933001892372e-34,
        -8.178931554944643e-35,
        1.427827833027748e-36,
        2.375359341848927e-37,
        -5.248898624020414e-39,
    ],
    &[
        -9.98593810642611,
        -2.31855362531986,
        -0.1243991503709493,
        -0.004100397228161503,
        -0.0000985015543551406,
        -1.912940523660777e-6,
        -3.278752590507159e-8,
        -3.474053800760674e-10,
        -4.602412022994138e-12,
        -5.949768057405413e-13,
        3.248402039365854e-14,
        9.04002132133134e-16,
        -2.056300608212933e-16,
        3.604662704408082e-18,
        8.243187546484379e-19,
        -3.667384432677828e-20,
        -2.810061773806194e-21,
        1.986773080821741e-22,
        9.001586047802177e-24,
        -8.748740275093391e-25,
        -2.840519186961089e-26,
        3.375980306486678e-27,
        9.21409829914214e-29,
        -1.15298600030599e-29,
        -3.178648227944787e-31,
        3.410297633063013e-32,
        1.157604317683979e-33,
        -8.075450870617852e-35,
        -4.248424076105624e-36,
        1.066993036845695e-37,
        1.49354920352649e-38,
    ],
    &[
        -15.79506876705246,
        -3.54056201197536,
        -0.1844712365334338,
        -0.006029021359090311,
        -0.0001455557055998811,
        -2.844535057103164e-6,
        -4.617508272633223e-8,
        -6.261614957552498e-10,
        -9.12231115417388e-12,
        2.207754744280809e-14,
        -5.215117240306766e-15,
        -2.26124933482068e-16,
        4.854301729764904e-17,
        -2.742489159010036e-18,
        -7.928997676572021e-20,
        2.030889061639949e-20,
        -7.26873410921454e-22,
        -6.881866222788877e-23,
        6.669842390422406e-24,
        7.703471894161977e-26,
        -3.410073450468872e-26,
        6.516791943464167e-28,
        1.355580616343458e-28,
        -5.780980346509555e-30,
        -4.684854176994948e-31,
        3.100034601506501e-32,
        1.524449102002576e-33,
        -1.376391875824569e-34,
        -5.034162979995781e-36,
        5.531608000464842e-37,
        1.773758296605908e-38,
    ],
    &[
        -24.61212828776792,
        -5.350062987708649,
        -0.2728830027122798,
        -0.00887981028718274,
        -0.0002151212935880703,
        -4.196832129277183e-6,
        -6.79572489008593e-8,
        -9.43149914119222e-10,
        -1.154199053155294e-11,
        -1.21756754820108e-13,
        -1.472795981411951e-15,
        2.29310247006494e-17,
        -3.552858135932911e-18,
        2.542099405304522e-19,
        -8.622194642292521e-21,
        -7.470815172942865e-22,
        1.399591702738314e-22,
        -9.0819452366437e-24,
        -5.733948667305263e-26,
        6.036967189399657e-26,
        -4.252410309672604e-27,
        -5.282527142334573e-29,
        2.732684073559352e-29,
        -1.309653404332131e-30,
        -7.621021962758483e-32,
        1.060557325293118e-32,
        -8.699452225344353e-35,
        -4.959567340517442e-35,
        2.292842149284469e-36,
        1.599318337763932e-37,
        -1.583907666848017e-38,
    ],
];

pub const SPLITS: [f64; 16] = [
    -8.900003194573971,
    -5.786324737388024,
    -4.229485508795051,
    -2.672646280202077,
    -1.894226665905591,
    -1.115807051609104,
    -0.3373874373126173,
    0.4410321769838694,
    0.8302419841321127,
    1.219451791280356,
    1.608661598428599,
    1.997871405576843,
    2.387081212725086,
    2.776291019873329,
    3.165500827021573,
    3.554710634169816,
];
