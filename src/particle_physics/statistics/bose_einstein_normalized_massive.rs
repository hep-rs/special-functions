#![allow(clippy::all)]

pub fn lower(x: f64) -> f64 {
    if x == 0.0 {
        1.0
    } else {
        1.0 + x.powi(2) * (140851.7797811005 + 3058.524274061134 * x.ln())
    }
}

pub fn upper(x: f64) -> f64 {
    0.41595368629035373 * crate::bessel::k2(x) * x.powi(2)
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        0.999999999481574,
        -9.96157584385139e-10,
        -8.836504830750655e-10,
        -7.243016358904922e-10,
        -5.492806752381048e-10,
        -3.860327992822741e-10,
        -2.51917636836861e-10,
        -1.529810671129016e-10,
        -8.664759115557302e-11,
        -4.588109778531008e-11,
        -2.276603045780287e-11,
        -1.060997292629778e-11,
        -4.6545418360211e-12,
        -1.926157836319399e-12,
        -7.533940281662454e-13,
        -2.79043314042059e-13,
        -9.80347271504882e-14,
        -3.272038577148588e-14,
        -1.038926867485021e-14,
        -3.141941172031713e-15,
        -9.05916008028407e-16,
        -2.49220856297692e-16,
        -6.544826571060516e-17,
        -1.640941158635338e-17,
        -3.926834345929112e-18,
        -8.961099808531593e-19,
        -1.946660562000281e-19,
        -4.01329528735444e-20,
        -7.815303880164815e-21,
        -1.457545026682342e-21,
        -2.381287650816652e-22,
    ],
    &[
        0.999762497499741,
        -0.0004343570714222406,
        -0.0003332096745832701,
        -0.0002162127880881909,
        -0.0001199174519083809,
        -0.00005745413336104372,
        -0.00002400491713288588,
        -8.812338920340335e-6,
        -2.856662837381007e-6,
        -8.189516417706089e-7,
        -2.068279945873991e-7,
        -4.538303299951543e-8,
        -8.333928110219295e-9,
        -1.138867326243224e-9,
        -5.086544752879457e-11,
        3.455404028771075e-11,
        1.616126774936491e-11,
        4.797629181128537e-12,
        1.157835160370106e-12,
        2.415628734470336e-13,
        4.419095143594673e-14,
        6.956173608577357e-15,
        8.639420077019005e-16,
        5.164916206938775e-17,
        -1.418219505129894e-17,
        -7.302766166143243e-18,
        -2.190226004867179e-18,
        -5.408508110812534e-19,
        -1.190870194121528e-19,
        -2.472010365378514e-20,
        -4.452130696916685e-21,
    ],
    &[
        0.911002017892115,
        -0.1368776568063763,
        -0.06702535541179129,
        -0.02161648076216943,
        -0.004179594335094545,
        -0.0001058888415481839,
        0.0002497641723969014,
        0.0001028904658548102,
        0.00002348269402572336,
        2.764010833259287e-6,
        -2.83223956618331e-7,
        -2.520696063627512e-7,
        -7.785608862337624e-8,
        -1.581562310444246e-8,
        -1.941556683729582e-9,
        6.149488046776075e-11,
        1.177288098275992e-10,
        4.098593860439596e-11,
        9.69130555115243e-12,
        1.677807477584504e-12,
        1.683817822367098e-13,
        -1.697051285663957e-14,
        -1.468144112141131e-14,
        -4.832759178250141e-15,
        -1.153927020715435e-15,
        -2.116400792289744e-16,
        -2.578419663215801e-17,
        3.648228726269623e-19,
        1.427815763501091e-18,
        5.72446170789159e-19,
        1.433883516406893e-19,
    ],
    &[
        0.3144039674388048,
        -0.3501463382560406,
        0.03697670739859352,
        0.0197918260250925,
        -0.001410080490740529,
        -0.001383336194126347,
        -0.00007907605786531532,
        0.00006972190348906381,
        0.00001532623367654417,
        -1.22833137523339e-6,
        -1.030804570195322e-6,
        -1.25846030788635e-7,
        2.859715606854845e-8,
        1.178822597441822e-8,
        8.941693865794931e-10,
        -3.950932650160672e-10,
        -1.206003544570502e-10,
        -5.097357662945179e-12,
        4.637555379556123e-12,
        1.142186903296677e-12,
        8.143221586785464e-15,
        -5.070827114688384e-14,
        -1.003520388032985e-14,
        4.155074951061322e-16,
        5.354843050511835e-16,
        8.043862956723505e-17,
        -9.78761441256834e-18,
        -5.52689687898482e-18,
        -5.592269846475301e-19,
        1.608108481378095e-19,
        5.557212831664274e-20,
    ],
    &[
        0.004842939723839797,
        -0.007767733952570758,
        0.004035315977944235,
        -0.001335017897840459,
        0.0002511976346761162,
        -0.00001115774777391887,
        -5.979673427386104e-6,
        1.100673714444647e-6,
        5.784753230679543e-8,
        -3.36344851325273e-8,
        5.121223085686738e-10,
        7.791151785662913e-10,
        -3.571928439749431e-11,
        -1.599661646206603e-11,
        9.07435010501928e-13,
        3.070875011975143e-13,
        -1.531094397443949e-14,
        -5.553469202739219e-15,
        1.504090722354737e-16,
        9.25063128290306e-17,
        8.629233449497524e-19,
        -1.353473978679649e-18,
        -8.344483707742177e-20,
        1.582634274556777e-20,
        2.395029650193985e-21,
        -1.060285636152124e-22,
        -4.854385642716995e-23,
        -1.008336812831642e-24,
        7.745379192313792e-25,
        5.19471980184351e-26,
        -9.83871675033307e-27,
    ],
    &[
        2.563587546121401e-6,
        -4.237841244699919e-6,
        2.452609657006519e-6,
        -1.02773001172888e-6,
        3.194960009733344e-7,
        -7.440825712610021e-8,
        1.284507049881978e-8,
        -1.563796091620828e-9,
        1.120789465270837e-10,
        1.991081745511001e-13,
        -1.039977680404853e-12,
        1.001786990683449e-13,
        -1.873634412329354e-17,
        -7.760892316307746e-16,
        4.97289323637943e-17,
        2.75054635499974e-18,
        -4.711119386078801e-19,
        1.487196064363078e-21,
        2.932610099141127e-21,
        -9.84256484497118e-23,
        -1.490187099532304e-23,
        8.91143058488987e-25,
        6.780982292259531e-26,
        -5.863174923358559e-27,
        -2.943436409170376e-28,
        3.304196382005359e-29,
        1.28924880741305e-30,
        -1.680635273225483e-31,
        -5.970191296755279e-33,
        7.819222875464145e-34,
        2.970282312110654e-35,
    ],
    &[
        1.34391196821076e-9,
        -2.394888310798245e-9,
        1.700788326164019e-9,
        -9.7158591657593e-10,
        4.512195041467913e-10,
        -1.719714201810104e-10,
        5.414744496249433e-11,
        -1.412425340386166e-11,
        3.044673667261656e-12,
        -5.367174271500911e-13,
        7.545026019803743e-14,
        -7.965734866833688e-15,
        5.225675697634748e-16,
        1.840860908539732e-18,
        -5.177743208558256e-18,
        6.032949740089202e-19,
        -2.038845795692396e-20,
        -3.053907665538756e-21,
        4.394444719667962e-22,
        -1.200543911752602e-23,
        -2.442408853621126e-24,
        2.547968383437663e-25,
        1.656532287788863e-27,
        -1.869421365995132e-27,
        8.549669196176722e-29,
        8.339451751489327e-30,
        -9.10359266192448e-31,
        -1.710705909666988e-32,
        6.223186901880776e-33,
        -9.43486227170097e-35,
        -3.404708480820819e-35,
    ],
];

pub const SPLITS: [f64; 8] = [
    -23.59061151107701,
    -10.0179504384536,
    -3.23161990214189,
    0.1615453660139632,
    1.85812800009189,
    2.706419317130853,
    3.130564975650334,
    3.554710634169816,
];
