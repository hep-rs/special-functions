#![allow(clippy::all)]

pub fn lower(x: f64) -> f64 {
    if x == 0.0 {
        1.0
    } else {
        1.0 + x.powi(2) * (-0.2481469840204258 + 0.2079768431451769 * x.ln())
    }
}

pub fn upper(x: f64) -> f64 {
    0.41595368629035373 * crate::bessel::k2(x) * x.powi(2)
}

pub const COEFFICIENTS: [&[f64]; 15] = [
    &[
        -8.300642194022464e-7,
        -9.42355953681271e-7,
        -3.028777697093985e-7,
        -6.70039364527073e-8,
        -1.123196394031636e-8,
        -1.509454430379584e-9,
        -1.686922666749777e-10,
        -1.607948025018773e-11,
        -1.331125640800312e-12,
        -9.69663884690551e-14,
        -6.272869950185366e-15,
        -3.624359906440409e-16,
        -1.874070087542951e-17,
        -8.647277587999908e-19,
        -3.521647677556579e-20,
        -1.230810019363746e-21,
        -3.417018974936153e-23,
        -5.394233841241763e-25,
        1.409377281230637e-26,
        1.793195453526475e-27,
        1.023025890715174e-28,
        4.29834872972517e-30,
        1.37217869327098e-31,
        2.64758913952591e-33,
        -4.315196956747208e-35,
        -7.885828184273108e-36,
        -5.171777816454064e-37,
        -2.50942681587178e-38,
        -9.82078170017864e-40,
        -2.985217793096117e-41,
        -5.193015836727894e-43,
    ],
    &[
        -0.00001305275430110229,
        -0.0000146911962084975,
        -4.661450833918322e-6,
        -1.01495700143933e-6,
        -1.669224126071059e-7,
        -2.19247928691791e-8,
        -2.383221136213286e-9,
        -2.195419710794638e-10,
        -1.741171045418936e-11,
        -1.200096631792997e-12,
        -7.210573411644987e-14,
        -3.756739478009928e-15,
        -1.663400259562803e-16,
        -5.912095943668865e-18,
        -1.369597522481538e-19,
        9.66183907429034e-22,
        3.345731731896973e-22,
        2.265178451373588e-23,
        9.81742572838352e-25,
        2.420807886453705e-26,
        -4.321420950680558e-28,
        -9.69032143113827e-29,
        -7.141173851462093e-30,
        -3.66876067810572e-31,
        -1.358732374110582e-32,
        -2.538406859765623e-34,
        1.16857320458996e-35,
        1.607585838798893e-36,
        1.073655583767538e-37,
        5.148733998262227e-39,
        1.724487705986775e-40,
    ],
    &[
        -0.0001956041302099107,
        -0.00021720309517055,
        -0.00006750834734135757,
        -0.00001431564806039869,
        -2.277887718515811e-6,
        -2.870041100669389e-7,
        -2.957609724324451e-8,
        -2.539498814081931e-9,
        -1.829398086191466e-10,
        -1.097862045543017e-11,
        -5.313974043074881e-13,
        -1.868480542740048e-14,
        -2.647577000431203e-16,
        2.179579998813504e-17,
        2.077690240127712e-18,
        8.041981905075087e-20,
        -1.11534244233739e-21,
        -4.251214572367711e-22,
        -3.659102433946118e-23,
        -1.933417038157195e-24,
        -5.221553894300597e-26,
        1.879456814579e-27,
        3.554171196101726e-28,
        2.639035300427018e-29,
        1.212043486948127e-30,
        2.109898042428997e-32,
        -2.188040389315342e-33,
        -2.691077604829641e-34,
        -1.677230797852885e-35,
        -5.799679987203831e-37,
        6.135684671639313e-39,
    ],
    &[
        -0.002711284483272978,
        -0.002940751648476253,
        -0.0008807539908507104,
        -0.000177764264529074,
        -0.00002650793254803793,
        -3.063258999941918e-6,
        -2.804375730112893e-7,
        -2.034051163070435e-8,
        -1.134185894405011e-9,
        -4.405040350423781e-11,
        -7.964359790377454e-13,
        1.494251417492188e-14,
        -1.367866450659705e-15,
        -5.174082582073499e-16,
        -5.444961153933074e-17,
        -2.941234164040941e-18,
        -1.188055811776908e-20,
        1.39010042027518e-20,
        1.425081669182486e-21,
        7.090919943760671e-23,
        1.759036976625552e-25,
        -2.809977237881906e-25,
        -2.285819517976241e-26,
        -4.640605250544128e-28,
        8.292916873602272e-29,
        1.022191263509218e-29,
        5.033866739096815e-31,
        -8.736703906619927e-33,
        -3.668709897138871e-33,
        -3.15415650262354e-34,
        -1.180195122484079e-35,
    ],
    &[
        -0.01390398025976789,
        -0.008292125161586734,
        -0.001240952038958044,
        -0.0001203157864173927,
        -8.353721098127263e-6,
        -4.341442967541868e-7,
        -1.710335917516724e-8,
        -5.061757767114906e-10,
        -1.131138906660681e-11,
        -2.459989070889961e-13,
        -9.88402017864952e-15,
        -4.927072267264753e-16,
        -1.501858298144542e-17,
        3.673423298953431e-20,
        2.912733760638509e-20,
        1.541565403704066e-21,
        3.972031846076764e-23,
        2.128717172806892e-25,
        -1.491606554249467e-26,
        2.186685739372276e-28,
        4.981944605610517e-29,
        9.07028101201233e-31,
        -1.277090319199601e-31,
        -1.15025583273741e-32,
        -4.795008211180039e-34,
        -9.35793880619346e-36,
        1.075689843813698e-37,
        1.169885349299833e-38,
        2.175326287886518e-40,
        -1.140904942644069e-42,
        4.840302672509352e-43,
    ],
    &[
        -0.04713467518894278,
        -0.02709929605290867,
        -0.003860717645285529,
        -0.0003514371418629096,
        -0.00002254944605246894,
        -1.06776240056469e-6,
        -3.851566149279755e-8,
        -1.138187868095317e-9,
        -3.378956368132991e-11,
        -1.177248913883629e-12,
        -3.294659962050749e-14,
        2.433607122232374e-16,
        9.3635892954871e-17,
        5.744709915591361e-18,
        2.01133605777572e-19,
        4.023877234153809e-21,
        -3.400661132595223e-24,
        -6.808867134821456e-24,
        -7.213674837035393e-25,
        -5.560094399680886e-26,
        -3.080190596882962e-27,
        -1.14473790033589e-28,
        -1.922642095289811e-30,
        9.38414968180937e-32,
        1.146066802576608e-32,
        7.754926462295998e-34,
        4.327312249433593e-35,
        2.008170865659153e-36,
        6.682369803849561e-38,
        5.51339164679027e-40,
        -1.245083861264877e-40,
    ],
    &[
        -0.1512177865489444,
        -0.08300146668465369,
        -0.01114626363233245,
        -0.000946900959529355,
        -0.00005655257928544675,
        -2.542225898331612e-6,
        -9.29548980025116e-8,
        -2.993904429084547e-9,
        -7.44674226128914e-11,
        5.832502990870094e-13,
        2.395759926402813e-13,
        1.674085362488193e-14,
        6.147780638712291e-16,
        1.068705759642292e-18,
        -1.794221153446055e-18,
        -1.723864374896201e-19,
        -1.069379002770987e-20,
        -4.385360859196008e-22,
        -3.964422339298358e-24,
        1.235222646814676e-24,
        1.369824548012601e-25,
        9.08632824076126e-27,
        4.047373748496551e-28,
        6.952741197825007e-30,
        -8.245207430026519e-31,
        -1.108276433185807e-31,
        -8.182223709954276e-33,
        -4.123278100419111e-34,
        -1.079377250766189e-35,
        4.899582221958748e-37,
        9.1528390888372e-38,
    ],
    &[
        -0.4563702785100718,
        -0.2378142239714867,
        -0.03009568988722393,
        -0.002411825741852933,
        -0.0001374280619462558,
        -5.920091266307859e-6,
        -1.837690980841805e-7,
        -1.473318089650253e-9,
        3.20650256505962e-10,
        2.360427751896385e-11,
        1.974722523396663e-13,
        -1.104382179615515e-13,
        -1.181633305404709e-14,
        -5.878893829314697e-16,
        4.440410043147226e-18,
        3.731236069788358e-18,
        3.67445499369449e-19,
        1.767363823623431e-20,
        -2.292450071400693e-22,
        -1.272104715938032e-22,
        -1.240263258316914e-23,
        -5.984305601331531e-25,
        8.07151092601569e-27,
        4.433155028055893e-27,
        4.375055051397408e-28,
        2.150186310917803e-29,
        -2.6324684830103e-31,
        -1.587223570292541e-31,
        -1.593683657858888e-32,
        -7.93352770142407e-34,
        8.559134192334864e-36,
    ],
    &[
        -1.297688038779626,
        -0.6422403989311667,
        -0.0768853906068981,
        -0.005783401516610714,
        -0.000295139282867759,
        -9.27521766482218e-6,
        -5.336753131894452e-8,
        3.65705262525455e-9,
        -1.305038557984661e-9,
        -1.764359442827234e-10,
        -3.742426154130236e-12,
        1.185348114423422e-12,
        1.311978644978596e-13,
        9.08236883560135e-16,
        -1.077539965256575e-15,
        -1.04145627327864e-16,
        2.142953466811183e-19,
        9.49290955890585e-19,
        8.440974587349877e-20,
        -8.301320694588026e-22,
        -8.358095776958794e-22,
        -6.87777674872585e-23,
        1.302118554782117e-24,
        7.451179522848829e-25,
        5.610714860172799e-26,
        -1.724149345692043e-27,
        -6.758070668307313e-28,
        -4.583547612636685e-29,
        2.103017016468247e-30,
        6.20254451659315e-31,
        3.746733474395591e-32,
    ],
    &[
        -2.62625683454278,
        -0.6386837012465913,
        -0.03657154684481044,
        -0.001270632080075693,
        -0.0000280370220782613,
        -3.979449073470845e-7,
        -8.797198827976358e-9,
        -4.076284889202894e-10,
        -6.816465332266017e-13,
        8.833899771228045e-13,
        1.352983596984585e-14,
        -2.367316111457952e-15,
        -9.13004728369084e-17,
        4.743514910558944e-18,
        3.737092859552257e-19,
        -4.385159664898077e-21,
        -1.147914444650844e-21,
        -1.521168911351031e-23,
        2.784909277638538e-24,
        1.04249746671201e-25,
        -5.287159536437809e-27,
        -3.949087705828087e-28,
        6.511221198302854e-30,
        1.22645658170045e-30,
        5.380251561025996e-33,
        -3.420195758970003e-33,
        -8.245202573890193e-35,
        8.48224606166911e-36,
        4.187963095411404e-37,
        -1.679809062619155e-38,
        -1.619233055933294e-39,
    ],
    &[
        -4.250320517271908,
        -1.00057004298336,
        -0.05482038924799158,
        -0.0017979244397873,
        -0.00003892463426306192,
        -7.211127413626651e-7,
        -1.632575963004699e-8,
        -4.382677515333255e-11,
        1.381352908988335e-11,
        -5.896421296963718e-13,
        -5.155439414364252e-14,
        2.037789823370495e-15,
        1.750936533345385e-16,
        -5.877948965833694e-18,
        -5.780666005257025e-19,
        1.390166247244812e-20,
        1.753909425486575e-21,
        -2.700594324068383e-23,
        -4.738859675275909e-24,
        5.026694351232995e-26,
        1.133114824959828e-26,
        -1.540265648546461e-28,
        -2.501743309536632e-29,
        7.705805141750245e-31,
        5.851484588104252e-32,
        -3.686117353808205e-33,
        -1.711824969070823e-34,
        1.464755857273563e-35,
        5.976860431443008e-37,
        -4.929141703170445e-38,
        -2.081148314980477e-39,
    ],
    &[
        -6.766627819338727,
        -1.537255028087557,
        -0.08067686009521011,
        -0.002557247698524944,
        -0.00005722196884179275,
        -1.105438681976031e-6,
        -1.594060800925984e-8,
        -8.506181165108465e-11,
        -1.309273663056174e-11,
        -1.41229441497856e-13,
        4.852022131227363e-14,
        -8.246933214029951e-16,
        -1.70810951675919e-16,
        5.667188513717535e-18,
        5.294404759820787e-19,
        -2.28723006446428e-20,
        -1.532081589551542e-21,
        6.927273752490832e-23,
        4.204288851850428e-24,
        -1.526744179524183e-25,
        -1.075017630282083e-26,
        1.469994581381349e-28,
        2.408964527122043e-29,
        7.157699601224663e-31,
        -3.991172143796877e-32,
        -5.399596177481716e-33,
        9.41244548664348e-36,
        2.277514229706801e-35,
        2.810302306104801e-37,
        -7.388492690159865e-38,
        -1.513409492950923e-39,
    ],
    &[
        -10.59591193536198,
        -2.322804847068378,
        -0.1176582429199066,
        -0.003672072893243742,
        -0.00008357636006120391,
        -1.558792911891285e-6,
        -2.314056366655562e-8,
        -3.645434029942852e-10,
        -2.765127314880669e-12,
        1.834705924244182e-13,
        -2.063356311741219e-14,
        1.244434924971994e-16,
        8.843758751623486e-17,
        -4.314241997188757e-18,
        -2.228220426757767e-19,
        2.407074215909234e-20,
        2.90833635513317e-22,
        -9.55197318664844e-23,
        3.258148490560248e-25,
        3.308038038010654e-25,
        -3.166783250894257e-27,
        -1.103727378037277e-27,
        1.017282150881591e-29,
        3.700400936374636e-30,
        -1.764447614748677e-32,
        -1.235204948052475e-32,
        -1.184940162549744e-35,
        3.962236193505368e-35,
        2.515823055570289e-37,
        -1.174772650909473e-37,
        -1.306435874974294e-39,
    ],
    &[
        -16.34006925874432,
        -3.465646309699478,
        -0.1708828398657565,
        -0.005292496682540255,
        -0.0001211757999578864,
        -2.24512690248972e-6,
        -3.445555475109924e-8,
        -4.57007690066232e-10,
        -4.640965665549524e-12,
        -1.094848469515273e-13,
        2.400759200350291e-15,
        2.533739640270635e-17,
        -1.956202770273176e-17,
        1.459126989833582e-18,
        -3.4398078824472e-21,
        -7.206334190598174e-21,
        4.286913436748976e-22,
        1.246201650562043e-23,
        -2.516159497550798e-24,
        4.312210733471319e-26,
        9.37625960217191e-27,
        -4.626850208466622e-28,
        -2.635074073596163e-29,
        2.451130149557648e-30,
        5.529925578434399e-32,
        -1.031163722640408e-32,
        -6.151857478077291e-35,
        3.845387974713455e-35,
        -1.429873489599711e-37,
        -1.327609506742399e-37,
        1.168535772959507e-39,
    ],
    &[
        -24.86525267859183,
        -5.123436157791071,
        -0.2476657054727948,
        -0.007640153400552978,
        -0.0001754842820853694,
        -3.245491482416712e-6,
        -4.982073565765511e-8,
        -6.555904922065301e-10,
        -7.593994304222867e-12,
        -7.790519105783912e-14,
        -5.907090782956875e-16,
        -2.238905366299202e-17,
        1.604492127083888e-18,
        -1.216480423942664e-19,
        4.65195786000524e-21,
        2.297340814589629e-22,
        -5.271371055263771e-23,
        3.707684930887002e-24,
        -2.366479790055481e-26,
        -1.866830810384493e-26,
        1.498249433714636e-27,
        -3.024046542528623e-30,
        -7.454946322328041e-30,
        4.368389006348926e-31,
        1.351088960399367e-32,
        -2.714669262219994e-33,
        5.579217784726103e-35,
        1.009138502098728e-35,
        -6.168723843455325e-37,
        -2.337654230586076e-38,
        3.347431942899678e-39,
    ],
];

pub const SPLITS: [f64; 16] = [
    -8.252342201891606,
    -6.776460597383929,
    -5.300578992876251,
    -3.824697388368573,
    -2.348815783860895,
    -1.610874981607056,
    -0.8729341793532173,
    -0.1349933770993784,
    0.6029474251544605,
    1.340888227408299,
    1.709858628535219,
    2.078829029662138,
    2.447799430789058,
    2.816769831915977,
    3.185740233042897,
    3.554710634169816,
];
