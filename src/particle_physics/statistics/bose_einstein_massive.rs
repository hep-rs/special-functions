#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    x.powi(-3)
        * (0.12179382823357308 + x.powi(2) * (1.137582358122433e20 + 1.682654393508201e18 * x.ln()))
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.0,
                0.06349363593424097,
                0.1190505673767018,
                0.05208462322730705,
                -0.01953173371024014,
                0.02014210038868515,
                -0.03273091313161336,
                0.07159887247540423,
                -0.195618348013158,
                0.6388161677304691,
                -2.422177969311362,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 6] = [
    &[
        88.16553246790225,
        -34.19430212537781,
        -3.72978705482978e-17,
        -3.325348510704102e-17,
        -2.832707219251117e-17,
        -2.306343369865524e-17,
        -1.795506726759287e-17,
        -1.337233234574522e-17,
        -9.53300876281154e-18,
        -6.509183754411225e-18,
        -4.259798391418435e-18,
        -2.67378845801357e-18,
        -1.61088099331172e-18,
        -9.32247136785104e-19,
        -5.186438162685175e-19,
        -2.776009268217822e-19,
        -1.430639710512002e-19,
        -7.104609733547881e-20,
        -3.402441035507535e-20,
        -1.572593756926631e-20,
        -7.020161395761027e-21,
        -3.029033695291968e-21,
        -1.264157819246195e-21,
        -5.106737737911675e-22,
        -1.998143383121661e-22,
        -7.577742511493915e-23,
        -2.787373416415796e-23,
        -9.95887631806141e-24,
        -3.485001600718818e-24,
        -1.281750554907796e-24,
        -3.799319373569934e-25,
    ],
    &[
        36.87407917946908,
        -17.09715125387406,
        -1.652623334197939e-7,
        -1.29835352906124e-7,
        -9.29105652956541e-8,
        -6.07290789841278e-8,
        -3.637117745004865e-8,
        -2.002624475521405e-8,
        -1.017168403122641e-8,
        -4.781613084448409e-9,
        -2.086950574287689e-9,
        -8.481614026261359e-10,
        -3.21832987943294e-10,
        -1.14286056436473e-10,
        -3.805765736089221e-11,
        -1.190368494477191e-11,
        -3.501175763646795e-12,
        -9.68930062242499e-13,
        -2.522567443538938e-13,
        -6.170671645775327e-14,
        -1.414282849705387e-14,
        -3.020570593562017e-15,
        -5.950375122621857e-16,
        -1.059520286215411e-16,
        -1.628943650572927e-17,
        -1.882269147287392e-18,
        -4.79991268240161e-20,
        5.969164476771382e-20,
        2.49955753716448e-20,
        7.468888784497059e-21,
        1.701619564974457e-21,
    ],
    &[
        11.22383620261924,
        -8.556630320819893,
        -0.005751005852991896,
        -0.003336713406218029,
        -0.001598370896683436,
        -0.0006405488467427927,
        -0.0002165923232398621,
        -0.00006192143600141334,
        -0.00001485351839418079,
        -2.91480296308788e-6,
        -4.370313533618724e-7,
        -3.941056107155047e-8,
        1.302921109975389e-9,
        1.022525071841177e-9,
        2.49130995561661e-11,
        -8.532085254290018e-11,
        -3.59685670117789e-11,
        -8.406623761446385e-12,
        -1.013063206522058e-12,
        1.036962143758156e-13,
        9.22616233158009e-14,
        2.702840787417987e-14,
        4.608792446913249e-15,
        2.083633484461633e-16,
        -1.562468233708637e-16,
        -6.011489429756127e-17,
        -1.121013226424884e-17,
        -4.234599982624083e-19,
        4.832505862363876e-19,
        1.923447878843142e-19,
        3.807516412578324e-20,
    ],
    &[
        -2.145887132896626,
        -5.058895598998775,
        -0.3387155401208638,
        -0.099553439079216,
        -0.02136023431021293,
        -0.003501281130153712,
        -0.0004394939258108493,
        -0.00003290911731933503,
        3.158105539702634e-6,
        1.781542390388495e-6,
        2.736083611131694e-7,
        -3.075309207118851e-8,
        -2.841713709984628e-8,
        -8.018739546918604e-9,
        -1.060960152960315e-9,
        1.32144352722009e-10,
        1.197627873095783e-10,
        3.638538355870995e-11,
        5.695272403463149e-12,
        -3.206954964620777e-13,
        -5.177385798275621e-13,
        -1.779590838590245e-13,
        -3.293241795313606e-14,
        -3.43084563157666e-16,
        2.187616414432587e-15,
        8.816500749424194e-16,
        1.908616571749589e-16,
        1.22708374673927e-17,
        -8.789108657572648e-18,
        -4.478635690928205e-18,
        -1.089977001307927e-18,
    ],
    &[
        -13.51866999964091,
        -6.663589102797322,
        -0.918359712384051,
        -0.1140363080347103,
        -0.00961299135470309,
        -0.0006875170142458433,
        -0.00005180641003603167,
        -7.447485287719965e-7,
        2.684115701658175e-7,
        -1.019548062562007e-7,
        -1.287624854874013e-8,
        5.309732594063548e-9,
        5.137100262499818e-10,
        -2.545562460116189e-10,
        -2.394186159430601e-11,
        1.103893185842335e-11,
        1.169435411307975e-12,
        -4.295287611493522e-13,
        -5.331746824657529e-14,
        1.479340777479846e-14,
        2.063904160297544e-15,
        -4.520667018006129e-16,
        -5.957072397919519e-17,
        1.317108638607105e-17,
        7.050331102578789e-19,
        -4.557391357598425e-19,
        5.230997238134813e-20,
        2.205447509751448e-20,
        -4.898588842953582e-21,
        -1.166589887860727e-21,
        2.611767366961446e-22,
    ],
    &[
        -41.3790631728838,
        -23.65336366758131,
        -3.924044370008532,
        -0.4628114753434195,
        -0.04081531185951268,
        -0.002902961189449254,
        -0.0001716066095680646,
        -8.70525282484327e-6,
        -3.869902498149908e-7,
        -1.592777293977627e-8,
        -2.961351747656423e-10,
        -9.02134129281963e-11,
        1.488380133256767e-11,
        -1.478368909659418e-12,
        -5.024376012719117e-13,
        2.941971933841648e-13,
        -6.987109876711073e-14,
        3.091245862268957e-15,
        3.77002269360846e-15,
        -1.307872083507443e-15,
        1.089495294846943e-16,
        5.718146787120765e-17,
        -2.066358326178372e-17,
        1.001861569191511e-18,
        1.081134182872247e-18,
        -2.729093172588461e-19,
        -1.60016566679492e-20,
        1.911395560583607e-20,
        -2.099283545344314e-21,
        -7.938555147643645e-22,
        2.317963657898718e-22,
    ],
];

pub const SPLITS: [f64; 7] = [
    -41.48842006319579,
    -18.69221864627725,
    -7.294117937817978,
    -1.595067583588342,
    1.254457593526476,
    2.679220182083885,
    4.103982770641293,
];
