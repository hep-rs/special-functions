#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    x.powi(-3)
        * (0.09134537117517981 - 36377.83929769925 * x.powi(2) + 2.069121583905669e49 * x.powi(4))
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.0,
                0.06349363593424097,
                0.1190505673767018,
                0.05208462322730705,
                -0.01953173371024014,
                0.02014210038868515,
                -0.03273091313161336,
                0.07159887247540423,
                -0.195618348013158,
                0.6388161677304691,
                -2.422177969311362,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 6] = [
    &[
        80.6291915873066,
        -30.97061682583025,
        -2.614410716563632e-17,
        -2.309921085565404e-17,
        -1.943152217354476e-17,
        -1.557019496960101e-17,
        -1.189040906438555e-17,
        -8.659536251934271e-18,
        -6.018706143087826e-18,
        -3.995471979451521e-18,
        -2.535477376548745e-18,
        -1.539456275139717e-18,
        -8.951465634652736e-19,
        -4.989449909771984e-19,
        -2.668460437325943e-19,
        -1.370686389562838e-19,
        -6.768666671016261e-20,
        -3.216404437365269e-20,
        -1.472142316074241e-20,
        -6.495945635135847e-21,
        -2.765933114264553e-21,
        -1.137447683530928e-21,
        -4.521527874913813e-22,
        -1.738865259343077e-22,
        -6.474790949539721e-23,
        -2.336189002248694e-23,
        -8.174632345887869e-24,
        -2.777779392945969e-24,
        -9.23350526878402e-25,
        -3.209635884924046e-25,
        -9.13802276662543e-26,
    ],
    &[
        34.17326632951869,
        -15.48530844910581,
        -3.107379572540552e-8,
        -2.415070304033955e-8,
        -1.703749923700145e-8,
        -1.094786301902874e-8,
        -6.43273765367155e-9,
        -3.470496227669696e-9,
        -1.726311181709577e-9,
        -7.949600156686257e-10,
        -3.402266636182304e-10,
        -1.358308866455603e-10,
        -5.076319771535594e-11,
        -1.781693361648355e-11,
        -5.890681110992902e-12,
        -1.839785966559294e-12,
        -5.442142575476034e-13,
        -1.528345463829581e-13,
        -4.084062866048989e-14,
        -1.040590085994453e-14,
        -2.532856915848005e-15,
        -5.899890405710941e-16,
        -1.317245216713759e-16,
        -2.82283098135226e-17,
        -5.813035949582403e-18,
        -1.151282959155621e-18,
        -2.193617703517929e-19,
        -4.018930381470493e-20,
        -7.068778923404033e-21,
        -1.213565265110757e-21,
        -1.881013099148643e-22,
    ],
    &[
        10.94447553097306,
        -7.744139650261877,
        -0.001079639062211837,
        -0.0006467694139438713,
        -0.0003255297342932887,
        -0.0001401475400222193,
        -0.00005240821229300671,
        -0.00001723453417921698,
        -5.029749013071515e-6,
        -1.309637348044405e-6,
        -3.042759048963889e-7,
        -6.25451068265818e-8,
        -1.10759699968654e-8,
        -1.562904972823977e-9,
        -1.237907095155825e-10,
        1.850772523774698e-11,
        1.178160601621715e-11,
        3.500632266170576e-12,
        7.760241098852067e-13,
        1.342348005216547e-13,
        1.609982027956688e-14,
        2.828722332497049e-16,
        -5.237006723487169e-16,
        -1.827504768076695e-16,
        -3.879094355190424e-17,
        -5.15466498101337e-18,
        -3.582653158157827e-20,
        2.179883717494707e-19,
        7.475516505018934e-20,
        1.44478081396269e-20,
        1.22840421951629e-21,
    ],
    &[
        1.24326033717218,
        -1.96098323215277,
        -0.007467184463820438,
        -0.001486469626440455,
        -0.0002177945775499148,
        -0.00002429957620007743,
        -2.039224483808714e-6,
        -1.151423227125859e-7,
        -1.679571100056885e-9,
        5.116207846862916e-10,
        7.105015161715795e-11,
        5.177548387311793e-12,
        1.624847193272135e-13,
        -1.572478986440182e-14,
        -3.630579198836911e-15,
        -4.657314968976754e-16,
        -4.798293751679949e-17,
        -3.776685427568153e-18,
        -1.23022092419112e-19,
        2.559889353283423e-20,
        6.316952030857119e-21,
        8.226441086070501e-22,
        6.950761115505777e-23,
        2.502416792344449e-24,
        -3.608278336426303e-25,
        -9.0170071072644e-26,
        -1.152276849445077e-26,
        -9.93947326952336e-28,
        -4.472531774165851e-29,
        3.520970654850386e-30,
        1.113641886697233e-30,
    ],
    &[
        -2.874664334734727,
        -2.209866854584277,
        -0.07313074672285467,
        -0.01225045680386696,
        -0.001319890657811994,
        -0.00007624890221901444,
        1.128772773191115e-6,
        5.171591592753097e-7,
        -1.03164154657503e-8,
        -1.369115875480382e-8,
        -1.893501660535277e-9,
        -1.596517854435619e-11,
        3.737158723107843e-11,
        6.477247734548755e-12,
        2.423186251900706e-13,
        -1.066739690984592e-13,
        -2.342716651127053e-14,
        -1.436216746944768e-15,
        3.102521777079199e-16,
        8.60507528560683e-17,
        7.038672734438004e-18,
        -8.864642251345896e-19,
        -3.20414676547689e-19,
        -3.265332670084009e-20,
        2.321901021782592e-21,
        1.203141699465383e-21,
        1.480877739155385e-22,
        -4.653125506567993e-24,
        -4.512732946801283e-24,
        -6.43997069113979e-25,
        1.330615177695702e-28,
    ],
    &[
        -16.32116113156662,
        -13.97857581433178,
        -3.472355710926915,
        -0.7465618442728964,
        -0.1165982246910201,
        -0.01496477105529541,
        -0.001421805977100169,
        -0.000166775157452576,
        -0.00003375710259516367,
        8.08930309872392e-6,
        1.312387821849586e-6,
        -1.439093738543244e-6,
        1.780834265606366e-8,
        1.704441737539245e-7,
        -1.372623274784281e-8,
        -1.753808424415228e-8,
        1.308489602038384e-9,
        1.741877619790079e-9,
        4.835165634907493e-11,
        -1.79304961580437e-10,
        -3.880276610200188e-11,
        1.87660830084021e-11,
        8.171493298150324e-12,
        -1.774743089094963e-12,
        -1.223716480809494e-12,
        1.186341851450558e-13,
        1.487814277495779e-13,
        6.294159994123074e-16,
        -1.534923924541644e-14,
        -1.487463821279672e-15,
        1.329110393762323e-15,
    ],
];

pub const SPLITS: [f64; 7] = [
    -37.99763869396531,
    -17.35056081007848,
    -7.027021868135066,
    -1.865252397163359,
    -0.5748100294204316,
    0.7156323383224953,
    3.296517073808349,
];
