#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-2)
        * polynomial(
            x2,
            &[
                2.,
                -0.5,
                0.1082414394573016,
                0.01596456439921957,
                0.0006209629499756117,
                0.00001179614175885279,
                1.346502336473863e-7,
            ],
        )
        + x.powi(2)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.125,
                    -0.01041666666666667,
                    -0.0003255208333333333,
                    -5.425347222222222e-6,
                    -5.651403356481481e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                2.349964007466563,
                1.028109253266621,
                -0.385540969974983,
                0.3975891252867012,
                -0.6460823285908895,
                1.413305093792571,
                -3.861351416968988,
                12.60972572103935,
                -47.8118766922742,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -0.4785920007653135,
        -3.635479445012965,
        -0.4469611182049083,
        -0.1235883282891649,
        -0.02248084597746076,
        -0.002590230770396393,
        -0.0001922539360936531,
        -0.00002211203074091212,
        -4.659636535289474e-6,
        -2.664177241189154e-7,
        8.931839421529804e-8,
        5.210614835838566e-9,
        -3.851344523336098e-9,
        -2.714130851096921e-10,
        1.528168154408515e-10,
        1.273118485906743e-11,
        -6.240933762113534e-12,
        -6.020294066685843e-13,
        2.583347934683628e-13,
        2.84849488568215e-14,
        -1.07981468120866e-14,
        -1.347734056366615e-15,
        4.544240199699048e-16,
        6.37352779431929e-17,
        -1.921217608368781e-17,
        -3.011859196930893e-18,
        8.146258163325023e-19,
        1.421888403262165e-19,
        -3.465530409734915e-20,
        -6.391650544961686e-21,
        1.469353398975687e-21,
    ],
    &[
        -25.34377895282228,
        -27.12670808285237,
        -7.932852743344154,
        -1.672580273790768,
        -0.2629834971694668,
        -0.0337229732684212,
        -0.003610040427077333,
        -0.000327768492034873,
        -0.00002683452379784031,
        -1.907094468819944e-6,
        -1.158442482793902e-7,
        -8.4499987515637e-9,
        -2.944169388728926e-10,
        -7.569998540862019e-12,
        -5.606424401344152e-12,
        6.47639717920124e-13,
        -2.351391018883653e-14,
        -1.324987940875517e-14,
        3.335199792329696e-15,
        -3.526505546136395e-16,
        -1.430465852086121e-17,
        1.23703679847792e-17,
        -2.218381407987535e-18,
        1.357807673653368e-19,
        3.090007059151469e-20,
        -1.016289662996895e-20,
        1.311815889800515e-21,
        -2.639489059351034e-24,
        -3.493145090791641e-23,
        7.409767458347735e-24,
        -6.353673438438822e-25,
    ],
];

pub const SPLITS: [f64; 3] = [-1.074094313080118, 1.514944238985425, 4.103982791050967];
