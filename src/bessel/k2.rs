#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-2)
        * polynomial(
            x2,
            &[
                2.,
                -0.5,
                0.10824143945730155,
                0.015964564399219575,
                0.0006209629499756117,
                0.000011796141758852788,
                1.3465023364738628e-7,
            ],
        )
        + x.powi(2)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.125,
                    -0.010416666666666666,
                    -0.0003255208333333333,
                    -5.4253472222222224e-6,
                    -5.651403356481482e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                2.349964007466563,
                1.0281092532666212,
                -0.38554096997498294,
                0.39758912528670115,
                -0.6460823285908894,
                1.4133050937925706,
                -3.8613514169689873,
                12.60972572103935,
                -47.8118766922742,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        5.196345117766398,
        -6.419838599467182,
        3.0019512532392536,
        -1.2558902715741471,
        0.49561365181237055,
        -0.18845913450682794,
        0.06982089132437691,
        -0.0253729705017927,
        0.009084418934742057,
        -0.0032143509401187887,
        0.0011264653263861589,
        -0.0003916367181750896,
        0.00013524910114360065,
        -0.00004644040444870389,
        0.000015867433385354455,
        -5.398091877361462e-6,
        1.829453620835563e-6,
        -6.17926280134225e-7,
        2.0808593425872703e-7,
        -6.988313838744305e-8,
        2.3412040885209315e-8,
        -7.82602499842426e-9,
        2.6107376219527312e-9,
        -8.69319601121002e-10,
        2.889716007074253e-10,
        -9.590646748932579e-11,
        3.178401748293222e-11,
        -1.0519217680521259e-11,
        3.4770639382073113e-12,
        -1.1479770349589424e-12,
        3.7859784112564323e-13,
        -1.2473187867792363e-13,
        4.105427901931142e-14,
        -1.3500375421741121e-14,
        4.4357022071082145e-15,
        -1.4562260792891293e-15,
        4.777098353179514e-16,
        -1.5659794915496623e-16,
        5.129920845951064e-17,
        -1.67939548719596e-17,
        5.494489380260474e-18,
        -1.796597605421279e-18,
        5.871850598664023e-19,
        -1.9199206950425112e-19,
        6.33087070861002e-20,
        -2.2597993604831824e-20,
        6.661830359620721e-21,
    ],
    &[
        0.45124108993188816,
        -0.33516136337281427,
        0.07704658995715782,
        -0.01446651844491849,
        0.002478133539685049,
        -0.00040539792356385993,
        0.00006450190859498585,
        -0.000010062591763707407,
        1.5461702064168823e-6,
        -2.3471473585578662e-7,
        3.528004452505734e-8,
        -5.259638166817989e-9,
        7.787246778797061e-10,
        -1.1461839828002617e-10,
        1.678487278039359e-11,
        -2.447139579075947e-12,
        3.5539292808612134e-13,
        -5.1435255271096236e-14,
        7.421243399846664e-15,
        -1.0678073416013628e-15,
        1.5325914621170414e-16,
        -2.1947129618809216e-17,
        3.13641884612321e-18,
        -4.473747229615752e-19,
        6.370252602067091e-20,
        -9.056254279042394e-21,
        1.2855813462451572e-21,
        -1.8224519221251076e-22,
        2.5802383716496133e-23,
        -3.648784762317886e-24,
        5.154126639652055e-25,
        -7.272954883620844e-26,
        1.0252821558785211e-26,
        -1.4440354302165503e-27,
        2.032063606850153e-28,
        -2.857214551783458e-29,
        4.014337564812426e-30,
        -5.635964278893397e-31,
        7.907192619931284e-32,
        -1.1086420301730293e-32,
        1.553421674835442e-33,
        -2.1753514583379726e-34,
        3.0445544539890806e-35,
        -4.2587939512539195e-36,
        5.956405492843591e-37,
        -8.482580459171955e-38,
        1.1621370248382497e-38,
    ],
    &[
        0.07262072106698558,
        -0.0767571531459658,
        0.02420731725110715,
        -0.005767117452865649,
        0.0011713572351553956,
        -0.00021789098275242958,
        0.000038687064915954554,
        -6.698030394164556e-6,
        1.1418836048172575e-6,
        -1.9250372322594155e-7,
        3.2160134108530935e-8,
        -5.3315389933495056e-9,
        8.780274990440177e-10,
        -1.4377072200445783e-10,
        2.342406304677186e-11,
        -3.7997273350134665e-12,
        6.139959978137508e-13,
        -9.887573871123832e-14,
        1.5873908226744675e-14,
        -2.541458079601435e-15,
        4.0588467559318997e-16,
        -6.467593742589843e-17,
        1.0284656476250746e-17,
        -1.632373294056943e-18,
        2.586415318824352e-19,
        -4.0915214139440895e-20,
        6.4629568507642736e-21,
        -1.0194923557444677e-21,
        1.606144221045966e-22,
        -2.5273785844203374e-23,
        3.972600974946335e-24,
        -6.237764252783499e-25,
        9.784981710220288e-26,
        -1.5335337378815362e-26,
        2.401330446048062e-27,
        -3.7571356346496066e-28,
        5.87391318275077e-29,
        -9.176597437869718e-30,
        1.4326356820209014e-30,
        -2.235141115136628e-31,
        3.485004017321283e-32,
        -5.4305499320066654e-33,
        8.457437311160492e-34,
        -1.3164524500964848e-34,
        2.0492207048727972e-35,
        -3.261518229477025e-36,
        4.949663884573595e-37,
    ],
    &[
        0.004443166797109716,
        -0.006428838849837302,
        0.0030048538610169414,
        -0.0010383112642699283,
        0.0002886319528007763,
        -0.00006845058836751702,
        0.000014478435708916123,
        -2.828903405861375e-6,
        5.248074677116391e-7,
        -9.43346494049429e-8,
        1.665329680467238e-8,
        -2.9101653589526335e-9,
        5.054192791269965e-10,
        -8.738792674922035e-11,
        1.5052532403684764e-11,
        -2.5837814513012364e-12,
        4.420610654633999e-13,
        -7.540190870329761e-14,
        1.2824907028829669e-14,
        -2.1756853203938026e-15,
        3.68214845967917e-16,
        -6.218074723968012e-17,
        1.0479436867615961e-17,
        -1.762857831330841e-18,
        2.960442124893479e-19,
        -4.963771813686388e-20,
        8.310614814151407e-21,
        -1.3895226814421363e-21,
        2.3203301932744924e-22,
        -3.8700998959285735e-23,
        6.447864217724035e-24,
        -1.0731512681402877e-24,
        1.7843690272132388e-25,
        -2.964230742220659e-26,
        4.9200071125685095e-27,
        -8.159560085023555e-28,
        1.3521792055813532e-28,
        -2.2391641887939187e-29,
        3.70542584921243e-30,
        -6.127818694800493e-31,
        1.0127523640712425e-31,
        -1.672796800027394e-32,
        2.761454966281375e-33,
        -4.556242424707938e-34,
        7.518902838218332e-35,
        -1.2719881153875108e-35,
        2.040216108702946e-36,
    ],
    &[
        0.00004370296753443314,
        -0.00007561438280959558,
        0.00005007319716283996,
        -0.00002634035426112181,
        0.00001140057927960095,
        -4.181992747138396e-6,
        1.3322594170670407e-6,
        -3.76167697095354e-7,
        9.578989830115472e-8,
        -2.233890595500202e-8,
        4.837731827780539e-9,
        -9.854728997476282e-10,
        1.9111168800244e-10,
        -3.5678253980974284e-11,
        6.476673254706231e-12,
        -1.1531291372208185e-12,
        2.0276340826574033e-13,
        -3.539177497050748e-14,
        6.152953112723386e-15,
        -1.0675427492074812e-15,
        1.8502064103300424e-16,
        -3.204296135265081e-17,
        5.545374547397214e-18,
        -9.588975462275946e-19,
        1.6565641997109237e-19,
        -2.8589306349439605e-20,
        4.9287819159637176e-21,
        -8.488129817171649e-22,
        1.460249206266295e-22,
        -2.5095576984293855e-23,
        4.308628276589196e-24,
        -7.390446664004777e-25,
        1.2665167051092222e-25,
        -2.1685944596800335e-26,
        3.7101460337280734e-27,
        -6.342583286915676e-28,
        1.0834784170196222e-28,
        -1.8495613591336427e-29,
        3.1551948876803932e-30,
        -5.379058849174397e-31,
        9.164777279474303e-32,
        -1.5605766921109343e-32,
        2.655874133157613e-33,
        -4.517614747478176e-34,
        7.686538590473675e-35,
        -1.3426893143225138e-35,
        2.2166001106013342e-36,
    ],
    &[
        1.068121314261434e-8,
        -1.994204616433338e-8,
        1.6250862485370568e-8,
        -1.1615013744541442e-8,
        7.330223800899278e-9,
        -4.116439010991735e-9,
        2.073476462211327e-9,
        -9.44126934773898e-10,
        3.914781513878373e-10,
        -1.488303343114029e-10,
        5.220425200944122e-11,
        -1.6992239937121777e-11,
        5.159702257144456e-12,
        -1.4687668706845984e-12,
        3.9374436931493537e-13,
        -9.98320246537727e-14,
        2.4037455557289785e-14,
        -5.517884738527e-15,
        1.2122195631473e-15,
        -2.55829671993513e-16,
        5.206103191714658e-17,
        -1.0254290069614227e-17,
        1.9623726046841282e-18,
        -3.6627116958499425e-19,
        6.693109112833058e-20,
        -1.2019475369236739e-20,
        2.128809144143502e-21,
        -3.7310444605042387e-22,
        6.490186591608946e-23,
        -1.1233382451549009e-23,
        1.9384893536281244e-24,
        -3.3401388135519866e-25,
        5.752477808480536e-26,
        -9.908331821834933e-27,
        1.7073887185993037e-27,
        -2.9436643019807604e-28,
        5.077485597365145e-29,
        -8.761228253643256e-30,
        1.5120930704894934e-30,
        -2.60995053835319e-31,
        4.504812853414818e-32,
        -7.774492135065227e-33,
        1.3414914571365144e-33,
        -2.3142620204998603e-34,
        3.994662057580341e-35,
        -7.085576236059028e-36,
        1.1860386869605895e-36,
    ],
    &[
        2.0872740330453488e-15,
        -3.891706803996866e-15,
        3.1586608129888806e-15,
        -2.2428407790253515e-15,
        1.4028152802230787e-15,
        -7.789411715812698e-16,
        3.870761518768847e-16,
        -1.7347992393439207e-16,
        7.063503978148712e-17,
        -2.6303157122388603e-17,
        9.01250932592621e-18,
        -2.8570256500466684e-18,
        8.420949119739589e-19,
        -2.3180637149152216e-19,
        5.983571569555333e-20,
        -1.453637802020838e-20,
        3.3347148544652367e-21,
        -7.245832976986997e-22,
        1.4953927226876105e-22,
        -2.938823051666548e-23,
        5.512804704924212e-24,
        -9.892570350989365e-25,
        1.7016709777470625e-25,
        -2.811312886093485e-26,
        4.4688893114409756e-27,
        -6.846931945889446e-28,
        1.012776553584484e-28,
        -1.4485712860959083e-29,
        2.006504407742038e-30,
        -2.695649434365122e-31,
        3.517611541990713e-32,
        -4.4650471993402474e-33,
        5.521156961473111e-34,
        -6.660345772223565e-35,
        7.850046482367897e-36,
        -9.053493027609405e-37,
        1.023305761040193e-37,
        -1.135366995276619e-38,
        1.2385835512407591e-39,
        -1.3307859187073608e-40,
        1.410703634929168e-41,
        -1.4779756335795002e-42,
        1.5330635290984216e-43,
        -1.5770939181924423e-44,
        1.611818510898879e-45,
        -1.65534482919493e-46,
        1.6597665441008814e-47,
    ],
    &[
        4.838449873212253e-22,
        -9.017213774138364e-22,
        7.30907651548686e-22,
        -5.178855064776401e-22,
        3.229926140202863e-22,
        -1.7871664965024094e-22,
        8.844253664701387e-23,
        -3.945231532229268e-23,
        1.5979656653057034e-23,
        -5.91630073256633e-24,
        2.014443250951653e-24,
        -6.342473076409698e-25,
        1.8556733642253766e-25,
        -5.0677098531589944e-26,
        1.296965258388554e-26,
        -3.1219325901993517e-27,
        7.091243814908859e-28,
        -1.5244764359044242e-28,
        3.110284057632482e-29,
        -6.037281925034641e-30,
        1.1174729115918286e-30,
        -1.9765143833819054e-31,
        3.3471385245834185e-32,
        -5.436747256034728e-33,
        8.48441303049134e-34,
        -1.2740821708064402e-34,
        1.843730089460246e-35,
        -2.5746186436938107e-36,
        3.47375916496913e-37,
        -4.533995790771241e-38,
        5.731279572253219e-39,
        -7.023921462687554e-40,
        8.354308166612366e-41,
        -9.653138408131097e-42,
        1.0845751451088611e-42,
        -1.185968914456248e-43,
        1.2632362658290348e-44,
        -1.3117651356779943e-45,
        1.329045252188042e-46,
        -1.314857759763719e-47,
        1.2711862355526898e-48,
        -1.2018818875963058e-49,
        1.1121513597151128e-50,
        -1.007955267670226e-51,
        8.954505429629508e-53,
        -7.858441872145606e-54,
        6.674097922663976e-55,
    ],
];

pub const SPLITS: [f64; 9] = [
    0.3416070042339728,
    1.2828489193002046,
    2.2240908343664363,
    4.1065746644989,
    7.871542324763827,
    15.401477645293681,
    30.461348286353388,
    45.521218927413095,
    60.581089568472805,
];
