#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-2)
        * polynomial(
            x2,
            &[
                2.,
                -0.5,
                0.1082414394573016,
                0.01596456439921957,
                0.0006209629499756117,
                0.00001179614175885279,
                1.346502336473863e-7,
            ],
        )
        + x.powi(2)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.125,
                    -0.01041666666666667,
                    -0.0003255208333333333,
                    -5.425347222222222e-6,
                    -5.651403356481481e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                2.349964007466563,
                1.028109253266621,
                -0.385540969974983,
                0.3975891252867012,
                -0.6460823285908895,
                1.413305093792571,
                -3.861351416968988,
                12.60972572103935,
                -47.8118766922742,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 6] = [
    &[
        2.137327932349713,
        -0.6805710710962857,
        -0.004875865597527234,
        -0.0004543006599682948,
        -0.00002908955118988276,
        -1.267835223122089e-6,
        -3.220810803551899e-8,
        -5.594971236579714e-11,
        2.281577456342882e-11,
        -1.396858549440057e-13,
        -7.776609628680743e-14,
        -2.728944515959103e-15,
        8.443133911696847e-17,
        9.43617173384534e-18,
        1.195268294833969e-19,
        -1.933740349356806e-20,
        -9.79865398344537e-22,
        1.459470781950009e-23,
        3.023489504685215e-24,
        6.948516718703481e-26,
        -5.371358416909179e-27,
        -3.722794740860198e-28,
        7.919650972225333e-31,
        1.007647651923468e-30,
        3.397834231067494e-32,
        -1.452743494934962e-33,
        -1.425411362448724e-34,
        -1.250495095823987e-36,
        3.36334592797323e-37,
        1.542754549517998e-38,
        -3.455941735734808e-40,
    ],
    &[
        0.7128894425998327,
        -0.7514943230873024,
        -0.01409138756921546,
        -0.001163936544677645,
        -0.00006198678022801884,
        -2.006729301281139e-6,
        -2.930530652459801e-8,
        -1.034386539537305e-10,
        -4.475697506905861e-11,
        -3.002228445611076e-12,
        1.573184506311553e-14,
        7.027834051682348e-15,
        4.535381975251134e-17,
        -1.853500584848494e-17,
        -4.030919861077375e-19,
        4.533956287082908e-20,
        1.809601689278818e-21,
        -1.009836506094167e-22,
        -6.684538464372163e-24,
        1.88542194204046e-25,
        2.216970916393687e-26,
        -2.097102994478831e-28,
        -6.789057994836784e-29,
        -4.241108117191029e-31,
        1.932722764426309e-31,
        4.220283844845757e-33,
        -5.078246576774743e-34,
        -2.036657416582779e-35,
        1.19973868678246e-36,
        7.91278805396557e-38,
        -2.367199884075032e-39,
    ],
    &[
        -0.961140827689283,
        -0.940274001817173,
        -0.03546977659510095,
        -0.002520037244773061,
        -0.0001105889186696244,
        -2.988574782282266e-6,
        -6.455456517863293e-8,
        -2.640399215505038e-9,
        -8.570345021507382e-11,
        1.271156733644247e-12,
        8.643643235565642e-14,
        -6.295082677618792e-15,
        -2.103180355818059e-16,
        1.860475899998686e-17,
        4.064464426054509e-19,
        -5.608995460389233e-20,
        -6.395206651398921e-22,
        1.665980511335097e-22,
        3.087698961204431e-25,
        -4.872849788666238e-25,
        3.612373486908896e-27,
        1.399719287711084e-27,
        -2.369436311126033e-29,
        -3.934517505451192e-30,
        1.073332947226383e-31,
        1.076667596951602e-32,
        -4.229165775008396e-34,
        -2.845204928527254e-35,
        1.543932843392767e-36,
        7.146125809758592e-38,
        -5.359263748370101e-39,
    ],
    &[
        -3.245868769458829,
        -1.380308889633334,
        -0.07865256672054343,
        -0.004881863543180843,
        -0.0001932244267815498,
        -5.683438677735556e-6,
        -1.686444681033818e-7,
        -4.56273205157434e-9,
        -4.684529407946268e-11,
        -5.621624858235876e-13,
        -1.172990842874036e-13,
        5.508194400292311e-16,
        2.027596115337259e-16,
        -8.587592039179447e-18,
        -2.672579859329817e-19,
        3.021931067139298e-20,
        -2.370855807400477e-22,
        -7.222630512917767e-23,
        2.8680099043921e-24,
        1.037331217786292e-25,
        -1.093335998245049e-26,
        6.10389076720321e-29,
        2.775229058125852e-29,
        -1.035380338527753e-30,
        -4.342630148107979e-32,
        4.206468589538852e-33,
        -1.277304235122223e-35,
        -1.121733509146904e-35,
        3.89351458785128e-37,
        1.885538759897889e-38,
        -1.680480477315691e-39,
    ],
    &[
        -10.2578336821135,
        -6.377415965992985,
        -0.924200621054631,
        -0.1022697152733353,
        -0.008055736201231474,
        -0.0005206559649256754,
        -0.00002868659694838407,
        -1.267965929450009e-6,
        -5.182606373785808e-8,
        -2.157451340388157e-9,
        -3.991013090039865e-11,
        -1.804321445083286e-12,
        -2.050963509658228e-13,
        1.413453896988216e-14,
        -3.012051797293139e-16,
        -9.52239093934094e-17,
        1.148045145054018e-17,
        -3.678385635932527e-19,
        -5.72804269787647e-20,
        8.671362404201205e-21,
        -3.865983021521005e-22,
        -3.341129022265615e-23,
        6.52722755737116e-24,
        -3.703266230967288e-25,
        -1.773088490447089e-26,
        4.875731788704397e-27,
        -3.376529307944649e-28,
        -7.390638612351378e-30,
        3.597956857324454e-30,
        -2.95502148158139e-31,
        -6.776468550268908e-34,
    ],
    &[
        -36.56079583478588,
        -21.98282877746469,
        -3.432999866214374,
        -0.3683886079102705,
        -0.02956118588339109,
        -0.001911278737774579,
        -0.0001027125805706502,
        -4.735637114919248e-6,
        -1.920996770767345e-7,
        -6.842126192261317e-9,
        -2.234283385746903e-10,
        -6.597247465926454e-12,
        -1.651043624173642e-13,
        -5.271132362180555e-15,
        -6.150808638102775e-17,
        -1.969155413921956e-18,
        -2.733978836690437e-19,
        2.301880964664106e-20,
        -1.40570356541685e-21,
        2.423238981249746e-23,
        4.793293103977652e-24,
        -6.563308981457956e-25,
        4.569500926714204e-26,
        -1.429945098674797e-27,
        -9.1857788854723e-29,
        1.777019483828777e-29,
        -1.438569662316519e-30,
        6.038431717056378e-32,
        1.228119189997038e-33,
        -4.650864637124284e-34,
        4.395173129082818e-35,
    ],
];

pub const SPLITS: [f64; 7] = [
    -1.074094313080118,
    -0.4268346750637322,
    0.2204249629526534,
    0.8676846009690391,
    1.514944238985425,
    2.809463515018196,
    4.103982791050967,
];
