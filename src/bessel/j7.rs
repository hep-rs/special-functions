#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(7)
        * polynomial(
            x2,
            &[
                1.550099206349206e-6,
                -4.84406001984127e-8,
                6.72786113866843e-10,
                -5.606550948890359e-12,
                3.185540311869522e-14,
                -1.327308463278967e-16,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                15.5176069514598,
                544.0860937355591,
                19383.06708932929,
                623286.751091245,
                1.612754468448597e7,
                2.771921742646025e8,
                1.737400949408491e9,
                -1.180889707801084e10,
                2.593036983379879e11,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 11.78097245096172
        + x1 * polynomial(
            x1,
            &[
                24.375,
                0.0,
                86.8359375,
                0.0,
                652.9833984375,
                0.0,
                -9330.05578177316,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 16] = [
    &[
        0.1218210773565624,
        0.1838075575194693,
        0.06610089188635809,
        -0.00938822233130034,
        -0.0201191931894571,
        -0.006751285741508845,
        0.0006121792505841983,
        0.0008937336399332921,
        0.0001095298515819558,
        -0.00004969233377180679,
        -0.00001130850498021951,
        1.604826997886996e-6,
        5.241521079953366e-7,
        -3.420105755448579e-8,
        -1.521522740475635e-8,
        5.140524423590011e-10,
        3.107441196540243e-10,
        -5.6371141404143e-12,
        -4.758501732562272e-12,
        4.530327828998273e-14,
        5.696618509025291e-14,
        -2.539519322731972e-16,
        -5.494567074910967e-16,
        7.456532103685913e-19,
        4.369453374865981e-18,
        2.600788084005251e-21,
        -2.917771066248009e-20,
        -5.381184933319998e-23,
        1.660788372005266e-22,
        4.371434007147274e-25,
        -8.158577265006973e-25,
    ],
    &[
        0.102252570481407,
        -0.06724945334508691,
        0.2419903577559075,
        0.001506906999111838,
        -0.08749903056249058,
        -0.005231582231208521,
        0.01097435456146235,
        0.001053490588938523,
        -0.0007230174250166487,
        -0.00008665161778772168,
        0.00002957725223920191,
        4.066151534516837e-6,
        -8.27213133260705e-7,
        -1.255971147300417e-7,
        1.686147459506266e-8,
        2.768954227213049e-9,
        -2.622486547474931e-10,
        -4.593346316001187e-11,
        3.221475617415262e-12,
        5.953196401240331e-13,
        -3.210424737360994e-14,
        -6.201547756298283e-15,
        2.65157818306987e-16,
        5.309598455498527e-17,
        -1.846735199692004e-18,
        -3.804295993854792e-19,
        1.100202480872278e-20,
        2.31541938107264e-21,
        -5.674342757619442e-23,
        -1.206752223011544e-23,
        2.559295545160485e-25,
    ],
    &[
        0.04337804325585068,
        -0.0118430196519945,
        0.0943527470314373,
        -0.1228108415115039,
        -0.05217913026335342,
        0.03388743711322033,
        0.0079586352008265,
        -0.003522380086855794,
        -0.0006150885926735386,
        0.0001987725923659923,
        0.00002937340047595153,
        -7.154469836492185e-6,
        -9.56400577984854e-7,
        1.800093175889504e-7,
        2.257335763716526e-8,
        -3.359858506152079e-9,
        -4.033177134204482e-10,
        4.85110490578609e-11,
        5.637444935571069e-12,
        -5.589914585289714e-13,
        -6.327027594196441e-14,
        5.266522142900404e-15,
        5.823402773962605e-16,
        -4.136120540206337e-17,
        -4.47319126449106e-18,
        2.75091940919585e-19,
        2.910196453430235e-20,
        -1.569989363866426e-21,
        -1.623900475062386e-22,
        7.74106799660385e-24,
        7.856166105396377e-25,
    ],
    &[
        -0.04636847754485317,
        -0.002429143031410868,
        -0.08339829035892678,
        -0.08210747413162259,
        0.06500197353889896,
        0.02292494077016752,
        -0.0112234294563996,
        -0.002482132386842283,
        0.000904918636835462,
        0.0001477468996372862,
        -0.00004293629899611373,
        -5.642182064489388e-6,
        1.35190358112557e-6,
        1.510111278251723e-7,
        -3.044449099616114e-8,
        -2.999773811525045e-9,
        5.162374228109134e-10,
        4.604170172334071e-11,
        -6.843202017940774e-12,
        -5.625983674356985e-13,
        7.296951441881147e-14,
        5.602110681882337e-15,
        -6.401045645628666e-16,
        -4.631973305809218e-17,
        4.703926119692654e-18,
        3.229875182670192e-19,
        -2.939398020054507e-20,
        -1.92442538752782e-21,
        1.581591465465907e-22,
        9.86355772349797e-24,
        -7.405838558708384e-25,
    ],
    &[
        -0.02957586594654444,
        0.01821052017889124,
        -0.05660869501715335,
        0.0948384406922572,
        0.03970687741730362,
        -0.02982238950540619,
        -0.006610155534543223,
        0.003470267559859831,
        0.0005240275961114723,
        -0.0002164224575378279,
        -0.00002474612941289133,
        8.491630786170913e-6,
        7.82243569774692e-7,
        -2.299447454319937e-7,
        -1.779851026320161e-8,
        4.567838334620214e-9,
        3.063336014885308e-10,
        -6.952756136659872e-11,
        -4.134695452949822e-12,
        8.378253623220833e-13,
        4.498051798231061e-14,
        -8.198831868449111e-15,
        -4.029769513343662e-16,
        6.649700455238597e-17,
        3.025223048253603e-18,
        -4.545148533911975e-19,
        -1.930611958435424e-20,
        2.654777188621851e-21,
        1.060132985050346e-22,
        -1.334848187433866e-23,
        -5.060946561085064e-25,
    ],
    &[
        0.04313591379327766,
        0.003428311729514034,
        0.0770296340783152,
        0.04096712631923402,
        -0.06286265761751691,
        -0.01185673930914435,
        0.01126550416965066,
        0.001305338297554652,
        -0.00094357036829184,
        -0.00007796516322422202,
        0.00004650007991422384,
        2.955402870628411e-6,
        -1.518207981148543e-6,
        -7.788015204983027e-8,
        3.535794465028529e-8,
        1.515084374373945e-9,
        -6.18032593881204e-10,
        -2.270990986995148e-11,
        8.416204977371255e-12,
        2.707934003993203e-13,
        -9.18829004091685e-14,
        -2.632983371650864e-15,
        8.226489692681697e-16,
        2.129097613177181e-17,
        -6.152514669563998e-18,
        -1.454924500731771e-19,
        3.902764306482997e-20,
        8.514497004297907e-22,
        -2.126951503148336e-22,
        -4.296331896669852e-24,
        1.006793937725643e-24,
    ],
    &[
        0.008831947965174034,
        -0.01820845465512593,
        0.01744545544752939,
        -0.092843980922845,
        -0.0112512766549946,
        0.02955103680466968,
        0.001763657599504735,
        -0.003485259065839901,
        -0.0001312417447842574,
        0.0002205745761052968,
        5.780256829424632e-6,
        -8.788044568745524e-6,
        -1.692581403242102e-7,
        2.416422170501106e-7,
        3.546135849372652e-9,
        -4.871807002965179e-9,
        -5.594570028448665e-11,
        7.519501749441561e-11,
        6.903172916545005e-13,
        -9.17822348939197e-13,
        -6.860340270051614e-15,
        9.08649553265374e-15,
        5.621104773186311e-17,
        -7.44621296455075e-17,
        -3.870394660208446e-19,
        5.136062018324149e-19,
        2.275027324220922e-21,
        -3.023757760017091e-21,
        -1.156725423016765e-23,
        1.530745209544153e-23,
        5.143475330439919e-26,
    ],
    &[
        -0.04014309505190795,
        0.003246833677388646,
        -0.07175280542388745,
        0.00355134827081653,
        0.0587304820325622,
        -0.001831233318753606,
        -0.01056960467529841,
        0.000275518650197494,
        0.0008899492028093536,
        -0.00002067962260830389,
        -0.00004412020188485693,
        9.40065671223128e-7,
        1.449735899348084e-6,
        -2.87617715565105e-8,
        -3.398478068921092e-8,
        6.336750576541722e-10,
        5.978853809225898e-10,
        -1.054153982287737e-11,
        -8.192651383949847e-12,
        1.37166264636637e-13,
        8.996636925894117e-14,
        -1.434734355507206e-15,
        -8.098315481370612e-16,
        1.233013965350748e-17,
        6.086144837595804e-18,
        -8.863492176799979e-20,
        -3.877366983461929e-20,
        5.409547829907041e-22,
        2.12111087518688e-22,
        -2.825781758567276e-24,
        -1.007306827128565e-24,
    ],
    &[
        0.0105105366197492,
        0.01536749762946885,
        0.01770628443532529,
        0.07930009887910286,
        -0.01655267064929669,
        -0.02523370693267783,
        0.003167777550395002,
        0.002978560629428125,
        -0.0002800007689040675,
        -0.0001887806109644072,
        0.0000144782249111928,
        7.535310332860059e-6,
        -4.939682647821887e-7,
        -2.076336773006524e-7,
        1.19803588201233e-8,
        4.195509421640931e-9,
        -2.173945839757247e-10,
        -6.490237065582881e-11,
        3.064254559035445e-12,
        7.939196895814247e-13,
        -3.452956934853307e-14,
        -7.875915298290393e-15,
        3.182390589351488e-16,
        6.466144141964437e-17,
        -2.443822907548373e-18,
        -4.467345419418385e-19,
        1.587921805631708e-20,
        2.633729205570735e-21,
        -8.844756777794936e-23,
        -1.334818323546327e-23,
        4.270155540218691e-25,
    ],
    &[
        0.03043890555964566,
        -0.00989946930969221,
        0.054569814524393,
        -0.04102352168879442,
        -0.04440837709855106,
        0.01361488096666381,
        0.007973332160468677,
        -0.001656843873424632,
        -0.0006702840951898686,
        0.0001078349458177505,
        0.00003319110728351209,
        -4.409783905385918e-6,
        -1.089624247511435e-6,
        1.242704316680793e-7,
        2.55239427080694e-8,
        -2.564288261529085e-9,
        -4.487427460186507e-10,
        4.045571988550252e-11,
        6.145204326910085e-12,
        -5.040832673241587e-13,
        -6.744050253012901e-14,
        5.087862449908364e-15,
        6.066595049652423e-16,
        -4.245398678247971e-17,
        -4.555873503220798e-18,
        2.977946366332273e-19,
        2.900056741105848e-20,
        -1.780788178119141e-21,
        -1.584999443183272e-22,
        9.145679655255e-24,
        7.519293530458634e-25,
    ],
    &[
        -0.02453856703522733,
        -0.0094361960184821,
        -0.04303509360269112,
        -0.05087711074353163,
        0.03687635062263817,
        0.0160740233974459,
        -0.006796348030087479,
        -0.001887495344547766,
        0.0005840054580614931,
        0.0001190814734910719,
        -0.00002950349706562846,
        -4.732978416632461e-6,
        9.86917609206057e-7,
        1.298858188961635e-7,
        -2.353298879283324e-8,
        -2.61416039088556e-9,
        4.208034012084066e-10,
        4.028322692483339e-11,
        -5.856358416886514e-12,
        -4.908788687717882e-13,
        6.526753336266809e-14,
        4.851096895296704e-15,
        -5.957928526875713e-16,
        -3.967569760823465e-17,
        4.537278955687817e-18,
        2.730627887400776e-19,
        -2.926937771492084e-20,
        -1.603643285872116e-21,
        1.620089295845391e-22,
        8.096137999490812e-24,
        -7.778912356957354e-25,
    ],
    &[
        -0.01506097217839072,
        0.01380645036852175,
        -0.02728689930389011,
        0.06316959865662729,
        0.0216553478691093,
        -0.02056852691880634,
        -0.003836222866495469,
        0.00247066553272245,
        0.000318736224465833,
        -0.0001590846859618543,
        -0.00001560840624159889,
        6.445409233453687e-6,
        5.06859188348752e-7,
        -1.801548241715221e-7,
        -1.174572471204937e-8,
        3.690533977801448e-9,
        2.042996249573165e-10,
        -5.784838354734835e-11,
        -2.767857576268877e-12,
        7.166468792301689e-13,
        3.00507063470333e-14,
        -7.196110939693802e-15,
        -2.674169823748756e-16,
        5.976931016485918e-17,
        1.986583046313079e-18,
        -4.175271734749751e-19,
        -1.250872805150033e-20,
        2.487567344949836e-21,
        6.762211267845028e-23,
        -1.273338146245307e-23,
        -3.17302729559016e-25,
    ],
    &[
        0.03028314958283119,
        0.001755700184086461,
        0.05352822088609526,
        0.01372788420147897,
        -0.04506599954918038,
        -0.004104714196725431,
        0.008236616465426849,
        0.0004607477949865499,
        -0.0007030826559584419,
        -0.0000278254733582788,
        0.0000353149384426498,
        1.058039572641589e-6,
        -1.175241149771066e-6,
        -2.773941655654548e-8,
        2.789313283582429e-8,
        5.323965973545955e-10,
        -4.966554966004387e-10,
        -7.806346484213555e-12,
        6.885240275893926e-12,
        9.02909816505745e-14,
        -7.646212979005317e-14,
        -8.446139976515933e-16,
        6.957125419472732e-16,
        6.518722576262435e-18,
        -5.282385004568738e-18,
        -4.219367392244192e-20,
        3.398216804439207e-20,
        2.321680574936473e-22,
        -1.876168599651109e-22,
        -1.093933731093169e-24,
        8.987310199712499e-25,
    ],
    &[
        -0.002141033895898913,
        -0.0137762523314723,
        -0.003277008053350108,
        -0.06551512197438147,
        0.003770237744038111,
        0.0211793132300539,
        -0.0007832644627920803,
        -0.002530986378176511,
        0.00007367414852010981,
        0.0001622498161430238,
        -4.016853448243569e-6,
        -6.547460154800455e-6,
        1.43682171147899e-7,
        1.823363039827345e-7,
        -3.63860581460578e-9,
        -3.72250265070558e-9,
        6.872392550772739e-11,
        5.816394123532748e-11,
        -1.005697795601302e-12,
        -7.184089033708817e-13,
        1.174033365612427e-14,
        7.193603195631073e-15,
        -1.118859318069567e-16,
        -5.959087133896975e-17,
        8.869521594684857e-19,
        4.152438394535585e-19,
        -5.940333720067766e-21,
        -2.46813190495495e-21,
        3.405756472142661e-23,
        1.260576257790089e-23,
        -1.690250128374697e-25,
    ],
    &[
        -0.02693314831159227,
        0.005601596755575612,
        -0.04781527807907281,
        0.02231162438088225,
        0.03985105473653129,
        -0.007483721783050839,
        -0.007246864795710091,
        0.000918790777141295,
        0.0006160149695710855,
        -0.00006031928644794394,
        -0.00003082461800497695,
        2.488488483232871e-6,
        1.022187457623094e-6,
        -7.076181130748896e-8,
        -2.41795719334237e-8,
        1.473680602578417e-9,
        4.291640433265124e-10,
        -2.346952700457862e-11,
        -5.931489091921439e-12,
        2.952446016269134e-13,
        6.567811957657805e-14,
        -3.008988274158675e-15,
        -5.959114535915283e-16,
        2.53536990025914e-17,
        4.51235290006645e-18,
        -1.795940606024691e-19,
        -2.895242323128562e-20,
        1.084518835046952e-21,
        1.594420318516289e-22,
        -5.624099327134657e-24,
        -7.618880489844102e-25,
    ],
    &[
        0.01656286707589014,
        0.00995390626660068,
        0.02895866835482762,
        0.04905928750657662,
        -0.02502660538851728,
        -0.01575389695832896,
        0.004635687326566888,
        0.001873246239576038,
        -0.0004002594540830848,
        -0.0001195478184545271,
        0.0000203201325792304,
        4.803935298720805e-6,
        -6.83181097359145e-7,
        -1.332413603365379e-7,
        1.637616653530744e-8,
        2.709558851341891e-9,
        -2.944206994829989e-10,
        -4.217553596551379e-11,
        4.120367084099323e-12,
        5.189919245705601e-13,
        -4.618272946723303e-14,
        -5.177877121712755e-15,
        4.240292778587947e-16,
        4.273976429067393e-17,
        -3.248232665510986e-18,
        -2.967772991583477e-19,
        2.107843137562593e-20,
        1.75790980093327e-21,
        -1.173677070929502e-22,
        -8.948047211246454e-24,
        5.669110991590408e-25,
    ],
];

pub const SPLITS: [f64; 17] = [
    0.5520966213424517,
    8.703548331409434,
    16.85500004147642,
    25.0064517515434,
    33.15790346161038,
    41.30935517167736,
    49.46080688174434,
    57.61225859181133,
    65.76371030187831,
    73.91516201194529,
    82.06661372201227,
    90.2180654320793,
    98.3695171421462,
    106.5209688522132,
    114.6724205622802,
    122.8238722723472,
    130.9753239824142,
];
