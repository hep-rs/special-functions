use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-3)
        * polynomial(
            x2,
            &[
                8.,
                -1.,
                0.125,
                -0.021512462131772485,
                -0.0021583309665691133,
                -0.0000653515033308945,
                -1.0206878356142753e-6,
            ],
        )
        + x.powi(3)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.020833333333333332,
                    0.0013020833333333333,
                    0.00003255208333333333,
                    4.5211226851851854e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                5.483249350755313,
                9.25298327939959,
                4.240950669724812,
                -1.7228862095757052,
                1.938246985772668,
                -3.4323123706391,
                8.151741880267862,
                -24.07311274016603,
                84.59024337863897,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        53.68743162354751,
        -83.67011383329668,
        51.047702188081246,
        -27.212788947798032,
        13.328464851798921,
        -6.159360282722756,
        2.7282126588290825,
        -1.170035373142923,
        0.48919901395910803,
        -0.20038384471402712,
        0.08070404966913614,
        -0.03204566958728247,
        0.012572015518378901,
        -0.004881241097802219,
        0.0018781560142216917,
        -0.0007169486581719669,
        0.0002717663754699676,
        -0.00010237320328615381,
        0.00003834776681016035,
        -0.000014292103018586703,
        5.302247536737172e-6,
        -1.9588881728877984e-6,
        7.209418302737385e-7,
        -2.6440386891882604e-7,
        9.665679100051456e-8,
        -3.5228996202668425e-8,
        1.2804605096664226e-8,
        -4.642103508141092e-9,
        1.678889847154096e-9,
        -6.058385037076962e-10,
        2.181628549827525e-10,
        -7.840617286804779e-11,
        2.8126545876477656e-11,
        -1.007223771036331e-11,
        3.600988326184223e-12,
        -1.2854135588697552e-12,
        4.581688337986376e-13,
        -1.6308085636427453e-13,
        5.797035301206992e-14,
        -2.0580835975949206e-14,
        7.297962686864103e-15,
        -2.5849666601650034e-15,
        9.14776508355719e-16,
        -3.2386216482832637e-16,
        1.1589281840948102e-16,
        -4.525840458920003e-17,
        1.4189697998906742e-17,
    ],
    &[
        1.284848429710864,
        -1.1872976533113575,
        0.3491690091620977,
        -0.08297468622872803,
        0.017525500372306244,
        -0.0034391823075100338,
        0.0006416450237202099,
        -0.00011534627630800397,
        0.000020151334048327825,
        -3.4414860843566656e-6,
        5.769813466580202e-7,
        -9.526048146221508e-8,
        1.552528699130035e-8,
        -2.5023949756338768e-9,
        3.9949343001437274e-10,
        -6.324496818712448e-11,
        9.938849562222414e-12,
        -1.551667569044419e-12,
        2.4083253795579565e-13,
        -3.7182745544599085e-14,
        5.713426470683938e-15,
        -8.741173598937818e-16,
        1.3320636832246617e-16,
        -2.0225811882532466e-17,
        3.0608282102244838e-18,
        -4.617805277573177e-19,
        6.946965548862715e-20,
        -1.0423320207493987e-20,
        1.5600832295992358e-21,
        -2.329654960302664e-22,
        3.47137915005221e-23,
        -5.162231992548991e-24,
        7.662157809425299e-25,
        -1.135249103899721e-25,
        1.6791982860887536e-26,
        -2.4798424036250182e-27,
        3.656745367394044e-28,
        -5.38453500432312e-29,
        7.918012845266235e-30,
        -1.162861521352121e-30,
        1.7057317837669944e-31,
        -2.4991345089455127e-32,
        3.6575324984931726e-33,
        -5.34727069052223e-34,
        7.813137595014331e-35,
        -1.1636877856479003e-35,
        1.6610917890618276e-36,
    ],
    &[
        0.13584961119627237,
        -0.16089214736968813,
        0.05945213592327958,
        -0.016913582577636952,
        0.004119246771910904,
        -0.0009116519374913035,
        0.00018969671691111827,
        -0.00003783762785385697,
        7.316909871393417e-6,
        -1.381397296902334e-6,
        2.5582565861909787e-7,
        -4.663099218235181e-8,
        8.387176690058225e-9,
        -1.4915032404357015e-9,
        2.626505528331193e-10,
        -4.585902346784316e-11,
        7.947136360622969e-12,
        -1.3680632603239239e-12,
        2.3411086156378143e-13,
        -3.984917643494141e-14,
        6.75031026200469e-15,
        -1.1384860670173185e-15,
        1.9124877996582166e-16,
        -3.200978008621206e-17,
        5.339591925573456e-18,
        -8.879491386892144e-19,
        1.4723914755219128e-19,
        -2.4350243947215026e-20,
        4.017060924857335e-21,
        -6.611663697947751e-22,
        1.085863992840349e-22,
        -1.7797598237663177e-23,
        2.9115362467143725e-24,
        -4.754519412605342e-25,
        7.751026906883697e-26,
        -1.261597718319136e-26,
        2.0503550844985274e-27,
        -3.327501989528635e-28,
        5.392876596859948e-29,
        -8.729010367700167e-30,
        1.411169533935759e-30,
        -2.278706359023286e-31,
        3.675498579578593e-32,
        -5.9223177872749894e-33,
        9.538984838189031e-34,
        -1.5724633896766917e-34,
        2.4628041090064565e-35,
    ],
    &[
        0.0056763495700632135,
        -0.008554984967975956,
        0.004309768831898416,
        -0.0016365166348944248,
        0.0005069582288786641,
        -0.00013541968244519368,
        0.000032495439723143686,
        -7.223571380038583e-6,
        1.5217294331642557e-6,
        -3.087191476124514e-7,
        6.097121332242597e-8,
        -1.1804448924698101e-8,
        2.2503349076789897e-9,
        -4.2362374100898736e-10,
        7.8905883655828e-11,
        -1.456379142735732e-11,
        2.6667194003908738e-12,
        -4.848712259417123e-13,
        8.761154950433926e-14,
        -1.574230388567736e-14,
        2.8144300705399625e-15,
        -5.008829893547215e-16,
        8.877395503397199e-17,
        -1.5674529033092238e-17,
        2.758033761061231e-18,
        -4.837497999137206e-19,
        8.459880383028086e-20,
        -1.4754485271372108e-20,
        2.566754884500017e-21,
        -4.454721695140365e-22,
        7.714368952565815e-23,
        -1.3331687317264622e-23,
        2.299483044118162e-24,
        -3.95900579336571e-25,
        6.804542108121059e-26,
        -1.1676443779595167e-26,
        2.0005977517302003e-27,
        -3.42280312214161e-28,
        5.84803139511197e-29,
        -9.978684141940685e-30,
        1.7005937595290398e-30,
        -2.8947929478314133e-31,
        4.9220765982932904e-32,
        -8.36035878125459e-33,
        1.4196938569253159e-33,
        -2.4734770283217804e-34,
        4.0722333133440434e-35,
    ],
    &[
        0.00003802685645496943,
        -0.0000665453102710237,
        0.000045376710509549,
        -0.00002488938044332799,
        0.00001133453317746985,
        -4.405380759677166e-6,
        1.4957848292384566e-6,
        -4.5251922747463336e-7,
        1.2407616350153844e-7,
        -3.1299966801012084e-8,
        7.362904113742673e-9,
        -1.6349037195188016e-9,
        3.46452708663967e-10,
        -7.075214377129083e-11,
        1.4041970364621355e-11,
        -2.7272495442992456e-12,
        5.211948190046048e-13,
        -9.84051879969943e-14,
        1.8408782647518812e-14,
        -3.418732639002716e-15,
        6.310972336447628e-16,
        -1.1590176306520863e-16,
        2.1188709921362965e-17,
        -3.857730912876109e-18,
        6.997237460057926e-19,
        -1.2647942667242297e-19,
        2.278911672592411e-20,
        -4.094049843286749e-21,
        7.334833851663659e-22,
        -1.3107606450118543e-22,
        2.3368387874884395e-23,
        -4.156955034365916e-24,
        7.379476260606575e-25,
        -1.3074828166990776e-25,
        2.312374126940618e-26,
        -4.082617654570962e-27,
        7.196487467756649e-28,
        -1.266609760414128e-28,
        2.2260831758792282e-29,
        -3.907052681965981e-30,
        6.8485228489127136e-31,
        -1.198981387934512e-31,
        2.0966320850217467e-32,
        -3.66236333301903e-33,
        6.3961088046787295e-34,
        -1.1476505722716249e-34,
        1.9397995638228066e-35,
    ],
    &[
        5.6571756012089984e-9,
        -1.0603425325317422e-8,
        8.740241256286486e-9,
        -6.3620947657676066e-9,
        4.113371128747485e-9,
        -2.3783274666181834e-9,
        1.2386066792896113e-9,
        -5.851535640828381e-10,
        2.5248657927871685e-10,
        -1.0014227952947425e-10,
        3.672759566574544e-11,
        -1.2524483274883842e-11,
        3.991561573593295e-12,
        -1.1945731086135244e-12,
        3.3721841338165134e-13,
        -9.017242297275769e-14,
        2.293247222119761e-14,
        -5.568385122746931e-15,
        1.295833585019651e-15,
        -2.9008124840717263e-16,
        6.269438528188656e-17,
        -1.3129523823647843e-17,
        2.6738499071880264e-18,
        -5.31403438298183e-19,
        1.0341928482977319e-19,
        -1.9774017600806868e-20,
        3.72596547613296e-21,
        -6.938195177044574e-22,
        1.2799255733560198e-22,
        -2.3439927452569738e-23,
        4.268683095059159e-24,
        -7.740453835370457e-25,
        1.3989276852604982e-25,
        -2.521613725562189e-26,
        4.53542536103265e-27,
        -8.142261557902666e-28,
        1.4592954777261993e-28,
        -2.6113559316629957e-29,
        4.66605231112673e-30,
        -8.325700645506631e-31,
        1.4835510156810935e-31,
        -2.6400739217588e-32,
        4.692270956214151e-33,
        -8.329840968473266e-34,
        1.478372930495898e-34,
        -2.69764243665241e-35,
        4.628079131650008e-36,
    ],
    &[
        4.875823643947992e-16,
        -9.124426553411938e-16,
        7.48576210796385e-16,
        -5.407000089409195e-16,
        3.4589340602779155e-16,
        -1.9732839089476591e-16,
        1.0111767142832707e-16,
        -4.687371676588814e-17,
        1.9788443860839388e-17,
        -7.65560746004065e-18,
        2.7296978277094942e-18,
        -9.017302083957259e-19,
        2.7728012496483506e-19,
        -7.970848617180764e-20,
        2.1504408465529853e-20,
        -5.464235979596935e-21,
        1.3119526218306084e-21,
        -2.98526616958949e-22,
        6.455196954322336e-23,
        -1.3298153037837815e-23,
        2.616026766878065e-24,
        -4.924991562523909e-25,
        8.891261891769356e-26,
        -1.5422147124879446e-26,
        2.574736458072242e-27,
        -4.144488141681238e-28,
        6.442726789798433e-29,
        -9.687513034039076e-30,
        1.4111061000752275e-30,
        -1.994141035546209e-31,
        2.7379961571863574e-32,
        -3.657758161110712e-33,
        4.7612787697287815e-34,
        -6.047569424119049e-35,
        7.506083658793444e-36,
        -9.117072174080377e-37,
        1.0853023721350966e-37,
        -1.268102349611573e-38,
        1.4565708782874345e-39,
        -1.6472410858269036e-40,
        1.8370059252967233e-41,
        -2.0233487557706557e-42,
        2.2044900894652564e-43,
        -2.379444483112228e-44,
        2.5482877991112193e-45,
        -2.7407154098668237e-46,
        2.8679523419235704e-47,
    ],
    &[
        5.21226177071993e-23,
        -9.749304631406916e-23,
        7.98699661990525e-23,
        -5.75569764270189e-23,
        3.6704903867383713e-23,
        -2.085873893056668e-23,
        1.06400563665861e-23,
        -4.906650594915624e-24,
        2.059391590249604e-24,
        -7.916211609094447e-25,
        2.8028676338953984e-25,
        -9.188635383014848e-26,
        2.8022555389985986e-26,
        -7.984075059535314e-27,
        2.133436079289079e-27,
        -5.365320026070031e-28,
        1.2739652501128568e-28,
        -2.8643644479045287e-29,
        6.114517913580203e-30,
        -1.2422755364448313e-30,
        2.4075132790875707e-31,
        -4.4597651658840105e-32,
        7.911845640101731e-33,
        -1.3465913948507888e-33,
        2.2024287731914485e-34,
        -3.4669167390218586e-35,
        5.259986187614427e-36,
        -7.702126506743363e-37,
        1.0898624917803233e-37,
        -1.4920604118119487e-38,
        1.9785407182541537e-39,
        -2.5439710445056752e-40,
        3.1748972775351175e-41,
        -3.849627621247086e-42,
        4.5392290848883744e-43,
        -5.209622888473988e-44,
        5.8245627502677e-45,
        -6.349107349333102e-46,
        6.75309545308486e-47,
        -7.014122873707138e-48,
        7.119605748071353e-49,
        -7.067673827298204e-50,
        6.866834190411541e-51,
        -6.53454122961543e-52,
        6.0953177156530075e-53,
        -5.620360144076508e-54,
        5.0077048937726036e-55,
    ],
];

pub const SPLITS: [f64; 9] = [
    0.3205403213681646,
    1.3086531232578744,
    2.2967659251475845,
    4.272991528927004,
    8.225442736485844,
    16.130345151603525,
    31.940149981838882,
    47.749954812074236,
    63.5597596423096,
];
