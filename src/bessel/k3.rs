#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-3)
        * polynomial(
            x2,
            &[
                8.,
                -1.,
                0.125,
                -0.02151246213177248,
                -0.002158330966569113,
                -0.0000653515033308945,
                -1.020687835614275e-6,
            ],
        )
        + x.powi(3)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.02083333333333333,
                    0.001302083333333333,
                    0.00003255208333333333,
                    4.521122685185185e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                5.483249350755314,
                9.25298327939959,
                4.240950669724813,
                -1.722886209575705,
                1.938246985772668,
                -3.4323123706391,
                8.151741880267863,
                -24.07311274016603,
                84.59024337863898,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        1.027612057341211,
        -4.713719400663061,
        -0.352824432599962,
        -0.112956838947027,
        -0.0247908956327773,
        -0.00347510675176041,
        -0.0002227392676142255,
        6.937479008838269e-6,
        -2.385091356110632e-6,
        -1.697834808024994e-6,
        -1.437040381255417e-7,
        5.987592847807559e-8,
        1.198545195097448e-8,
        -1.913984537557548e-9,
        -7.885187759960397e-10,
        2.537650305307884e-11,
        4.358509886201868e-11,
        2.731670549862448e-12,
        -2.068217258254064e-12,
        -3.407032286403975e-13,
        7.989792221543579e-14,
        2.605382793905182e-14,
        -1.917810342597275e-15,
        -1.612759400456077e-15,
        -4.638528057096984e-17,
        8.496624325029243e-17,
        1.061835493574826e-17,
        -3.732987132831379e-18,
        -9.51569616055123e-19,
        1.187732607182359e-19,
        6.463192881095719e-20,
    ],
    &[
        -26.02620336344492,
        -28.70450502747168,
        -8.438148134563054,
        -1.837420298079813,
        -0.2924060231422913,
        -0.03833703405751172,
        -0.004232215582488291,
        -0.0003832054996455492,
        -0.00003280491990859494,
        -2.492240012193219e-6,
        -1.070615681182042e-7,
        -1.580726159883444e-8,
        -6.105864632393557e-10,
        2.181564791340286e-10,
        -5.450800367083506e-11,
        3.785974300407932e-12,
        1.002599900462196e-12,
        -3.750314241351039e-13,
        5.165573655800841e-14,
        1.592565894732654e-15,
        -2.287702846416151e-15,
        4.821993494294058e-16,
        -2.874663214768512e-17,
        -1.12850926883916e-17,
        3.76464172333209e-18,
        -4.685491127331496e-19,
        -3.127847015159711e-20,
        2.528495711176928e-20,
        -4.835115600406408e-21,
        1.479858684376531e-22,
        1.403662350522834e-22,
    ],
];

pub const SPLITS: [f64; 3] = [-1.137747202833556, 1.507116678620242, 4.15198056007404];
