#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-3)
        * polynomial(
            x2,
            &[
                8.,
                -1.,
                0.125,
                -0.02151246213177248,
                -0.002158330966569113,
                -0.0000653515033308945,
                -1.020687835614275e-6,
            ],
        )
        + x.powi(3)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.02083333333333333,
                    0.001302083333333333,
                    0.00003255208333333333,
                    4.521122685185185e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                5.483249350755314,
                9.25298327939959,
                4.240950669724813,
                -1.722886209575705,
                1.938246985772668,
                -3.4323123706391,
                8.151741880267863,
                -24.07311274016603,
                84.59024337863898,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        4.473589499997765,
        -1.00875824036928,
        -0.002692399439878692,
        -0.0002825480605974812,
        -0.00002154987424520211,
        -1.231734158197415e-6,
        -5.10997981700415e-8,
        -1.257891212780273e-9,
        8.412883816981432e-12,
        2.367685137572131e-12,
        8.766765666293503e-14,
        -1.45929657848389e-15,
        -3.14410711841401e-16,
        -1.397978361698314e-17,
        5.421714038251082e-20,
        4.136461622910236e-20,
        2.204356295429092e-21,
        9.67022425345866e-24,
        -5.683172805508075e-24,
        -3.52273025925342e-25,
        -3.863539457136457e-27,
        7.932326094406401e-28,
        5.662341119445555e-29,
        9.44456416097919e-31,
        -1.107489742903945e-31,
        -9.1253557770418e-33,
        -2.003850595526206e-34,
        1.527954115671252e-35,
        1.471434406409424e-36,
        3.956418639590494e-38,
        -2.056083404783541e-39,
    ],
    &[
        2.418120002618839,
        -1.052079626620182,
        -0.00920939427350635,
        -0.000901303898983631,
        -0.00006074955057375474,
        -2.756647725230241e-6,
        -6.729286204567949e-8,
        5.858027075460928e-10,
        8.906163078796579e-11,
        -1.092008211406175e-12,
        -3.68585334421273e-13,
        -1.229327645932985e-14,
        6.6255515917605e-16,
        6.601224168825264e-17,
        4.454116317073341e-19,
        -2.037793626052406e-19,
        -9.70943035386729e-21,
        3.082582685466456e-22,
        4.605233025929243e-23,
        7.863778115816957e-25,
        -1.29774333862613e-25,
        -8.034905512659827e-27,
        1.340265966508081e-28,
        3.406258192296552e-29,
        9.07097808166141e-31,
        -8.526034308774412e-32,
        -6.744509134552284e-33,
        3.233994148111628e-35,
        2.574513388447465e-35,
        9.31097382098677e-37,
        -5.529393102847858e-38,
    ],
    &[
        0.191278892683077,
        -1.190255227648522,
        -0.02793468010280707,
        -0.00239230452735063,
        -0.0001296012969369825,
        -4.000331990179739e-6,
        -3.872926519003413e-8,
        -1.299744782002833e-10,
        -1.931608402208675e-10,
        -9.31105888473708e-12,
        3.769370006104529e-13,
        3.365144066436844e-14,
        -9.88058167651266e-16,
        -1.347135605730773e-16,
        2.021415094128589e-18,
        5.289313827559082e-19,
        -1.295673852790723e-21,
        -2.041947554529925e-21,
        -1.965556502320138e-23,
        7.712310347212366e-24,
        1.704044092737815e-25,
        -2.833251594861027e-26,
        -1.018990921218942e-27,
        1.003792663928131e-28,
        5.293787429800826e-30,
        -3.381819006110141e-31,
        -2.543408714914839e-32,
        1.054989473687306e-33,
        1.159007086342506e-34,
        -2.8599775295877e-36,
        -5.068955078636001e-37,
    ],
    &[
        -2.532754710463232,
        -1.570290137179311,
        -0.0719273213018862,
        -0.005172831067963337,
        -0.0002235874424124892,
        -5.83245408795645e-6,
        -1.490193485644918e-7,
        -7.386433222307814e-9,
        -1.379235106279389e-10,
        8.78568246680297e-12,
        -7.457375934594762e-14,
        -3.488904021061181e-14,
        8.484909230103552e-16,
        1.055428022736518e-16,
        -5.233493033836358e-18,
        -2.820492104365484e-19,
        2.522673792870451e-20,
        5.441867413008936e-22,
        -1.068424027805965e-22,
        1.188859895437629e-25,
        4.085077344661379e-25,
        -8.903470826280275e-27,
        -1.404195514327661e-27,
        6.391923060146326e-29,
        4.180245642400154e-30,
        -3.387328151615752e-31,
        -9.45634626069152e-33,
        1.540185296789764e-33,
        5.396844473399691e-36,
        -6.229945100955506e-36,
        1.094492117818431e-37,
    ],
    &[
        -6.495117229046533,
        -2.465322675008416,
        -0.1601514228293261,
        -0.00995395261748551,
        -0.0003943470841296471,
        -0.00001217185319128166,
        -3.860789815308995e-7,
        -9.18060997891058e-9,
        -7.008236841253364e-11,
        -5.683033488685327e-12,
        -2.389083500298139e-13,
        1.477386204890237e-14,
        -1.476553112398963e-16,
        -4.206823638735684e-17,
        2.331803708435676e-18,
        2.752043369685042e-20,
        -8.800051564587133e-21,
        3.134358727861019e-22,
        1.457701200742357e-23,
        -1.710980200102024e-24,
        3.026246375088115e-26,
        4.346522420339091e-27,
        -3.033595185338979e-28,
        -6.671171450771045e-31,
        1.063526749364952e-30,
        -4.718467776518053e-32,
        -1.447979128534756e-33,
        2.297590788113976e-34,
        -5.734698772856783e-36,
        -5.265285145077313e-37,
        4.45011228892169e-38,
    ],
    &[
        -13.17547636821951,
        -4.353820490087371,
        -0.3273763529996523,
        -0.01880926026434939,
        -0.000753530235945784,
        -0.00002500460529124862,
        -7.125212499573113e-7,
        -1.557544622973952e-8,
        -3.385373457558118e-10,
        -7.779297965678355e-12,
        -1.106417734098259e-14,
        -3.091604242253097e-15,
        -1.512035742540133e-16,
        1.11597663611324e-17,
        -3.471311819339841e-19,
        -8.992122454576458e-21,
        1.420492276837247e-21,
        -6.078414732370293e-23,
        -1.414979094857304e-25,
        1.700734147587725e-25,
        -9.75679195239044e-27,
        1.246762223524585e-28,
        1.892645624539188e-29,
        -1.471096534879643e-30,
        3.65675596993264e-32,
        1.829027357489091e-33,
        -2.101643889124668e-34,
        7.605736291864831e-36,
        1.21851926336488e-37,
        -2.837816121047062e-38,
        1.373870104404543e-39,
    ],
    &[
        -37.87086174340478,
        -23.32293095684745,
        -3.704696263930508,
        -0.4075640912103082,
        -0.03328708130438147,
        -0.002203761106097103,
        -0.0001209021931528392,
        -5.676070624493495e-6,
        -2.374630807325298e-7,
        -8.485175349010589e-9,
        -2.878328786737166e-10,
        -9.07774952772313e-12,
        -1.535004209509559e-13,
        -1.267167879274561e-14,
        1.341917978409689e-16,
        8.668527990538917e-18,
        -3.484685215093516e-18,
        3.461232901189675e-19,
        -1.930468259530563e-20,
        -7.901508798152468e-23,
        1.505618887033441e-22,
        -1.850512165430457e-23,
        1.23835542298014e-24,
        -2.04091660148337e-26,
        -6.590665085362791e-27,
        9.89499060056531e-28,
        -7.671404831156574e-29,
        2.368493415373778e-30,
        2.729341822284373e-31,
        -5.276236600575122e-32,
        4.652086575000555e-33,
    ],
];

pub const SPLITS: [f64; 8] = [
    -1.137747202833556,
    -0.4765312324701064,
    0.184684737893343,
    0.8459007082567925,
    1.507116678620242,
    2.168332648983691,
    2.829548619347141,
    4.15198056007404,
];
