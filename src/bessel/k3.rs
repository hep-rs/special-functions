use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                8.,
                -1.,
                0.125,
                -0.021512462131772485,
                -0.0021583309665691133,
                -0.0000653515033308945,
                -1.0206878356142753e-6,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.020833333333333332,
                    0.0013020833333333333,
                    0.00003255208333333333,
                    4.5211226851851854e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                5.483249350755313,
                9.25298327939959,
                4.240950669724812,
                -1.7228862095757052,
                1.938246985772668,
                -3.4323123706391,
                8.151741880267862,
                -24.07311274016603,
                84.59024337863897,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 19] = [
    &[],
    &[
        -6.821811247507384e51,
        -1.4714814507158638e52,
        -7.069154320768358e51,
        3.5751216676843277e50,
        7.335765591114102e50,
        -4.017276212643284e49,
        -5.72569361040064e49,
        1.7172944005611146e49,
        -2.3685578006269228e48,
        1.7463030786972689e47,
        -5.691482016170699e45,
    ],
    &[
        219543.6295064012,
        87153.31512367859,
        -739.4434932278723,
        -8579.337968460992,
        1817.478781726069,
        -165.38916880869735,
        6.674150705769237,
        0.005182075048290133,
        -0.009915019048173277,
        0.0002536543156963887,
    ],
    &[
        -8.304656292226907,
        -36.00352423008299,
        14.812013532138945,
        -2.7032871605164983,
        0.29433403338293285,
        -0.021164212557265548,
        0.0010435179557558407,
        -0.00003528846782677814,
        7.890759684820963e-7,
        -1.0581998867995601e-8,
        6.480627957375117e-11,
    ],
    &[
        0.022142039187941453,
        -0.006864615743935035,
        0.0009640742444919131,
        -0.00008047215574218828,
        4.397965347843071e-6,
        -1.6313353102184564e-7,
        4.105147238262888e-9,
        -6.754808587042877e-11,
        6.591574564875977e-13,
        -2.9049703170833583e-15,
    ],
    &[
        9.493061501188036e-7,
        -2.466071153554219e-7,
        2.8833778465055592e-8,
        -1.990922004071436e-9,
        8.94374714268837e-11,
        -2.7098661828089762e-12,
        5.535975892830436e-14,
        -7.350528767440067e-16,
        5.754102582472663e-18,
        -2.0226778410187415e-20,
    ],
    &[
        1.779598114363541e-10,
        -3.956008604728177e-11,
        3.943160309777975e-12,
        -2.312481161298661e-13,
        8.791279246919069e-15,
        -2.2462442232980586e-16,
        3.85647574827148e-18,
        -4.289016215855907e-20,
        2.803244725645216e-22,
        -8.201690989336589e-25,
    ],
    &[
        6.906813544136969e-14,
        -1.3379250922112702e-14,
        1.1593481130587921e-15,
        -5.897213813801522e-17,
        1.9402306063420542e-18,
        -4.2810831574929063e-20,
        6.333959483017651e-22,
        -6.058328783976651e-24,
        3.3987487114658606e-26,
        -8.519352032647262e-29,
    ],
    &[
        4.062734447468878e-17,
        -6.96194362191187e-18,
        5.3284190242436085e-19,
        -2.3903708694710267e-20,
        6.925864830660525e-22,
        -1.3438941292354042e-23,
        1.7461673531062405e-25,
        -1.4648421080618332e-27,
        7.1983357446543e-30,
        -1.5785614620606092e-32,
    ],
    &[
        3.10306164132404e-20,
        -4.762754855797008e-21,
        3.2615212387516886e-22,
        -1.307777302180336e-23,
        3.383418683954788e-25,
        -5.8565297451344774e-27,
        6.781856680274633e-29,
        -5.065801489219399e-31,
        2.2146455201273817e-33,
        -4.316992196601564e-36,
    ],
    &[
        2.824549138515221e-23,
        -3.923343395593127e-24,
        2.4295645402579646e-25,
        -8.803045320257049e-27,
        2.056536299935941e-28,
        -3.2122006296005474e-30,
        3.354301936953756e-32,
        -2.25793624787609e-34,
        8.890073701157437e-37,
        -1.5597551056084434e-39,
    ],
    &[
        2.9101663553123636e-26,
        -3.6899922198418986e-27,
        2.084758268692072e-28,
        -6.887842169881969e-30,
        1.4664979388569597e-31,
        -2.0865136937400793e-33,
        1.9837162877073635e-35,
        -1.2151775365052007e-37,
        4.3519331115099515e-40,
        -6.942027896286927e-43,
    ],
    &[
        3.284076658442292e-29,
        -3.829216685827222e-30,
        1.9885937681962166e-31,
        -6.036726618513565e-33,
        1.180469847940016e-34,
        -1.5419913290622535e-36,
        1.3454404110510167e-38,
        -7.56119662293633e-41,
        2.483391314147657e-43,
        -3.631718368978551e-46,
    ],
    &[
        3.970760594426193e-32,
        -4.284404552592273e-33,
        2.058283189365847e-34,
        -5.778317134534045e-36,
        1.0446279542311714e-37,
        -1.261145820135446e-39,
        1.0167116583543446e-41,
        -5.277772356590423e-44,
        1.6007086356675836e-46,
        -2.1610749358655667e-49,
    ],
    &[
        5.065778044120694e-35,
        -5.0856296452558354e-36,
        2.272634439469635e-37,
        -5.933177681517507e-39,
        9.972483550516485e-41,
        -1.1190761936939938e-42,
        8.383869199174064e-45,
        -4.0434492094073366e-47,
        1.1391296361890681e-49,
        -1.4282281567325026e-52,
    ],
    &[
        6.744528641547206e-38,
        -6.329831512884772e-39,
        2.643805595608203e-40,
        -6.449894216485431e-42,
        1.0128586782156518e-43,
        -1.061701889333059e-45,
        7.42854979321074e-48,
        -3.3454102253566215e-50,
        8.798964971863958e-53,
        -1.0297746813205584e-55,
    ],
    &[
        -6.88702144870509e-40,
        6.131145902261266e-41,
        -2.4285035411563557e-42,
        5.617120282350523e-44,
        -8.36096040672599e-46,
        8.305244130015053e-48,
        -5.5054734261705775e-50,
        2.348448879684381e-52,
        -5.849336650218938e-55,
        6.481337128168778e-58,
    ],
    &[
        7.1672830481623546e-43,
        -6.553258143357643e-44,
        2.6990725233302405e-45,
        -6.59421041269512e-47,
        1.0582979793647506e-48,
        -1.1657808868555621e-50,
        8.926416387265924e-53,
        -4.6912390647936725e-55,
        1.6194507055225947e-57,
        -3.315874551976302e-60,
        3.0579375380165076e-63,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 19] = [
    &[],
    &[
        1.,
        6.740707726403387e40,
        -2.204229559743049e42,
        -8.52726371689251e50,
        -1.83935215462783e51,
        -9.902325861903308e50,
        -1.8524498360969339e50,
        -1.8674900916638525e49,
    ],
    &[
        1.,
        -7.457046594117664,
        26.799253575654618,
        27380.87062376082,
        10999.004799697736,
        3199.0242603329234,
        442.48013844855734,
        64.85639740521927,
        3.4340831970240364,
        0.3741401883179409,
    ],
    &[
        1.,
        -3.176841655311599,
        4.922949697914987,
        -5.997536163925055,
        -0.8650085281535043,
        -0.3158923756935372,
        -0.023324135052024103,
        -0.003735180039344289,
        -0.0001886947321596366,
        -0.000011373911550159763,
        -6.39904050799922e-7,
    ],
    &[
        1.,
        -1.0883864170114765,
        0.5455398429739561,
        -0.1640697674165672,
        0.03404000051493387,
        -0.00489525533551215,
        0.0005241575235071124,
        -0.00003932424368867074,
        2.171568612435137e-6,
        -7.385980405645352e-8,
        1.596695906072729e-9,
    ],
    &[
        1.,
        -0.6908113775793179,
        0.21793640648988377,
        -0.04142328571783825,
        0.005264925421943432,
        -0.0004688842532139751,
        0.000029741486985389018,
        -1.3332647521497697e-6,
        4.0722165844994194e-8,
        -7.735624381885168e-10,
        7.121957302226002e-12,
    ],
    &[
        1.,
        -0.49822377690333874,
        0.11285619945048715,
        -0.015321164093040832,
        0.0013821769870032412,
        -0.00008670598078381864,
        3.837251808805294e-6,
        -1.1856656903123088e-7,
        2.455144079114557e-9,
        -3.0888576365879473e-11,
        1.8039112025638941e-13,
    ],
    &[
        1.,
        -0.38650364402226856,
        0.06772409480754724,
        -0.007088851684871736,
        0.0004912099250166433,
        -0.000023563604229876753,
        7.932429917968707e-7,
        -1.852500008768463e-8,
        2.876217940625704e-10,
        -2.6855267577035204e-12,
        1.1476277379246676e-14,
    ],
    &[
        1.,
        -0.3143766552500734,
        0.04472209141229991,
        -0.0037924824343132713,
        0.00021239889343190914,
        -8.212783183111168e-6,
        2.2216185481384056e-7,
        -4.154015713986185e-9,
        5.141970414517827e-11,
        -3.808154647554491e-13,
        1.2827080652645972e-15,
    ],
    &[
        1.,
        -0.2643049934064334,
        0.031570345436632154,
        -0.0022447785372791654,
        0.00010524945893659819,
        -3.4011359897798352e-6,
        7.674088388730796e-8,
        -1.194258181064317e-9,
        1.227297248866946e-11,
        -7.524527184543915e-14,
        2.0911502043047454e-16,
    ],
    &[
        1.,
        -0.2276678322236699,
        0.023403658531907325,
        -0.0014307504042974505,
        0.00005761499262167309,
        -1.5972033248145953e-6,
        3.087651557075899e-8,
        -4.1110336615911196e-10,
        3.608870268384284e-12,
        -1.886711808415039e-14,
        4.462263272938016e-17,
    ],
    &[
        1.,
        -0.1997726933726861,
        0.01800825430438156,
        -0.0009647232123382071,
        0.00003401724102658578,
        -8.25078988012936e-7,
        1.3942873204074522e-8,
        -1.6212371158082891e-10,
        1.2416015979602578e-12,
        -5.656286502459852e-15,
        1.164242763520229e-17,
    ],
    &[
        1.,
        -0.17786304785454987,
        0.014267955565205237,
        -0.0006798456132918788,
        0.00002131010485232963,
        -4.5920373932263913e-7,
        6.889871788233761e-9,
        -7.108188657675858e-11,
        4.826466453788859e-13,
        -1.9479047518223534e-15,
        3.54890174708681e-18,
    ],
    &[
        1.,
        -0.1602204804995058,
        0.011573562792427959,
        -0.0004963863795037594,
        0.000013999748177562887,
        -2.713155421072801e-7,
        3.659419306067813e-9,
        -3.392152122109021e-11,
        2.068376454661873e-13,
        -7.492106442976508e-16,
        1.2243335082462126e-18,
    ],
    &[
        1.,
        -0.14572141416122003,
        0.009570924615171653,
        -0.0003731278102168856,
        9.562494506442487e-6,
        -1.683423375912022e-7,
        2.0617909342751068e-9,
        -1.734836078639652e-11,
        9.5982114255451e-14,
        -3.1532492044473135e-16,
        4.671451091799025e-19,
    ],
    &[
        1.,
        -0.13360189313957335,
        0.00804330010544388,
        -0.00028735995929341304,
        6.747145374801646e-6,
        -1.0879499691210929e-7,
        1.220133748564024e-9,
        -9.398156263782538e-12,
        4.758424694796217e-14,
        -1.4301436867946053e-16,
        1.9376414345330452e-19,
    ],
    &[
        1.,
        -0.11112773274559246,
        0.005495320586889193,
        -0.00015871782323641164,
        2.950756949137851e-6,
        -3.662069104158184e-8,
        3.034043179752819e-10,
        -1.6182380625743132e-12,
        5.042074496989654e-15,
        -6.992658980570516e-18,
    ],
    &[
        1.,
        -0.11474154397940126,
        0.005931278280665421,
        -0.0001819027353428179,
        3.6653866629628984e-6,
        -5.0708137397470926e-8,
        4.877772102433801e-10,
        -3.2216031044701084e-12,
        1.3982056413329955e-14,
        -3.600989506266458e-17,
        4.179245848698337e-20,
    ],
    &[],
];

pub const SPLITS: [f64; 20] = [
    0.,
    0.22933138868870723,
    1.8076983259416413,
    4.96443220044751,
    11.277899949459245,
    17.591367698470982,
    23.904835447482718,
    30.218303196494453,
    36.53177094550619,
    42.845238694517924,
    49.15870644352967,
    55.4721741925414,
    61.78564194155314,
    68.09910969056487,
    74.41257743957661,
    80.72604518858834,
    87.03951293760008,
    93.35298068661182,
    101.24481537287649,
    std::f64::INFINITY,
];
