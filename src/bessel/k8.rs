#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-8)
        * polynomial(
            x2,
            &[
                645120.,
                -23040.,
                480.,
                -8.,
                0.125,
                -0.002083333333333333,
                0.00004340277777777778,
                -1.550099206349206e-6,
                1.428862156543534e-7,
                5.464141798991691e-9,
            ],
        )
        + x.powi(8) * x.ln() * polynomial(x2, &[-9.68812003968254e-8, -2.691144455467372e-9])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                39.94938812693157,
                616.7186792095061,
                5935.917287391496,
                38397.96495281374,
                167991.0966685601,
                472474.9593803253,
                734023.5976087197,
                355542.6800917236,
                -162957.0617087067,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        2.604550849087052,
        -11.02517179132707,
        -0.6918362480346786,
        -0.2142155606402198,
        -0.04600695929696787,
        -0.006343360792063417,
        -0.0003465967738046046,
        0.00004642866562869737,
        3.494337860308629e-6,
        -3.171804247676274e-6,
        -6.992914147701448e-7,
        5.976493652835972e-8,
        4.47351222199879e-8,
        2.875189800472743e-9,
        -2.125406832650196e-9,
        -4.647821321588335e-10,
        5.965344446874756e-11,
        3.627825145024284e-11,
        1.517399715230076e-12,
        -2.014447968825303e-12,
        -3.799382469609098e-13,
        7.227976618730823e-14,
        3.422182233364863e-14,
        2.577142085186977e-16,
        -2.149677881628319e-15,
        -3.207389152144642e-16,
        9.32699463235829e-17,
        3.394435615523537e-17,
        -1.230850319578889e-18,
        -2.270242680043529e-18,
        -2.547763648436141e-19,
    ],
    &[
        -50.73722144240848,
        -52.98808630602814,
        -14.09340337582982,
        -2.820236507768715,
        -0.3999254434756106,
        -0.04735854739280808,
        -0.004795458392562885,
        -0.000368961549839672,
        -0.00003053498215704167,
        -2.35316314115757e-6,
        4.24462097387863e-8,
        -2.776297078582656e-8,
        -8.237033996597574e-10,
        9.56532095169493e-10,
        -2.230825952394129e-10,
        1.675074882768556e-11,
        4.942026122969761e-12,
        -1.968087775393102e-12,
        2.94938438774927e-13,
        8.681119703996783e-15,
        -1.506455151621961e-14,
        3.527618708301882e-15,
        -2.521974577947376e-16,
        -9.10997186601394e-17,
        3.508088996469555e-17,
        -5.085699909239367e-18,
        -2.516208261261911e-19,
        2.968309352729939e-19,
        -6.64857207259262e-20,
        3.247550419654419e-21,
        2.009522266414545e-21,
    ],
];

pub const SPLITS: [f64; 3] = [0.02843178561634381, 2.404588164233183, 4.780744542850023];
