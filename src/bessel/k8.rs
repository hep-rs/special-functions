#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-8)
        * polynomial(
            x2,
            &[
                645120.,
                -23040.,
                480.,
                -8.,
                0.125,
                -0.002083333333333333,
                0.00004340277777777778,
                -1.550099206349206e-6,
                1.428862156543534e-7,
                5.464141798991691e-9,
            ],
        )
        + x.powi(8) * x.ln() * polynomial(x2, &[-9.68812003968254e-8, -2.691144455467372e-9])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                39.94938812693157,
                616.7186792095061,
                5935.917287391496,
                38397.96495281374,
                167991.0966685601,
                472474.9593803253,
                734023.5976087197,
                355542.6800917236,
                -162957.0617087067,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        10.69945949465654,
        -2.418119874615531,
        -0.006072468291575361,
        -0.0005834772006738686,
        -0.00004124587547728634,
        -2.233042750343242e-6,
        -9.14337423060236e-8,
        -2.484976606475212e-9,
        -9.55642182033532e-12,
        3.445964718124837e-12,
        2.078004360982528e-13,
        4.562639292124524e-15,
        -2.289884037309383e-16,
        -2.72592372520302e-17,
        -1.222362218279165e-18,
        -7.265804192078914e-21,
        3.013419823445446e-21,
        2.305285080877812e-22,
        7.051821149018019e-24,
        -2.076104372559521e-25,
        -3.625686163597807e-26,
        -1.896722373478705e-27,
        -1.922449183939207e-29,
        4.652483181409237e-30,
        3.875022072910831e-31,
        1.22678353322094e-32,
        -3.865472283888123e-34,
        -6.662089238816094e-35,
        -3.405580020246091e-36,
        -2.097041187592845e-38,
        9.55320051053385e-39,
    ],
    &[
        5.781754184357283,
        -2.510207298100532,
        -0.01895555194231144,
        -0.001742143282892798,
        -0.0001129591972948989,
        -5.122630431314821e-6,
        -1.350251262236375e-7,
        7.281725377730926e-10,
        2.339390913276307e-10,
        5.817465773681319e-12,
        -4.856655471464094e-13,
        -4.535565804404303e-14,
        -8.105626866205756e-16,
        1.140417996738392e-16,
        9.15188819431569e-18,
        8.312952940284484e-20,
        -2.988694907753149e-20,
        -1.976065199117075e-21,
        6.491574534630856e-24,
        8.138599375201127e-24,
        4.264737588169525e-25,
        -8.940961599477498e-27,
        -2.218746416492159e-27,
        -8.677209827684957e-29,
        4.251422670469754e-30,
        5.914818059550301e-31,
        1.523237943706137e-32,
        -1.601250044892405e-33,
        -1.516320743799228e-34,
        -1.689357579955748e-36,
        5.35934836499646e-37,
    ],
    &[
        0.5160114593452878,
        -2.785031117288728,
        -0.05459973173066133,
        -0.004522617477316319,
        -0.0002417609658272284,
        -7.303962549216677e-6,
        -2.54568169660053e-8,
        4.559107185311202e-9,
        -2.463458644470286e-10,
        -3.109789858152404e-11,
        -1.637282609673558e-14,
        1.170629652244961e-13,
        2.901289014639437e-15,
        -4.1699053129678e-16,
        -2.286389014251063e-17,
        1.252049519189351e-18,
        1.332688365264369e-19,
        -2.323974049475693e-21,
        -6.685108909727579e-22,
        -5.936585264298611e-24,
        2.974798919422669e-24,
        1.019380601458508e-25,
        -1.15690828600984e-26,
        -7.726638637066288e-28,
        3.632730234648729e-29,
        4.616905106609145e-30,
        -6.168481179852816e-32,
        -2.391548515312207e-32,
        -2.886706394813084e-34,
        1.091825918710751e-34,
        4.107891796043466e-36,
    ],
    &[
        -5.716511777933299,
        -3.515881556656414,
        -0.1369535732041984,
        -0.00957656804202153,
        -0.0003918277815447839,
        -8.071712297395371e-6,
        -1.227977595969865e-7,
        -1.248528642476456e-8,
        -4.06200715518716e-10,
        2.871956011797932e-11,
        7.279493424132322e-13,
        -1.316336186483193e-13,
        -1.226812378862738e-15,
        5.763947172444586e-16,
        -3.126589071805717e-18,
        -2.517628009432166e-18,
        5.187009924286961e-20,
        1.076530772089431e-20,
        -4.051021821921672e-22,
        -4.427367479624294e-23,
        2.603026443333934e-24,
        1.706250150949181e-25,
        -1.517488497817343e-26,
        -5.853370408560224e-28,
        8.296503056598467e-29,
        1.538501568815117e-30,
        -4.31116394077918e-31,
        -6.728888942073368e-34,
        2.139040501204988e-33,
        -3.075256772353883e-35,
        -1.012191678168888e-35,
    ],
    &[
        -14.29218567048069,
        -5.191726513742163,
        -0.295695489486032,
        -0.0174305366434027,
        -0.0006146737253200117,
        -0.00001577452539835921,
        -5.147624497012521e-7,
        -1.239618592751202e-8,
        1.50416084670224e-10,
        -8.152171046709117e-12,
        -8.797585688019866e-13,
        5.605340481280712e-14,
        3.568800261682345e-16,
        -2.262955797811378e-16,
        9.34504334337014e-18,
        4.267583279917202e-19,
        -5.71638681782069e-20,
        1.06063308900914e-21,
        1.78837557367985e-22,
        -1.302067643110076e-23,
        -9.86231707118302e-26,
        5.872957061056899e-26,
        -2.473369657256605e-27,
        -1.245311151685548e-28,
        1.657359619899143e-29,
        -2.916444692548863e-31,
        -5.609054423518438e-32,
        4.028278795382583e-33,
        4.039642719420644e-35,
        -1.929425283903204e-35,
        7.888362957759379e-37,
    ],
    &[
        -27.84047659691302,
        -8.590048857066648,
        -0.5767657556337108,
        -0.03057369368853159,
        -0.00108069230202982,
        -0.0000321562454314957,
        -8.624898304933151e-7,
        -1.502189694056637e-8,
        -3.147725851780296e-10,
        -1.041973527872346e-11,
        2.299720350420116e-13,
        -6.232233148432426e-15,
        -5.449813845793796e-16,
        4.852600714956754e-17,
        -1.551846443253346e-18,
        -4.642733066643686e-20,
        7.756160348349282e-21,
        -3.616564490699651e-22,
        -7.092282152096348e-25,
        1.196404619368044e-24,
        -7.6613128328548e-26,
        1.194598272665558e-27,
        1.705063077756812e-28,
        -1.524394097981342e-29,
        4.520993842566187e-31,
        2.039631096806429e-32,
        -2.867374795227754e-33,
        1.235162075900092e-34,
        1.353973546717508e-36,
        -5.069188099634051e-37,
        2.942099234558578e-38,
    ],
    &[
        -73.08591793039073,
        -41.43216200970128,
        -5.935972040112629,
        -0.5914751199735274,
        -0.04318640298303209,
        -0.002582681733318933,
        -0.0001271934125344533,
        -5.325755702449861e-6,
        -2.059270335575552e-7,
        -6.175620277960376e-9,
        -2.063342895405881e-10,
        -6.62660325828418e-12,
        1.244767962488147e-13,
        -2.67936642750157e-14,
        1.198752581260364e-15,
        1.245678386790855e-17,
        -1.181380175724869e-17,
        1.500299040686165e-18,
        -1.104270075553112e-19,
        2.913767589259465e-21,
        5.117079874260624e-22,
        -9.53774797647717e-23,
        8.961368543059358e-24,
        -4.407016120071269e-25,
        -1.492578890302818e-26,
        5.876214189090483e-27,
        -6.956742972210844e-28,
        4.680263262286978e-29,
        -5.28300985691411e-31,
        -3.389291396772707e-31,
        5.181672905521591e-32,
    ],
];

pub const SPLITS: [f64; 8] = [
    0.02843178561634381,
    0.6224708802705537,
    1.216509974924764,
    1.810549069578974,
    2.404588164233183,
    2.998627258887393,
    3.592666353541603,
    4.780744542850023,
];
