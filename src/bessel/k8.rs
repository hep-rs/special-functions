use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-8)
        * polynomial(
            x2,
            &[
                645120.,
                -23040.,
                480.,
                -8.,
                0.125,
                -0.0020833333333333333,
                0.00004340277777777778,
                -1.5500992063492063e-6,
                1.4288621565435345e-7,
                5.4641417989916915e-9,
            ],
        )
        + x.powi(8) * x.ln() * polynomial(x2, &[-9.68812003968254e-8, -2.6911444554673723e-9])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                39.94938812693157,
                616.718679209506,
                5935.917287391496,
                38397.96495281374,
                167991.09666856012,
                472474.9593803253,
                734023.5976087196,
                355542.68009172357,
                -162957.06170870663,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 13] = [
    &[
        114881.58782556164,
        -184940.5107248261,
        109501.08888261931,
        -52411.110073923126,
        21509.16239467975,
        -7860.366315964937,
        2623.864786583024,
        -814.5110806278833,
        238.2213373942087,
        -66.29093874762582,
        17.68485374683744,
        -4.549955474141066,
        1.1343375826062716,
        -0.27510128496448927,
        0.06511012514172064,
        -0.015078936989399626,
        0.0034248236993979176,
        -0.0007643363430087225,
        0.00016789012227931465,
        -0.00003634787643869912,
        7.765781869542174e-6,
        -1.6391393090375315e-6,
        3.421269317687171e-7,
        -7.067536080752102e-8,
        1.4460599393821066e-8,
        -2.9324820740411108e-9,
        5.897643797957017e-10,
        -1.1769365412148177e-10,
        2.3317039181100322e-11,
        -4.588114140407746e-12,
        8.970415865566084e-13,
        -1.7432919467187759e-13,
        3.368641306392086e-14,
        -6.474440266822087e-15,
        1.2380475356086603e-15,
        -2.3559990325313703e-16,
        4.462948661336112e-17,
        -8.417363346171365e-18,
        1.5809893044790403e-18,
        -2.957775997170157e-19,
        5.512696404018096e-20,
        -1.0237618861637088e-20,
        1.8946943921296187e-21,
        -3.495131783239215e-22,
        6.433802707515058e-23,
        -1.2174328958266533e-23,
        2.153639579820417e-24,
    ],
    &[
        884.4819888888525,
        -1130.4107465687794,
        464.55934947879257,
        -146.2017859143863,
        38.40475962629466,
        -8.847479310920836,
        1.8442990066054579,
        -0.35529394884501414,
        0.06420812840429102,
        -0.011005886122176586,
        0.0018043680110220184,
        -0.0002847834163323947,
        0.000043494578579518206,
        -6.4549978934773385e-6,
        9.340724547487143e-7,
        -1.321658956330054e-7,
        1.8329300005523093e-8,
        -2.496525621103426e-9,
        3.345331729581487e-10,
        -4.416736116855491e-11,
        5.7528609661146035e-12,
        -7.400769313823473e-13,
        9.412643272836676e-14,
        -1.1845932207319334e-14,
        1.4763469417290147e-15,
        -1.8233556247752797e-16,
        2.2330012880418365e-17,
        -2.713219539247086e-18,
        3.272497897476405e-19,
        -3.919870748981392e-20,
        4.664910981694289e-21,
        -5.517718367727999e-22,
        6.488904785468529e-23,
        -7.589576392997835e-24,
        8.831312882527589e-25,
        -1.0226143961314691e-25,
        1.17865232182204e-26,
        -1.3525299546733441e-27,
        1.5455686304981449e-28,
        -1.7591228401092033e-29,
        1.994576749839173e-30,
        -2.2533405545219193e-31,
        2.5368467374491145e-32,
        -2.846551197183109e-33,
        3.1843870591306397e-34,
        -3.594160613268272e-35,
        3.947498495762717e-36,
    ],
    &[
        27.816006649626136,
        -41.63268307025023,
        21.42485741841153,
        -8.59976016252736,
        2.8968028734934026,
        -0.8568935800985588,
        0.22935001813964592,
        -0.05670470878657946,
        0.013144682047300026,
        -0.0028886202705488534,
        0.0006068756613066797,
        -0.0001226963716360882,
        0.000023996885270052182,
        -4.559341825771642e-6,
        8.44453936787062e-7,
        -1.5290556170577784e-7,
        2.7132547743363592e-8,
        -4.727861209777551e-9,
        8.10408458188635e-10,
        -1.3685533907392126e-10,
        2.2798443454921853e-11,
        -3.750850617605767e-12,
        6.100576093683723e-13,
        -9.817776274331007e-14,
        1.5645815873823188e-14,
        -2.4707615228439387e-15,
        3.868868544426716e-16,
        -6.010397386777431e-17,
        9.268514298306542e-18,
        -1.4194024969360056e-18,
        2.1595932564531779e-19,
        -3.26569496298257e-20,
        4.909853430352095e-21,
        -7.341587832932205e-22,
        1.0921140976903349e-22,
        -1.6166664730479715e-23,
        2.3820783205746656e-24,
        -3.494422729643323e-25,
        5.104719617595219e-26,
        -7.427317216857629e-27,
        1.076554996265197e-27,
        -1.5547468535316718e-28,
        2.237548631552972e-29,
        -3.209544728602748e-30,
        4.59091893557764e-31,
        -6.673319650598062e-32,
        9.297472926016302e-33,
    ],
    &[
        0.2759428993013236,
        -0.4571217537027385,
        0.2791612139391922,
        -0.13553286055018007,
        0.05531571321949469,
        -0.01974784857764608,
        0.006345271467676087,
        -0.0018737124108019173,
        0.0005164539119723212,
        -0.0001344495906980236,
        0.0000333610705095413,
        -7.946448402650425e-6,
        1.8273708256149303e-6,
        -4.0756164095043624e-7,
        8.849166106368443e-8,
        -1.876299203925187e-8,
        3.895113548910765e-9,
        -7.93429984480374e-10,
        1.5888346636165145e-10,
        -3.1327589095274043e-11,
        6.090541930884604e-12,
        -1.168934737660397e-12,
        2.217122150316501e-13,
        -4.159671010426191e-14,
        7.726040805154567e-15,
        -1.4216830747576758e-15,
        2.5934721972155663e-16,
        -4.6929873064539423e-17,
        8.428236967831867e-18,
        -1.5029763510267524e-18,
        2.6624699443977896e-19,
        -4.687124712254524e-20,
        8.203034949192098e-21,
        -1.4276855649432088e-21,
        2.47179452179613e-22,
        -4.2582896974580946e-23,
        7.301512903180897e-24,
        -1.2463745911420167e-24,
        2.1185464415602103e-25,
        -3.586490921488256e-26,
        6.048201241220258e-27,
        -1.0162117269074068e-27,
        1.7014351697164662e-28,
        -2.8391920245274805e-29,
        4.7258692156904136e-30,
        -8.043998309588384e-31,
        1.2946221734275935e-31,
    ],
    &[
        0.0005281799694315291,
        -0.0009419864387502965,
        0.0006770437762988659,
        -0.0004027036153547703,
        0.0002038287685672911,
        -0.00009002387522594463,
        0.00003544483076244116,
        -0.000012665683914459207,
        4.169296116620211e-6,
        -1.2801004846538714e-6,
        3.703846972788129e-7,
        -1.018619410557017e-7,
        2.6817047692232474e-8,
        -6.7985311939520066e-9,
        1.6678440994330148e-9,
        -3.9756374027431484e-10,
        9.239585121188477e-11,
        -2.0996097944942744e-11,
        4.676465996492315e-12,
        -1.023021871980549e-12,
        2.201940990265244e-13,
        -4.670242084225296e-14,
        9.773663676092392e-15,
        -2.0204944875861655e-15,
        4.1302540806669817e-16,
        -8.356018099880492e-17,
        1.6744267437434074e-17,
        -3.3256780594520298e-18,
        6.551071936823732e-19,
        -1.2805768130384423e-19,
        2.485300130109063e-20,
        -4.7910398830473705e-21,
        9.177783954855654e-22,
        -1.7476970015601045e-22,
        3.309509164720597e-23,
        -6.2339939039162434e-24,
        1.16842122291464e-24,
        -2.179604379084074e-25,
        4.047687537484151e-26,
        -7.484885999924408e-27,
        1.3784876099763146e-27,
        -2.5289720405833816e-28,
        4.6226091732896545e-29,
        -8.42012313822736e-30,
        1.5300992257330277e-30,
        -2.855581489987955e-31,
        4.989481946910972e-32,
    ],
    &[
        5.987083888080982e-8,
        -1.041054986733099e-7,
        6.983403858612677e-8,
        -3.741507173693769e-8,
        1.6552824567814544e-8,
        -6.219416704552536e-9,
        2.0307336627973146e-9,
        -5.871261025472119e-10,
        1.52657954357347e-10,
        -3.616307713650311e-11,
        7.891825697750991e-12,
        -1.601784884997916e-12,
        3.04904996559413e-13,
        -5.483302856086189e-14,
        9.376771829512041e-15,
        -1.533541112758796e-15,
        2.4109253579984424e-16,
        -3.659986603223833e-17,
        5.386575207665499e-18,
        -7.712642736505132e-19,
        1.077655484631254e-19,
        -1.4733311131578966e-20,
        1.975464949823274e-21,
        -2.602900561841356e-22,
        3.376130446551661e-23,
        -4.317257368877881e-24,
        5.449938119108033e-25,
        -6.7993108091843e-26,
        8.391907257224491e-27,
        -1.0255552100598903e-27,
        1.24192501908678e-28,
        -1.4913063692071525e-29,
        1.776798019961546e-30,
        -2.101577314000786e-31,
        2.4688855691518354e-32,
        -2.882012946251044e-33,
        3.3442829160728055e-34,
        -3.859036447328508e-35,
        4.429616035010421e-36,
        -5.059349684371833e-37,
        5.75153496082471e-38,
        -6.509423211909158e-39,
        7.336204214805437e-40,
        -8.235005504740144e-41,
        9.210193898965927e-42,
        -1.0386646704597e-42,
        1.1393049543918369e-43,
    ],
    &[
        1.7553678371927517e-11,
        -3.0246047578988726e-11,
        1.9807813471883878e-11,
        -1.0242471234707561e-11,
        4.332197054599638e-12,
        -1.5429967444275039e-12,
        4.73672413905842e-13,
        -1.276899702558503e-13,
        3.068971163121441e-14,
        -6.6593085593734015e-15,
        1.3183582996507775e-15,
        -2.40269774872517e-16,
        4.062503089720125e-17,
        -6.416074805818466e-18,
        9.52240202143094e-19,
        -1.335291794204248e-19,
        1.7778227192034618e-20,
        -2.2575037724140763e-21,
        2.745262202439107e-22,
        -3.209257744040486e-23,
        3.6192451561994074e-24,
        -3.950377053752656e-25,
        4.1857660642444677e-26,
        -4.3175239349786825e-27,
        4.346378896020323e-28,
        -4.2802371073876735e-29,
        4.1321623243887965e-30,
        -3.9182207145546e-31,
        3.655526796040038e-32,
        -3.360687160739243e-33,
        3.0487123762354446e-34,
        -2.7323756966188804e-35,
        2.4219442773190573e-36,
        -2.125188217390492e-37,
        1.8475745536493227e-38,
        -1.5925672324874376e-39,
        1.3619724645820693e-40,
        -1.1562869687865326e-41,
        9.75022049322043e-43,
        -8.16988436962003e-44,
        6.805354700971341e-45,
        -5.6374400815772866e-46,
        4.645760802749252e-47,
        -3.809863580505434e-48,
        3.1101381958920358e-49,
        -2.5441859483470695e-50,
        2.04596911208998e-51,
    ],
    &[
        4.8609777974155575e-15,
        -9.068525992023781e-15,
        7.373281396999156e-15,
        -5.250952774522112e-15,
        3.2980850675920352e-15,
        -1.8414225745068375e-15,
        9.213619006028616e-16,
        -4.16392546387602e-16,
        1.7122651654494467e-16,
        -6.450306490015712e-17,
        2.2398385138446696e-17,
        -7.209712635822211e-18,
        2.1621948482334256e-18,
        -6.06952459069821e-19,
        1.601493484384887e-19,
        -3.987278835886033e-20,
        9.400307254319546e-21,
        -2.1054036355793964e-21,
        4.49331690338907e-22,
        -9.163428857805418e-23,
        1.7904063857462587e-23,
        -3.3598820446076925e-24,
        6.070061667042925e-25,
        -1.0580980520296243e-25,
        1.783384850615237e-26,
        -2.9122849010189997e-27,
        4.616791740164243e-28,
        -7.118362924828316e-29,
        1.0693970581532392e-29,
        -1.5680988724509984e-30,
        2.248078150698999e-31,
        -3.1561071149616693e-32,
        4.345735758144949e-33,
        -5.8773792551094055e-34,
        7.818395434583976e-35,
        -1.0243192282671418e-35,
        1.323339370852845e-36,
        -1.6878076286996459e-37,
        2.1274074147061045e-38,
        -2.6526336775795593e-39,
        3.274831717814802e-40,
        -4.006236602806249e-41,
        4.8600111917212805e-42,
        -5.850295557232245e-43,
        6.993503023797772e-44,
        -8.416734343023378e-45,
        9.796355226525343e-46,
    ],
    &[
        1.1194544524719852e-21,
        -2.0852747511006385e-21,
        1.687922415129503e-21,
        -1.193434781878248e-21,
        7.423245586847178e-22,
        -4.0949611796863637e-22,
        2.0200143744755484e-22,
        -8.981859664446265e-23,
        3.6266917392999445e-23,
        -1.3388758004892757e-23,
        4.5470664110002115e-24,
        -1.4285568905327786e-24,
        4.17266156159482e-25,
        -1.1382495200696153e-25,
        2.911652036663965e-26,
        -7.010040661759672e-27,
        1.5938039305386763e-27,
        -3.432477256778259e-28,
        7.021836405244201e-29,
        -1.367969310978293e-29,
        2.5439550965742597e-30,
        -4.525824537845259e-31,
        7.718286912842714e-32,
        -1.2641504277067897e-32,
        1.992038979762014e-33,
        -3.0250864709986295e-34,
        4.4340106742718947e-35,
        -6.282261351312548e-36,
        8.615975477993671e-37,
        -1.1453607491269463e-37,
        1.4776938647762648e-38,
        -1.85252351180509e-39,
        2.2594012898926672e-40,
        -2.6839208483070203e-41,
        3.108667048634903e-42,
        -3.514596604710043e-43,
        3.882673815358669e-44,
        -4.1955418352951406e-45,
        4.439007575205821e-46,
        -4.603155348692127e-47,
        4.6829707775767056e-48,
        -4.678436859383584e-49,
        4.594141996471943e-50,
        -4.4385038895864273e-51,
        4.223031137941659e-52,
        -3.993167642836618e-53,
        3.662920468084065e-54,
    ],
    &[
        3.175101611434302e-28,
        -5.910655362906581e-28,
        4.7753527525709855e-28,
        -3.366154232648694e-28,
        2.085280573404381e-28,
        -1.1446095140337477e-28,
        5.613590101058707e-29,
        -2.4797250788315117e-29,
        9.940148024078082e-30,
        -3.640618583819791e-30,
        1.2258407756812539e-30,
        -3.815799945725151e-31,
        1.1035748752006344e-31,
        -2.9787647792269247e-32,
        7.534402541812793e-33,
        -1.792376212752683e-33,
        4.0236202834626896e-34,
        -8.549099349750823e-35,
        1.7239776291784085e-35,
        -3.3078142395696824e-36,
        6.05269938314167e-37,
        -1.058464180898604e-37,
        1.7724423161249155e-38,
        -2.847238160215378e-39,
        4.395030751379618e-40,
        -6.529304856241407e-41,
        9.349197412982e-42,
        -1.2920492880590755e-42,
        1.7255987625105686e-43,
        -2.229884501518953e-44,
        2.7912770166512324e-45,
        -3.388215259568152e-46,
        3.992379384893313e-47,
        -4.570974110998754e-48,
        5.089855632368908e-49,
        -5.517058856717422e-50,
        5.826191590873663e-51,
        -5.9991796180993715e-52,
        6.027965738757792e-53,
        -5.91495671983107e-54,
        5.672229688696235e-55,
        -5.319706575207162e-56,
        4.882644255925066e-57,
        -4.38885054056528e-58,
        3.8661993917543263e-59,
        -3.3629971050978046e-60,
        2.830494073530161e-61,
    ],
    &[
        9.90135791117659e-35,
        -1.8425751116561446e-34,
        1.4871758304051316e-34,
        -1.046640848982789e-34,
        6.470004355143025e-35,
        -3.5421929951364723e-35,
        1.7320207768239484e-35,
        -7.625272395480365e-36,
        3.04537198834943e-36,
        -1.110925324984923e-36,
        3.724598347942332e-37,
        -1.1541029472968723e-37,
        3.32165456022073e-38,
        -8.919967876829167e-39,
        2.244038006505656e-39,
        -5.308144797214145e-40,
        1.1845070757998185e-40,
        -2.501031015275205e-41,
        5.010425346040214e-42,
        -9.547485802309011e-43,
        1.7344282897955331e-43,
        -3.0101636525396466e-44,
        5.0007175497515925e-45,
        -7.9663852780377e-46,
        1.2189850929396706e-46,
        -1.794377754660458e-47,
        2.5446739397885732e-48,
        -3.481258037482674e-49,
        4.600147324328217e-50,
        -5.878283213600429e-51,
        7.271994868795413e-52,
        -8.718343994514441e-53,
        1.0139567137157622e-53,
        -1.1450227814299269e-54,
        1.2566118949074968e-55,
        -1.3413560004550474e-56,
        1.393761401493092e-57,
        -1.4107936827173842e-58,
        1.3921415333122212e-59,
        -1.3401342854568407e-60,
        1.2593479824814739e-61,
        -1.1559828694059656e-62,
        1.0371227481666431e-63,
        -9.099910437655855e-65,
        7.813343356583184e-66,
        -6.611291877005211e-67,
        5.408077261801908e-68,
    ],
    &[
        3.2540760181999717e-41,
        -6.054370394297529e-41,
        4.883656018859842e-41,
        -3.433707552434502e-41,
        2.1199045935547767e-41,
        -1.158809160078569e-41,
        5.6561179332512386e-42,
        -2.4851737047127743e-42,
        9.903708388285962e-43,
        -3.604340249118842e-43,
        1.2054142817526086e-43,
        -3.7252346839073826e-44,
        1.0691888747427623e-44,
        -2.862821620539611e-45,
        7.180143043825567e-46,
        -1.693005903113694e-46,
        3.765361525291788e-47,
        -7.922842254361234e-48,
        1.581494800403346e-48,
        -3.0022728239209887e-49,
        5.432756519966848e-50,
        -9.390513568904966e-51,
        1.5534489997560304e-51,
        -2.4638754332085197e-52,
        3.7529510335245327e-53,
        -5.498274681046358e-54,
        7.75890004360418e-55,
        -1.0560226310903201e-55,
        1.3879924856950464e-56,
        -1.7637991695224366e-57,
        2.169379466934783e-58,
        -2.5852004473514895e-59,
        2.9877709474714167e-60,
        -3.3519162845282536e-61,
        3.6534949278734516e-62,
        -3.8721313566074656e-63,
        3.993523657811329e-64,
        -4.010961473961352e-65,
        3.9258397451017915e-66,
        -3.7471391568679655e-67,
        3.4900221275268398e-68,
        -3.1738262140558733e-69,
        2.819802365058253e-70,
        -2.4489398519744643e-71,
        2.08023637825477e-72,
        -1.7402020779911482e-73,
        1.4069727878249259e-74,
    ],
    &[
        1.1050121597452827e-47,
        -2.055651654100064e-47,
        1.6574999316094546e-47,
        -1.164654928962957e-47,
        7.184336731181583e-48,
        -3.923217450180118e-48,
        1.912686077986325e-48,
        -8.393059244038726e-49,
        3.3400275778806643e-49,
        -1.213730390596756e-49,
        4.052625314255882e-50,
        -1.2503157722679272e-50,
        3.58220770090055e-51,
        -9.573849447694571e-52,
        2.3965583056024742e-52,
        -5.639532658607935e-53,
        1.2516658682567505e-53,
        -2.628010578899755e-54,
        5.2341389525066696e-55,
        -9.913466837075214e-56,
        1.7896144790270537e-56,
        -3.085727498271731e-57,
        5.091648854036758e-58,
        -8.054463461143771e-59,
        1.223514848445678e-59,
        -1.787483520946759e-60,
        2.5150953383059824e-61,
        -3.4129044149843666e-62,
        4.471888223084826e-63,
        -5.66448570713983e-64,
        6.943959323859826e-65,
        -8.246638570375376e-66,
        9.497074613892062e-67,
        -1.061553823609964e-67,
        1.1526774603382345e-68,
        -1.2168622859446615e-69,
        1.2499096534048375e-70,
        -1.2500805090505186e-71,
        1.218210412040259e-72,
        -1.1574966085960937e-73,
        1.0730124949255138e-74,
        -9.710450053814896e-76,
        8.583681591220759e-77,
        -7.41560833006593e-78,
        6.264773346260584e-79,
        -5.210624470506349e-80,
        4.1883322300153557e-81,
    ],
];

pub const SPLITS: [f64; 14] = [
    1.0288398267661059,
    1.9519978074760203,
    2.8751557881859346,
    4.721471749605763,
    8.414103672445421,
    15.799367518124738,
    23.184631363804055,
    30.56989520948337,
    45.340422900842,
    60.11095059220063,
    74.88147828355926,
    89.6520059749179,
    104.42253366627652,
    119.19306135763516,
];
