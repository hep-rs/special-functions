use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                645120.,
                -23040.,
                480.,
                -8.,
                0.125,
                -0.0020833333333333333,
                0.00004340277777777778,
                -1.5500992063492063e-6,
                1.4288621565435345e-7,
                5.4641417989916915e-9,
            ],
        )
        + x.powi(0) * x.ln() * polynomial(x2, &[-9.68812003968254e-8, -2.6911444554673723e-9])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                39.94938812693157,
                616.718679209506,
                5935.917287391496,
                38397.96495281374,
                167991.09666856012,
                472474.9593803253,
                734023.5976087196,
                355542.68009172357,
                -162957.06170870663,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 35] = [
    &[],
    &[
        4.01792775359407e13,
        1.0667134429636196e12,
        -9.337425268746064e11,
        -3.812208369319299e10,
        1.2085400650382704e10,
        7.225136998743356e8,
        -9.14595182734906e7,
        -2.484359218654349e7,
        4.467238352482191e6,
        -279818.8338413884,
        6592.231964106375,
    ],
    &[
        -21876.939274648274,
        2270.5917469804626,
        869.4442004946261,
        -243.58866340158497,
        28.324701984169508,
        -1.8741769175008438,
        0.07403819703836044,
        -0.0016402381487135445,
        0.000015771799447015517,
    ],
    &[
        484.88873815324587,
        -178.72967835529624,
        30.109886519833555,
        -3.0421954005012672,
        0.2030951035203691,
        -0.009286964088349814,
        0.0002907407171250791,
        -6.005662559122461e-6,
        7.422778381318064e-8,
        -4.1794303106942093e-10,
    ],
    &[
        0.005221200988968678,
        -0.0015928120707337857,
        0.00021979637532210453,
        -0.00001799962022577787,
        9.63620568128746e-7,
        -3.495822948129628e-8,
        8.589985364230504e-10,
        -1.3779508290863454e-11,
        1.3087720520151399e-13,
        -5.604917665140278e-16,
    ],
    &[
        5.538500528237169e-7,
        -1.4241350930107806e-7,
        1.646990584124458e-8,
        -1.1240116145762443e-9,
        4.9870762320450647e-11,
        -1.4913113409313568e-12,
        3.0046568247696924e-14,
        -3.931777485139068e-16,
        3.0311765930486606e-18,
        -1.0486300625292047e-20,
    ],
    &[
        -3.066979235372934e-10,
        6.989057157034719e-11,
        -7.136981313701757e-12,
        4.2853705030077666e-13,
        -1.666976904449001e-14,
        4.355380276939388e-16,
        -7.641409529130442e-18,
        8.679111355427568e-20,
        -5.789403393926346e-22,
        1.7276361842883e-24,
    ],
    &[
        -2.379843074404039e-13,
        4.737253789054551e-14,
        -4.216657178822111e-15,
        2.202389107604419e-16,
        -7.437462062049753e-18,
        1.683757718502467e-19,
        -2.5549667568218246e-21,
        2.5053937627250914e-23,
        -1.440404721247868e-25,
        3.6986553650213953e-28,
    ],
    &[
        -2.539722619603079e-16,
        4.4837015153415043e-17,
        -3.534578029794564e-18,
        1.6327921252428688e-19,
        -4.870330209544789e-21,
        9.726573064640798e-23,
        -1.300415510242271e-24,
        1.1222234296104629e-26,
        -5.671572590733551e-29,
        1.2788113365482045e-31,
    ],
    &[
        -3.3334922832679675e-19,
        5.2839328736784455e-20,
        -3.736287072730456e-21,
        1.546695333563089e-22,
        -4.130540308041761e-24,
        7.379044868272099e-26,
        -8.817492576680047e-28,
        6.795305675578084e-30,
        -3.0644798057314583e-32,
        6.161021782015737e-35,
    ],
    &[
        -5.043833848654962e-22,
        7.251183328534582e-23,
        -4.6470321102476866e-24,
        1.742319408289313e-25,
        -4.211444180066465e-27,
        6.805323679506493e-29,
        -7.351074732213473e-31,
        5.118156975943364e-33,
        -2.0840630912569988e-35,
        3.78107729014862e-38,
    ],
    &[
        -8.450736056035964e-25,
        1.1111904878297128e-25,
        -6.509888921898093e-27,
        2.2300963424580705e-28,
        -4.9227930722976945e-30,
        7.261186673379092e-32,
        -7.156294630911839e-34,
        4.5439787243347024e-36,
        -1.686676922486514e-38,
        2.7883936500208877e-41,
    ],
    &[
        -1.52707455271979e-27,
        1.849654916312199e-28,
        -9.977893875585728e-30,
        3.1461827671012967e-31,
        -6.390046098039505e-33,
        8.669103236575517e-35,
        -7.855537109938971e-37,
        4.5845500321496585e-39,
        -1.563584371559023e-41,
        2.374286758677031e-44,
    ],
    &[
        -2.9231612993396425e-30,
        3.281437340064036e-31,
        -1.64005411096855e-32,
        4.789808084728849e-34,
        -9.007947308427477e-36,
        1.1312542985377424e-37,
        -9.486507063737955e-40,
        5.122184571443358e-42,
        -1.6158274110114359e-44,
        2.268884354530485e-47,
    ],
    &[
        -5.852816743972196e-33,
        6.121298780065357e-34,
        -2.8496920284740254e-35,
        7.750221537973287e-37,
        -1.3569910094767622e-38,
        1.5862374801567936e-40,
        -1.237871546790962e-42,
        6.218603525092722e-45,
        -1.8247808898724425e-47,
        2.3829692926723477e-50,
    ],
    &[
        -1.2145068624697907e-35,
        1.1888891190747015e-36,
        -5.179313393741049e-38,
        1.3178953812832399e-39,
        -2.1585129394224609e-41,
        2.359811167590907e-43,
        -1.722021602891151e-45,
        8.087876771446158e-48,
        -2.2184911339906926e-50,
        2.7076925863375564e-53,
    ],
    &[
        -2.594103178549589e-38,
        2.386421584816223e-39,
        -9.768459542401584e-41,
        2.3351470763921384e-42,
        -3.5925304879526733e-44,
        3.688674719439886e-46,
        -2.5276414177608542e-48,
        1.114636417855029e-50,
        -2.870237809466308e-53,
        3.2882300517376096e-56,
    ],
    &[
        -5.673782885078223e-41,
        4.92274743365621e-42,
        -1.9002165282147236e-43,
        4.2830289060343475e-45,
        -6.212143954806095e-47,
        6.012589730048421e-49,
        -3.883327661327889e-51,
        1.613866646524732e-53,
        -3.916046821611001e-56,
        4.227062937364548e-59,
    ],
    &[
        -1.2656542869420137e-43,
        1.0389952262708193e-44,
        -3.794232573743908e-46,
        8.089824700167129e-48,
        -1.1098144409013704e-49,
        1.0158878835251465e-51,
        -6.204678026517916e-54,
        2.438206870881624e-56,
        -5.5936612763316805e-59,
        5.7080932495465725e-62,
    ],
    &[
        -2.8704354374223124e-46,
        2.2359202284329203e-47,
        -7.747036201162781e-49,
        1.567037473413065e-50,
        -2.0392944281062023e-52,
        1.7706232838079728e-54,
        -1.0256823223002157e-56,
        3.8224396905459365e-59,
        -8.31585264784594e-62,
        8.046500966390821e-65,
    ],
    &[
        -6.602114897977248e-49,
        4.892450578034988e-50,
        -1.612521401424661e-51,
        3.1025209134898916e-53,
        -3.8401405370958056e-55,
        3.1709715700841544e-57,
        -1.746810877409922e-59,
        6.190262086430513e-62,
        -1.2805005482380842e-64,
        1.1780250007693458e-67,
    ],
    &[
        -1.536895555804369e-51,
        1.0860317402939917e-52,
        -3.4130780367687306e-54,
        6.261099467269058e-56,
        -7.388380747495747e-58,
        5.816108108055066e-60,
        -3.0541915885684e-62,
        1.0316741738078676e-64,
        -2.0340885161525533e-67,
        1.7835082100299338e-70,
    ],
    &[
        -3.615073297449359e-54,
        2.4411758438481687e-55,
        -7.33095391980347e-57,
        1.284982039711588e-58,
        -1.448781441298245e-60,
        1.0896040229645548e-62,
        -5.466270063033318e-65,
        1.7638935933443127e-67,
        -3.322091510319954e-70,
        2.7823139615312357e-73,
    ],
    &[
        -8.580508336453954e-57,
        5.547896806658253e-58,
        -1.5951462333743114e-59,
        2.6768591214740342e-61,
        -2.889335344252502e-63,
        2.0802186517129437e-65,
        -9.989772305324547e-68,
        3.085606301818286e-70,
        -5.5624119206967125e-73,
        4.458833979316585e-76,
    ],
    &[
        -2.0527836427345626e-59,
        1.2731273318796117e-60,
        -3.5110530707397247e-62,
        5.6511433057871663e-64,
        -5.850103139316491e-66,
        4.039341178835622e-68,
        -1.8602644118874066e-70,
        5.5100943910963725e-73,
        -9.524964033888366e-76,
        7.321258336411292e-79,
    ],
    &[
        -4.945359438563204e-62,
        2.9468513125304216e-63,
        -7.807966844092087e-65,
        1.2073519169323253e-66,
        -1.200718443861126e-68,
        7.964375312891798e-71,
        -3.5234092950701826e-73,
        1.0024868872591893e-75,
        -1.664556505380774e-78,
        1.2289127107542148e-81,
    ],
    &[
        -1.1987566901356863e-64,
        6.873642458619642e-66,
        -1.7524543107444473e-67,
        2.607398528756695e-69,
        -2.4949655419910946e-71,
        1.5922461657287368e-73,
        -6.777074550481824e-76,
        1.8550872486763748e-78,
        -2.9633073486669264e-81,
        2.1046408309101984e-84,
    ],
    &[
        -2.9217861061101533e-67,
        1.6144146130773553e-68,
        -3.9661745393954763e-70,
        5.686119130776794e-72,
        -5.242557268216028e-74,
        3.2236347870689933e-76,
        -1.3219711987409298e-78,
        3.486386349855788e-81,
        -5.365458712121012e-84,
        3.6712578666512717e-87,
    ],
    &[
        -7.156456552450771e-70,
        3.815462759553453e-71,
        -9.044283389435634e-73,
        1.251054928115746e-74,
        -1.112883677832854e-76,
        6.602172480628049e-79,
        -2.612076765421473e-81,
        6.64585743121209e-84,
        -9.866946397962737e-87,
        6.512987191203706e-90,
    ],
    &[
        -1.760608947835014e-72,
        9.068329830818376e-74,
        -2.0766266548056564e-75,
        2.774942193686934e-77,
        -2.3845692278786075e-79,
        1.3665297703480644e-81,
        -5.222517117334512e-84,
        1.283501734298672e-86,
        -1.8406434543682702e-89,
        1.1735421818632574e-92,
    ],
    &[
        -4.3486562052652893e-75,
        2.1663678659032867e-76,
        -4.798064707813187e-78,
        6.200898208062921e-80,
        -5.1534010200767235e-82,
        2.8561232791193194e-84,
        -1.0556069055341953e-86,
        2.508846574706133e-89,
        -3.479313337478184e-92,
        2.1451609153574612e-95,
    ],
    &[
        -1.0779805448674987e-77,
        5.199558256473593e-79,
        -1.1149868648409199e-80,
        1.3951432654382736e-82,
        -1.122561073385312e-84,
        6.023324111223242e-87,
        -2.15524323048749e-89,
        4.959005818111021e-92,
        -6.657823709015122e-95,
        3.97382528844913e-98,
    ],
    &[
        -2.6809412730612087e-80,
        1.2533085492985085e-81,
        -2.604763714967552e-83,
        3.1587582529990356e-85,
        -2.4631941824655083e-87,
        1.280879273270844e-89,
        -4.441645212006052e-92,
        9.903990879668961e-95,
        -1.2885713792540774e-97,
        7.453121115665227e-101,
    ],
    &[
        -6.687417014416323e-83,
        3.032876834075344e-84,
        -6.1148155819469746e-86,
        7.193535242546677e-88,
        -5.441622283835676e-90,
        2.7449510281679773e-92,
        -9.23336344406755e-95,
        1.9971425354009853e-97,
        -2.5204801010842956e-100,
        1.4141068522977715e-103,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 35] = [
    &[],
    &[
        1.,
        -12.814050032184088,
        76.52235550477191,
        -282.5726378666933,
        721.4816835992954,
        -1347.8536531514596,
        1897.846568630443,
        -2036.343227665518,
        6.228351515411201e7,
        1.6525538125197662e6,
        777281.9165262849,
    ],
    &[
        1.,
        -3.4490200834179623,
        5.563508711816249,
        -5.563889160960272,
        3.8516803647868594,
        -1.9480977170241276,
        0.737858290654198,
        -0.2092423820145817,
        0.008722191904780827,
        -0.0016551007925982694,
    ],
    &[
        1.,
        -1.9719480456525007,
        1.8278189502023559,
        -1.0524659632216666,
        0.41654311400580474,
        -0.11664407810418358,
        0.02186330557248755,
        -0.0017350021317163852,
        0.00023914330845062603,
        -7.565751520944879e-6,
        6.347699120294632e-7,
    ],
    &[
        1.,
        -0.9720920759413847,
        0.4335273535532027,
        -0.1171303122145768,
        0.02130565833915286,
        -0.002738683446308683,
        0.00025348359370556755,
        -0.000016815269458029712,
        7.776921935989516e-7,
        -2.29753719499904e-8,
        3.623328381250749e-10,
    ],
    &[
        1.,
        -0.6523893940459228,
        0.19412333326409797,
        -0.03474824291397169,
        0.004151517405106834,
        -0.0003467306072586603,
        0.000020562686601361487,
        -8.583920130092187e-7,
        2.4272447617446944e-8,
        -4.232449287905583e-10,
        3.508628992874531e-12,
    ],
    &[
        1.,
        -0.4406216204975111,
        0.08719979872177674,
        -0.010183830731741934,
        0.0007744636358474704,
        -0.00003983321173607823,
        1.388248912797809e-6,
        -3.168981670380704e-8,
        4.3131016216365847e-10,
        -2.678745171942951e-12,
    ],
    &[
        1.,
        -0.3475275429481195,
        0.05409263001738642,
        -0.004952507324791522,
        0.0002941507523625232,
        -0.000011763656521053514,
        3.1709254897882563e-7,
        -5.562117966259495e-9,
        5.7698170235750606e-11,
        -2.7019664539508526e-13,
    ],
    &[
        1.,
        -0.2858461625018272,
        0.036526702501692404,
        -0.0027397518407120927,
        0.00013299410252548487,
        -4.335061493852045e-6,
        9.494232498132779e-8,
        -1.348133036726146e-9,
        1.1271163223360255e-11,
        -4.2314382589977476e-14,
    ],
    &[
        1.,
        -0.24223332532050904,
        0.026197093088427645,
        -0.0016606394341316896,
        0.00006801885209445996,
        -1.867475618721015e-6,
        3.438074960038783e-8,
        -4.094491637726801e-10,
        2.8636499620093743e-12,
        -8.966339824359193e-15,
    ],
    &[
        1.,
        -0.20988715048103737,
        0.01964981184685804,
        -0.001077206863733436,
        0.00003811494881857132,
        -9.028998367303308e-7,
        1.4323194216550722e-8,
        -1.467646505353683e-10,
        8.816971635397381e-13,
        -2.366916981076656e-15,
    ],
    &[
        1.,
        -0.1850035988304892,
        0.015256508921111167,
        -0.0007361787767277107,
        0.00002291004444410238,
        -4.769208512707324e-7,
        6.6423128014556986e-9,
        -5.969422630905138e-11,
        3.1417884876758997e-13,
        -7.37992554336588e-16,
    ],
    &[
        1.,
        -0.16530070013709114,
        0.012173766934814655,
        -0.0005243168519283915,
        0.000014555447695784642,
        -2.7012487945693595e-7,
        3.351696721480013e-9,
        -2.681573634421826e-11,
        1.2554652217569052e-13,
        -2.621068190702666e-16,
    ],
    &[
        1.,
        -0.14933202132183052,
        0.009931461095183934,
        -0.0003861117341374253,
        9.671310805041613e-6,
        -1.6186831761208717e-7,
        1.8104329515263675e-9,
        -1.3049548883781382e-11,
        5.5010932448128233e-14,
        -1.0334576583805156e-16,
    ],
    &[
        1.,
        -0.13613901414601132,
        0.008251647368230234,
        -0.0002922800114930358,
        6.667802393933239e-6,
        -1.0160483700230439e-7,
        1.0342474297656946e-9,
        -6.781891816796971e-12,
        2.5997414558902683e-14,
        -4.439146741204767e-17,
    ],
    &[
        1.,
        -0.12506268760144407,
        0.006961871586759181,
        -0.00022641974143194446,
        4.741454039491018e-6,
        -6.630318941327297e-8,
        6.191651413872844e-10,
        -3.723560338523084e-12,
        1.3086355880764207e-14,
        -2.0479342053049974e-17,
    ],
    &[
        1.,
        -0.11563580962512619,
        0.005950731163070305,
        -0.0001788749359545749,
        3.46134185045617e-6,
        -4.471645894038292e-8,
        3.8568868591570437e-10,
        -2.1417970647191757e-12,
        6.9488766244825735e-15,
        -1.0036172850432337e-17,
    ],
    &[
        1.,
        -0.10751830074149966,
        0.0051437625387975566,
        -0.00014371697626145284,
        2.5844927891825788e-6,
        -3.102353765659571e-8,
        2.485828042439102e-10,
        -1.2821418194707092e-12,
        3.862825083915156e-15,
        -5.179596700059871e-18,
    ],
    &[
        1.,
        -0.10045697418524005,
        0.004489714159764312,
        -0.00011717257905164739,
        1.9679360353961342e-6,
        -2.205868929759961e-8,
        1.6502298222268384e-10,
        -7.945544777204349e-13,
        2.2342568884542763e-15,
        -2.7956791100632898e-18,
    ],
    &[
        1.,
        -0.09425959267905716,
        0.003952404219547261,
        -0.00009676443491264707,
        1.524389239399913e-6,
        -1.6025283152525796e-8,
        1.1242306334483946e-10,
        -5.075294552856676e-13,
        1.3379395772192147e-15,
        -1.5692540201332494e-18,
    ],
    &[
        1.,
        -0.08877765675177478,
        0.0035057163253227617,
        -0.00008082137288876688,
        1.1988300286462075e-6,
        -1.1865154132784579e-8,
        7.835775960015162e-11,
        -3.3296455602155985e-13,
        8.261003355390425e-16,
        -9.11793579474409e-19,
    ],
    &[
        1.,
        -0.0838946904092668,
        0.0031304267637335174,
        -0.0000681887942626724,
        9.555804151876354e-7,
        -8.934441709119948e-9,
        5.573406250842309e-11,
        -2.2368672456907937e-13,
        5.241262625750584e-16,
        -5.462814383052711e-19,
    ],
    &[
        1.,
        -0.07951808615640929,
        0.0028121371909006687,
        -0.00005805192413737285,
        7.70920628256894e-7,
        -6.829923133288037e-9,
        4.036836463653821e-11,
        -1.5349622684619437e-13,
        3.407173667210107e-16,
        -3.3638625853116232e-19,
    ],
    &[
        1.,
        -0.07557331249625365,
        0.0025398944735169145,
        -0.0000498248208363754,
        6.287258046811001e-7,
        -5.2925093538827475e-9,
        2.9720219938615876e-11,
        -1.0736026071338658e-13,
        2.2638316117580203e-16,
        -2.1230494869186095e-19,
    ],
    &[
        1.,
        -0.07199972464091302,
        0.0023052490537629816,
        -0.000043078891852908084,
        5.178128249462353e-7,
        -4.1518471152677505e-9,
        2.2206222823725483e-11,
        -7.639821385446594e-14,
        1.534171787082598e-16,
        -1.3701012589793591e-19,
    ],
    &[
        1.,
        -0.06874748506978869,
        0.0021015998401592182,
        -0.00003749579638555335,
        4.302846891696832e-7,
        -3.2935787847344506e-9,
        1.6816011922620496e-11,
        -5.5224337691232015e-14,
        1.058515096405824e-16,
        -9.02251435279111e-20,
    ],
    &[
        1.,
        -0.06577526634381707,
        0.00192373032685888,
        -0.00003283577237506306,
        3.6047297052767667e-7,
        -2.6394790807263346e-9,
        1.2891018670444863e-11,
        -4.0493844483961623e-14,
        7.423855149698375e-17,
        -6.05219737931818e-20,
    ],
    &[
        1.,
        -0.0630485143573971,
        0.001767474816616781,
        -0.000028915936796097367,
        3.042478549379817e-7,
        -2.1351148295087208e-9,
        9.993587873059869e-12,
        -3.008409565602153e-14,
        5.285344716803231e-17,
        -4.128900894399695e-20,
    ],
    &[
        1.,
        -0.060538119132757376,
        0.0016294747226349969,
        -0.00002559516486578802,
        2.585592491662319e-7,
        -1.7420112605089306e-9,
        7.827683468522612e-12,
        -2.2621190165458623e-14,
        3.81507144772544e-17,
        -2.8608724684563357e-20,
    ],
    &[
        1.,
        -0.058219386041156375,
        0.0015069982424070348,
        -0.000022763389065413843,
        2.2112615373314957e-7,
        -1.4325801179221516e-9,
        6.1897873765717855e-12,
        -1.719961475401688e-14,
        2.789026886524359e-17,
        -2.0108557445598282e-20,
    ],
    &[
        1.,
        -0.056071231280247116,
        0.0013978052732269738,
        -0.000020333917564710827,
        1.9022297464072882e-7,
        -1.1867760117032155e-9,
        4.93788034686555e-12,
        -1.3212539151307176e-14,
        2.0630534502249527e-17,
        -1.4322409997658962e-20,
    ],
    &[
        1.,
        -0.054075546693636296,
        0.0013000450648103146,
        -0.000018237847343607987,
        1.6453031990320012e-7,
        -9.898551456711738e-10,
        3.971481982394985e-12,
        -1.0246993970589721e-14,
        1.542792820639702e-17,
        -1.032734543590779e-20,
    ],
    &[
        1.,
        -0.0522166938384928,
        0.0012121778577266938,
        -0.00001641995128134508,
        1.4302938059587207e-7,
        -8.308497285519634e-10,
        3.218587039945274e-12,
        -8.017908084687727e-15,
        1.1655047232855657e-17,
        -7.532283646610208e-21,
    ],
    &[
        1.,
        -0.05048109768185705,
        0.0011329142997869531,
        -0.00001483561614584978,
        1.249262072286132e-7,
        -7.015146615793757e-10,
        2.6269798038281305e-12,
        -6.325878077690293e-15,
        8.88859128530566e-18,
        -5.552587704355099e-21,
    ],
    &[],
];

pub const SPLITS: [f64; 36] = [
    0.,
    0.8139941545585064,
    3.7844787442249457,
    6.754963333891385,
    12.695932513224264,
    18.636901692557142,
    24.57787087189002,
    30.5188400512229,
    36.45980923055578,
    42.40077840988865,
    48.341747589221534,
    54.282716768554415,
    60.22368594788729,
    66.16465512722017,
    72.10562430655305,
    78.04659348588592,
    83.9875626652188,
    89.92853184455169,
    95.86950102388457,
    101.81047020321743,
    107.75143938255032,
    113.6924085618832,
    119.63337774121608,
    125.57434692054895,
    131.51531609988183,
    137.4562852792147,
    143.3972544585476,
    149.33822363788047,
    155.27919281721336,
    161.2201619965462,
    167.1611311758791,
    173.10210035521197,
    179.04306953454486,
    184.98403871387774,
    190.92500789321062,
    std::f64::INFINITY,
];
