#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-9)
        * polynomial(
            x2,
            &[
                -6.571138360796385e6,
                -205348.073774887,
                -3666.929888837269,
                -50.92958178940651,
                -0.6366197723675813,
                -0.007957747154594767,
                -0.0001105242660360384,
                -1.9736476077864e-6,
                -6.167648774332502e-8,
                -5.243925645868637e-9,
            ],
        )
        + x.powi(9) * x.ln() * polynomial(x2, &[3.426471541295834e-9])
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                25.7035233093411,
                1518.114345457959,
                94565.872769152,
                5.6887282837693e6,
                3.110312189150865e8,
                1.446943149661225e10,
                5.206411511727444e11,
                1.208050171080509e13,
                9.98319238601254e13,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 14.92256510455152
        + x1 * polynomial(
            x1,
            &[
                40.375,
                0.0,
                251.5026041666667,
                0.0,
                4360.0583984375,
                0.0,
                36993.98662894113,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 20] = [
    &[
        -725182.6486649074,
        1.032784426680211e6,
        -498153.9909711958,
        187404.5615139728,
        -59275.16244492718,
        16485.4619067149,
        -4150.287009242349,
        964.909094394568,
        -210.1745788767005,
        43.3537038833936,
        -8.538982866128398,
        1.616341108033029,
        -0.2955691093854404,
        0.0524344854879327,
        -0.00905564533969998,
        0.001526966902102311,
        -0.0002520079824410474,
        0.00004079270096295817,
        -6.488067714745248e-6,
        1.015522508909986e-6,
        -1.566371688802365e-7,
        2.383683595706279e-8,
        -3.582674649117406e-9,
        5.323238091010642e-10,
        -7.825548981272468e-11,
        1.13906071221236e-11,
        -1.642714541166096e-12,
        2.348686346912972e-13,
        -3.332164799550482e-14,
        4.779072454471366e-15,
        -6.551333906231786e-16,
    ],
    &[
        -18545.026424423,
        20896.21581428268,
        -7350.900719868591,
        1965.100188841351,
        -436.8365308887625,
        84.91580845273742,
        -14.89560977539127,
        2.408444011849494,
        -0.3643893182068664,
        0.05216528232428889,
        -0.007126418087970429,
        0.000935225716165979,
        -0.0001185265413743043,
        0.0000145691453146943,
        -1.743041297049984e-6,
        2.035715324450269e-7,
        -2.326707556483425e-8,
        2.607960144821879e-9,
        -2.871994119172805e-10,
        3.112234339462025e-11,
        -3.323242054831823e-12,
        3.500854541969687e-13,
        -3.642238337477532e-14,
        3.745867432655691e-15,
        -3.811440620936228e-16,
        3.839753279788078e-17,
        -3.832538625582354e-18,
        3.792295055087805e-19,
        -3.722412121602496e-20,
        3.659094495299636e-21,
        -3.505999365268247e-22,
    ],
    &[
        -1036.14490110754,
        1406.28541343012,
        -639.244759683353,
        226.6822020043543,
        -67.7203007206208,
        17.82526655818241,
        -4.254443483742539,
        0.939023858394504,
        -0.1943882323842005,
        0.03814107708660878,
        -0.007150758897936357,
        0.001289146416847272,
        -0.0002246208516141904,
        0.00003798330674774425,
        -6.254817806750181e-6,
        1.005904364231033e-6,
        -1.583680042047374e-7,
        2.445914869090092e-8,
        -3.712339638435205e-9,
        5.545660200774488e-10,
        -8.164690107746019e-11,
        1.18609019700521e-11,
        -1.70191589645548e-12,
        2.414353439365023e-13,
        -3.388929835607566e-14,
        4.710235021199286e-15,
        -6.486761345429358e-16,
        8.85686222829245e-17,
        -1.199946627539486e-17,
        1.640979516469944e-18,
        -2.152049746400684e-19,
    ],
    &[
        -26.40580216175829,
        37.91328583919019,
        -19.42901276246498,
        7.994198535893548,
        -2.820472465243073,
        0.8867869787228651,
        -0.2547636854042275,
        0.06805875454236925,
        -0.01712219680061192,
        0.004095472194937084,
        -0.000938258410711131,
        0.000207085540620414,
        -0.00004424144128380407,
        9.18405307166406e-6,
        -1.858463907083923e-6,
        3.67582603437737e-7,
        -7.122401405747158e-8,
        1.354614773029245e-8,
        -2.533110562012571e-9,
        4.664197841615142e-10,
        -8.467208647230231e-11,
        1.517166910707438e-11,
        -2.685896227936447e-12,
        4.702110743487192e-13,
        -8.146820035854044e-14,
        1.397923824351924e-14,
        -2.377152157168152e-15,
        4.008366906174161e-16,
        -6.710183867858619e-17,
        1.143439211432474e-17,
        -1.835753446922786e-18,
    ],
    &[
        -0.6786908537402936,
        0.8613463343631463,
        -0.2864279015771565,
        0.154156126875069,
        -0.05704814315423176,
        0.01639778945279766,
        -0.005305982761735829,
        0.001576342869785792,
        -0.0004193112403977067,
        0.0001098123943532314,
        -0.00002795677966711626,
        6.819001486896598e-6,
        -1.615635122473236e-6,
        3.738686129479927e-7,
        -8.450862506221653e-8,
        1.870194689532961e-8,
        -4.061879703957653e-9,
        8.672215746514621e-10,
        -1.822671624101926e-10,
        3.775972540802005e-11,
        -7.719476143710433e-12,
        1.558912387622475e-12,
        -3.112571917218843e-13,
        6.149346652005928e-14,
        -1.202992390247944e-14,
        2.331861058742641e-15,
        -4.481295197547056e-16,
        8.543047342188914e-17,
        -1.618110692302207e-17,
        3.140829407726254e-18,
        -5.664134597236143e-19,
    ],
    &[
        0.07207093576039662,
        -0.01076742715681127,
        0.0931600558638578,
        0.1375173262484335,
        -0.08634737799949657,
        -0.0478608279641206,
        0.01365275351920772,
        0.007666563989202089,
        -0.00097723009757209,
        -0.0006744335201367894,
        0.00003076335859510934,
        0.00003832121958786525,
        -1.927333851813807e-8,
        -1.492801628420398e-6,
        -4.561646454986533e-8,
        4.363772763663634e-8,
        2.058674944266272e-9,
        -9.43896779358209e-10,
        -6.468117778102716e-11,
        1.769698860480898e-11,
        1.083714860581154e-12,
        -2.059985962213003e-13,
        -2.747896720700188e-14,
        4.449949129250173e-15,
        -6.991499197977584e-17,
        3.77057658298634e-17,
        -1.623666130414384e-17,
        2.980955852232885e-18,
        -5.248956090465427e-19,
        1.117194850733129e-19,
        -2.184071124973113e-20,
    ],
    &[
        -0.003415887356397349,
        -0.08712783045112765,
        0.003946676524687662,
        -0.1320826195897438,
        0.02181171609875001,
        0.06892923914925406,
        -0.006554423280432909,
        -0.01174987263286701,
        0.0007281724116925499,
        0.001056836785081085,
        -0.00004163243205827171,
        -0.00006000968284476842,
        1.356423776416731e-6,
        2.368993562623424e-6,
        -2.315787603915805e-8,
        -6.909873198051248e-8,
        -9.10279385289824e-12,
        1.553527879689545e-9,
        1.215528117242482e-11,
        -2.778032129246706e-11,
        -3.837499413962601e-13,
        4.048482453068141e-13,
        7.481285074054885e-15,
        -4.902866210790213e-15,
        -1.083820398127694e-16,
        5.013741028744715e-17,
        1.24892480694102e-18,
        -4.387779492212915e-19,
        -1.187322036682589e-20,
        3.301858194281608e-21,
        9.53273937532124e-23,
    ],
    &[
        0.005334228344916598,
        0.07881066082464539,
        0.0004300251472369227,
        0.1032349498199632,
        -0.0277584663804735,
        -0.06176154815088445,
        0.00922360852672276,
        0.01137268926052666,
        -0.001234887893406516,
        -0.001079920551096169,
        0.0000917943916697104,
        0.00006375039683797964,
        -4.375594769004153e-6,
        -2.588589228344732e-6,
        1.455852156861871e-7,
        7.710176023995261e-8,
        -3.577841366423252e-9,
        -1.761617090856991e-9,
        6.763153636966039e-11,
        3.191001965396279e-11,
        -1.013681902533967e-12,
        -4.700295406418618e-13,
        1.233348848083287e-14,
        5.744515775112573e-15,
        -1.240954269144531e-16,
        -5.921601713272037e-17,
        1.047930869199884e-18,
        5.219282229807778e-19,
        -7.515251852916847e-21,
        -3.952595110365645e-21,
        4.61884509320933e-23,
    ],
    &[
        -0.01175122438179595,
        -0.06204859049601405,
        -0.006600256997816005,
        -0.07808381840207803,
        0.0494544832982713,
        0.0488421209313832,
        -0.01609812505952566,
        -0.00924054369465471,
        0.002189766235468997,
        0.0008967121462901574,
        -0.0001684943569693575,
        -0.00005389145674309285,
        8.42156487315695e-6,
        2.22058745755312e-6,
        -2.967343446688509e-7,
        -6.693087539590502e-8,
        7.78681438526521e-9,
        1.543917549277712e-9,
        -1.583463667808258e-10,
        -2.818260931714678e-11,
        2.571622670047316e-12,
        4.177243285097704e-13,
        -3.415562480288112e-14,
        -5.131521151884534e-15,
        3.781828197191469e-16,
        5.312457698816446e-17,
        -3.546495604382202e-18,
        -4.69954896942577e-19,
        2.854583943893807e-20,
        3.570268900028914e-21,
        -1.994282541836926e-22,
    ],
    &[
        0.01687046644911064,
        0.03829272351446957,
        0.01078619391776402,
        0.04812362716456945,
        -0.06817527411315016,
        -0.03020147722774644,
        0.02207385175821593,
        0.005727953604752334,
        -0.003010755593161879,
        -0.0005570137380623591,
        0.0002333180998179343,
        0.00003353331714988381,
        -0.00001178052749738862,
        -1.383545895234357e-6,
        4.202484662736199e-7,
        4.174067795251686e-8,
        -1.118277900347437e-8,
        -9.63458815983733e-10,
        2.308452257833549e-10,
        1.759446029121314e-11,
        -3.808415005277714e-12,
        -2.608695965560046e-13,
        5.140323999006002e-14,
        3.205621919812349e-15,
        -5.7847295958562e-16,
        -3.31986778459213e-17,
        5.51332792594932e-18,
        2.938268620818898e-19,
        -4.509291089609939e-20,
        -2.233624061056753e-21,
        3.200158358872106e-22,
    ],
    &[
        -0.01891380949660163,
        -0.00987774855962248,
        -0.01249507317580869,
        -0.01401297438968542,
        0.07555979707387106,
        0.007757175739410105,
        -0.02442588849282301,
        -0.001353357523834884,
        0.003334167833794804,
        0.0001219573180709975,
        -0.0002589315615292247,
        -6.821370356332756e-6,
        0.0000131142656170571,
        2.619645648876123e-7,
        -4.696116700986741e-7,
        -7.373448201727824e-9,
        1.255057097388037e-8,
        1.593106835044262e-10,
        -2.603001342170862e-10,
        -2.735571313445293e-12,
        4.315577515966859e-12,
        3.835693738823193e-14,
        -5.854370788518621e-14,
        -4.487850186117847e-16,
        6.621907089734618e-16,
        4.459309667870168e-18,
        -6.343200271389877e-18,
        -3.817559657733676e-20,
        5.213841074815258e-20,
        2.830597231356496e-22,
        -3.718068357479899e-22,
    ],
    &[
        0.01723631986036249,
        -0.01817847354911936,
        0.01163815194685684,
        -0.01912191134158521,
        -0.06822966412308113,
        0.01445447880091548,
        0.02200420422478343,
        -0.00302309595267721,
        -0.00300046602013193,
        0.0003171736715944598,
        0.0002329268232668711,
        -0.00002034971042013623,
        -0.00001179802332307207,
        8.866266871312278e-7,
        4.226517954868847e-7,
        -2.802904221883725e-8,
        -1.130311838786698e-8,
        6.732805433327446e-10,
        2.346304878102287e-10,
        -1.271597000347649e-11,
        -3.89390491908165e-12,
        1.938882195347007e-13,
        5.288162522991104e-14,
        -2.437645288719531e-15,
        -5.9884103220308e-16,
        2.571040789270884e-17,
        5.743193149975292e-18,
        -2.307947473827331e-19,
        -4.72630179902399e-20,
        1.772936751454247e-21,
        3.374375321060774e-22,
    ],
    &[
        -0.01217195711621961,
        0.04004600739089,
        -0.008562618053765429,
        0.04487342319753063,
        0.04721789412997127,
        -0.03177850181095421,
        -0.01512163248509587,
        0.006443839570208355,
        0.00205161805900803,
        -0.0006610200882732552,
        -0.0001585888590384452,
        0.00004165790543738701,
        8.002122067439766e-6,
        -1.788579740306967e-6,
        -2.856695101536434e-7,
        5.586106117709478e-8,
        7.615141117286966e-9,
        -1.328449114124075e-9,
        -1.576004942194111e-10,
        2.488417845494092e-11,
        2.608159496292465e-12,
        -3.768941859285609e-13,
        -3.53266166078705e-14,
        4.713169244952175e-15,
        3.990457787603305e-16,
        -4.950288419671201e-17,
        -3.818019881545177e-18,
        4.42960563706165e-19,
        3.134979503519426e-20,
        -3.394963733292046e-21,
        -2.23350234752527e-22,
    ],
    &[
        0.004918019141116968,
        -0.05101135086141612,
        0.004060356988880481,
        -0.05798332646364814,
        -0.01734547637223446,
        0.04045937969215715,
        0.005349709612646084,
        -0.008142835646710103,
        -0.0007044551842423509,
        0.0008305701854578871,
        0.00005297107537607261,
        -0.00005209789379187326,
        -2.602532970057035e-6,
        2.227923500103302e-6,
        9.05098152038029e-8,
        -6.934545944714877e-8,
        -2.351185693683721e-9,
        1.644298395126747e-9,
        4.742982672620016e-11,
        -3.072335053039047e-11,
        -7.652740691371671e-13,
        4.643390108820003e-13,
        1.010850876841915e-14,
        -5.796177128334796e-15,
        -1.113884457200859e-16,
        6.078524208192506e-17,
        1.040013905846485e-18,
        -5.432294562718551e-19,
        -8.336666617062391e-21,
        4.159152044103575e-21,
        5.800964592327118e-23,
    ],
    &[
        0.002776981645463987,
        0.04893527420107843,
        0.0007810676030923549,
        0.05606902771811626,
        -0.01417236302017411,
        -0.03879266573723899,
        0.004945066959790328,
        0.007772126219467892,
        -0.0007136251191406647,
        -0.0007899100799428387,
        0.00005815015356901222,
        0.00004939318356992872,
        -3.0766860644508e-6,
        -2.106376781722429e-6,
        1.147247096262713e-7,
        6.539665260658795e-8,
        -3.184266080841919e-9,
        -1.547086725813885e-9,
        6.842742662266217e-11,
        2.884574265304199e-11,
        -1.17292227087103e-12,
        -4.351116485053968e-13,
        1.641748667450878e-14,
        5.421571874312556e-15,
        -1.912368100903687e-16,
        -5.676215234065636e-17,
        1.883051920297924e-18,
        5.064941904517258e-19,
        -1.58824011437346e-20,
        -3.872384123370529e-21,
        1.160245488354069e-22,
    ],
    &[
        -0.00907164232058257,
        -0.03492008709761858,
        -0.004832028375620184,
        -0.04040812615169684,
        0.03969797550601938,
        0.027652091935956,
        -0.01325469083253284,
        -0.005505820334514545,
        0.001855502642384343,
        0.0005566759519434235,
        -0.0001474446146885523,
        -0.000034644537575964,
        7.631960769364709e-6,
        1.47085826815709e-6,
        -2.790625509809153e-7,
        -4.547242507133638e-8,
        7.609636505910075e-9,
        1.07136760018436e-9,
        -1.609117523931888e-10,
        -1.989756504826058e-11,
        2.717904313774036e-12,
        2.989989416800634e-13,
        -3.753319168175915e-14,
        -3.711902101524496e-15,
        4.318230946397952e-16,
        3.872403018318348e-17,
        -4.203952385351573e-18,
        -3.443434188336512e-19,
        3.508877445954351e-20,
        2.623879208130278e-21,
        -2.538750546235482e-22,
    ],
    &[
        0.0125146585765967,
        0.01304842302714672,
        0.007197914483161519,
        0.01565568542218532,
        -0.05322572736583668,
        -0.01028034449467663,
        0.01760898880712641,
        0.001996608408935937,
        -0.002448733635104686,
        -0.0001975023780380594,
        0.0001934804341256477,
        0.00001203803267695013,
        -9.96361482668288e-6,
        -5.00754223412537e-7,
        3.626047049505687e-7,
        1.517064417382905e-8,
        -9.84446214656301e-9,
        -3.502762998828971e-10,
        2.073181568306734e-10,
        6.374911529131386e-12,
        -3.488326186140305e-12,
        -9.38677443371145e-14,
        4.799915761979857e-14,
        1.141770203395069e-15,
        -5.503677592917627e-16,
        -1.166965910297251e-17,
        5.340979487459248e-18,
        1.016540584696949e-19,
        -4.444554420280739e-20,
        -7.588463685193942e-22,
        3.206659052663456e-22,
    ],
    &[
        -0.01242013606192493,
        0.01070791249117106,
        -0.007438182347427246,
        0.01138560096444529,
        0.05196848119605829,
        -0.008579002129769609,
        -0.01709933130798828,
        0.00180023184091846,
        0.002368252803029655,
        -0.0001900500837065062,
        -0.0001864595374065624,
        0.00001229599210762196,
        9.57080970339667e-6,
        -5.411960057799169e-7,
        -3.472446638880962e-7,
        1.730940902909462e-8,
        9.40010458868327e-9,
        -4.211917995994404e-10,
        -1.974124011774798e-10,
        8.066833553929431e-12,
        3.312850332758272e-12,
        -1.248400649014322e-13,
        -4.546870061775594e-14,
        1.594145748262638e-15,
        5.200787573244758e-16,
        -1.708680353298172e-17,
        -5.035172580563974e-18,
        1.559376527029846e-19,
        4.180580405773603e-20,
        -1.218050248988581e-21,
        -3.009620389197221e-22,
    ],
    &[
        0.00903312495892184,
        -0.03009152592521216,
        0.005665532256653005,
        -0.03358027066773909,
        -0.03704974707782485,
        0.02395630979246515,
        0.01210624344100011,
        -0.004884603150753722,
        -0.0016678760411969,
        0.0005039068421124528,
        0.0001306960617836305,
        -0.00003194737016656043,
        -6.678655659164911e-6,
        1.380422232205906e-6,
        2.412763467875298e-7,
        -4.340434421019613e-8,
        -6.504385860565582e-9,
        1.039504790161048e-9,
        1.360463821931374e-10,
        -1.9614596211693e-11,
        -2.274004191207447e-12,
        2.993269029970883e-13,
        3.108941898695249e-14,
        -3.772109074509485e-15,
        -3.542507018655847e-16,
        3.993013542801219e-17,
        3.416854154959851e-18,
        -3.601381528646842e-19,
        -2.826483578778756e-20,
        2.782057168999997e-21,
        2.027430788522472e-22,
    ],
    &[
        -0.003442283613617882,
        0.04022403960612553,
        -0.002498349533174666,
        0.04534786081436551,
        0.01312381439117645,
        -0.03197876808626161,
        -0.004172647539910063,
        0.006478715758202695,
        0.0005625433639129433,
        -0.0006648194755310443,
        -0.00004320317955827655,
        0.00004194729119293383,
        2.164905483712343e-6,
        -1.80441465532253e-6,
        -7.670640263852419e-8,
        5.649603006231481e-8,
        2.028065961021304e-9,
        -1.347589431472263e-9,
        -4.159786755175617e-11,
        2.532979460203397e-11,
        6.817224596247606e-13,
        -3.851116300105968e-13,
        -9.13626981776337e-15,
        4.835882613604399e-15,
        1.020243069681758e-16,
        -5.101534600903064e-17,
        -9.64150410015702e-19,
        4.585981508363605e-19,
        7.81218237158831e-21,
        -3.531450662708684e-21,
        -5.487310824492551e-23,
    ],
];

pub const SPLITS: [f64; 21] = [
    1.116982428360211,
    1.740569922086432,
    2.364157415812653,
    3.611332403265095,
    6.105682378169978,
    11.09438232797975,
    21.07178222759928,
    31.04918212721881,
    41.02658202683835,
    51.00398192645788,
    60.98138182607742,
    70.95878172569695,
    80.93618162531649,
    90.913581524936,
    100.8909814245556,
    110.8683813241751,
    120.8457812237946,
    130.8231811234142,
    140.8005810230337,
    150.7779809226532,
    160.7553808222728,
];
