#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(2)
        * polynomial(
            x2,
            &[
                0.125,
                0.01041666666666667,
                0.0003255208333333333,
                5.425347222222222e-6,
                5.651403356481481e-8,
                4.036716683201058e-10,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -0.7480167757526863,
                0.3272573393918002,
                0.1227215022719251,
                0.1265565492179228,
                0.2056543924791245,
                0.4498689835480848,
                1.229106330051017,
                4.013800359072853,
                15.21899302815124,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 16] = [
    &[
        2.46128332569321,
        3.621787015828132,
        1.534535569260258,
        0.439568685608115,
        0.1003442973861743,
        0.01774589878929927,
        0.0027580747244773,
        0.0003531564261238467,
        0.00004159542651619366,
        4.1775410562607e-6,
        3.961806084815625e-7,
        3.274723581733325e-8,
        2.599699595624956e-9,
        1.826252837788974e-10,
        1.246878927992359e-11,
        7.617258440382777e-13,
        4.56258531991787e-14,
        2.466150006251066e-15,
        1.315825145258363e-16,
        6.377952963184579e-18,
        3.068035258690545e-19,
        1.348023988563032e-20,
        5.903650987991229e-22,
        2.372172289907699e-23,
        9.5350673874112e-25,
        3.529693247529631e-26,
        1.311056403631618e-27,
        4.499173344328295e-29,
        1.55325290735052e-30,
        4.97274824735176e-32,
        1.60207761058875e-33,
    ],
    &[
        114.1624513865951,
        154.4448574936112,
        63.40323702208198,
        18.41318769010793,
        4.117405946949892,
        0.7472194555450332,
        0.1140272244086971,
        0.01500701951200763,
        0.001736079054094332,
        0.0001791430152924531,
        0.00001668400021835409,
        1.415788647586463e-6,
        1.10347626095936e-7,
        7.952036621480948e-9,
        5.329046053364502e-10,
        3.337346903687127e-11,
        1.961679476577997e-12,
        1.086320171778217e-13,
        5.686875492644821e-15,
        2.822679848327189e-16,
        1.332032845466742e-17,
        5.990648795210042e-19,
        2.57347630231017e-20,
        1.058063653138804e-21,
        4.171298078225756e-23,
        1.579492153781947e-24,
        5.753739183461471e-26,
        2.019203388003762e-27,
        6.836131942601755e-29,
        2.237613269762951e-30,
        7.069190474617369e-32,
    ],
    &[
        4781.91310623164,
        6453.393871769235,
        2654.015548142505,
        773.3903094991702,
        173.6462041460595,
        31.64756268049565,
        4.849673768438908,
        0.640833723689305,
        0.07441503430529434,
        0.007706221692790082,
        0.000720080126832426,
        0.00006129620309319043,
        4.791285114685179e-6,
        3.462174453658193e-7,
        2.326024677200706e-8,
        1.460160453445787e-9,
        8.601747940355498e-11,
        4.773390603760273e-12,
        2.503737928866475e-13,
        1.245038967447534e-14,
        5.885544864304572e-16,
        2.651329276585242e-17,
        1.140720975434716e-18,
        4.696932001373961e-20,
        1.854275051406978e-21,
        7.030717589660296e-23,
        2.564328432754486e-24,
        9.01006176158995e-26,
        3.053854875977677e-27,
        1.000692032301595e-28,
        3.164682858307755e-30,
    ],
    &[
        202293.9554842502,
        273530.9831305046,
        112852.9333748352,
        33003.34341015679,
        7436.814889700032,
        1360.117170980723,
        209.1173025777305,
        27.71931230536359,
        3.228305769679051,
        0.335237264897242,
        0.03140600840169784,
        0.002679884083925083,
        0.0002099517722851323,
        0.00001520341707804307,
        1.023471386657072e-6,
        6.436946874351608e-8,
        3.798716605151317e-9,
        2.111565750309376e-10,
        1.109312584733611e-11,
        5.524570526609496e-13,
        2.615282522234533e-14,
        1.179723861199506e-15,
        5.082197971065032e-17,
        2.095147881915074e-18,
        8.280899726442641e-20,
        3.143275446828985e-21,
        1.147661690429345e-22,
        4.036499972590681e-24,
        1.369441077459262e-25,
        4.491546940243571e-27,
        1.42169995207965e-28,
    ],
    &[
        8.681082247896975e6,
        1.175980176827064e7,
        4.86491959627715e6,
        1.426804691604655e6,
        322419.6992907443,
        59127.67812032368,
        9114.33186437987,
        1211.087092713717,
        141.3723237310194,
        14.71229347851402,
        1.381097183841469,
        0.1180754685166069,
        0.00926718478072283,
        0.0006722178549685666,
        0.00004532568003204823,
        2.855029583625903e-6,
        1.687309387591952e-7,
        9.39198123658197e-9,
        4.94050464588867e-10,
        2.463501251925538e-11,
        1.167572493209057e-12,
        5.272692675267143e-14,
        2.273882575151129e-15,
        9.38370836776689e-17,
        3.712454039792244e-18,
        1.410494422702871e-19,
        5.154552638720493e-21,
        1.814487828038831e-22,
        6.160972877416255e-24,
        2.022297686586758e-25,
        6.405980282455684e-27,
    ],
    &[
        3.769493863749168e8,
        5.113815141155179e8,
        2.120001049082297e8,
        6.231537044206227e7,
        1.411271929267036e7,
        2.59360315052977e6,
        400606.6407067692,
        53334.02573008008,
        6237.130497738251,
        650.2043535896867,
        61.13680701179671,
        5.234915430273684,
        0.4114662682957464,
        0.02988823101027239,
        0.002017938039018227,
        0.0001272679699713731,
        7.530465945215644e-6,
        4.196414432488073e-7,
        2.209853860043624e-8,
        1.103048706883895e-9,
        5.233056047485271e-11,
        2.365455977374273e-12,
        1.021042351473948e-13,
        4.21722774300921e-15,
        1.66984049593453e-16,
        6.349390999019539e-18,
        2.322120605547678e-19,
        8.180277483281594e-21,
        2.779529435788549e-22,
        9.12985986925457e-24,
        2.893941228260402e-25,
    ],
    &[
        1.652035561884532e10,
        2.243771010595577e10,
        9.31725440564013e9,
        2.743542344122277e9,
        6.224237421254809e8,
        1.145813822194096e8,
        1.772692070143572e7,
        2.363696906884343e6,
        276829.4566669035,
        28899.22912867993,
        2720.936544466048,
        233.2795200693345,
        18.35803286903203,
        1.335034190296451,
        0.0902354397509043,
        0.0056969694565932,
        0.0003374285141619689,
        0.00001882150838041049,
        9.92059857545888e-7,
        4.956219375209618e-8,
        2.353298283948824e-9,
        1.06460232768594e-10,
        4.598892985692491e-12,
        1.900905243365976e-13,
        7.532165861113925e-15,
        2.86600356779086e-16,
        1.048861478180603e-17,
        3.697257028967343e-19,
        1.257046151292696e-20,
        4.131459316487205e-22,
        1.310323815514659e-23,
    ],
    &[
        7.293690938508516e11,
        9.91518165805652e11,
        4.122714283681415e11,
        1.215682841901049e11,
        2.76189270703761e10,
        5.091322238421128e9,
        7.887219623379748e8,
        1.053010927882921e8,
        1.234752733642278e7,
        1.290497809266691e6,
        121638.3124077924,
        10439.70609486775,
        822.3891098758991,
        59.86377961838129,
        4.049967158711915,
        0.2559198593866584,
        0.0151709127199259,
        0.0008469137927708396,
        0.00004467487894082593,
        2.233589889066603e-6,
        1.061316033412731e-7,
        4.804609715636888e-9,
        2.076900718405947e-10,
        8.590214473930708e-12,
        3.405920129728113e-13,
        1.296739748469981e-14,
        4.748393484456876e-16,
        1.674758118146321e-17,
        5.697172879419922e-19,
        1.873441121752071e-20,
        5.944774271601521e-22,
    ],
    &[
        3.239271888563135e13,
        4.406756405624389e13,
        1.834287066913025e13,
        5.415084986726564e12,
        1.231669259595144e12,
        2.273051330322499e11,
        3.525154514968802e10,
        4.711346928800721e9,
        5.530089928137389e8,
        5.785377631434358e7,
        5.458205586058002e6,
        468874.2425000816,
        36967.35421819642,
        2693.166307077296,
        182.3452459797515,
        11.53127871373205,
        0.6840739857264233,
        0.03821523013428772,
        0.002017229109328827,
        0.0001009204330330368,
        4.798373441336854e-6,
        2.173558987901514e-7,
        9.40121292499027e-9,
        3.890615371131322e-10,
        1.54342888596898e-11,
        5.879426988583096e-13,
        2.154028339000661e-14,
        7.601025945653833e-16,
        2.586950657084758e-17,
        8.510818343538494e-19,
        2.701856228763404e-20,
    ],
    &[
        1.445628120681892e15,
        1.96784043282192e15,
        8.198285151916925e14,
        2.422573023034513e14,
        5.515495496187277e13,
        1.018851930507979e13,
        1.581538421910401e12,
        2.115597911445492e11,
        2.485380441654189e10,
        2.602263491419041e9,
        2.457055065313374e8,
        2.112291554739017e7,
        1.666617455967046e6,
        121503.5441317331,
        8232.2233195513,
        520.9383743066802,
        30.9234490445418,
        1.728572480933266,
        0.0912984445442478,
        0.004570203310081228,
        0.0002174154376926809,
        9.85370920474042e-6,
        4.264190670437658e-7,
        1.765583403282059e-8,
        7.007561370168824e-10,
        2.67066296845256e-11,
        9.78888083806898e-13,
        3.455774698705146e-14,
        1.176649794990357e-15,
        3.872675903820595e-17,
        1.229920184814734e-18,
    ],
    &[
        6.477733133229402e16,
        8.822158163198977e16,
        3.678162448230493e16,
        1.087765011605325e16,
        2.478545352517746e15,
        4.582183736458277e14,
        7.118386472772313e13,
        9.52938999889572e12,
        1.120325497962056e12,
        1.173846033468695e11,
        1.109104881887474e10,
        9.54111427007277e8,
        7.5328391338377e7,
        5.495151562212994e6,
        372534.6542119664,
        23587.71890560758,
        1400.971269291047,
        78.35426470022855,
        4.140612285737732,
        0.2073746190199356,
        0.00987011999131708,
        0.0004475454686825601,
        0.00001937640033486646,
        8.026343723391954e-7,
        3.187011994750104e-8,
        1.215115704219139e-9,
        4.455619324253621e-11,
        1.573591121522673e-12,
        5.359944614932608e-14,
        1.764763452933511e-15,
        5.606728073513883e-17,
    ],
    &[
        2.912556759232388e18,
        3.968361174680801e18,
        1.655548126328619e18,
        4.899422074829405e17,
        1.117145477293191e17,
        2.066736342154293e16,
        3.212826427720469e15,
        4.303838220040226e14,
        5.06304342823341e13,
        5.308190374345339e12,
        5.018423445290128e11,
        4.319611935135872e10,
        3.41229961457082e9,
        2.490595180465947e8,
        1.689342207066273e7,
        1.070180849732543e6,
        63593.6616437561,
        3558.393746557161,
        188.1292664572944,
        9.42631121959939,
        0.448845822373572,
        0.02036080536824002,
        0.0008818781992586608,
        0.00003654482540409116,
        1.451642203782543e-6,
        5.536771428195548e-8,
        2.03097990659066e-9,
        7.175360493530797e-11,
        2.444906626442628e-12,
        8.052577741621355e-14,
        2.559175102988744e-15,
    ],
    &[
        1.313397016801717e20,
        1.790158068677284e20,
        7.472366002680437e19,
        2.212681962290474e19,
        5.048310672159387e18,
        9.3450451459084e17,
        1.453578624984842e17,
        1.948299967545132e16,
        2.293260042954595e15,
        2.40559704619149e14,
        2.275471666820386e13,
        1.959610346481701e12,
        1.548767843163361e11,
        1.130967205371843e10,
        7.674780492482203e8,
        4.864082825913769e7,
        2.891660498872217e6,
        161871.9560852995,
        8561.557870276234,
        429.1527750803641,
        20.44260112703996,
        0.927679658208041,
        0.04019493092453475,
        0.001666264088825528,
        0.00006621076831477826,
        2.526229094742772e-6,
        9.26968577929982e-8,
        3.275990695599677e-9,
        1.116598914037486e-10,
        3.678770213578954e-12,
        1.16949063946956e-13,
    ],
    &[
        5.937671393168353e21,
        8.095596531894623e21,
        3.380810112259782e21,
        1.001627461668364e21,
        2.286452963014754e20,
        4.234724683473836e19,
        6.590312068676346e18,
        8.837753779564617e17,
        1.040764415327429e17,
        1.092268254246754e16,
        1.033663985925952e15,
        8.905811564119913e13,
        7.041746035973369e12,
        5.144330900709199e11,
        3.492403888896591e10,
        2.214287588262765e9,
        1.316891702374917e8,
        7.374615454878839e6,
        390194.4192765909,
        19565.74247386233,
        932.336176818275,
        42.3235774502749,
        1.834423945577008,
        0.07606986144782447,
        0.00302366868652363,
        0.0001154015500011363,
        4.235785253082634e-6,
        1.497401938161532e-7,
        5.105245802033912e-9,
        1.682453589685274e-10,
        5.350012926169591e-12,
    ],
    &[
        2.690266575194612e23,
        3.669003185172016e23,
        1.532850749133168e23,
        4.543417485871017e22,
        1.037624734379476e22,
        1.922666873746448e21,
        2.993523159994849e20,
        4.016171364066945e19,
        4.731642226797375e18,
        4.967903318731516e17,
        4.703300824980265e16,
        4.053887121058865e15,
        3.206628189434564e14,
        2.343487713693577e13,
        1.591546591335914e12,
        1.009452158793577e11,
        6.005573065731149e9,
        3.364282460394293e8,
        1.780651562001851e7,
        893172.4563990023,
        42574.44881751278,
        1933.271805148454,
        83.81870985585014,
        3.476813403021827,
        0.1382379722038913,
        0.005277475130147583,
        0.0001937612823942967,
        6.851523975400112e-6,
        2.336568302695337e-7,
        7.702213598785933e-9,
        2.449824693427518e-10,
    ],
    &[
        1.221289939895814e25,
        1.66600922218939e25,
        6.962867115771704e24,
        2.064645983646078e24,
        4.717176485795279e23,
        8.744285585942278e22,
        1.362005965756774e22,
        1.828021878890368e21,
        2.154517546272056e20,
        2.262956835460926e19,
        2.143220452196275e18,
        1.847960412253188e17,
        1.462253178471751e16,
        1.069019741373101e15,
        7.262525999418951e13,
        4.607822239720859e12,
        2.742221361308779e11,
        1.536650659649449e10,
        8.135663112671938e8,
        4.082041701595607e7,
        1.946328530400309e6,
        88406.05937430794,
        3833.974246700173,
        159.0764564483253,
        6.326528679271717,
        0.2415879732364227,
        0.008872062197442019,
        0.000313798439807268,
        0.0000107039910749985,
        3.529265917045031e-7,
        1.122801031465132e-8,
    ],
];

pub const SPLITS: [f64; 17] = [
    0.392488550596883,
    4.23823809058471,
    8.083987630572538,
    11.92973717056036,
    15.77548671054819,
    19.62123625053602,
    23.46698579052385,
    27.31273533051167,
    31.1584848704995,
    35.00423441048733,
    38.84998395047516,
    42.69573349046298,
    46.54148303045081,
    50.38723257043864,
    54.23298211042646,
    58.07873165041429,
    61.92448119040212,
];
