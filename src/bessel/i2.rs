#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(2)
        * polynomial(
            x2,
            &[
                0.125,
                0.01041666666666667,
                0.0003255208333333333,
                5.425347222222222e-6,
                5.651403356481481e-8,
                4.036716683201058e-10,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -0.7480167757526863,
                0.3272573393918002,
                0.1227215022719251,
                0.1265565492179228,
                0.2056543924791245,
                0.4498689835480848,
                1.229106330051017,
                4.013800359072853,
                15.21899302815124,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 3] = [
    &[
        -2.619877717695911,
        1.333882187379885,
        0.02011040731598692,
        0.003998639970358285,
        0.0005883471604244473,
        0.00006604100567429378,
        5.479855295912884e-6,
        2.67711218085627e-7,
        -8.009027729525369e-9,
        -3.519196919176451e-9,
        -4.199488033422508e-10,
        -2.301542655813293e-11,
        1.582591413337745e-12,
        5.719502449593458e-13,
        7.759889631650182e-14,
        5.762737228053536e-15,
        -6.035491439471818e-17,
        -9.25696742233518e-17,
        -1.591423075384964e-17,
        -1.56503707211813e-18,
        -5.519082939423599e-20,
        1.28007693687801e-20,
        3.187391090922888e-21,
        4.02826537594646e-22,
        2.764733271212217e-23,
        -8.53884213596813e-25,
        -5.749549672949817e-25,
        -9.51593238394636e-26,
        -9.23098592822292e-27,
        -2.811311696452696e-28,
        8.302513802881028e-29,
    ],
    &[
        0.5709357349123777,
        1.996170959601075,
        0.1920653722084852,
        0.03090521917789521,
        0.00296276991042187,
        0.000106156505303754,
        -7.912808515030453e-6,
        3.429696760652047e-7,
        3.91642976476284e-7,
        3.087228694033558e-8,
        -7.652278143532512e-9,
        -1.650420555971876e-9,
        4.484158787748732e-11,
        5.442242132060375e-11,
        5.167762738098077e-12,
        -1.016089689690785e-12,
        -2.864175141418348e-13,
        -5.814762370276874e-15,
        8.009426334248926e-15,
        1.234286784371871e-15,
        -8.075534184151663e-17,
        -4.839117886145844e-17,
        -4.010382145627512e-18,
        9.32072417331859e-19,
        2.458884215443759e-19,
        4.60785723952462e-21,
        -6.806937577588858e-21,
        -1.040535286315144e-21,
        6.763201089495654e-23,
        3.94973010123883e-23,
        3.232272622629406e-24,
    ],
    &[
        22.68254490729558,
        26.38575032132172,
        7.916678948162113,
        1.641488915624148,
        0.2501008140171544,
        0.03192572053394725,
        0.00324825592860526,
        0.000295339016375493,
        0.00002615098911102869,
        2.881593081053151e-7,
        5.129551099818027e-7,
        -7.204157710602646e-8,
        -3.746230001984307e-9,
        1.118738243831032e-8,
        -5.223762946614472e-9,
        1.19167489079778e-9,
        1.101388940277955e-10,
        -2.166869749879759e-10,
        8.615379720364652e-11,
        -8.405302130615388e-12,
        -8.671693681300859e-12,
        4.916194667015792e-12,
        -7.647658055500908e-13,
        -4.133447845293316e-13,
        2.704412476352614e-13,
        -3.954639185258747e-14,
        -2.543639718861623e-14,
        1.449977103632335e-14,
        -1.170042390897791e-15,
        -1.713708691507692e-15,
        6.886410176521947e-16,
    ],
];

pub const SPLITS: [f64; 4] = [
    -0.935247912638941,
    0.330042964848012,
    1.595333842334965,
    4.125915597308872,
];
