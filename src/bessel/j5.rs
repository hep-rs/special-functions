#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(5)
        * polynomial(
            x2,
            &[
                0.0002604166666666667,
                -0.00001085069444444444,
                1.937624007936508e-7,
                -2.018358341600529e-9,
                1.40163773722259e-11,
                -7.008188686112948e-14,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                7.878169683048819,
                134.4212702170205,
                2100.332347140945,
                23431.83274779117,
                100171.0849968072,
                -482073.3465471348,
                7.721781997371071e6,
                -2.262240819542306e8,
                1.009524965720754e10,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 8.639379797371931
        + x1 * polynomial(
            x1,
            &[
                12.375,
                0.0,
                19.3359375,
                0.0,
                -6.3228515625,
                0.0,
                -2268.275089808873,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 12] = [
    &[
        0.1501523997901303,
        0.2103227754214523,
        0.05222069876518798,
        -0.02218547479582838,
        -0.01672836741733716,
        -0.001544761522232283,
        0.001225108026692037,
        0.0002349097315651093,
        -0.00004621650148113794,
        -0.00001065825496778069,
        1.097998236302871e-6,
        2.653011585127951e-7,
        -1.805757376508289e-8,
        -4.302984715406985e-9,
        2.177788302140082e-10,
        4.967289332331596e-11,
        -2.005816396908851e-12,
        -4.314519689733119e-13,
        1.455122175827925e-14,
        2.931477739300422e-15,
        -8.521498464193353e-17,
        -1.603827879276262e-17,
        4.110299175817832e-19,
        7.226564277646197e-20,
        -1.660551422399362e-21,
        -2.730664428991539e-22,
        5.699165590208452e-24,
        8.782810143151e-25,
        -1.681996011975314e-26,
        -2.428847100182609e-27,
        4.313656718382946e-29,
    ],
    &[
        0.04902369372889181,
        -0.2462881108274562,
        0.1801808585826796,
        0.08533207378573321,
        -0.02730375726650098,
        -0.00982329296603133,
        0.001534721008793722,
        0.0005452449040782345,
        -0.00004593810386482859,
        -0.00001760855064378765,
        8.586496589271381e-7,
        3.702872295567528e-7,
        -1.102266684506392e-8,
        -5.459078657152503e-9,
        1.035959484818786e-10,
        5.945925092898814e-11,
        -7.463938445509006e-13,
        -4.975806279665751e-13,
        4.26882508669515e-15,
        3.298136153340925e-15,
        -1.992166735944038e-17,
        -1.77410651585912e-17,
        7.758687813910627e-20,
        7.899363226732074e-20,
        -2.569692360837994e-22,
        -2.959623421304858e-22,
        7.354969301304846e-25,
        9.46056827485393e-25,
        -1.844496643533225e-27,
        -2.604408883346746e-27,
        4.100963881263598e-30,
    ],
    &[
        0.002784636465387207,
        -0.1621002182133928,
        -0.03331439287833825,
        0.1158434250502581,
        0.004455712389856107,
        -0.01395115185434441,
        -0.0002959517235542905,
        0.0007340127970851161,
        0.00001381683160698868,
        -0.00002219384443554516,
        -4.251268094095774e-7,
        4.397631898129818e-7,
        8.665862313670272e-9,
        -6.172851833861104e-9,
        -1.229851649521055e-10,
        6.466546790642789e-11,
        1.278077345378636e-12,
        -5.249842415727385e-13,
        -1.013872823389573e-14,
        3.399284568880475e-15,
        6.34523706352808e-17,
        -1.795904514887923e-17,
        -3.216123800561439e-19,
        7.886617801037283e-20,
        1.348390924423499e-21,
        -2.923605794229944e-22,
        -4.757923520751226e-24,
        9.26930615193496e-25,
        1.433505218339704e-26,
        -2.53576337727445e-27,
        -3.732819139701598e-29,
    ],
    &[
        -0.02231808762397108,
        -0.0929534754089518,
        -0.1087219258766413,
        0.08122268101224779,
        0.02507939912970218,
        -0.01081915300469748,
        -0.001925929952458699,
        0.0006088153165184188,
        0.00007620445581976055,
        -0.00001913471704133212,
        -1.864537571879486e-6,
        3.865273112310815e-7,
        3.119020144183058e-8,
        -5.465574678733727e-9,
        -3.799947944626493e-10,
        5.728544307622307e-11,
        3.522578872474505e-12,
        -4.636421611038515e-13,
        -2.566717439101341e-14,
        2.988065156510238e-15,
        1.507770096743774e-16,
        -1.570552446323466e-17,
        -7.288203598157965e-19,
        6.862808250389996e-20,
        2.948450263424003e-21,
        -2.532702211306639e-22,
        -1.012654210239316e-23,
        7.998995359872545e-25,
        2.989044688954233e-26,
        -2.181231709895235e-27,
        -7.662844168122876e-29,
    ],
    &[
        -0.01685122667360817,
        -0.01864862351196525,
        -0.06234011078188665,
        -0.002420917177455211,
        -0.104549289531805,
        0.02975341888066398,
        0.06537697784066608,
        -0.01171208469537206,
        -0.01417227214940794,
        0.001991381880052084,
        0.001661355129072786,
        -0.0001960315899303629,
        -0.0001244516845294981,
        0.00001275265207725031,
        6.529318914910106e-6,
        -5.928912487754038e-7,
        -2.544882755468554e-7,
        2.076256225734453e-8,
        7.680427005288307e-9,
        -5.688695584988363e-10,
        -1.85097066647243e-10,
        1.255075381160813e-11,
        3.648209387037995e-12,
        -2.280628769909905e-13,
        -5.994012923329362e-14,
        3.475834088948871e-15,
        8.338899105388942e-16,
        -4.509961193814997e-17,
        -9.95347495773864e-18,
        4.9954670650879e-19,
        1.030436150754585e-19,
    ],
    &[
        -0.01678389217129139,
        0.03139184122406091,
        -0.05461244576519298,
        0.01757941787747242,
        -0.08100513253210926,
        -0.03486388622563945,
        0.05491959947233481,
        0.0110622084138295,
        -0.01247454002624093,
        -0.001644725561635379,
        0.001516803965868519,
        0.0001462937851826566,
        -0.0001171076217704024,
        -8.762932536390043e-6,
        6.300339168814692e-6,
        3.798282011366897e-7,
        -2.507270867821474e-7,
        -1.25107300482518e-8,
        7.697680197585316e-9,
        3.245007847167066e-10,
        -1.881379665633304e-10,
        -6.810798057137667e-12,
        3.751093413344729e-12,
        1.181808069932023e-13,
        -6.221672101287322e-14,
        -1.725054682308037e-15,
        8.723709806061949e-16,
        2.148789417225428e-17,
        -1.048127074141114e-17,
        -2.290118034184253e-19,
        1.091120714468497e-19,
    ],
    &[
        -0.00927207709728,
        0.05431438531443738,
        -0.0278994141498206,
        0.02490897563240104,
        -0.03770360711608751,
        -0.06754141893339308,
        0.02731984160526811,
        0.02333257631453509,
        -0.006442153004029813,
        -0.003705499705152299,
        0.0008074859447914636,
        0.0003494260017431267,
        -0.00006403856415222715,
        -0.00002208522583962518,
        3.530179351928007e-6,
        1.00627165889684e-6,
        -1.43659182984521e-7,
        -3.472260052460791e-8,
        4.502105072445883e-9,
        9.4054043207639e-10,
        -1.12136030368757e-10,
        -2.055486447928031e-11,
        2.274995204066988e-12,
        3.703729899442214e-13,
        -3.834173986357118e-14,
        -5.600141205281512e-15,
        5.455601194494532e-16,
        7.209998006598656e-17,
        -6.643758704797687e-18,
        -7.924613338540932e-19,
        7.002540397229307e-20,
    ],
    &[
        -0.002378665023712697,
        0.06875998860419842,
        -0.00595826733386639,
        -0.06149257161271845,
        0.002197890018578637,
        0.008471226712192328,
        -0.0002269686493586843,
        -0.000496420252745879,
        0.00001125728574371172,
        0.00001627686505978134,
        -3.291882785199391e-7,
        -3.423042753605985e-7,
        6.35186123643716e-9,
        5.017805769751528e-9,
        -8.692656144114092e-11,
        -5.424808950243961e-11,
        8.874458176698992e-13,
        4.506142092978523e-13,
        -7.016786431354533e-15,
        -2.966827392309953e-15,
        4.422909108519861e-17,
        1.586657420664471e-17,
        -2.274363960613203e-19,
        -7.030279596557155e-20,
        9.72208202786239e-22,
        2.62333727638421e-22,
        -3.509105419771948e-24,
        -8.3576401755291e-25,
        1.083705134215621e-26,
        2.294509204190071e-27,
        -2.896054677539639e-29,
    ],
    &[
        0.005192456039433765,
        0.06334507331714404,
        0.02217428624274841,
        -0.05743895342330174,
        -0.005461764583466481,
        0.007967660145461186,
        0.0004342098709649459,
        -0.0004697830191692135,
        -0.00001734530260762611,
        0.00001549359930405081,
        4.184898408476179e-7,
        -3.276778443802481e-7,
        -6.76454339422855e-9,
        4.829865953815376e-9,
        7.83429307830467e-11,
        -5.24962168147747e-11,
        -6.81469622334475e-13,
        4.383339744692193e-13,
        4.610473568835371e-15,
        -2.900552845667054e-15,
        -2.49201148122106e-17,
        1.558793425507005e-17,
        1.099115480077674e-19,
        -6.939386676822728e-20,
        -4.023280392097299e-22,
        2.601178726162881e-22,
        1.239058535641597e-24,
        -8.323210905357727e-25,
        -3.245906322749901e-27,
        2.294602950183257e-27,
        7.294917089015458e-30,
    ],
    &[
        0.01163783010676322,
        0.05322000258760763,
        0.04587631922263315,
        -0.04889215451556183,
        -0.01196950598252654,
        0.006825834758563765,
        0.000999771914499776,
        -0.0004047508240872872,
        -0.0000419700150650182,
        0.00001342091131956023,
        1.066296905299464e-6,
        -2.853250917934934e-7,
        -1.820112366269352e-8,
        4.226993216106619e-9,
        2.233579251546525e-10,
        -4.617148157917669e-11,
        -2.066764858591317e-12,
        3.873887652777426e-13,
        1.494090404234756e-14,
        -2.575518758329138e-15,
        -8.673495025533373e-17,
        1.390461784377109e-17,
        4.133039918143123e-19,
        -6.217575891460939e-20,
        -1.64584488037815e-21,
        2.340676086163677e-22,
        5.559512804505503e-24,
        -7.520967930575845e-25,
        -1.613250432989948e-26,
        2.081795232511667e-27,
        4.065178494216856e-29,
    ],
    &[
        0.01657033299809003,
        0.03960029420828996,
        0.06379576332526341,
        -0.03696118443807966,
        -0.01693730344437499,
        0.00519964034223027,
        0.00143478289581749,
        -0.0003103773618698832,
        -0.00006104457646376483,
        0.0000103560196817205,
        1.571531850059404e-6,
        -2.2148746678684e-7,
        -2.718051695370224e-8,
        3.300300466890077e-9,
        3.379669392797561e-10,
        -3.625214539354897e-11,
        -3.168707017260921e-12,
        3.058266064170975e-13,
        2.321080439107997e-14,
        -2.044062560102188e-15,
        -1.365306642195784e-16,
        1.109235766493212e-17,
        6.592102578289411e-19,
        -4.984894822898593e-20,
        -2.659817365781423e-21,
        1.885738514732266e-22,
        9.10318536515592e-24,
        -6.087719718876108e-25,
        -2.676287528649593e-26,
        1.69274281718197e-27,
        6.83221133958023e-29,
    ],
    &[
        0.01167519292960999,
        0.01250929153443518,
        0.03845228858740486,
        0.00411365794858134,
        0.05793075262025818,
        -0.01784949546815456,
        -0.03914015079720564,
        0.006732853962893631,
        0.008902859683060212,
        -0.001140746496713918,
        -0.001086073528418677,
        0.0001137889585995145,
        0.00008422305970115043,
        -7.571189575712828e-6,
        -4.554397593361519e-6,
        3.619365675354955e-7,
        1.822457626903121e-7,
        -1.306825348853617e-8,
        -5.626860137235738e-9,
        3.695433136286636e-10,
        1.382962312462341e-10,
        -8.413535211240399e-12,
        -2.772261514121896e-12,
        1.576305801426842e-13,
        4.621634337140489e-14,
        -2.473718604069107e-15,
        -6.51090667743693e-16,
        3.29983748815719e-17,
        7.856481130838525e-18,
        -3.750566900620038e-19,
        -8.210576816848314e-20,
    ],
];

pub const SPLITS: [f64; 13] = [
    0.4948790357344923,
    6.493677078206859,
    12.49247512067923,
    18.49127316315159,
    24.49007120562396,
    36.48766729056869,
    48.48526337551343,
    60.48285946045816,
    66.48165750293053,
    72.4804555454029,
    78.47925358787526,
    84.47805163034763,
    96.4756477152924,
];
