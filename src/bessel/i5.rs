#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(5)
        * polynomial(
            x2,
            &[
                0.0002604166666666667,
                0.00001085069444444444,
                1.937624007936508e-7,
                2.018358341600529e-9,
                1.40163773722259e-11,
                7.008188686112948e-14,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -4.936910719967729,
                28.07867971981646,
                -87.74587412442644,
                139.8449868858046,
                -66.4263687707572,
                -29.06153633720628,
                -35.80796441548631,
                -69.93743049899669,
                -183.5857550598663,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -5.035107058635863,
        6.937346463806903,
        0.3040476366461658,
        0.1071595173413519,
        0.02797720969954861,
        0.005335216727388928,
        0.0006429877245935153,
        4.260231842417332e-6,
        -0.00001818651080281644,
        -3.741306681309228e-6,
        6.540614558869736e-8,
        2.37668995304324e-7,
        6.622178336359088e-8,
        5.421071497658369e-9,
        -2.520287619550151e-9,
        -1.15225534064428e-9,
        -2.04438958318629e-10,
        1.097383737505011e-11,
        1.768957778814751e-11,
        5.17736392301724e-12,
        5.119711592667578e-13,
        -1.921567277016089e-13,
        -1.027565005871483e-13,
        -2.178761003982502e-14,
        -1.603873065612735e-16,
        1.526889331108245e-15,
        5.485447649215701e-16,
        8.185935567616017e-17,
        -1.119250231907768e-17,
        -1.027071802502999e-17,
        -2.737462558325632e-18,
    ],
    &[
        28.45807784470537,
        34.06352872161814,
        9.77758150877559,
        2.100802213812722,
        0.3115711733171748,
        0.03963411130169759,
        0.004385814890934308,
        0.0002999438166904168,
        0.00003816254339615237,
        3.551221933127251e-6,
        -1.01012729325278e-6,
        2.949887885194668e-7,
        -1.086859850348531e-8,
        -2.076326241138017e-8,
        8.783635840296475e-9,
        -1.304044340625973e-9,
        -3.932521843977199e-10,
        2.87800428897164e-10,
        -6.699006735168979e-11,
        -7.036426466952087e-12,
        1.051042357921446e-11,
        -3.131698529054669e-12,
        -1.184884201098219e-13,
        4.377189548939916e-13,
        -1.453039965303213e-13,
        -4.479659261184012e-15,
        2.078120133277195e-14,
        -6.676787695028239e-15,
        -4.631601074023449e-16,
        1.025973623561184e-15,
        -2.852728902498133e-16,
    ],
];

pub const SPLITS: [f64; 3] = [-0.7018601683138514, 1.827507012626683, 4.356874193567218];
