#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(0)
        * polynomial(
            x2,
            &[
                1.,
                -0.25,
                0.015625,
                -0.0004340277777777778,
                6.781684027777778e-6,
                -6.781684027777778e-8,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                -0.07957747154594767,
                0.1342869832337867,
                -0.6994113710093057,
                7.496815633005995,
                -136.6294649115343,
                3788.621204109419,
                -148635.7283112213,
                7.838212235162061e6,
                -5.34849120990989e8,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 0.7853981633974483
        + x1 * polynomial(
            x1,
            &[
                -0.125,
                0.0,
                0.06510416666666667,
                0.0,
                -0.2095703125,
                0.0,
                1.638065883091518,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        0.21332564939815,
        -0.3446706660653889,
        0.3388489786941216,
        -0.2943658576075537,
        -0.1314701636579285,
        0.110945363364243,
        0.0172317851938688,
        -0.01421093610048253,
        -0.00121135494727819,
        0.00097633092985017,
        0.00005403264748406561,
        -0.00004255759350220181,
        -1.676463980394684e-6,
        1.290443926931923e-6,
        3.839073405557474e-8,
        -2.888543082345856e-8,
        -6.766101357035414e-10,
        4.97756848469564e-10,
        9.46992850570889e-12,
        -6.813842629624495e-12,
        -1.078617384627861e-13,
        7.593330379134889e-14,
        1.019601149192973e-15,
        -7.025449541266275e-16,
        -8.129231415757386e-18,
        5.484467245609921e-18,
        5.541160425360063e-20,
        -3.661755270545594e-20,
        -3.266568632983742e-22,
        2.10444557053271e-22,
        1.681888761738605e-24,
    ],
    &[
        -0.07823417480318238,
        0.02933997795472684,
        -0.1148538183779742,
        0.01236232241182167,
        0.145852799609073,
        -0.01563704981345393,
        -0.03124201237586802,
        0.003153973122310923,
        0.002995785252880468,
        -0.0002856402460547548,
        -0.0001662072230080289,
        0.00001498376435741579,
        6.072162555247775e-6,
        -5.180600243479253e-7,
        -1.580471779479681e-7,
        1.277648514216699e-8,
        3.090406404145495e-9,
        -2.370607610880002e-10,
        -4.716543256860938e-11,
        3.438636985152322e-12,
        5.783021730345642e-13,
        -4.013895732082158e-14,
        -5.826935650932352e-15,
        3.85688157219528e-16,
        4.913672106940007e-17,
        -3.106792162833057e-18,
        -3.520363373783863e-19,
        2.129645507846597e-20,
        2.170110463567125e-21,
        -1.251529497556446e-22,
        -1.163410215650624e-23,
    ],
    &[
        0.04774973780365052,
        0.02879959436970734,
        0.06712794921519551,
        0.08159235380736807,
        -0.0974122923055092,
        -0.02950615285933656,
        0.02243081769025405,
        0.003770996824907183,
        -0.00230831535728965,
        -0.0002536399149565495,
        0.0001371029477921403,
        0.00001060496658415144,
        -5.332634813808096e-6,
        -3.031768692361564e-7,
        1.467518248217443e-7,
        6.309350100516551e-9,
        -3.012794953956648e-9,
        -9.99350320393052e-11,
        4.796549983637682e-11,
        1.24546634841055e-12,
        -6.100134753159113e-13,
        -1.253034536210346e-14,
        6.344221375773505e-15,
        1.038487944993531e-16,
        -5.499086960674879e-17,
        -7.206011841653824e-19,
        4.035426798394118e-19,
        4.241686780641774e-21,
        -2.540444316098561e-21,
        -2.131210865820549e-23,
        1.387369091501159e-23,
    ],
    &[
        -0.01427935626124674,
        -0.05205604655425083,
        -0.01782175720182148,
        -0.1175719433098964,
        0.03361119128106572,
        0.04770218088607558,
        -0.008410157822860157,
        -0.006715294782624889,
        0.000923613249771546,
        0.0004978798348547982,
        -0.00005811505801124349,
        -0.00002302754095870505,
        2.383451613305916e-6,
        7.309397144664803e-7,
        -6.889818154688441e-8,
        -1.694586135702241e-8,
        1.480472334047927e-9,
        2.999041091726149e-10,
        -2.458405717492957e-11,
        -4.188210695130869e-12,
        3.250015215182082e-13,
        4.736116961976778e-14,
        -3.502137097904692e-15,
        -4.42760872874822e-16,
        3.135608527610334e-17,
        3.480643730279111e-18,
        -2.370056455126252e-19,
        -2.333825770719652e-20,
        1.532779003321892e-21,
        1.344106247237452e-22,
        -8.57876860338332e-24,
    ],
];

pub const SPLITS: [f64; 5] = [
    0.2964867156972843,
    9.05897985767766,
    17.82147299965805,
    26.58396614163843,
    35.34645928361881,
];
