#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-2)
        * polynomial(
            x2,
            &[
                -1.273239544735163,
                -0.3183098861837907,
                -0.06890864054804665,
                0.01016335735377876,
                -0.0003953172918621757,
                7.509657081336582e-6,
                -8.57210010938407e-8,
            ],
        )
        + x.powi(2)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.07957747154594767,
                    -0.006631455962162306,
                    0.0002072329988175721,
                    -3.453883313626201e-6,
                    3.597795118360626e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                1.193662073189215,
                1.566681471060845,
                -2.937527758239084,
                21.20527850478839,
                -310.1271981325302,
                7462.435705064007,
                -265049.7253102198,
                1.29832951382428e7,
                -8.368815657859004e8,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 3.926990816987242
        + x1 * polynomial(
            x1,
            &[
                1.875,
                0.0,
                -0.3515625,
                0.0,
                -1.4501953125,
                0.0,
                8.307429722377232,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 10] = [
    &[
        -5.821328061106358,
        3.908693211703593,
        -1.078467076049606,
        0.2653110118060108,
        -0.06126457932511338,
        0.01360107580307008,
        -0.002937716503545529,
        0.0006218349576151107,
        -0.0001296054005013009,
        0.00002668464241473278,
        -5.439974989170467e-6,
        1.099954735853008e-6,
        -2.208828821474675e-7,
        4.409608293997585e-8,
        -8.758687165924497e-9,
        1.732055533739766e-9,
        -3.411928300623728e-10,
        6.698000690401133e-11,
        -1.310866829590011e-11,
        2.558446008467792e-12,
        -4.980977233327308e-13,
        9.67550423446127e-14,
        -1.875599992983178e-14,
        3.62902667077652e-15,
        -7.00954654314951e-16,
        1.351755783460983e-16,
        -2.602962236380105e-17,
        5.005694954252544e-18,
        -9.62611954984321e-19,
        1.911707793503957e-19,
        -3.533516804580509e-20,
    ],
    &[
        -1.987067062329885,
        0.6665938888174963,
        -0.1049558800192789,
        0.01500527073396953,
        -0.001971447854343779,
        0.0002493060072013408,
        -0.00003068896123662877,
        3.70114182936945e-6,
        -4.394321066346485e-7,
        5.153288544517431e-8,
        -5.983207813614034e-9,
        6.889621870340024e-10,
        -7.878475011588954e-11,
        8.956137958167138e-12,
        -1.012943623264406e-12,
        1.14056807170127e-13,
        -1.279270036210046e-14,
        1.429887711860935e-15,
        -1.593318319615759e-16,
        1.770522078153687e-17,
        -1.962526436427155e-18,
        2.170430583112545e-19,
        -2.395410250355895e-20,
        2.638722830425054e-21,
        -2.901712825121105e-22,
        3.18581764977942e-23,
        -3.492573879042837e-24,
        3.823629912236298e-25,
        -4.181312440674196e-26,
        4.620019995334325e-27,
        -4.980690798345804e-28,
    ],
    &[
        -0.990425057772539,
        0.3536114880989414,
        -0.0548825077160921,
        0.01110400416989829,
        -0.00182019458473919,
        0.0002800190591207747,
        -0.00004258847259409693,
        6.354930188805367e-6,
        -9.32977839400234e-7,
        1.352981087165602e-7,
        -1.942669085268294e-8,
        2.766501980908076e-9,
        -3.912528308897077e-10,
        5.500755693389636e-11,
        -7.69445745246204e-12,
        1.071541191372508e-12,
        -1.486441518576902e-13,
        2.054886828800149e-14,
        -2.831984719727551e-15,
        3.892187568251194e-16,
        -5.33597032999375e-17,
        7.2987834351678e-18,
        -9.9630477497724e-19,
        1.357421489264277e-19,
        -1.846225756377035e-20,
        2.507040903350853e-21,
        -3.399357905805983e-22,
        4.602992659441134e-23,
        -6.226861463962053e-24,
        8.561010362513508e-25,
        -1.134458922189525e-25,
    ],
    &[
        -0.3248376737024159,
        0.344997315671857,
        -0.00951618278251101,
        0.001357177317969597,
        -0.001225801140683549,
        0.0002004910777188556,
        -0.0000286973909181492,
        4.950782121091156e-6,
        -8.420122345485149e-7,
        1.382646668924766e-7,
        -2.249671340908885e-8,
        3.636442052944567e-9,
        -5.837585530781592e-10,
        9.3156986108835e-11,
        -1.479115877271986e-11,
        2.338158191134235e-12,
        -3.68179634392666e-13,
        5.777650055924837e-14,
        -9.03876338956263e-15,
        1.410162890875908e-15,
        -2.194564762803993e-16,
        3.40758429517459e-17,
        -5.280205584210568e-18,
        8.166518560638945e-19,
        -1.26087372326247e-19,
        1.943629874565147e-20,
        -2.991680157180358e-21,
        4.598625903211758e-22,
        -7.063436299146364e-23,
        1.107842211066168e-23,
        -1.657968838199123e-24,
    ],
    &[
        0.2038664117276971,
        0.03809955863278401,
        -0.1570169446190619,
        0.00378886328042736,
        0.00615216609575579,
        0.00002541028964301852,
        -0.0001343678963311182,
        3.253730456417508e-6,
        7.687043945384591e-7,
        6.789897152162064e-8,
        -2.067384092816105e-8,
        2.340323901626434e-9,
        -3.628717312693903e-10,
        6.728025057117047e-11,
        -1.15856289953235e-11,
        1.948230981112972e-12,
        -3.287119488035245e-13,
        5.536624300974237e-14,
        -9.29179210983986e-15,
        1.554970278920681e-15,
        -2.595922667973492e-16,
        4.324056487809028e-17,
        -7.187904161583413e-18,
        1.192613690958165e-18,
        -1.975375385903049e-19,
        3.266704196328466e-20,
        -5.394262616862908e-21,
        8.895499816765013e-22,
        -1.466077265288463e-22,
        2.474943031211433e-23,
        -3.95996752103335e-24,
    ],
    &[
        0.0167084899037968,
        0.1477517846111678,
        0.1121222817592115,
        -0.1526689475368665,
        -0.0202532634279024,
        0.02114724358094387,
        0.001289808157192953,
        -0.001231344521273153,
        -0.00004467730074356623,
        0.00004050615213406862,
        9.42664142355874e-7,
        -8.560651170255029e-7,
        -1.387258859152405e-8,
        1.272978229736942e-8,
        1.375196490166856e-10,
        -1.383318733821787e-10,
        -1.283302918430897e-12,
        1.205217470027166e-12,
        1.884806754152138e-15,
        -7.04626529560819e-15,
        -1.813045558356064e-16,
        6.884366467758226e-17,
        -4.29179693437278e-18,
        5.646099964997835e-19,
        -1.311405970961416e-19,
        2.318450358189465e-20,
        -3.842771118619903e-21,
        6.552920206034845e-22,
        -1.125081175560497e-22,
        1.975397931465575e-23,
        -3.272280721072549e-24,
    ],
    &[
        0.01805065944563991,
        0.06022819114401827,
        0.06231259911807801,
        0.008711023110274642,
        0.0971388662720841,
        -0.1002936757634805,
        -0.06189227936301367,
        0.04049541567683788,
        0.01342918507048169,
        -0.007098308204157238,
        -0.001569092068150535,
        0.0007230281907054815,
        0.0001170514793961648,
        -0.00004881417161035392,
        -6.117172629886197e-6,
        2.360316676928773e-6,
        2.376604095753759e-7,
        -8.607936914130464e-8,
        -7.156110696584073e-9,
        2.457671552655456e-9,
        1.722516584552762e-10,
        -5.650917816929924e-11,
        -3.395099784949909e-12,
        1.069888884929718e-12,
        5.585875078618071e-14,
        -1.698194762413855e-14,
        -7.793321922205064e-16,
        2.293595773290075e-16,
        9.34315645589927e-18,
        -2.641954305436107e-18,
        -9.73067579151898e-20,
    ],
    &[
        0.02237662975174229,
        0.02651186014492041,
        0.06702821286903995,
        0.001957773613529155,
        0.09004266995170358,
        -0.0482484221351617,
        -0.06550074134315372,
        0.02048682777555033,
        0.01547926949276217,
        -0.003752031843401037,
        -0.001944471140624183,
        0.0003983350720582535,
        0.0001546205832908018,
        -0.00002795679556165599,
        -8.553332421908372e-6,
        1.401114808906618e-6,
        3.496593783773409e-7,
        -5.279985497831263e-8,
        -1.102146322324782e-8,
        1.553067036441283e-9,
        2.764852500654076e-10,
        -3.668603935943418e-11,
        -5.657600555960785e-12,
        7.117345448345912e-13,
        9.6312567872641e-14,
        -1.154922062561716e-14,
        -1.386264575794572e-15,
        1.591318392325609e-16,
        1.710143927722584e-17,
        -1.866191710713802e-18,
        -1.828481624306537e-19,
    ],
    &[
        0.03425632478580843,
        0.01425788362404961,
        0.1194571503157592,
        -0.01982032618813601,
        -0.03420860614333566,
        0.003259689797624388,
        0.003069465251674099,
        -0.000220595630613637,
        -0.0001375974787832131,
        8.220094995441404e-6,
        3.721806959125188e-6,
        -1.943374278934087e-7,
        -6.750494508861081e-8,
        3.175600846854485e-9,
        8.789980245224858e-10,
        -3.800381776197043e-11,
        -8.620974738145538e-12,
        3.473643847226848e-13,
        6.600121111790444e-14,
        -2.503567877178121e-15,
        -4.054977332660797e-16,
        1.459031848088721e-17,
        2.04388479296526e-18,
        -7.016673836449266e-20,
        -8.605856694736028e-21,
        2.831743738190695e-22,
        3.072769227368158e-23,
        -9.72665365552456e-25,
        -9.42299902500924e-26,
        2.870550642562116e-27,
        2.508975022001756e-28,
    ],
    &[
        0.03289782233383492,
        0.002572660330920313,
        0.1138330700104721,
        -0.007007092491769913,
        -0.03284625186277171,
        0.001324217984151229,
        0.002966275962746468,
        -0.0000980015034529625,
        -0.0001338279653800022,
        3.905477268987273e-6,
        3.643601082564915e-6,
        -9.74278668075238e-8,
        -6.652814578619253e-8,
        1.664663565257328e-9,
        8.721356000429366e-10,
        -2.069342306054717e-11,
        -8.611679025926602e-12,
        1.954866067748209e-13,
        6.637474513339433e-14,
        -1.450462999535332e-15,
        -4.105064919361997e-16,
        8.674521931849049e-18,
        2.082619310794176e-18,
        -4.269757974401323e-20,
        -8.824588298699887e-21,
        1.759765207692971e-22,
        3.170221270265473e-23,
        -6.161256054262759e-25,
        -9.77938229473892e-26,
        1.850305768704693e-27,
        2.618656395922398e-28,
    ],
];

pub const SPLITS: [f64; 11] = [
    0.3430978824893078,
    0.7266840374939242,
    1.110270192498541,
    1.877442502507773,
    3.411787122526239,
    6.48047636256317,
    12.61785484263703,
    24.89261180278476,
    37.16736876293248,
    43.30474724300634,
    49.4421257230802,
];
