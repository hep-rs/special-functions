use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                3840.,
                -192.,
                6.,
                -0.16666666666666666,
                0.005208333333333333,
                -0.00026041666666666666,
                0.000029100076294670406,
                1.4821739266237164e-6,
                2.694338949399656e-8,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.00002170138888888889,
                    -7.750496031746032e-7,
                    -1.2110150049603175e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                22.402990204514566,
                189.02522985059164,
                937.2500980091835,
                2782.4612284647637,
                4382.376434832003,
                2099.888708357001,
                -937.4503162308041,
                1186.4605564796116,
                -2389.3997317992175,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 23] = [
    &[],
    &[
        6.035765588017705e24,
        5.752745233447328e23,
        -1.681877756147958e23,
        -2.8797269632801814e22,
        2.785017661963122e21,
        8.721582424554183e20,
        -3.5610502691664118e19,
        -3.4360014799407722e19,
        6.345641404697455e18,
        -4.751217595255914e17,
        1.4101292029094498e16,
    ],
    &[
        -383538.0057411081,
        9304.915903676569,
        1366.2226931955854,
        2875.2582893704075,
        -725.5851212220095,
        75.92748312444296,
        -3.9259598181851527,
        0.06585591856570112,
        0.0032081473058920363,
        -0.0001849016997177666,
        2.8738646442937855e-6,
    ],
    &[
        109.54099173831963,
        -51.79647073880012,
        11.379273234682728,
        -1.5289506071281487,
        0.1390664413062257,
        -0.008941094854336456,
        0.00041120156902969547,
        -0.000013345444933386645,
        2.9222786741596735e-7,
        -3.894409971533863e-9,
        2.3958306878231517e-11,
    ],
    &[
        -0.027507326885700387,
        0.008512300669655172,
        -0.0011769102951272813,
        0.00009491140734124853,
        -4.8805655683182844e-6,
        1.6378100557926267e-7,
        -3.5006668492007676e-9,
        4.354672380565641e-11,
        -2.412277352315441e-13,
    ],
    &[
        -0.00003092752135898783,
        8.339682339902594e-6,
        -9.99007978602584e-7,
        6.940701912637771e-8,
        -3.057610601221885e-9,
        8.74204502069216e-11,
        -1.583439561272471e-12,
        1.6604804762310024e-14,
        -7.714898624770051e-17,
    ],
    &[
        -7.822760309250613e-8,
        1.8634915491842383e-8,
        -1.964653827298168e-9,
        1.1969350208233298e-10,
        -4.607334315872202e-12,
        1.1470292921107974e-13,
        -1.8030054036328742e-15,
        1.6355085423984627e-17,
        -6.552598866395463e-20,
    ],
    &[
        5.60575534168291e-10,
        -1.2309628307252482e-10,
        1.1928648890906797e-11,
        -6.660892486519122e-13,
        2.3434955506266586e-14,
        -5.318221461452633e-16,
        7.600148591497535e-18,
        -6.251708188318164e-20,
        2.2656928412357e-22,
    ],
    &[
        3.7293167673114744e-12,
        -7.373070586708841e-13,
        6.421302514782965e-14,
        -3.216927163459272e-15,
        1.0137405975447842e-16,
        -2.0572561029704705e-18,
        2.6250446809970507e-20,
        -1.92516143170921e-22,
        6.2117177087425e-25,
    ],
    &[
        2.1638774218539528e-14,
        -4.377266559142211e-15,
        4.0074871880469383e-16,
        -2.186328603957413e-17,
        7.870074109365804e-19,
        -1.9528563882035353e-20,
        3.382358711247822e-22,
        -4.0370992538285286e-24,
        3.177488400471e-26,
        -1.4889835932634154e-28,
        3.154167182819966e-31,
    ],
    &[
        1.4379158540599511e-18,
        -2.499438951663323e-19,
        1.9630681651262226e-20,
        -9.172967647536444e-22,
        2.823801972875298e-23,
        -5.983269602770423e-25,
        8.83638011888813e-27,
        -8.980605528721735e-29,
        6.010597567473594e-31,
        -2.3919807156428365e-33,
        4.297771172487661e-36,
    ],
    &[
        1.3576159632338387e-22,
        -2.0663298372242853e-23,
        1.4195661110011934e-24,
        -5.796378916995597e-26,
        1.5577046914142205e-27,
        -2.8786195675627956e-29,
        3.704409075076772e-31,
        -3.2776755931109796e-33,
        1.9081975908160786e-35,
        -6.600100422113364e-38,
        1.029857491138133e-40,
    ],
    &[
        1.5926822477452683e-26,
        -2.1544546627468482e-27,
        1.3145538554356932e-28,
        -4.764015114282719e-30,
        1.135566188317827e-31,
        -1.8601523439313754e-33,
        2.1205788620273145e-35,
        -1.6611742901436968e-37,
        8.55730024518646e-40,
        -2.6174979433720435e-42,
        3.6099486816266536e-45,
    ],
    &[
        2.1573136131712628e-30,
        -2.62498667713264e-31,
        1.440005284174854e-32,
        -4.689765511279556e-34,
        1.0041183663765763e-35,
        -1.4768054139027606e-37,
        1.510931825966224e-39,
        -1.0617935471616858e-41,
        4.904786319535684e-44,
        -1.3447984870518225e-46,
        1.6618563870676974e-49,
    ],
    &[
        3.229972474990863e-34,
        -3.570288877107399e-35,
        1.7786042944626534e-36,
        -5.258450009419364e-38,
        1.0217373318615125e-39,
        -1.363281684102974e-41,
        1.2649669896491263e-43,
        -8.059611586048217e-46,
        3.374466520933592e-48,
        -8.383551320952768e-51,
        9.384870118820616e-54,
    ],
    &[
        5.200336134429585e-38,
        -5.2650190370129995e-39,
        2.401744283926442e-40,
        -6.500484796043643e-42,
        1.1560067335738148e-43,
        -1.4113511464871133e-45,
        1.197994961911742e-47,
        -6.980986029503183e-50,
        2.672623026856088e-52,
        -6.0701031097546665e-55,
        6.210687811252579e-58,
    ],
    &[
        8.84074331480928e-42,
        -8.255481332469381e-43,
        3.472703998376566e-44,
        -8.665643867890556e-46,
        1.4205192207494877e-47,
        -1.598354263248017e-49,
        1.2501601476598694e-51,
        -6.711560166959255e-54,
        2.366822474793185e-56,
        -4.950764802917993e-59,
        4.664369047848853e-62,
    ],
    &[
        1.567153571669242e-45,
        -1.3577992683078706e-46,
        5.298631544503366e-48,
        -1.226403836342061e-49,
        1.8644550475241438e-51,
        -1.9453013121737812e-53,
        1.4106745937233612e-55,
        -7.020560088506917e-58,
        2.2947856107004063e-60,
        -4.4485584266571817e-63,
        3.8837761117622587e-66,
    ],
    &[
        2.8708733577952817e-49,
        -2.319767317343926e-50,
        8.441607528475811e-52,
        -1.8217756043299478e-53,
        2.5820327229608894e-55,
        -2.5112777734366477e-57,
        1.6973970836729677e-59,
        -7.872793186608816e-62,
        2.3980180506548118e-64,
        -4.331483414359643e-67,
        3.523167838050369e-70,
    ],
    &[
        5.3995090514029055e-53,
        -4.087361696980298e-54,
        1.3932810318193862e-55,
        -2.816312083642466e-57,
        3.738335231931303e-59,
        -3.4048735487910236e-61,
        2.154960819935828e-63,
        -9.358262737867539e-66,
        2.6686453994655886e-68,
        -4.512419347411271e-71,
        3.435608014091674e-74,
    ],
    &[
        -2.2486652723726504e-57,
        1.3077069840073575e-58,
        -3.329025813460552e-60,
        4.845355125241115e-62,
        -4.410122614933863e-64,
        2.5703314793019636e-66,
        -9.367808083851873e-69,
        1.951983390130837e-71,
        -1.780396219151781e-74,
    ],
    &[
        -1.0548241454438436e-59,
        5.909659764922739e-61,
        -1.4492653134989703e-62,
        2.0319700534848483e-64,
        -1.7815002876010248e-66,
        1.0001170281797852e-68,
        -3.510826401059974e-71,
        7.045968764875468e-74,
        -6.189539365667701e-77,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 23] = [
    &[],
    &[
        1.,
        3.521600592500009e11,
        -6.08522731831995e12,
        4.911833108881045e13,
        -2.4625938369862562e14,
        8.602152460278005e14,
        1.5718117290888672e21,
        1.498155044572282e20,
        3.4784847818971496e19,
    ],
    &[
        1.,
        -5.165832938305664,
        12.668848567929743,
        -19.624233188051765,
        21.547927796261668,
        -17.839787984038175,
        -88.31772478326991,
        -3.5856702598904016,
        -2.095234706125606,
        -0.014122937355774275,
        -0.011661557907216295,
    ],
    &[
        1.,
        -1.8721299808884173,
        1.5715501469274187,
        -0.7452435263394969,
        0.1860351598510479,
        0.005508721775116513,
        0.0015569099959135703,
        0.0001071567851653945,
    ],
    &[
        1.,
        -1.0509955413584247,
        0.502840617948837,
        -0.14432818739305722,
        0.027544255687996667,
        -0.003658794020234878,
        0.00033841290765020056,
        -0.00002188856628779196,
        8.814466413296522e-7,
        -2.0817213491221275e-8,
    ],
    &[
        1.,
        -0.7477233532596977,
        0.25299169603879446,
        -0.05096901121384998,
        0.006760121755158809,
        -0.0006147756106537093,
        0.00003855903105827526,
        -1.6230183109235909e-6,
        4.21555430016906e-8,
        -5.344341866346448e-10,
    ],
    &[
        1.,
        -0.5738456152071918,
        0.14836414883284446,
        -0.022720564132751652,
        0.002275871997209279,
        -0.0001550339728058579,
        7.20633752346256e-6,
        -2.2141889987353966e-7,
        4.108173267195678e-9,
        -3.5484506486482644e-11,
    ],
    &[
        1.,
        -0.41546399921386473,
        0.07639666987411113,
        -0.008131523420580183,
        0.0005488219958807984,
        -0.000024099576901423972,
        6.740700333410809e-7,
        -1.1017265565702143e-8,
        8.095792087289251e-11,
    ],
    &[
        1.,
        -0.34590712721461014,
        0.05282276093077913,
        -0.004655281591119298,
        0.00025923773164240286,
        -9.35220013261115e-6,
        2.137716355199795e-7,
        -2.836072916757601e-9,
        1.6761676604624612e-11,
    ],
    &[
        1.,
        -0.3603110571841369,
        0.05883737902614334,
        -0.0057373714349480244,
        0.0003702079149658208,
        -0.000016528871216263077,
        5.17570703390155e-7,
        -1.1234849014951135e-8,
        1.6198893091809228e-10,
        -1.4029816003904204e-12,
        5.553051059451106e-15,
    ],
    &[
        1.,
        -0.2803327371869432,
        0.03553988245359707,
        -0.0026841418318655744,
        0.00013378439107546367,
        -4.599995299835758e-6,
        1.1054621037110563e-7,
        -1.8343561284719097e-9,
        2.0125479002681768e-11,
        -1.3191652072686894e-13,
        3.925787000297829e-16,
    ],
    &[
        1.,
        -0.22870682892246824,
        0.02362369562816762,
        -0.0014515479097126855,
        0.00005876674501725833,
        -1.638398531262111e-6,
        3.186367890567973e-8,
        -4.269566840290569e-10,
        3.773457234477055e-12,
        -1.986985071803349e-14,
        4.735525826067424e-17,
    ],
    &[
        1.,
        -0.19281651141827927,
        0.016776396187614645,
        -0.0008674798916474301,
        0.000029525398531664598,
        -6.912611294734747e-7,
        1.127608057972132e-8,
        -1.265669469292121e-10,
        9.35688950906664e-13,
        -4.114929848006495e-15,
        8.176380383326716e-18,
    ],
    &[
        1.,
        -0.1665008223350022,
        0.01250210099168905,
        -0.0005575437193118084,
        0.000016355161679082278,
        -3.29780251451441e-7,
        4.629406749681841e-9,
        -4.4679495068568833e-11,
        2.83758190784486e-13,
        -1.0709894725143284e-15,
        1.8244479381186797e-18,
    ],
    &[
        1.,
        -0.14641798404327855,
        0.009663935711784366,
        -0.000378658256524361,
        9.754701227448768e-6,
        -1.7264549838684604e-7,
        2.126154961458182e-9,
        -1.7991595048625732e-11,
        1.001240848236936e-13,
        -3.309203449724595e-16,
        4.933077242985376e-19,
    ],
    &[
        1.,
        -0.13060780856754645,
        0.007687188178183217,
        -0.00026850782990212095,
        6.164098599390477e-6,
        -9.71849918364019e-8,
        1.0657640912955405e-9,
        -8.027548268528056e-12,
        3.974788467403196e-14,
        -1.168330443619234e-16,
        1.5481748521148395e-19,
    ],
    &[
        1.,
        -0.1178485587247913,
        0.006257129911570563,
        -0.00019711060568218034,
        4.0799610265736045e-6,
        -5.7983164902875497e-8,
        5.730037510518281e-10,
        -3.888163371014008e-12,
        1.7338281860602584e-14,
        -4.588246406579375e-17,
        5.471940700068313e-20,
    ],
    &[
        1.,
        -0.10734093975002819,
        0.005190129369452908,
        -0.00014886497083414882,
        2.8049965739184395e-6,
        -3.62812956715288e-8,
        3.262495368789317e-10,
        -2.013963358960703e-12,
        8.168204221851846e-15,
        -1.96550930880817e-17,
        2.130920327146346e-20,
    ],
    &[
        1.,
        -0.09854091294070808,
        0.004373389715007331,
        -0.00011512156415809268,
        1.990460928175751e-6,
        -2.362064525685701e-8,
        1.9483832214244642e-10,
        -1.1031044555499782e-12,
        4.1025550947425334e-15,
        -9.050754309893602e-18,
        8.99444828111526e-21,
    ],
    &[
        1.,
        -0.09106578044867104,
        0.0037346119741074988,
        -0.00009082827103664676,
        1.4507805854153125e-6,
        -1.5902609203024822e-8,
        1.211497431985262e-10,
        -6.333987249999862e-13,
        2.175034973252249e-15,
        -4.429804109712211e-18,
        4.0634650800147094e-21,
    ],
    &[
        1.,
        -0.07595494393022462,
        0.0025654762888608048,
        -0.00005057542413349536,
        6.413170511030855e-7,
        -5.424586488013334e-9,
        3.0607356927681955e-11,
        -1.1108642092083346e-13,
        2.3533115689504077e-16,
        -2.2171091243048254e-19,
    ],
    &[
        1.,
        -0.07274841355694532,
        0.002353339056722184,
        -0.000044430998679768135,
        5.39547725767072e-7,
        -4.370329639194767e-9,
        2.3612568414373422e-11,
        -8.205914459997342e-14,
        1.6644555195956319e-16,
        -1.5013573690524765e-19,
    ],
    &[],
];

pub const SPLITS: [f64; 24] = [
    0.,
    0.5545619341642494,
    2.6532312380787513,
    6.8505698459077555,
    11.04790845373676,
    15.245247061565763,
    19.442585669394767,
    23.639924277223773,
    27.837262885052777,
    32.034601492881784,
    40.42927870853979,
    48.8239559241978,
    57.218633139855804,
    65.61331035551382,
    74.00798757117182,
    82.40266478682983,
    90.79734200248784,
    99.19201921814584,
    107.58669643380385,
    115.98137364946186,
    124.37605086511988,
    129.62272412490614,
    134.86939738469238,
    std::f64::INFINITY,
];
