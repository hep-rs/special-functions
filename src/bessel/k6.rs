#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-6)
        * polynomial(
            x2,
            &[
                3840.,
                -192.,
                6.,
                -0.1666666666666667,
                0.005208333333333333,
                -0.0002604166666666667,
                0.00002910007629467041,
                1.482173926623716e-6,
                2.694338949399656e-8,
            ],
        )
        + x.powi(6)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.00002170138888888889,
                    -7.750496031746032e-7,
                    -1.211015004960317e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                22.40299020451457,
                189.0252298505917,
                937.250098009184,
                2782.461228464764,
                4382.376434832003,
                2099.888708357002,
                -937.450316230804,
                1186.460556479612,
                -2389.399731799218,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        2.36533671454608,
        -8.196851592385144,
        -0.4791427923738053,
        -0.1488473791907452,
        -0.03217594222923397,
        -0.004512761166677692,
        -0.0002701005801978399,
        0.0000283983761364463,
        2.922696951572864e-6,
        -1.882329490009374e-6,
        -4.526581380129069e-7,
        2.606488929309564e-8,
        2.569557029337149e-8,
        2.067906002996511e-9,
        -1.080837007736403e-9,
        -2.576125620794152e-10,
        2.446789333607745e-11,
        1.767373159419607e-11,
        1.018995857558208e-12,
        -8.689233854081453e-13,
        -1.765674606233214e-13,
        2.636989923502808e-14,
        1.387375433263394e-14,
        3.357142102130935e-16,
        -7.720281286570561e-16,
        -1.245345777345488e-16,
        2.898720049618273e-17,
        1.135233421711736e-17,
        -1.855777238733801e-19,
        -6.76001341167765e-19,
        -8.413958499729412e-20,
    ],
    &[
        -36.03033204344471,
        -37.75599492314941,
        -9.97416686853789,
        -2.006575149745421,
        -0.285045211066134,
        -0.03373744338157064,
        -0.003444210585891324,
        -0.0002654946823188386,
        -0.00002134322295019883,
        -1.808592510910164e-6,
        3.026807241959127e-8,
        -1.500862479013193e-8,
        -1.844648397357119e-9,
        7.722531015306277e-10,
        -1.235183031877059e-10,
        -1.370482600514534e-12,
        5.250347046288894e-12,
        -1.213338161432161e-12,
        7.859810260118285e-14,
        3.120062643437152e-14,
        -1.090024734358356e-14,
        1.350402348354794e-15,
        1.316816815988214e-16,
        -9.000126793684281e-17,
        1.648944817534156e-17,
        -1.81527792604011e-19,
        -6.693584718386138e-19,
        1.732832836327391e-19,
        -1.367778727099345e-20,
        -4.421581520430737e-21,
        1.640404788365359e-21,
    ],
];

pub const SPLITS: [f64; 3] = [-0.3294163225192047, 2.052535095364062, 4.434486513247328];
