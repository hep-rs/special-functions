#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-6)
        * polynomial(
            x2,
            &[
                3840.,
                -192.,
                6.,
                -0.1666666666666667,
                0.005208333333333333,
                -0.0002604166666666667,
                0.00002910007629467041,
                1.482173926623716e-6,
                2.694338949399656e-8,
            ],
        )
        + x.powi(6)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.00002170138888888889,
                    -7.750496031746032e-7,
                    -1.211015004960317e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                22.40299020451457,
                189.0252298505917,
                937.250098009184,
                2782.461228464764,
                4382.376434832003,
                2099.888708357002,
                -937.450316230804,
                1186.460556479612,
                -2389.399731799218,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        8.392448672644183,
        -1.815292004585861,
        -0.004180588439504984,
        -0.0004024924450185836,
        -0.00002850225115544382,
        -1.545553133972864e-6,
        -6.341835572033176e-8,
        -1.736984918387659e-9,
        -8.455275944900504e-12,
        2.221588332343634e-12,
        1.331831487801949e-13,
        2.75603127011473e-15,
        -1.528641901221238e-16,
        -1.673551640123471e-17,
        -6.84121905746634e-19,
        1.625796794954822e-22,
        1.880531442403538e-21,
        1.23121780939702e-22,
        2.791907454042299e-24,
        -1.682689526665065e-25,
        -1.916289098697858e-26,
        -7.729225838838699e-28,
        5.275476200891928e-30,
        2.625784115432644e-30,
        1.570623584858425e-31,
        2.518184188245668e-33,
        -3.026550023634196e-34,
        -2.737060644641881e-35,
        -8.882978606478517e-37,
        2.404507473374286e-38,
        4.226117226965932e-39,
    ],
    &[
        4.705716977969425,
        -1.878775358290559,
        -0.01307833308612981,
        -0.001204275439233821,
        -0.00007827778659780965,
        -3.569914043800844e-6,
        -9.64276075754847e-8,
        2.4875044019723e-10,
        1.480325354604808e-10,
        3.879272026626513e-12,
        -2.854779799608775e-13,
        -2.684928079442498e-14,
        -4.724466384704273e-16,
        6.337636015981031e-17,
        4.855415857936317e-18,
        3.384468325719423e-20,
        -1.522854244168914e-20,
        -9.12307624386342e-22,
        7.248470808498797e-24,
        3.688490998106864e-24,
        1.653387534918474e-25,
        -4.996888353106264e-27,
        -8.725506232883057e-28,
        -2.670282077254554e-29,
        1.878125036614189e-30,
        1.977341914451057e-31,
        3.184123615310094e-33,
        -5.817889345903235e-34,
        -4.223871929284636e-35,
        2.536566118591016e-38,
        1.615393897690781e-37,
    ],
    &[
        0.7786879167178403,
        -2.068689015494676,
        -0.03777691078092715,
        -0.003141216347433938,
        -0.000169406580723614,
        -5.269517901190579e-6,
        -3.014538729325444e-8,
        3.035202847387364e-9,
        -1.290583299665999e-10,
        -1.924379817049081e-11,
        -1.301399511600801e-13,
        6.4202369909771e-14,
        1.996777493780244e-15,
        -1.9976631579349e-16,
        -1.273920568965187e-17,
        4.947429275641429e-19,
        6.412915963973277e-20,
        -4.946538090309994e-22,
        -2.807831005426071e-22,
        -4.702606022472096e-24,
        1.083857527995471e-24,
        4.635711256962269e-26,
        -3.564540442669064e-27,
        -2.871822974416231e-28,
        8.637464789682198e-30,
        1.465821088152565e-30,
        -2.718925274981426e-33,
        -6.531145053308809e-33,
        -1.450273577754017e-34,
        2.540312838810081e-35,
        1.257956851105265e-36,
    ],
    &[
        -3.818186881466744,
        -2.575943389507036,
        -0.0952974595421421,
        -0.006721070074365392,
        -0.0002799485576070786,
        -5.975320309960138e-6,
        -8.21306895280399e-8,
        -7.863645451716204e-9,
        -3.157683972015521e-10,
        1.551537584832811e-11,
        6.705014736065929e-13,
        -6.996212369443555e-14,
        -1.834969380490695e-15,
        2.967788706319451e-16,
        3.868645168102023e-18,
        -1.266866619493177e-18,
        -7.810411906390347e-22,
        5.366771123786421e-21,
        -6.290227348608183e-23,
        -2.237559441400849e-23,
        5.535821649468368e-25,
        9.10490482443973e-26,
        -3.591356847517723e-27,
        -3.5785668306685e-28,
        2.055568833578007e-29,
        1.337329593789507e-30,
        -1.094542898053467e-31,
        -4.616285560892893e-33,
        5.543017906965741e-34,
        1.373034287977798e-35,
        -2.697701796042148e-36,
    ],
    &[
        -10.04829114355121,
        -3.747288626011885,
        -0.2073541770908921,
        -0.01235157026491973,
        -0.0004405202282156522,
        -0.0000111769576580146,
        -3.566711731780766e-7,
        -9.45709663557061e-9,
        8.584101848021303e-11,
        -2.600386220933401e-12,
        -6.74503555789109e-13,
        2.810322295076319e-14,
        9.76988011380272e-16,
        -1.413399925626107e-16,
        2.548969154336072e-18,
        4.033886121996004e-19,
        -2.688667054769112e-20,
        -3.372054107534184e-22,
        1.163185447996621e-22,
        -3.813661586063341e-24,
        -2.795734616529548e-25,
        2.709557273623192e-26,
        -1.079444919052247e-28,
        -1.013982755319021e-28,
        4.924362479906213e-30,
        1.821922018784877e-31,
        -2.766704863990082e-32,
        5.074134107044579e-34,
        8.797511539120412e-35,
        -5.939728598772687e-36,
        -8.673185210651705e-38,
    ],
    &[
        -19.76900755742952,
        -6.139261973289256,
        -0.406984041382735,
        -0.0217401867357036,
        -0.000770346625967126,
        -0.00002281421609073845,
        -6.197280660989894e-7,
        -1.097270356830029e-8,
        -2.060981417138227e-10,
        -8.046158705473442e-12,
        1.334069944576584e-13,
        -6.932909065431001e-16,
        -5.248106963360674e-16,
        3.040268457925585e-17,
        -3.674926851957502e-19,
        -6.626322567530747e-20,
        5.097595162944146e-21,
        -1.130259184919246e-22,
        -8.463936328081239e-24,
        8.63322679374669e-25,
        -2.709496175890374e-26,
        -1.00087024071228e-27,
        1.461822301712313e-28,
        -5.911053955920895e-30,
        -9.37046958348263e-32,
        2.450248349583461e-32,
        -1.225467261383801e-33,
        -1.793013482179086e-36,
        4.02820997142909e-36,
        -2.448358277794145e-37,
        2.3766227849211e-39,
    ],
    &[
        -51.97233927398176,
        -29.45292150985484,
        -4.210460961684141,
        -0.4211269421575644,
        -0.03079435504107154,
        -0.001846192527531614,
        -0.0000912769460803989,
        -3.81684021921988e-6,
        -1.486727784380397e-7,
        -4.48858768526858e-9,
        -1.425648402891033e-10,
        -5.460871469657991e-12,
        1.208971021634048e-13,
        -1.797043503464262e-14,
        3.892894533128352e-16,
        6.281590100106057e-17,
        -1.176232532657341e-17,
        1.046505478501034e-18,
        -4.493060705510188e-20,
        -2.469271116206773e-21,
        6.945400728879151e-22,
        -7.254195596618318e-23,
        3.976935282637994e-24,
        6.933245757678683e-26,
        -4.255007871590196e-26,
        5.144462498373698e-27,
        -3.34443745404838e-28,
        1.571094449652251e-30,
        2.628747628621888e-30,
        -3.69336300850201e-31,
        2.743224825785327e-32,
    ],
];

pub const SPLITS: [f64; 8] = [
    -0.3294163225192047,
    0.2660715319516119,
    0.8615593864224284,
    1.457047240893245,
    2.052535095364062,
    2.648022949834878,
    3.243510804305695,
    4.434486513247328,
];
