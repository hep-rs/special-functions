use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-6)
        * polynomial(
            x2,
            &[
                3840.,
                -192.,
                6.,
                -0.16666666666666666,
                0.005208333333333333,
                -0.00026041666666666666,
                0.000029100076294670406,
                1.4821739266237164e-6,
                2.694338949399656e-8,
            ],
        )
        + x.powi(6)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.00002170138888888889,
                    -7.750496031746032e-7,
                    -1.2110150049603175e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                22.402990204514566,
                189.02522985059164,
                937.2500980091835,
                2782.4612284647637,
                4382.376434832003,
                2099.888708357001,
                -937.4503162308041,
                1186.4605564796116,
                -2389.3997317992175,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 12] = [
    &[
        7505.768401570212,
        -10795.148853869408,
        5424.60011486634,
        -2189.244201865111,
        762.1228481636126,
        -238.49750216693155,
        68.85971162436527,
        -18.66607392466788,
        4.809401685849983,
        -1.1884739220590408,
        0.28359468314186775,
        -0.06568963839905326,
        0.014831548771165697,
        -0.0032750186487799215,
        0.0007091841745945021,
        -0.00015093780036334306,
        0.00003163345953223043,
        -6.538745405638646e-6,
        1.3348392507667783e-6,
        -2.6943592904590263e-7,
        5.3828403393853655e-8,
        -1.0653155510271134e-8,
        2.090211540878077e-9,
        -4.068575256698437e-10,
        7.861330098799159e-11,
        -1.5086347372489283e-11,
        2.8768341001281943e-12,
        -5.45349855160746e-13,
        1.0280964251335412e-13,
        -1.928160880295319e-14,
        3.598668704386815e-15,
        -6.685834888786887e-16,
        1.2368004607284256e-16,
        -2.2786579675882454e-17,
        4.182065162935467e-18,
        -7.647570762118392e-19,
        1.3936677156399706e-19,
        -2.5314756044092218e-20,
        4.583921340596555e-21,
        -8.275886606911754e-22,
        1.4899316303706108e-22,
        -2.67515464478881e-23,
        4.790877625722361e-24,
        -8.559062262909747e-25,
        1.5269244016049528e-25,
        -2.7978352011255615e-26,
        4.813323563650058e-27,
    ],
    &[
        207.5135989892385,
        -219.55235306230526,
        72.8623299359223,
        -18.696729525023162,
        4.0658536473732,
        -0.7872106818136828,
        0.13981223077921587,
        -0.023226795048913985,
        0.003658346696979805,
        -0.0005516484741494455,
        0.00008021941763516076,
        -0.00001131247377143623,
        1.5538022473626521e-6,
        -2.0859875117172198e-7,
        2.7449728762502673e-8,
        -3.5488679180704985e-9,
        4.5166152502072076e-10,
        -5.667879584410752e-11,
        7.022934139450849e-12,
        -8.602545680991186e-13,
        1.0427859330531489e-13,
        -1.2520284144350556e-14,
        1.4901380338049885e-15,
        -1.7592748917428927e-16,
        2.0615924371306738e-17,
        -2.399227098587031e-18,
        2.77428832525473e-19,
        -3.1888490761678134e-20,
        3.644936790184392e-21,
        -4.144524861907053e-22,
        4.6895246430785913e-23,
        -5.28177798358979e-24,
        5.923050321425353e-25,
        -6.615024326563376e-26,
        7.359294099995271e-27,
        -8.157359925611298e-28,
        9.010623569668892e-29,
        -9.920384119895574e-30,
        1.088783435394674e-30,
        -1.1914057624914027e-31,
        1.300002524986491e-32,
        -1.4146594388575555e-33,
        1.5354506648739e-34,
        -1.662441111550639e-35,
        1.7959130147292837e-36,
        -1.9575272855884935e-37,
        2.0810301060328888e-38,
    ],
    &[
        14.73851236505423,
        -19.080901748201747,
        8.071686470509633,
        -2.656463436269719,
        0.7409631678208183,
        -0.18383311320310666,
        0.04179757954180285,
        -0.008882530477662347,
        0.0017886357129045197,
        -0.00034466725231095826,
        0.00006402879493770459,
        -0.00001153197245953677,
        2.022595983746091e-6,
        -3.4667966844324143e-7,
        5.8238190388172624e-8,
        -9.611103166087144e-9,
        1.561272115903934e-9,
        -2.5005927536942655e-10,
        3.9543707791569797e-11,
        -6.181667231591451e-12,
        9.562689713780396e-13,
        -1.4651908012163766e-13,
        2.225319468073147e-14,
        -3.3525694429737252e-15,
        5.013242572452658e-16,
        -7.444812415208052e-17,
        1.0984897745611057e-17,
        -1.611152517126157e-18,
        2.3498913900791197e-19,
        -3.4094550430235486e-20,
        4.922539586449004e-21,
        -7.074386900823266e-22,
        1.0122802157725275e-22,
        -1.442553976772839e-23,
        2.047768872490438e-24,
        -2.896260266471768e-25,
        4.082114450257782e-26,
        -5.734565327512693e-27,
        8.030722831363607e-28,
        -1.121278439729534e-28,
        1.561126960691022e-29,
        -2.167633555973228e-30,
        3.0019921643003195e-31,
        -4.1472632208623055e-32,
        5.717855683029509e-33,
        -8.007560884629006e-34,
        1.0784725879008558e-34,
    ],
    &[
        0.447549608927435,
        -0.670524395404291,
        0.34405088619431234,
        -0.13747969897863285,
        0.04618596735249946,
        -0.013686159857014057,
        0.0036916839467099997,
        -0.0009260535039766768,
        0.00021930233463741963,
        -0.000049563868454518504,
        0.000010777261121324603,
        -2.268524137491864e-6,
        4.6446054985228947e-7,
        -9.284824293637006e-8,
        1.8178078984335397e-8,
        -3.4942990752020127e-9,
        6.608637638778684e-10,
        -1.231854918833711e-10,
        2.266433073428279e-11,
        -4.121056356818123e-12,
        7.413565924900491e-13,
        -1.3207081637029405e-13,
        2.3318682291435583e-14,
        -4.083490297830647e-15,
        7.096852674053819e-16,
        -1.2247630476767067e-16,
        2.0999507153030592e-17,
        -3.578761380814129e-18,
        6.064557300105456e-19,
        -1.0222735329015628e-19,
        1.71467060970514e-20,
        -2.8626655959295056e-21,
        4.758345915510097e-22,
        -7.876726457063139e-23,
        1.2987921220804606e-23,
        -2.1336800808447078e-24,
        3.4930042932881053e-25,
        -5.699371527348351e-26,
        9.270109547087945e-27,
        -1.5032788515510615e-27,
        2.430820952945003e-28,
        -3.9199702348439964e-29,
        6.30496677442287e-30,
        -1.0116021102884724e-30,
        1.6201995572282418e-31,
        -2.6512770559597806e-32,
        4.120382157123113e-33,
    ],
    &[
        0.004133668547020895,
        -0.006967873214021734,
        0.004378860946683686,
        -0.002181272567173834,
        0.0009058708351773711,
        -0.0003260707978090198,
        0.00010480656478789996,
        -0.00003078065272222795,
        8.40834250698615e-6,
        -2.1660934527960702e-6,
        5.318854323486472e-7,
        -1.2552460664631844e-7,
        2.8655409796652445e-8,
        -6.359801092468369e-9,
        1.377767557240022e-9,
        -2.9227823158699793e-10,
        6.087467386845936e-11,
        -1.2474630536780645e-11,
        2.5196777846603035e-12,
        -5.023902307592151e-13,
        9.900810671897822e-14,
        -1.9306742037713696e-14,
        3.728777162349492e-15,
        -7.138388369802929e-16,
        1.3555728275388366e-16,
        -2.5551110531065655e-17,
        4.78304738806441e-18,
        -8.89660716295765e-19,
        1.6449881913881215e-19,
        -3.02477967374434e-20,
        5.533170264268929e-21,
        -1.0072688145810063e-21,
        1.8253090944726035e-22,
        -3.29354945971745e-23,
        5.9188261042549385e-24,
        -1.0596158206832461e-24,
        1.8901338453836554e-25,
        -3.3600875387205267e-26,
        5.95386177422644e-27,
        -1.0517377716794773e-27,
        1.852430874398526e-28,
        -3.253590784051996e-29,
        5.699369992851133e-30,
        -9.958569769024487e-31,
        1.7373197621535185e-31,
        -3.1091034123831106e-32,
        5.2372760267891284e-33,
    ],
    &[
        3.967585889962789e-6,
        -7.235697958174631e-6,
        5.515776596113013e-6,
        -3.5610641703052354e-6,
        1.9787400828993352e-6,
        -9.618994664072903e-7,
        4.1538053295533556e-7,
        -1.615667524940406e-7,
        5.7309542454213836e-8,
        -1.8744522386814073e-8,
        5.709413073292506e-9,
        -1.633920276015215e-9,
        4.4284109496587416e-10,
        -1.1448105495551477e-10,
        2.8407754774412236e-11,
        -6.8042618341772496e-12,
        1.5808065236618734e-12,
        -3.577256567104156e-13,
        7.913065748852466e-14,
        -1.716204000493973e-14,
        3.65860318954133e-15,
        -7.682361622842526e-16,
        1.5917180611739455e-16,
        -3.2588466812062583e-17,
        6.601180317864442e-18,
        -1.324314733220698e-18,
        2.63365617751681e-19,
        -5.195868039976466e-20,
        1.017601007225644e-20,
        -1.979567934554021e-21,
        3.827010825965094e-22,
        -7.356019860577122e-23,
        1.4063582108216273e-23,
        -2.6753236304175282e-24,
        5.065537555946198e-25,
        -9.549295181707936e-26,
        1.792789714451735e-26,
        -3.3527779557060455e-27,
        6.2473166421299465e-28,
        -1.160067382333657e-28,
        2.1471100375742786e-29,
        -3.961692272857781e-30,
        7.288382509614525e-31,
        -1.3371580645964392e-31,
        2.449193198718851e-32,
        -4.612736958028147e-33,
        8.129382772948061e-34,
    ],
    &[
        4.293996793720222e-11,
        -7.762506687815437e-11,
        5.768696908258108e-11,
        -3.5762721592688255e-11,
        1.8817883257095197e-11,
        -8.547671338025865e-12,
        3.4033643215357925e-12,
        -1.2038491403023963e-12,
        3.8271692560386563e-13,
        -1.1045517732897459e-13,
        2.919372889065095e-14,
        -7.120514405890242e-15,
        1.6135793891996973e-15,
        -3.417835080679235e-16,
        6.803953839132864e-17,
        -1.279317592336881e-17,
        2.2823723235342343e-18,
        -3.879958575789252e-19,
        6.309893270471776e-20,
        -9.853519645791129e-21,
        1.4827445032757099e-21,
        -2.157233215682968e-22,
        3.044088599057976e-23,
        -4.1787313891630555e-24,
        5.596005756389324e-25,
        -7.329867949623563e-26,
        9.4134742586651e-27,
        -1.1879566454790221e-27,
        1.4761006912723546e-28,
        -1.8091314661992333e-29,
        2.1905088417204287e-30,
        -2.623825561889371e-31,
        3.112813932639292e-32,
        -3.661337415502491e-33,
        4.273372265153773e-34,
        -4.952984579034295e-35,
        5.704307118745909e-36,
        -6.5315186960711305e-37,
        7.438827362413119e-38,
        -8.430457447920093e-39,
        9.510639786637896e-40,
        -1.0683604193962307e-40,
        1.195357353671486e-41,
        -1.3324780833803922e-42,
        1.4803531408021971e-43,
        -1.6586562533020558e-44,
        1.80873903770806e-45,
    ],
    &[
        8.007992109544818e-16,
        -1.4439157166695472e-15,
        1.0651588658255133e-15,
        -6.527772009274215e-16,
        3.383334469681352e-16,
        -1.5089004502481585e-16,
        5.880820573578238e-17,
        -2.0300866035944482e-17,
        6.279148503888657e-18,
        -1.7574841208549715e-18,
        4.48933249725551e-19,
        -1.0543151211070041e-19,
        2.2911101419044378e-20,
        -4.632954160880512e-21,
        8.761431617808302e-22,
        -1.5564373037428463e-22,
        2.6077525169121826e-23,
        -4.135744712435421e-24,
        6.22916473871172e-25,
        -8.937460827609873e-26,
        1.2249764903149589e-26,
        -1.6080832566509767e-27,
        2.0268626193746833e-28,
        -2.4585779961588418e-29,
        2.8763848432878665e-30,
        -3.2526050975522755e-31,
        3.562217085329867e-32,
        -3.785892766947611e-33,
        3.912050328266849e-34,
        -3.93764261739176e-35,
        3.8676889685274385e-36,
        -3.71380046656469e-37,
        3.492094371858237e-38,
        -3.220926889914289e-39,
        2.9188122878596476e-40,
        -2.6027777165425405e-41,
        2.287268253641308e-42,
        -1.983598791569009e-43,
        1.6998674454269611e-44,
        -1.4412038602508347e-45,
        1.2102193615893655e-46,
        -1.007543196075619e-47,
        8.323582757430472e-49,
        -6.828813846416693e-50,
        5.56782075579361e-51,
        -4.542958458602728e-52,
        3.6406266945139387e-53,
    ],
    &[
        1.7750833902708106e-20,
        -3.197000561584202e-20,
        2.3508027137847436e-20,
        -1.4335356004998173e-20,
        7.382426357351633e-21,
        -3.267267201448071e-21,
        1.262254545570383e-21,
        -4.314728778133776e-22,
        1.3201570328765958e-22,
        -3.651364700620996e-23,
        9.207123198506946e-24,
        -2.1321022024721524e-24,
        4.563162946529977e-25,
        -9.076333654261882e-26,
        1.6860333601135487e-26,
        -2.937763830205736e-27,
        4.819960917696538e-28,
        -7.472315583854359e-29,
        1.0980314744040199e-29,
        -1.5337688090182969e-30,
        2.041834415288872e-31,
        -2.596771224398461e-32,
        3.1619571829818985e-33,
        -3.693806278641775e-34,
        4.147764098356739e-35,
        -4.4848600668831684e-36,
        4.6774139195586345e-37,
        -4.712723774582253e-38,
        4.59409618496493e-39,
        -4.339232555628106e-40,
        3.9765622476163393e-41,
        -3.5404641195440715e-42,
        3.066390033140548e-43,
        -2.58673161555979e-44,
        2.1279509208391238e-45,
        -1.7091392473796546e-46,
        1.3418690077106367e-47,
        -1.0310136028670027e-48,
        7.76139510110846e-50,
        -5.731012933125682e-51,
        4.155565249601445e-52,
        -2.96225530840236e-53,
        2.078212352934882e-54,
        -1.4365057525076425e-55,
        9.79376474713643e-57,
        -6.621334669666898e-58,
        4.386010269809036e-59,
    ],
    &[
        4.263653756804255e-25,
        -7.674283109690099e-25,
        5.633216495039003e-25,
        -3.426045044400233e-25,
        1.758343558945841e-25,
        -7.750689988972297e-26,
        2.9807206889689957e-26,
        -1.0137628385122154e-26,
        3.0847454183731215e-27,
        -8.481400433429753e-28,
        2.125019852005412e-28,
        -4.8874039837597137e-29,
        1.038401322504858e-29,
        -2.049402873951029e-30,
        3.7755280207943896e-31,
        -6.520581102678476e-32,
        1.0597859339093026e-32,
        -1.6265382881071725e-33,
        2.364651920059776e-34,
        -3.2654410350274224e-35,
        4.2943046944123924e-36,
        -5.3905024540579335e-37,
        6.472566838296269e-38,
        -7.448814008228377e-39,
        8.230933211662934e-40,
        -8.747696376628283e-41,
        8.955752594671069e-42,
        -8.845263410805729e-43,
        8.439499353786597e-44,
        -7.788996794426119e-45,
        6.962025551441802e-46,
        -6.0336668823107485e-47,
        5.075702992466428e-48,
        -4.1489259539100436e-49,
        3.2986458235234753e-50,
        -2.5533766721569386e-51,
        1.926091168779073e-52,
        -1.4171373880173507e-53,
        1.0178863929791535e-54,
        -7.143455325705928e-56,
        4.9023058545580485e-57,
        -3.2925342684593805e-58,
        2.1659458285038823e-59,
        -1.39668305844737e-60,
        8.835469561696255e-62,
        -5.507490545922517e-63,
        3.3486167871129006e-64,
    ],
    &[
        1.0713870819786819e-29,
        -1.927690665769005e-29,
        1.413491227315755e-29,
        -8.582715275861859e-30,
        4.395800775944577e-30,
        -1.9329537598997215e-30,
        7.4134111766252775e-31,
        -2.513817200881447e-31,
        7.624508173911739e-32,
        -2.0890822896647266e-32,
        5.214940986548437e-33,
        -1.1947210936625337e-33,
        2.5278875161713283e-34,
        -4.967341186104641e-35,
        9.109088412043776e-36,
        -1.5655830206174e-36,
        2.531554461030542e-37,
        -3.8645007217815166e-38,
        5.586374843699867e-39,
        -7.668395926466183e-40,
        1.0021042773197013e-40,
        -1.2495534126642106e-41,
        1.4898598953907542e-42,
        -1.7018675891901335e-43,
        1.8658274302007557e-44,
        -1.9665285308521025e-45,
        1.995622072411288e-46,
        -1.9526565356040176e-47,
        1.8446843090272574e-48,
        -1.6846477097302337e-49,
        1.4890044581553673e-50,
        -1.2751516526749798e-51,
        1.0591528955218548e-52,
        -8.541104689550764e-54,
        6.693194510181628e-55,
        -5.10155116212626e-56,
        3.7851897260773316e-57,
        -2.736153160415446e-58,
        1.9283965085043108e-59,
        -1.3261047171206768e-60,
        8.904203694903187e-62,
        -5.841810501659884e-63,
        3.747352390072142e-64,
        -2.3518370377692847e-65,
        1.4450198787012793e-66,
        -8.726813166334753e-68,
        5.13084766586115e-69,
    ],
    &[
        2.770000941386828e-34,
        -4.9826503886818595e-34,
        3.6509599075647515e-34,
        -2.2144683583575968e-34,
        1.13263038819377e-34,
        -4.972528476307123e-35,
        1.903694142286061e-35,
        -6.44266118803651e-36,
        1.949991307167749e-36,
        -5.330979806539059e-37,
        1.3276257902185476e-37,
        -3.033982722917031e-38,
        6.402807549058258e-39,
        -1.2547241115829149e-39,
        2.294325906079025e-40,
        -3.9314711525483064e-41,
        6.337324812944853e-42,
        -9.64251550472732e-43,
        1.3891244184837094e-43,
        -1.900039071143443e-44,
        2.4737014124259077e-45,
        -3.072495376038166e-46,
        3.648425668530638e-47,
        -4.149795072722099e-48,
        4.529241410429912e-49,
        -4.751321281083129e-50,
        4.7979301820797196e-51,
        -4.6704432861380454e-52,
        4.388330710708263e-53,
        -3.9848558212573495e-54,
        3.5010558029606485e-55,
        -2.9794023598010015e-56,
        2.458361687903738e-57,
        -1.9686406849603543e-58,
        1.5313898137895378e-59,
        -1.1581831668307198e-60,
        8.523055665290271e-62,
        -6.107687332913918e-63,
        4.2652291526385826e-64,
        -2.904677829572857e-65,
        1.9303495522482862e-66,
        -1.252668731899017e-67,
        7.94268358933396e-69,
        -4.923648097281832e-70,
        2.985716073209945e-71,
        -1.777919610686279e-72,
        1.0299550389452978e-73,
    ],
];

pub const SPLITS: [f64; 13] = [
    0.7193434755106227,
    1.3723862788910306,
    2.0254290822714385,
    3.3315146890322542,
    5.943685902553886,
    11.16802832959715,
    21.616713183683675,
    32.0653980377702,
    42.514082891856724,
    52.96276774594325,
    63.411452600029776,
    73.86013745411631,
    84.30882230820283,
];
