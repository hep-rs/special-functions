#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-1)
        * polynomial(
            x2,
            &[
                -0.6366197723675813,
                -0.1960570906462389,
                0.05434868816051024,
                -0.002955305336079834,
                0.00007164268749973962,
                -9.92674061942482e-7,
            ],
        )
        + x.powi(1)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.3183098861837907,
                    -0.03978873577297383,
                    0.001657863990540576,
                    -0.00003453883313626201,
                    4.317354142032751e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                0.238732414637843,
                -0.2238116387229778,
                0.979175919413028,
                -9.63876295672199,
                166.9915682252085,
                -4477.461423038404,
                171502.7634360246,
                -8.883307199850336e6,
                5.977725469899289e8,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 2.356194490192345
        + x1 * polynomial(
            x1,
            &[
                0.375,
                0.0,
                -0.1640625,
                0.0,
                0.3708984375,
                0.0,
                -2.369397844587054,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 9] = [
    &[
        -2.045048632650596,
        0.8131691145598289,
        -0.1822496046854423,
        0.04206287591542898,
        -0.00950880955241754,
        0.002142796777508141,
        -0.0004824898783428564,
        0.0001085973445860582,
        -0.00002443765931248022,
        5.498565943313918e-6,
        -1.237111514540948e-6,
        2.783228617674629e-7,
        -6.261465472769401e-8,
        1.408620981094121e-8,
        -3.168880974454664e-9,
        7.128743983563978e-10,
        -1.603675882507424e-10,
        3.607592654006747e-11,
        -8.11551908116834e-12,
        1.825632950752189e-12,
        -4.106854448583689e-13,
        9.23855590231491e-14,
        -2.078251004986061e-14,
        4.6751030457232e-15,
        -1.05168040741878e-15,
        2.365788981961392e-16,
        -5.321944820225086e-17,
        1.197333374804446e-17,
        -2.699979609352942e-18,
        6.364721000694008e-19,
        -1.36279647737511e-19,
    ],
    &[
        -1.123062649501622,
        0.2318512194391681,
        -0.02167269713259019,
        0.002850379897189169,
        -0.0003434752407731684,
        0.00004032259883245127,
        -4.729725415229625e-6,
        5.541582897970618e-7,
        -6.487557033360156e-8,
        7.59162808499187e-9,
        -8.881201057490518e-10,
        1.038803320701532e-10,
        -1.214911300022075e-11,
        1.420760273324465e-12,
        -1.661391446414931e-13,
        1.942695434399234e-14,
        -2.271557001966579e-15,
        2.656023869758984e-16,
        -3.105503828596988e-17,
        3.630995043979402e-18,
        -4.245355218671615e-19,
        4.963616217643053e-20,
        -5.803351863976099e-21,
        6.785107910689093e-22,
        -7.932904711933738e-23,
        9.27482489802085e-24,
        -1.084370078177367e-24,
        1.267794812499525e-25,
        -1.48251164573182e-26,
        1.756633463063571e-27,
        -2.026059340842195e-28,
    ],
    &[
        -0.6443703104288391,
        0.2498292920543533,
        -0.01335207421083207,
        0.002317423978905698,
        -0.0004062660121998079,
        0.00005662637019891457,
        -7.86297827313196e-6,
        1.099366896062502e-6,
        -1.533662665469638e-7,
        2.13645017404504e-8,
        -2.974045919182412e-9,
        4.138109060053847e-10,
        -5.755976365372762e-11,
        8.004609475309133e-12,
        -1.112992689061018e-12,
        1.54736805993307e-13,
        -2.151080510784805e-14,
        2.990131903770848e-15,
        -4.156245047007269e-16,
        5.77688665447152e-17,
        -8.0291958319647e-18,
        1.115933988445019e-18,
        -1.550941219292665e-19,
        2.155481089944387e-20,
        -2.995618218780959e-21,
        4.163160324626327e-22,
        -5.785689837875724e-23,
        8.04055722789473e-24,
        -1.117813757977245e-24,
        1.582837419341131e-25,
        -2.157982637784472e-26,
    ],
    &[
        -0.04576452334035884,
        0.3371249199271665,
        -0.02463929357506974,
        -0.001854625073493976,
        -0.0001840592668217893,
        0.00006464608090751367,
        -8.018992186361979e-6,
        1.153036389975033e-6,
        -1.835842594239915e-7,
        2.854278954044006e-8,
        -4.398736238605608e-9,
        6.777830087734696e-10,
        -1.043688162040303e-10,
        1.605984800685338e-11,
        -2.470001967289217e-12,
        3.79748821011406e-13,
        -5.836819779896364e-14,
        8.969412514864685e-15,
        -1.378096202915371e-15,
        2.117082401616453e-16,
        -3.25199539749914e-17,
        4.994875264160668e-18,
        -7.671294318246762e-19,
        1.178113662838794e-19,
        -1.809191269329517e-20,
        2.778202431837411e-21,
        -4.266072742391022e-22,
        6.550660867679869e-23,
        -1.006377505681952e-23,
        1.580773312686403e-24,
        -2.371223933773892e-25,
    ],
    &[
        0.2587524335191917,
        -0.1419258750640862,
        -0.1229737871930007,
        0.01644445417880968,
        0.003227816446723007,
        -0.0003013259686091176,
        -0.00004526275650669205,
        4.020451427575627e-6,
        1.246040066064634e-7,
        5.381167257233507e-9,
        -4.893821199880567e-9,
        6.860037076420562e-10,
        -9.85379358789864e-11,
        1.644124144668121e-11,
        -2.713561386159655e-12,
        4.410589208437019e-13,
        -7.16939635476686e-14,
        1.165736786753908e-14,
        -1.894336313183123e-15,
        3.076832569676929e-16,
        -4.995746411818334e-17,
        8.109113773671643e-18,
        -1.315962019359375e-18,
        2.135145251054124e-19,
        -3.463692950662045e-20,
        5.618111682015243e-21,
        -9.11149501651597e-22,
        1.477583222101666e-22,
        -2.397509598600274e-23,
        3.986676953349863e-24,
        -6.297934477516108e-25,
    ],
    &[
        -0.00387287363194169,
        0.2129514361534708,
        0.140974841304913,
        -0.1166860908970202,
        -0.01760887820919152,
        0.0112271730690341,
        0.0007526663726892998,
        -0.0004565607017885272,
        -0.00001711016594277627,
        0.00001047579485288538,
        2.368051287508306e-7,
        -1.541945603128233e-7,
        -2.3577471722123e-9,
        1.612865945262657e-9,
        1.405179527883482e-11,
        -1.19907136737184e-11,
        -1.375857431485835e-13,
        8.214420668571998e-14,
        -1.187087427660273e-15,
        -8.866472327848199e-17,
        -4.414126382520316e-17,
        8.547962972571826e-18,
        -1.206498387515023e-18,
        1.982108928551943e-19,
        -3.388805508921913e-20,
        5.679073954122071e-21,
        -9.47636962351469e-22,
        1.58374525188041e-22,
        -2.648886832159446e-23,
        4.545093756931033e-24,
        -7.385146225573552e-25,
    ],
    &[
        -0.01057173974047953,
        -0.0925060057851191,
        0.01991445651944174,
        -0.1018499063432773,
        0.1230701907807327,
        0.06953183095909461,
        -0.0492290816559558,
        -0.0134323762366222,
        0.007693271689429639,
        0.001304430703713052,
        -0.0006640399649940255,
        -0.00007774442262788929,
        0.00003679304424687992,
        3.164976820590324e-6,
        -1.428148862040655e-6,
        -9.41476291051828e-8,
        4.114414121105806e-8,
        2.143959680887742e-9,
        -9.16797471347498e-10,
        -3.867332403479064e-11,
        1.629698020347926e-11,
        5.672259278064234e-13,
        -2.367496144740608e-13,
        -6.905659878256996e-15,
        2.865576868041107e-15,
        7.097497695320086e-17,
        -2.93625691608557e-17,
        -6.242037430092942e-19,
        2.580779063071532e-19,
        4.727756996136137e-21,
        -1.968571617481072e-21,
    ],
    &[
        0.01953068560953672,
        -0.02194336328557696,
        -0.00215482655362652,
        -0.01324291220587517,
        -0.1227376340616709,
        0.02042528067169508,
        0.04509695800691346,
        -0.00560006418242134,
        -0.006748232365447736,
        0.0007150310726532614,
        0.0005671714372671016,
        -0.00005394951194971564,
        -0.00003087298820343848,
        2.706404578584474e-6,
        1.182945504911729e-6,
        -9.70694156940878e-8,
        -3.372860345056446e-8,
        2.616787676299728e-9,
        7.448206158507724e-10,
        -5.500930599515002e-11,
        -1.313054049811131e-11,
        9.27671067261727e-13,
        1.892437364754091e-13,
        -1.283594777698246e-14,
        -2.273008895602467e-15,
        1.484255746333296e-16,
        2.311463976132607e-17,
        -1.456309944898954e-18,
        -2.016771633497456e-19,
        1.219129901154523e-20,
        1.526648874550939e-21,
    ],
    &[
        -0.00995785602358431,
        0.08201471398758231,
        -0.004143590488550651,
        0.0771921454350004,
        0.04655565238001122,
        -0.06817935448724664,
        -0.01573252147627829,
        0.01554981311525987,
        0.002204786174617103,
        -0.001759226556916733,
        -0.0001741816055061368,
        0.0001212396231711392,
        8.910294600989513e-6,
        -5.66419055824642e-6,
        -3.201958489797415e-7,
        1.918418525501493e-7,
        8.534494729146464e-9,
        -4.934923301669669e-9,
        -1.754483558433927e-10,
        9.97922917236348e-11,
        2.86511180593788e-12,
        -1.629070292763567e-12,
        -3.803237564704496e-14,
        2.19290619765756e-14,
        4.179910981077593e-16,
        -2.476674941220518e-16,
        -3.860498940946384e-18,
        2.381033098534477e-18,
        3.032884979266595e-20,
        -1.958319026015035e-20,
        -2.046446759615517e-22,
    ],
];

pub const SPLITS: [f64; 10] = [
    0.2159295662033709,
    0.5393760646613918,
    0.8628225631194126,
    1.509715560035454,
    2.803501553867538,
    5.391073541531705,
    10.56621751686004,
    20.91650546751671,
    31.26679341817338,
    41.61708136883004,
];
