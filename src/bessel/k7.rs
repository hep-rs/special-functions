#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-7)
        * polynomial(
            x2,
            &[
                46080.,
                -1920.,
                48.,
                -1.,
                0.02083333333333333,
                -0.0005208333333333333,
                0.00002170138888888889,
                -2.18929825007283e-6,
                -9.56634079263831e-8,
            ],
        )
        + x.powi(7) * x.ln() * polynomial(x2, &[1.550099206349206e-6, 4.84406001984127e-8])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                30.54953209706532,
                357.0476563844509,
                2543.964551739213,
                11686.33715955201,
                33598.21933371202,
                52497.21770892504,
                25311.15853823171,
                -11469.11871263625,
                14814.27833715515,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        10.56447216567215,
        -2.15947517494023,
        -0.004058179459675982,
        -0.0004018572495979411,
        -0.00002943237971187084,
        -1.668998150215517e-6,
        -7.341097674749878e-8,
        -2.324230674441078e-9,
        -3.293225655836674e-11,
        1.734545121605334e-12,
        1.585361124179179e-13,
        5.957112627881253e-15,
        1.16597400677289e-17,
        -1.418079496886808e-17,
        -1.01059910160337e-18,
        -3.261699170142789e-20,
        4.822631959562573e-22,
        1.259064824342293e-22,
        7.580255873479727e-24,
        1.749893578399914e-25,
        -9.80001979882107e-27,
        -1.221260702424624e-27,
        -5.798536373566072e-29,
        -4.597542751339307e-31,
        1.432055585056658e-31,
        1.162874036009265e-32,
        3.910931755377912e-34,
        -7.843710334995376e-36,
        -1.762324318349676e-36,
        -1.00930883797923e-37,
        -1.73888560975705e-39,
    ],
    &[
        6.190000983386936,
        -2.222508597107714,
        -0.01318056727149797,
        -0.001258555024518234,
        -0.00008587847425022611,
        -4.218982867122246e-6,
        -1.328566553085083e-7,
        -8.135744734294852e-10,
        1.738780657201633e-10,
        8.460273827904314e-12,
        -1.083420538794698e-13,
        -3.3488090134852e-14,
        -1.589825649635335e-15,
        2.017556919362867e-17,
        6.718407746500313e-18,
        3.256462906624931e-19,
        -5.125187722652079e-21,
        -1.5120719207721e-21,
        -7.09475031529803e-23,
        1.512385757974484e-24,
        3.624869897054808e-25,
        1.577553947628847e-26,
        -4.707510186202998e-28,
        -8.98105716120194e-29,
        -3.49501208443005e-30,
        1.467785064290553e-31,
        2.257670162553317e-32,
        7.580489637500165e-34,
        -4.494117358112687e-35,
        -5.681851038898244e-36,
        -1.581684693210466e-37,
    ],
    &[
        1.570298759376691,
        -2.419243910853759,
        -0.03986122946707173,
        -0.003474702815927586,
        -0.0001999352227571711,
        -6.88847689704977e-6,
        -5.856326502489744e-8,
        5.233464696211815e-9,
        -2.482306125556348e-11,
        -2.713298562479746e-11,
        -9.04824381342059e-13,
        7.333520837433441e-14,
        5.895838518856221e-15,
        -1.160304369281753e-16,
        -2.874668317201929e-17,
        -4.207408175468318e-19,
        1.13221665461758e-19,
        5.522191845523257e-21,
        -3.351495246099434e-22,
        -3.601100093367608e-23,
        3.915653217129888e-25,
        1.79875783673083e-25,
        3.921496867318819e-27,
        -7.205468181187456e-28,
        -4.152784727998311e-29,
        2.094563858518115e-30,
        2.645593511825616e-31,
        -1.581088537443963e-33,
        -1.318524787432621e-33,
        -3.4052821897921e-35,
        5.258418563048632e-36,
    ],
    &[
        -3.764598191324541,
        -2.970070808881803,
        -0.1054399906586143,
        -0.007816316503068653,
        -0.0003444058026355798,
        -7.561535267978852e-6,
        -6.868937143611781e-8,
        -9.30724699405773e-9,
        -5.779484345580573e-10,
        1.840545509074594e-11,
        1.739519727005223e-12,
        -9.38475851734351e-14,
        -6.811163265136998e-15,
        4.553292095909626e-16,
        2.707081474194529e-17,
        -2.267941840769183e-18,
        -1.081941779411599e-19,
        1.143637340982535e-20,
        4.249741105551172e-22,
        -5.800070451564516e-23,
        -1.595729858141302e-24,
        2.94522480152879e-25,
        5.453542716340578e-27,
        -1.492798402108389e-27,
        -1.486409030968037e-29,
        7.535403462904297e-30,
        1.233324490734106e-32,
        -3.781546465198388e-32,
        2.50974165644861e-34,
        1.874455313587678e-34,
        -2.836969077818307e-36,
    ],
    &[
        -10.91968672871429,
        -4.295084065906468,
        -0.2378891868868152,
        -0.01474183371306709,
        -0.0005404834170926419,
        -0.00001358315242610107,
        -4.508393844470835e-7,
        -1.366544608986128e-8,
        1.610672061269585e-10,
        9.96331892431317e-17,
        -1.303946165299586e-12,
        4.129264884127202e-14,
        2.995875627993994e-15,
        -2.899142862321216e-16,
        4.237224388627746e-19,
        1.156230221732469e-18,
        -5.169572629028038e-20,
        -2.581808225614621e-21,
        3.308416385513484e-22,
        -3.469570587604753e-24,
        -1.27064039473593e-24,
        7.099565146120656e-26,
        2.407697118053518e-27,
        -4.180665046042581e-28,
        7.924870904310652e-30,
        1.50018141739144e-30,
        -1.020464903892852e-31,
        -2.1496265181024e-33,
        5.532974275459244e-34,
        -1.492811382963143e-35,
        -1.819269824913753e-36,
    ],
    &[
        -22.09332019763576,
        -7.077894806286786,
        -0.4778826006130921,
        -0.02627307184217185,
        -0.000949297232278557,
        -0.00002866523110329017,
        -8.080586557237606e-7,
        -1.429605914423488e-8,
        -2.644175923249231e-10,
        -1.265566757105545e-11,
        2.435712423452758e-13,
        6.885337314826837e-16,
        -1.085905734126078e-15,
        6.082211058350184e-17,
        -4.439362362562559e-19,
        -1.677612035193919e-19,
        1.205326308767089e-20,
        -2.11462528534669e-22,
        -2.68362528122134e-23,
        2.432805963893381e-24,
        -6.467784554278082e-26,
        -4.198061761444825e-27,
        4.946482635464185e-28,
        -1.736179398212779e-29,
        -6.068254245227772e-31,
        1.00413016390592e-31,
        -4.379633392104774e-33,
        -7.110042996629631e-35,
        2.02100436354895e-35,
        -1.059890237740215e-36,
        -2.897208913117577e-39,
    ],
    &[
        -59.74355430616851,
        -34.65330497581626,
        -5.068326732040014,
        -0.5187361841185178,
        -0.03877327913603761,
        -0.002379047735223657,
        -0.0001202924359793868,
        -5.140271530114328e-6,
        -2.057116443946047e-7,
        -6.276885086864525e-9,
        -2.075460211456785e-10,
        -8.308968023482322e-12,
        2.360565405044048e-13,
        -3.328776995119974e-14,
        9.14786111516379e-16,
        1.110422859376612e-16,
        -2.378872980426224e-17,
        2.318326369193595e-18,
        -1.15943143405205e-19,
        -4.153404954928541e-21,
        1.604485224278736e-21,
        -1.877122414084618e-22,
        1.194939862342974e-23,
        1.532690814787563e-26,
        -1.108178398542056e-25,
        1.551061520473982e-26,
        -1.176119811900774e-27,
        2.353265768814906e-29,
        7.549546032079071e-30,
        -1.294270817191078e-30,
        1.129834594892583e-31,
    ],
];

pub const SPLITS: [f64; 8] = [
    -0.2865095218115694,
    0.3226854455466868,
    0.931880412904943,
    1.541075380263199,
    2.150270347621456,
    2.759465314979712,
    3.368660282337968,
    4.587050217054481,
];
