#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-7)
        * polynomial(
            x2,
            &[
                46080.,
                -1920.,
                48.,
                -1.,
                0.02083333333333333,
                -0.0005208333333333333,
                0.00002170138888888889,
                -2.18929825007283e-6,
                -9.56634079263831e-8,
            ],
        )
        + x.powi(7) * x.ln() * polynomial(x2, &[1.550099206349206e-6, 4.84406001984127e-8])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                30.54953209706532,
                357.0476563844509,
                2543.964551739213,
                11686.33715955201,
                33598.21933371202,
                52497.21770892504,
                25311.15853823171,
                -11469.11871263625,
                14814.27833715515,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        3.481743883816331,
        -9.61488713523318,
        -0.5080773134579545,
        -0.1637571405704837,
        -0.03727386970170279,
        -0.005659007791186986,
        -0.0004070060625893912,
        0.00003474639706779918,
        7.927416292289279e-6,
        -1.702534095265569e-6,
        -7.386577503674672e-7,
        -3.544336125267985e-8,
        3.269177923156721e-8,
        7.087401283851335e-9,
        -6.87394043620263e-10,
        -5.150762422270744e-10,
        -4.346288127129465e-11,
        2.335910390016734e-11,
        6.399422273961719e-12,
        -3.725241809469595e-13,
        -4.517611196519358e-13,
        -5.058222799574521e-14,
        1.980657292841846e-14,
        6.381122585810643e-15,
        -2.057915742290386e-16,
        -4.35962817946459e-16,
        -5.780784905419112e-17,
        1.833055782102925e-17,
        6.68008282400594e-18,
        -1.562134086895167e-19,
        -4.4189064698179e-19,
    ],
    &[
        -41.20168930042078,
        -44.09768827478179,
        -11.87569207018743,
        -2.447509665319197,
        -0.3548258871775364,
        -0.04290955828017389,
        -0.004502653725948293,
        -0.0003512241766729001,
        -0.00002892007351265324,
        -2.664050455810655e-6,
        7.408877408119236e-8,
        -2.325866165639116e-8,
        -3.873720578392162e-9,
        1.545609676322322e-9,
        -2.358338181560865e-10,
        -8.90610480778514e-12,
        1.253367427439493e-11,
        -2.752678166578702e-12,
        1.29359103265928e-13,
        9.26301872074502e-14,
        -2.946746600877575e-14,
        3.210026951205246e-15,
        5.561556733385663e-16,
        -2.93051734877289e-16,
        4.883439194080052e-17,
        1.375384575941738e-18,
        -2.682528774314517e-18,
        6.249503141261746e-19,
        -3.233497872754058e-20,
        -2.262262942958633e-20,
        7.195270106687225e-21,
    ],
];

pub const SPLITS: [f64; 3] = [-0.2865095218115694, 2.150270347621456, 4.587050217054481];
