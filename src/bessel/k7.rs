use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-7)
        * polynomial(
            x2,
            &[
                46080.,
                -1920.,
                48.,
                -1.,
                0.020833333333333332,
                -0.0005208333333333333,
                0.00002170138888888889,
                -2.1892982500728297e-6,
                -9.566340792638307e-8,
            ],
        )
        + x.powi(7) * x.ln() * polynomial(x2, &[1.5500992063492063e-6, 4.84406001984127e-8])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                30.549532097065317,
                357.0476563844509,
                2543.9645517392123,
                11686.337159552008,
                33598.21933371202,
                52497.21770892503,
                25311.158538231713,
                -11469.118712636244,
                14814.278337155149,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 13] = [
    &[
        79023.55266860782,
        -125546.19298080807,
        73227.29258512291,
        -34710.45042716751,
        14202.473981065481,
        -5208.816734094683,
        1755.468725418229,
        -553.1232682716377,
        164.98086091248877,
        -47.01725629488383,
        12.893652733458739,
        -3.421381146523622,
        0.8823817025721635,
        -0.22197235849778557,
        0.05462716061051703,
        -0.013184094807437872,
        0.003126936883203763,
        -0.0007300875318018165,
        0.0001680615780290704,
        -0.00003819100493058177,
        8.577105473785866e-6,
        -1.9056101792618871e-6,
        4.191951785600745e-7,
        -9.137327986855568e-8,
        1.974866402475387e-8,
        -4.234820312615673e-9,
        9.014609544141029e-10,
        -1.9058371967458467e-10,
        4.003532238213185e-11,
        -8.359748818057228e-12,
        1.7357748971564323e-12,
        -3.584988940236754e-13,
        7.367295663300336e-14,
        -1.5068668835513144e-14,
        3.0683087030912077e-15,
        -6.22132229933448e-16,
        1.2563773327313834e-16,
        -2.527542203113623e-17,
        5.0663884257221665e-18,
        -1.0120345400973983e-18,
        2.0149245201874492e-19,
        -3.999023047383927e-20,
        7.913019829793336e-21,
        -1.5613568497387275e-21,
        3.0764573625835097e-22,
        -6.258903079846737e-23,
        1.1800419664773201e-23,
    ],
    &[
        809.1270957834996,
        -979.7987526519596,
        379.6303993143739,
        -113.38787705882892,
        28.497958415057926,
        -6.329669094613372,
        1.280778943799863,
        -0.24093085946151266,
        0.04273767588905865,
        -0.007223351737759363,
        0.001172394769254512,
        -0.00018384125483048426,
        0.000027984674775747402,
        -4.151195704645138e-6,
        6.019536074826594e-7,
        -8.554916209726989e-8,
        1.194191103191554e-8,
        -1.6403407312598253e-9,
        2.2206309584957797e-10,
        -2.966782460742969e-11,
        3.916236348151172e-12,
        -5.1129102530654e-13,
        6.608024613336985e-14,
        -8.461003687806025e-15,
        1.0740456067237739e-15,
        -1.3525239679959307e-16,
        1.690561653718233e-17,
        -2.0984502718864112e-18,
        2.587881936732532e-19,
        -3.1720950733080877e-20,
        3.8660315605846486e-21,
        -4.686505876385866e-22,
        5.652386938690874e-23,
        -6.78479337032716e-24,
        8.107302947845241e-25,
        -9.646177030483808e-26,
        1.1430600801639902e-26,
        -1.3492940193202863e-27,
        1.5869016402543943e-28,
        -1.8598398952928633e-29,
        2.172471829079088e-30,
        -2.52959989666534e-31,
        2.9365015296105485e-32,
        -3.3989742074878514e-33,
        3.92401664246372e-34,
        -4.575958953283979e-35,
        5.1861933487598106e-36,
    ],
    &[
        34.20269206733741,
        -48.678497040696506,
        23.373434253115303,
        -8.759032389941293,
        2.7702148017063783,
        -0.774567448827549,
        0.19723943473924735,
        -0.04667155222611187,
        0.010409231811078817,
        -0.0022112096951843107,
        0.00045093417083257964,
        -0.00008882206095959434,
        0.00001698042161833382,
        -3.1628643209459427e-6,
        5.758268623084126e-7,
        -1.0273522681600373e-7,
        1.8001717067882266e-8,
        -3.103696451553132e-9,
        5.273521392332248e-10,
        -8.842349574115221e-11,
        1.4648414385533175e-11,
        -2.400018841762454e-12,
        3.892515043559656e-13,
        -6.254348520245075e-14,
        9.962663835856943e-15,
        -1.5742824484919044e-15,
        2.4691480601445705e-16,
        -3.8458088351269145e-17,
        5.951159908922966e-18,
        -9.15308386249801e-19,
        1.3997395587275965e-19,
        -2.129063438894626e-20,
        3.2220059055370726e-21,
        -4.852704654815104e-22,
        7.275695320161428e-23,
        -1.0861818577959627e-23,
        1.6149688985630346e-24,
        -2.3919288698651264e-25,
        3.529694978036932e-26,
        -5.19047760178897e-27,
        7.607285742697027e-28,
        -1.111400425933309e-28,
        1.6187940467519755e-29,
        -2.3510081418814332e-30,
        3.4063320466154794e-31,
        -5.019891580362924e-32,
        7.085592730409637e-33,
    ],
    &[
        0.5565478135314615,
        -0.8855446105629649,
        0.5026234794971587,
        -0.22473261514272186,
        0.08452751181019183,
        -0.027939164664440474,
        0.008361880251698445,
        -0.0023143140715819405,
        0.0006014323853436625,
        -0.00014842260608479083,
        0.00003508130246437718,
        -7.994386255177065e-6,
        1.7655901282645757e-6,
        -3.794906449449204e-7,
        7.965086993954608e-8,
        -1.6370810698448013e-8,
        3.302552441236259e-9,
        -6.552078413245285e-10,
        1.280502755606651e-10,
        -2.4687261905191486e-11,
        4.701005148010746e-12,
        -8.851127424341758e-13,
        1.6493130750961395e-13,
        -3.0441220630956747e-14,
        5.5691900497038286e-15,
        -1.0105887745340192e-15,
        1.819955219650923e-16,
        -3.2544390559056503e-17,
        5.781276282468719e-18,
        -1.0206734176183974e-18,
        1.7915610588660845e-19,
        -3.1275865402376293e-20,
        5.431976326541781e-21,
        -9.388654327448907e-22,
        1.6153307310783681e-22,
        -2.7671871610875043e-23,
        4.72098459283657e-24,
        -8.022950368426545e-25,
        1.3583974480902965e-25,
        -2.2918622019080835e-26,
        3.8538179332009504e-27,
        -6.459547371509645e-28,
        1.0794039628918139e-28,
        -1.798471278472764e-29,
        2.9902810096623853e-30,
        -5.0862233126752214e-31,
        8.183380728730518e-32,
    ],
    &[
        0.0023881866524484976,
        -0.004152995878827344,
        0.0028035577752266927,
        -0.0015324102177707215,
        0.0007051672637329651,
        -0.00028212755555550494,
        0.00010070607935077041,
        -0.00003274042272847428,
        9.855870297006958e-6,
        -2.7836809398493827e-6,
        7.454947480013598e-7,
        -1.9091608374629585e-7,
        4.7071491199051835e-8,
        -1.1234686086326329e-8,
        2.6071742561878957e-9,
        -5.904053009253594e-10,
        1.30854661731525e-10,
        -2.845485181410567e-11,
        6.083423219030968e-12,
        -1.2809211253845459e-12,
        2.660271046226834e-13,
        -5.456499777241157e-14,
        1.1065424710474229e-14,
        -2.220786311403742e-15,
        4.4146627775764403e-16,
        -8.698897097742564e-17,
        1.7001751918827877e-17,
        -3.2979300098578944e-18,
        6.352371918271842e-19,
        -1.2155763824919303e-19,
        2.3118803101576927e-20,
        -4.3717212220032385e-21,
        8.222339587702153e-22,
        -1.538623700744344e-22,
        2.865429334876719e-23,
        -5.312302968971089e-24,
        9.806587682554868e-25,
        -1.8029869547086495e-25,
        3.3021508302396605e-26,
        -6.0257920428616055e-27,
        1.0957750543851165e-27,
        -1.986050615243567e-28,
        3.588292347516927e-29,
        -6.463811138970186e-30,
        1.1621171694619529e-30,
        -2.1456402170316566e-31,
        3.7148183282927083e-32,
    ],
    &[
        1.1137032186072433e-6,
        -1.870606023185164e-6,
        1.1554219899295488e-6,
        -5.544153536375339e-7,
        2.1633681627785185e-7,
        -7.112692558348253e-8,
        2.0253544967606497e-8,
        -5.1049478715998455e-9,
        1.1592213562496007e-9,
        -2.406393379161209e-10,
        4.6231022718159197e-11,
        -8.306668367741652e-12,
        1.4085503617241424e-12,
        -2.2717614526100813e-13,
        3.508566681186925e-14,
        -5.219140963740112e-15,
        7.51511047668748e-16,
        -1.0519222093688245e-16,
        1.4365069274359458e-17,
        -1.9196774640856652e-18,
        2.51685521683259e-19,
        -3.2444116334327155e-20,
        4.1195945200130425e-21,
        -5.160442663882739e-22,
        6.38569220076824e-23,
        -7.814677620137644e-24,
        9.467229441061506e-25,
        -1.1363569860493288e-25,
        1.352420723328318e-26,
        -1.5969830053564227e-27,
        1.8721201065927936e-28,
        -2.179905214735632e-29,
        2.522398061090079e-30,
        -2.9016347568577075e-31,
        3.3196178953873743e-32,
        -3.778306975163634e-33,
        4.279609192322632e-34,
        -4.825370645357558e-35,
        5.417367988719725e-36,
        -6.057300566366696e-37,
        6.746783051005285e-38,
        -7.487338611430981e-39,
        8.280392778342203e-40,
        -9.127282290420785e-41,
        1.0030595308223962e-41,
        -1.1117970512998843e-42,
        1.2002371975953179e-43,
    ],
    &[
        1.2482356016820942e-9,
        -2.0695050412775768e-9,
        1.2384621925568108e-9,
        -5.680202108773647e-10,
        2.0949818660180812e-10,
        -6.442865770071202e-11,
        1.6982889272815578e-11,
        -3.9197041229529395e-12,
        8.057257417084248e-13,
        -1.4956664831866856e-13,
        2.536397412118569e-14,
        -3.968323509695333e-15,
        5.777015677865386e-16,
        -7.884231088151442e-17,
        1.0154779941618393e-17,
        -1.2417700141312962e-18,
        1.4495365149413534e-19,
        -1.6232212727344545e-20,
        1.751607437636575e-21,
        -1.828845448041712e-22,
        1.854382692671279e-23,
        -1.832071126230428e-24,
        1.7688403336564712e-25,
        -1.6732963116050132e-26,
        1.5544994128564165e-27,
        -1.4210493370864668e-28,
        1.2805015365076672e-29,
        -1.1390741289325645e-30,
        1.0015754170591473e-31,
        -8.714788084317097e-33,
        7.510825778232725e-34,
        -6.417075088450466e-35,
        5.4390064188165976e-36,
        -4.576257656415709e-37,
        3.824303966441441e-38,
        -3.175851654361844e-39,
        2.621954271004556e-40,
        -2.152871789102763e-41,
        1.7587052008093188e-42,
        -1.4298431369373084e-43,
        1.1572568343778738e-44,
        -9.326768812087683e-46,
        7.486809434744942e-47,
        -5.987171129769093e-48,
        4.771003636529183e-49,
        -3.8123716076254443e-50,
        2.999087224388565e-51,
    ],
    &[
        1.2841068937870453e-12,
        -2.3582112651465444e-12,
        1.832202835482299e-12,
        -1.2153455450231139e-12,
        6.963610196271043e-13,
        -3.4892182791599663e-13,
        1.54707894548289e-13,
        -6.13602152612783e-14,
        2.1981693331045658e-14,
        -7.174179681921024e-15,
        2.1494681319679975e-15,
        -5.952194612095369e-16,
        1.532613900404225e-16,
        -3.6893592516524677e-17,
        8.34367935688165e-18,
        -1.7806863584209418e-18,
        3.600925626923101e-19,
        -6.925894580757579e-20,
        1.271440898361685e-20,
        -2.235123009455226e-21,
        3.7742865835851956e-22,
        -6.139990772481834e-23,
        9.649561353692599e-24,
        -1.4689412194860269e-24,
        2.171472706686008e-25,
        -3.1246507532985995e-26,
        4.386698750513943e-27,
        -6.021466471396076e-28,
        8.098014787595205e-29,
        -1.0690370022262466e-29,
        1.3877488244523903e-30,
        -1.774342001647135e-31,
        2.237762676587057e-32,
        -2.7875378673162294e-33,
        3.433816212626692e-34,
        -4.187403848641374e-35,
        5.059791818094801e-36,
        -6.063173768389104e-37,
        7.210454614592129e-38,
        -8.515252037067556e-39,
        9.991893121857688e-40,
        -1.1655408297042437e-40,
        1.3521524550447921e-41,
        -1.560669009073458e-42,
        1.7930896584659756e-43,
        -2.0767930370640804e-44,
        2.3350500283599747e-45,
    ],
    &[
        4.0361582874183984e-18,
        -7.396558592042912e-18,
        5.7114109623624635e-18,
        -3.751537173684563e-18,
        2.1216627642583498e-18,
        -1.0462395573689576e-18,
        4.552942363649437e-19,
        -1.7676712624483954e-19,
        6.182656892009851e-20,
        -1.9648367576552563e-20,
        5.7163400471756006e-21,
        -1.5325691860058732e-21,
        3.8086073576461547e-22,
        -8.81867083834297e-23,
        1.911320553786944e-23,
        -3.893608113768861e-24,
        7.483019001411091e-25,
        -1.3613612433344446e-25,
        2.3516783595314652e-26,
        -3.868253069097482e-27,
        6.074527425127775e-28,
        -9.128850444142891e-29,
        1.3158288277122536e-29,
        -1.8229483001837344e-30,
        2.4322017067025532e-31,
        -3.1310341652498364e-32,
        3.8959394688520135e-33,
        -4.693664707760483e-34,
        5.484002411053497e-35,
        -6.223780937856826e-36,
        6.87141344181876e-37,
        -7.391261777916835e-38,
        7.757133453728286e-39,
        -7.954430352395425e-40,
        7.980747198305031e-41,
        -7.845003116310109e-42,
        7.565418101555316e-43,
        -7.166779198863921e-44,
        6.677469699557649e-45,
        -6.126675108615303e-46,
        5.542063812663041e-47,
        -4.948104011328679e-48,
        4.365051906200154e-49,
        -3.8085503492263623e-50,
        3.289874957129213e-51,
        -2.8356582643592685e-52,
        2.389558430798221e-53,
    ],
    &[
        1.5435679246389042e-23,
        -2.826118610476023e-23,
        2.1764854293515473e-23,
        -1.423675156276207e-23,
        8.007502021989968e-24,
        -3.92261240844776e-24,
        1.694017453771788e-24,
        -6.520803627359996e-25,
        2.2592306227882857e-25,
        -7.105873229597672e-26,
        2.0442459849720003e-26,
        -5.414637662930376e-27,
        1.3281444614369493e-27,
        -3.0324095755317693e-28,
        6.474035605206551e-29,
        -1.297695053410429e-29,
        2.4511192615089975e-30,
        -4.377016675441476e-31,
        7.411514833468525e-32,
        -1.193238359339367e-32,
        1.831107656725518e-33,
        -2.684438697147869e-34,
        3.767515196216687e-35,
        -5.071767177889327e-36,
        6.56065569910251e-37,
        -8.168582927605483e-38,
        9.80480091353503e-39,
        -1.1362214235269104e-39,
        1.2729815120045617e-40,
        -1.3806588051461216e-41,
        1.4514335837762726e-42,
        -1.4807113025793993e-43,
        1.467572139671791e-44,
        -1.4146794559148263e-45,
        1.32770799601784e-46,
        -1.214435461127217e-47,
        1.0836826372781525e-48,
        -9.44284757997927e-50,
        8.042388222204161e-51,
        -6.701135720301801e-52,
        5.467474159430792e-53,
        -4.3720817052257305e-54,
        3.429547902109035e-55,
        -2.641270286914196e-56,
        1.998965432588918e-57,
        -1.4956945650807256e-58,
        1.0900877187216793e-59,
    ],
    &[
        6.458117638900831e-29,
        -1.181839571907277e-28,
        9.088923457853472e-29,
        -5.932105876708839e-29,
        3.326928528106548e-29,
        -1.6241355555543904e-29,
        6.986352735565831e-30,
        -2.6774899208378997e-30,
        9.232191341147268e-31,
        -2.888761362651503e-31,
        8.264457801861113e-32,
        -2.17608445063663e-32,
        5.304120019153965e-33,
        -1.2029576729201596e-33,
        2.550111638132701e-34,
        -5.073390573554667e-35,
        9.506984905217267e-36,
        -1.6834890001992326e-36,
        2.8254148449295994e-37,
        -4.5063203302897173e-38,
        6.846842856616225e-39,
        -9.93247889960908e-40,
        1.3785271601888954e-40,
        -1.833939303789171e-41,
        2.342751760361255e-42,
        -2.878352914136245e-43,
        3.406387395389117e-44,
        -3.8885547936065786e-45,
        4.287452196218248e-46,
        -4.571562339880541e-47,
        4.7194341249440577e-48,
        -4.722284302222259e-49,
        4.584609802373834e-50,
        -4.322832690050014e-51,
        3.9623870184812954e-52,
        -3.533908333731811e-53,
        3.069261029857893e-54,
        -2.5980479880430265e-55,
        2.1450424843618305e-56,
        -1.728733182738e-57,
        1.360943244643961e-58,
        -1.0473180184302877e-59,
        7.883902376027461e-61,
        -5.8092190228214265e-62,
        4.1927648271295956e-63,
        -2.979776457413654e-64,
        2.0574508537925796e-65,
    ],
    &[
        2.840449144787175e-34,
        -5.1964958687905275e-34,
        3.992945596787868e-34,
        -2.6026165598332133e-34,
        1.4571077411669938e-34,
        -7.098607309672605e-35,
        3.046364330054455e-35,
        -1.1644828063368818e-35,
        4.003945604917534e-36,
        -1.2490635979417608e-36,
        3.5619892436389375e-37,
        -9.347116254016046e-38,
        2.2701689204114293e-38,
        -5.129289037509889e-39,
        1.0830435691587614e-39,
        -2.1457589313186663e-40,
        4.0034528975980913e-41,
        -7.057025487240219e-42,
        1.1787441721033259e-42,
        -1.870628314780291e-43,
        2.827361212242446e-44,
        -4.079116923979007e-45,
        5.628953192591646e-46,
        -7.443564077609587e-47,
        9.448846809686404e-48,
        -1.153236752852078e-48,
        1.3553376293867196e-49,
        -1.5359212147945612e-50,
        1.680528403904651e-51,
        -1.777482040666812e-52,
        1.8194552370157425e-53,
        -1.8043429501724997e-54,
        1.735306740037428e-55,
        -1.6200421258513137e-56,
        1.4694687911449913e-57,
        -1.296131784951946e-58,
        1.1126146256266079e-59,
        -9.302124830082861e-61,
        7.580200128297653e-62,
        -6.024835937630438e-63,
        4.6737723706704514e-64,
        -3.541011032093149e-65,
        2.6217596808955375e-66,
        -1.8981156791158197e-67,
        1.344541944273876e-68,
        -9.365274368665436e-70,
        6.332045272421267e-71,
    ],
    &[
        1.2889741613668426e-39,
        -2.357665514470378e-39,
        1.810586154302325e-39,
        -1.1791066729525834e-39,
        6.5938460636051066e-40,
        -3.207981842690304e-40,
        1.3745955784499075e-40,
        -5.2455904689475e-41,
        1.80035994759724e-41,
        -5.605478218905937e-42,
        1.5952485662532354e-42,
        -4.17709229438131e-43,
        1.0122077493295805e-43,
        -2.281595938127689e-44,
        4.805655716010216e-45,
        -9.496586194142978e-46,
        1.7670754850626402e-46,
        -3.106194977576836e-47,
        5.1732651004695656e-48,
        -8.185038402918535e-49,
        1.2332485393422362e-49,
        -1.7734443154211068e-50,
        2.438960910439505e-51,
        -3.213846632126143e-52,
        4.064700346274622e-53,
        -4.942074206122066e-54,
        5.785111268207554e-55,
        -6.528832671270051e-56,
        7.112791799204006e-57,
        -7.48942374278754e-58,
        7.630457020024055e-59,
        -7.530204026817882e-60,
        7.205265397642328e-61,
        -6.690960179874684e-62,
        6.035421581928224e-63,
        -5.292637604989582e-64,
        4.515726831991867e-65,
        -3.7514756506844057e-66,
        3.0367384331685716e-67,
        -2.3968469586000287e-68,
        1.8457971188595596e-69,
        -1.3877417871868545e-70,
        1.019231607662921e-71,
        -7.316850093338244e-73,
        5.136984232059065e-74,
        -3.544435566322322e-75,
        2.3731580052630992e-76,
    ],
];

pub const SPLITS: [f64; 14] = [
    0.750879928759858,
    1.5122349376087891,
    2.27358994645772,
    3.7962999641555824,
    6.841719999551307,
    12.932560070342756,
    19.023400141134204,
    25.114240211925654,
    37.29592035350855,
    49.47760049509145,
    61.659280636674346,
    73.84096077825724,
    86.02264091984014,
    98.20432106142304,
];
