use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                46080.,
                -1920.,
                48.,
                -1.,
                0.020833333333333332,
                -0.0005208333333333333,
                0.00002170138888888889,
                -2.1892982500728297e-6,
                -9.566340792638307e-8,
            ],
        )
        + x.powi(0) * x.ln() * polynomial(x2, &[1.5500992063492063e-6, 4.84406001984127e-8])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                30.549532097065317,
                357.0476563844509,
                2543.9645517392123,
                11686.337159552008,
                33598.21933371202,
                52497.21770892503,
                25311.158538231713,
                -11469.118712636244,
                14814.278337155149,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 34] = [
    &[],
    &[
        -1.4665124253159058e28,
        -7.539437890519197e26,
        3.7482516947622166e26,
        3.1569486863440953e25,
        -5.54832053780991e24,
        -7.223184754044325e23,
        4.246742817346266e22,
        2.7594849984866003e22,
        -4.745197409090963e21,
        3.171298276605003e20,
        -8.228670297592274e18,
    ],
    &[
        152325.8287210182,
        -36012.12020250774,
        7318.685622836482,
        -2044.0165762848499,
        407.93095311225056,
        -50.66269161692813,
        4.061883402878629,
        -0.21440736096981863,
        0.007290509796437584,
        -0.00014627053593645135,
        1.3270347075162481e-6,
    ],
    &[
        -39.05990861615909,
        14.718866161559431,
        -2.5326247318721884,
        0.26107722925690724,
        -0.017761494508887202,
        0.0008265604259467603,
        -0.00002629656344518851,
        5.511532951249993e-7,
        -6.900550850315453e-9,
        3.929133425150636e-11,
    ],
    &[
        -0.005683577294014625,
        0.0018189258491623519,
        -0.0002634667518946179,
        0.000022659903253845418,
        -1.2746853998934873e-6,
        4.86115417287017e-8,
        -1.2561576837277074e-9,
        2.1197970192627652e-11,
        -2.1186505469198422e-13,
        9.550034983483032e-16,
    ],
    &[
        -6.511538026463456e-7,
        1.6180549897519702e-7,
        -1.781219977101743e-8,
        1.1341654980595201e-9,
        -4.566916750265644e-11,
        1.1903987128608201e-12,
        -1.9607401678886948e-14,
        1.865196464647553e-16,
        -7.842613345246132e-19,
    ],
    &[
        -9.178073673174452e-10,
        1.992632366255277e-10,
        -1.9103163389876687e-11,
        1.0559566053937109e-12,
        -3.679977842811717e-14,
        8.277170483264163e-16,
        -1.1731063825698337e-17,
        9.575843052802501e-20,
        -3.4459000746621145e-22,
    ],
    &[
        -2.009502276632036e-12,
        3.8685554980572023e-13,
        -3.281527810968376e-14,
        1.601625587148394e-15,
        -4.918471969256358e-17,
        9.729580245996877e-19,
        -1.2105010998522502e-20,
        8.658444851844817e-23,
        -2.725530095754654e-25,
    ],
    &[
        -5.819860724091485e-15,
        1.0055869042700055e-15,
        -7.644420956358178e-17,
        3.338877220115181e-18,
        -9.162961809628943e-20,
        1.6176447127628438e-21,
        -1.793809434270869e-23,
        1.142176003873948e-25,
        -3.19673699931005e-28,
    ],
    &[
        -2.038004368866039e-17,
        3.192380163272981e-18,
        -2.1977328602119145e-19,
        8.683903287179854e-21,
        -2.1537701585343456e-22,
        3.433016026261507e-24,
        -3.4339476735459e-26,
        1.9705407547329605e-28,
        -4.966142287102924e-31,
    ],
    &[
        -8.170681021086643e-20,
        1.1700914836548898e-20,
        -7.358435708793532e-22,
        2.6539701808461734e-23,
        -6.003817338607916e-25,
        8.722456981846264e-27,
        -7.946764970622651e-29,
        4.150737648396561e-31,
        -9.515290415068006e-34,
    ],
    &[
        -3.6205215302891136e-22,
        4.773965750938083e-23,
        -2.762661516616806e-24,
        9.163592092160064e-26,
        -1.905364484825979e-27,
        2.5429157287078926e-29,
        -2.127138459952302e-31,
        1.0195781069833616e-33,
        -2.143839522581556e-36,
    ],
    &[
        -1.731412104237655e-24,
        2.1149887926864483e-25,
        -1.1333150089063142e-26,
        3.479238707445227e-28,
        -6.692675928153437e-30,
        8.25982647637397e-32,
        -6.386633156713628e-34,
        2.8285240768182817e-36,
        -5.493212953338667e-39,
    ],
    &[
        -8.788013304463097e-27,
        9.997574248026675e-28,
        -4.987361907332437e-29,
        1.4248874303824957e-30,
        -2.549878721704243e-32,
        2.9266186173831478e-34,
        -2.1037753527119442e-36,
        8.659257426591537e-39,
        -1.5624500293937054e-41,
    ],
    &[
        -4.6773003344298755e-29,
        4.9785384926978124e-30,
        -2.323003443259865e-31,
        6.205892380089704e-33,
        -1.038160994310462e-34,
        1.1135591537598777e-36,
        -7.478811248937107e-39,
        2.8753284591084137e-41,
        -4.844818194209343e-44,
    ],
    &[
        -2.587152046193507e-31,
        2.587008576890995e-32,
        -1.1337263598693059e-33,
        2.8439449969430385e-35,
        -4.466212548537873e-37,
        4.496222282667281e-39,
        -2.8335557022475526e-41,
        1.0220190401301246e-43,
        -1.6152198876430123e-46,
    ],
    &[
        -1.4771335912452233e-33,
        1.3926169551129354e-34,
        -5.7529376026910836e-36,
        1.3600795086411814e-37,
        -2.0126146959170826e-39,
        1.9088242901946314e-41,
        -1.1330990942220195e-43,
        3.848897111516397e-46,
        -5.727637017655849e-49,
    ],
    &[
        -8.659815248183234e-36,
        7.722445749042128e-37,
        -3.016986186292183e-38,
        6.744294687110748e-40,
        -9.435208405108637e-42,
        8.458772219034939e-44,
        -4.745625990425577e-46,
        1.5232866575761046e-48,
        -2.141794218480539e-51,
    ],
    &[
        -5.191555054773956e-38,
        4.391707647789877e-39,
        -1.6273435717843593e-40,
        3.4499206803221656e-42,
        -4.576479697389971e-44,
        3.88988888514448e-46,
        -2.0687929519243548e-48,
        6.294251371565019e-51,
        -8.387369603043503e-54,
    ],
    &[
        -3.1721866747243234e-40,
        2.552215939057124e-41,
        -8.993585855307612e-43,
        1.8129282486760554e-44,
        -2.286495982222726e-46,
        1.8475417817375725e-48,
        -9.33994378551503e-51,
        2.7008138691821104e-53,
        -3.4202198191990567e-56,
    ],
    &[
        -1.9703336248671856e-42,
        1.5112929471457938e-43,
        -5.076551164630432e-45,
        9.753863521638334e-47,
        -1.1724201525264441e-48,
        9.027791302263764e-51,
        -4.34875119557828e-53,
        1.1981402037464266e-55,
        -1.4455072731126167e-58,
    ],
    &[
        -1.2413634784970735e-44,
        9.09691117999331e-46,
        -2.919179359132025e-47,
        5.357681886058733e-49,
        -6.151119667794531e-51,
        4.52362241414708e-53,
        -2.08097786828013e-55,
        5.4748668022771704e-58,
        -6.306885825709346e-61,
    ],
    &[
        -7.918794365744055e-47,
        5.555153649638432e-48,
        -1.7063599190531483e-49,
        2.997512592673685e-51,
        -3.2936673891776483e-53,
        2.3180422832576376e-55,
        -1.0204238361766671e-57,
        2.5688230969362445e-60,
        -2.8313474794436946e-63,
    ],
    &[
        -5.107076590809391e-49,
        3.435872813160476e-50,
        -1.012067155656744e-51,
        1.7047787859009641e-53,
        -1.7960828192788544e-55,
        1.2119354003070613e-57,
        -5.114729998985596e-60,
        1.2343360330567488e-62,
        -1.3041367721536984e-65,
    ],
    &[
        -3.325787310961367e-51,
        2.1493668801567826e-52,
        -6.081458617592171e-54,
        9.839330377136625e-56,
        -9.956292165602483e-58,
        6.452079570741899e-60,
        -2.614975649116333e-62,
        6.060092652012372e-65,
        -6.148180910685187e-68,
    ],
    &[
        -2.1845609526108036e-53,
        1.3583143747556297e-54,
        -3.6973807054666255e-56,
        5.754740251228436e-58,
        -5.601561984875179e-60,
        3.4917293787317614e-62,
        -1.3611823888649531e-64,
        3.033993471647287e-67,
        -2.9603839442719874e-70,
    ],
    &[
        -1.446065336840166e-55,
        8.662909375620795e-57,
        -2.2718339490292905e-58,
        3.4064867698049625e-60,
        -3.194248654262671e-62,
        1.9180466479392436e-64,
        -7.202358374992757e-67,
        1.5463010240296335e-69,
        -1.4532153686870944e-72,
    ],
    &[
        -9.638904577012564e-58,
        5.570819618626296e-59,
        -1.4093826172648814e-60,
        2.0386272698226395e-62,
        -1.843999441458115e-64,
        1.0680575573066442e-66,
        -3.8684453431460663e-69,
        8.010602305997746e-72,
        -7.260958628290674e-75,
    ],
    &[
        -6.465339165952739e-60,
        3.609397787030466e-61,
        -8.820230643414727e-63,
        1.2322757731324309e-64,
        -1.0765492180611466e-66,
        6.022198362946977e-69,
        -2.1065351973372184e-71,
        4.212637867046922e-74,
        -3.687438134465239e-77,
    ],
    &[
        -4.361389626487833e-62,
        2.3546225957276312e-63,
        -5.564222804013878e-65,
        7.517194487853544e-67,
        -6.350247240061381e-69,
        3.434839835597106e-71,
        -1.161718541096506e-73,
        2.246225844323513e-76,
        -1.900980650306118e-79,
    ],
    &[
        -2.957375946313415e-64,
        1.5456985756242366e-65,
        -3.536033212777795e-67,
        4.624477259773039e-69,
        -3.781633885605077e-71,
        1.9799968439485078e-73,
        -6.482096439219597e-76,
        1.2131434742428425e-78,
        -9.937301257709857e-82,
    ],
    &[
        -2.0148441362275053e-66,
        1.0205195082030252e-67,
        -2.2623623734347083e-69,
        2.8671193117011565e-71,
        -2.2718938904693575e-73,
        1.1526219046719873e-75,
        -3.656286571840789e-78,
        6.6302213710965405e-81,
        -5.262164085999576e-84,
    ],
    &[
        5.722318713134e-69,
        -3.116805062283359e-70,
        7.548275593434327e-72,
        -1.0668014138828968e-73,
        9.696449947766778e-76,
        -5.877972029391343e-78,
        2.376434485768748e-80,
        -6.178904936951115e-83,
        9.375293996982563e-86,
        -6.324770423775617e-89,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 34] = [
    &[],
    &[
        1.,
        3.925236123634222e14,
        -6.015023541174924e15,
        4.302806973302981e16,
        -1.91117625928267e17,
        5.914351029621518e17,
        -1.3563388706667763e18,
        -3.182511709097652e23,
        -1.6364959159901615e22,
        -5.122619044611313e21,
    ],
    &[
        1.,
        -4.48727534043611,
        9.570229112193955,
        -12.915063898291232,
        12.387703421963328,
        -8.994254763591975,
        5.141402611466819,
        0.9293396719841447,
        0.12365909238659838,
        0.008361649353909833,
        0.0006070092279111689,
    ],
    &[
        1.,
        -1.5599966536791325,
        1.1301806669529288,
        -0.50150708038527,
        0.14960472278197195,
        -0.029812239445090438,
        0.0029933345029568323,
        -0.0004107088772013448,
        0.000016497522186403914,
        -1.2705230436821487e-6,
    ],
    &[
        1.,
        -0.9149306924707565,
        0.3807491526300579,
        -0.09494046688096819,
        0.015707688333114346,
        -0.001799725515089953,
        0.0001439733759008191,
        -7.90577762263606e-6,
        2.734690329612141e-7,
        -5.114652816895249e-9,
    ],
    &[
        1.,
        -0.6230887761908267,
        0.17508756253363245,
        -0.029175870439120052,
        0.003184618527214757,
        -0.00023682734008797287,
        0.000012045965828373705,
        -4.0631021444668375e-7,
        8.314133596392553e-9,
        -7.984720106557333e-11,
    ],
    &[
        1.,
        -0.4783056219133322,
        0.10278030667089268,
        -0.013037976884251738,
        0.0010774592258371066,
        -0.00006025669644269032,
        2.2852632139714572e-6,
        -5.683010958332565e-8,
        8.439738400516465e-10,
        -5.733574361071608e-12,
    ],
    &[
        1.,
        -0.3860113959081986,
        0.06676856400637604,
        -0.006797264417910914,
        0.0004492169631887683,
        -0.000020006516273146044,
        6.011835905751642e-7,
        -1.1771015764112854e-8,
        1.3652281333338767e-10,
        -7.163752460446939e-13,
    ],
    &[
        1.,
        -0.3225407977422873,
        0.04653238407491138,
        -0.0039429778916765966,
        0.00021638755275402532,
        -7.98091451172909e-6,
        1.979749522615398e-7,
        -3.187817170914028e-9,
        3.026653537314436e-11,
        -1.2926452821522772e-13,
    ],
    &[
        1.,
        -0.2764510044848942,
        0.03413970821584248,
        -0.0024727023034490014,
        0.00011580230381619228,
        -3.638115043657405e-6,
        7.671160535570668e-8,
        -1.0474162903756247e-9,
        8.408807103526773e-12,
        -3.026471676573334e-14,
    ],
    &[
        1.,
        -0.24158164415472697,
        0.02604583121338011,
        -0.001645234614899146,
        0.00006711924833267642,
        -1.8345079559008379e-6,
        3.360390255914164e-8,
        -3.9794699681434877e-10,
        2.765742803355092e-12,
        -8.599224103790117e-15,
    ],
    &[
        1.,
        -0.21434366112438766,
        0.0204890161738216,
        -0.0011465909198675162,
        0.00004140524972645979,
        -1.0008041919580454e-6,
        1.6195410135219925e-8,
        -1.6923990159339793e-10,
        1.0365961524986443e-12,
        -2.8363099854575643e-15,
    ],
    &[
        1.,
        -0.19251467555906376,
        0.01651920374259414,
        -0.0008293423468263866,
        0.00002685092247619723,
        -5.814713778331906e-7,
        8.423957269098469e-9,
        -7.874268069455443e-11,
        4.310250217879849e-13,
        -1.0529130027678704e-15,
    ],
    &[
        1.,
        -0.1746500044819326,
        0.013589772083543466,
        -0.0006184083106683437,
        0.000018138622666084002,
        -3.5566871898565975e-7,
        4.662896418689553e-9,
        -3.9418607357889206e-11,
        1.950071912938846e-13,
        -4.302060011637561e-16,
    ],
    &[
        1.,
        -0.1597724151937762,
        0.011369210173426547,
        -0.0004729556147051334,
        0.00001267674321630836,
        -2.2705287931436476e-7,
        2.7178265058616918e-9,
        -2.0967377673950455e-11,
        9.461207223568027e-14,
        -1.90275865087109e-16,
    ],
    &[
        1.,
        -0.14719858886300138,
        0.00964748959074587,
        -0.00036953855790188467,
        9.11733256225014e-6,
        -1.5026737966525142e-7,
        1.6545678198226608e-9,
        -1.1737332684738645e-11,
        4.8681093895335285e-14,
        -8.99496539415044e-17,
    ],
    &[
        1.,
        -0.1364371184593553,
        0.00828655928795593,
        -0.00029406779697006147,
        6.720076545684521e-6,
        -1.025591638696314e-7,
        1.045382992033418e-9,
        -6.862963159046212e-12,
        2.6333957061005906e-14,
        -4.500098795423984e-17,
    ],
    &[
        1.,
        -0.12712599836839478,
        0.007192782764172067,
        -0.0002377420135672697,
        5.059165963809507e-6,
        -7.18838146472514e-8,
        6.820002967125948e-10,
        -4.166470168388605e-12,
        1.4873362497523205e-14,
        -2.36392624928665e-17,
    ],
    &[
        1.,
        -0.11899292517525877,
        0.006300902497208697,
        -0.0001948766851623289,
        3.87977605550577e-6,
        -5.156495169671322e-8,
        4.575324241708693e-10,
        -2.613564482706577e-12,
        8.72189789039753e-15,
        -1.2956180843735257e-17,
    ],
    &[
        1.,
        -0.11182929560329055,
        0.005564350655640551,
        -0.00016169225002019705,
        3.024065438096628e-6,
        -3.775105528102452e-8,
        3.1457050704773566e-10,
        -1.6872498941218474e-12,
        5.286061017446176e-15,
        -7.370455453077925e-18,
    ],
    &[
        1.,
        -0.10547271041873524,
        0.004949198203392978,
        -0.00013561093245401343,
        2.391272050138889e-6,
        -2.8141296243777715e-8,
        2.2103074326419718e-10,
        -1.1173100017565661e-12,
        3.298551169246718e-15,
        -4.333276697659534e-18,
    ],
    &[
        1.,
        -0.09979491862663434,
        0.004430265088029562,
        -0.0001148345854197992,
        1.9153361331400906e-6,
        -2.131823143988202e-8,
        1.5834412137364083e-10,
        -7.568576701682777e-13,
        2.1125254231581428e-15,
        -2.6234811498984717e-18,
    ],
    &[
        1.,
        -0.09469333308761813,
        0.00398855470748311,
        -0.00009808350374666847,
        1.551911138716272e-6,
        -1.6384428179723732e-8,
        1.1542462067397066e-10,
        -5.232191218039905e-13,
        1.3848379698453555e-15,
        -1.6306302878810345e-18,
    ],
    &[
        1.,
        -0.090084945754385,
        0.003609522662418399,
        -0.00008443044549874216,
        1.2705892822174982e-6,
        -1.2757629452375947e-8,
        8.54675721397272e-11,
        -3.683946010813727e-13,
        9.270784013628205e-16,
        -1.037816293275114e-18,
    ],
    &[
        1.,
        -0.08590188910711966,
        0.0032818842766314956,
        -0.00007319259778142309,
        1.0501189581697184e-6,
        -1.0051668733333905e-8,
        6.419083381375438e-11,
        -2.6372777332146505e-13,
        6.325522084572644e-16,
        -6.748431239693051e-19,
    ],
    &[
        1.,
        -0.08208814831384907,
        0.002996777877401635,
        -0.00006385972412129102,
        8.753892400212446e-7,
        -8.005290780854564e-9,
        4.883832271329586e-11,
        -1.9167434965402254e-13,
        4.3913250712740003e-16,
        -4.4746883289808e-19,
    ],
    &[
        1.,
        -0.07859709156548286,
        0.0027471677673381826,
        -0.00005604543325754028,
        7.354857178659803e-7,
        -6.4385278877669325e-9,
        3.7599536625722333e-11,
        -1.4124501362904005e-13,
        3.097179544638284e-16,
        -3.020429591293705e-19,
    ],
    &[
        1.,
        -0.07538959121614991,
        0.002527411666620933,
        -0.00004945353681690641,
        6.224114247482768e-7,
        -5.2253495888121814e-9,
        2.926276613506371e-11,
        -1.0541153462934827e-13,
        2.2163628650437246e-16,
        -2.0724273549603385e-19,
    ],
    &[
        1.,
        -0.07243257762654072,
        0.0023329429088676007,
        -0.00004385444400822837,
        5.302296446910065e-7,
        -4.2761562232194345e-9,
        2.300310137307927e-11,
        -7.95925566293058e-14,
        1.607379468661554e-16,
        -1.4435420544730423e-19,
    ],
    &[
        1.,
        -0.06969791406033235,
        0.0021600339350322565,
        -0.00003906835069448951,
        4.544796524369282e-7,
        -3.5263588700462956e-9,
        1.8250086588788753e-11,
        -6.074900990716101e-14,
        1.180199746456464e-16,
        -1.0195734743497503e-19,
    ],
    &[
        1.,
        -0.06716151265943174,
        0.002005618198104017,
        -0.00003495310226982378,
        3.917722420974578e-7,
        -2.9287987205139907e-9,
        1.4603487949323336e-11,
        -4.683213622252384e-14,
        8.765110834599516e-17,
        -7.294594558200511e-20,
    ],
    &[
        1.,
        -0.06480263345712445,
        0.0018671545818481222,
        -0.00003139531955284419,
        3.3950567474721756e-7,
        -2.4486335972297986e-9,
        1.177872141205658e-11,
        -3.6440038374190655e-14,
        6.57917206106596e-17,
        -5.2817673373900195e-20,
    ],
    &[
        1.,
        -0.06944555772822517,
        0.002171099743808659,
        -0.00004023947557286157,
        4.89641171701312e-7,
        -4.087269966331473e-9,
        2.3703675557106855e-11,
        -9.430477490932142e-14,
        2.4632950589111847e-16,
        -3.814643491379864e-19,
        2.659535041840811e-22,
    ],
    &[],
];

pub const SPLITS: [f64; 35] = [
    0.,
    0.5786374890615835,
    3.0266174181249874,
    7.922577276251795,
    12.818537134378602,
    17.71449699250541,
    22.610456850632218,
    27.506416708759026,
    32.402376566885835,
    37.29833642501264,
    42.19429628313945,
    47.09025614126625,
    51.98621599939306,
    56.88217585751987,
    61.77813571564668,
    66.67409557377349,
    71.5700554319003,
    76.4660152900271,
    81.3619751481539,
    86.25793500628072,
    91.15389486440752,
    96.04985472253433,
    100.94581458066114,
    105.84177443878795,
    110.73773429691475,
    115.63369415504157,
    120.52965401316837,
    125.42561387129518,
    130.32157372942197,
    135.2175335875488,
    140.1134934456756,
    145.00945330380242,
    149.9054131619292,
    157.2493529491194,
    std::f64::INFINITY,
];
