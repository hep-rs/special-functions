#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-9)
        * polynomial(
            x2,
            &[
                1.032192e7,
                -322560.,
                5760.,
                -80.,
                1.,
                -0.0125,
                0.0001736111111111111,
                -3.100198412698413e-6,
                9.68812003968254e-8,
                -8.23713914251601e-9,
            ],
        )
        + x.powi(9) * x.ln() * polynomial(x2, &[5.382288910934744e-9])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                50.60255829411332,
                996.237866415356,
                12411.46341909131,
                106661.013757816,
                647965.6585787319,
                2.740354764405887e6,
                7.584910508623437e6,
                1.173290844302688e7,
                5.703497159804733e6,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        2.885177434284774,
        -12.91305905934674,
        -0.8511798314137109,
        -0.2715988986197156,
        -0.06029615163142429,
        -0.008618000269662684,
        -0.0004912707177794359,
        0.00006785767505095376,
        5.651432863919139e-6,
        -4.939238839689766e-6,
        -1.167078121370216e-6,
        9.28622400773923e-8,
        7.962507139353001e-8,
        6.124786570957924e-9,
        -3.972068540995951e-9,
        -9.79549847620511e-10,
        1.070489504622449e-10,
        8.003559690231472e-11,
        5.038321956869663e-12,
        -4.597701296125946e-12,
        -1.03886177413832e-12,
        1.565796934444464e-13,
        9.53432118168175e-14,
        3.598207755683322e-15,
        -6.111164450906486e-15,
        -1.178584379560246e-15,
        2.525538608546199e-16,
        1.2169452326799e-16,
        6.068601853566054e-19,
        -8.197239801467317e-18,
        -1.333251889134722e-18,
    ],
    &[
        -63.86660265546599,
        -68.15814219547286,
        -18.89286994815144,
        -3.890849344688257,
        -0.573178239870439,
        -0.07044157960217928,
        -0.007326515897362937,
        -0.0005934140033680636,
        -0.00005108518260946882,
        -3.65510588261798e-6,
        5.164627817023595e-9,
        -4.962212374242695e-8,
        1.291411498995464e-9,
        1.04724566678562e-9,
        -3.654448841021293e-10,
        5.170072249968755e-11,
        1.904809005157176e-12,
        -2.811040031659396e-12,
        6.818479424011065e-13,
        -5.922760844956361e-14,
        -1.500064080518975e-14,
        6.884630227278342e-15,
        -1.205805290498362e-15,
        1.101377217175929e-17,
        5.397994761527043e-17,
        -1.556985687524491e-17,
        1.766684256928081e-18,
        2.536340675381683e-19,
        -1.558580426148131e-19,
        3.036200866928984e-20,
        -1.268051201867315e-21,
    ],
];

pub const SPLITS: [f64; 3] = [0.1049895878400409, 2.569121718889714, 5.033253849939387];
