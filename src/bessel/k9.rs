#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-9)
        * polynomial(
            x2,
            &[
                1.032192e7,
                -322560.,
                5760.,
                -80.,
                1.,
                -0.0125,
                0.0001736111111111111,
                -3.100198412698413e-6,
                9.68812003968254e-8,
                -8.23713914251601e-9,
            ],
        )
        + x.powi(9) * x.ln() * polynomial(x2, &[5.382288910934744e-9])
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                50.60255829411332,
                996.237866415356,
                12411.46341909131,
                106661.013757816,
                647965.6585787319,
                2.740354764405887e6,
                7.584910508623437e6,
                1.173290844302688e7,
                5.703497159804733e6,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        12.35491420230339,
        -2.81771708195859,
        -0.006838648279397996,
        -0.0006825577211726992,
        -0.00005023625799759484,
        -2.844317738477237e-6,
        -1.230200987635102e-7,
        -3.64743211197058e-9,
        -2.904546707696755e-11,
        4.520123689716735e-12,
        3.221712969529644e-13,
        9.51247122100535e-15,
        -2.074866372634147e-16,
        -4.103832844287034e-17,
        -2.342880404694941e-18,
        -4.807642457945601e-20,
        3.631506245425056e-21,
        4.184352389179259e-22,
        1.949337360648197e-23,
        9.6775079395962e-26,
        -5.688344031760183e-26,
        -4.585627806585985e-27,
        -1.527771647682424e-28,
        4.088464216304458e-30,
        8.294113913018574e-31,
        4.822316095350851e-32,
        7.513502524922867e-34,
        -1.111624831179971e-34,
        -1.09519932211517e-35,
        -4.293824806514191e-37,
        6.133314656391798e-39,
    ],
    &[
        6.625577815699176,
        -2.924389276213853,
        -0.02234216364653331,
        -0.002135557203001042,
        -0.000144461382465413,
        -6.877337504535768e-6,
        -1.939895086339339e-7,
        7.019939232619475e-10,
        3.553164237926316e-10,
        1.09747458440407e-11,
        -6.800488917690766e-13,
        -7.840345753478231e-14,
        -2.065536770095483e-15,
        1.755593537337779e-16,
        1.84333852651736e-17,
        3.925188981996204e-19,
        -5.215344561391725e-20,
        -4.773341077303145e-21,
        -6.594734922577183e-23,
        1.655384321259234e-23,
        1.28506186493255e-24,
        4.851929373404028e-27,
        -5.39179536520441e-27,
        -3.464955712494256e-28,
        3.284828314356345e-30,
        1.757136849486881e-30,
        9.07859111608934e-32,
        -2.517514761749171e-33,
        -5.642188671952182e-34,
        -2.21765231027839e-35,
        1.240827701916775e-36,
    ],
    &[
        0.4813281262510252,
        -3.256890003494667,
        -0.06711779554636223,
        -0.005769004198064509,
        -0.0003200149352994153,
        -0.00001000184862515051,
        -3.094400349921448e-8,
        7.032972827742882e-9,
        -3.91519493039718e-10,
        -5.185794831813337e-11,
        -3.82069651091239e-14,
        2.149888461656485e-13,
        5.757589765139944e-15,
        -8.37674402043071e-16,
        -4.977006563662263e-17,
        2.712844958656903e-18,
        3.186298674304031e-19,
        -4.994190006834758e-21,
        -1.751873515849442e-21,
        -2.149208066408097e-23,
        8.502080881114274e-24,
        3.401153617902032e-25,
        -3.565088474787506e-26,
        -2.752524102104238e-27,
        1.16506594986867e-28,
        1.78241078116844e-29,
        -1.527409076714245e-31,
        -1.001750921778068e-31,
        -1.826420002985608e-33,
        4.933059388905609e-34,
        2.303336691510841e-35,
    ],
    &[
        -6.860144384382859,
        -4.173091631587551,
        -0.1737191253649324,
        -0.01250699703866189,
        -0.0005247562000783499,
        -0.00001109324739868778,
        -1.930964219648661e-7,
        -1.965150543795208e-8,
        -5.576551168134846e-10,
        5.042529147730875e-11,
        7.906817993484237e-13,
        -2.465400991221204e-13,
        3.405898689132589e-16,
        1.148035900658407e-15,
        -2.137948409442858e-17,
        -5.268417988122103e-18,
        1.991510245944226e-19,
        2.319937985853698e-20,
        -1.436415288542166e-21,
        -9.46250379029993e-23,
        9.23794102362878e-24,
        3.316619162695844e-25,
        -5.5213415422931e-26,
        -7.595595541862583e-28,
        3.112301742004762e-28,
        -1.666971488785797e-30,
        -1.659908207306147e-30,
        4.011273170746725e-32,
        8.335302324926351e-33,
        -3.741490232402795e-34,
        -3.881330884637104e-35,
    ],
    &[
        -17.18485780740983,
        -6.325416842613439,
        -0.3828710164386679,
        -0.02313311925972141,
        -0.0008414634633510237,
        -0.00002287846298798917,
        -7.718222471304387e-7,
        -1.749938619237882e-8,
        2.052208005099372e-10,
        -1.847316432553798e-11,
        -1.11810107274187e-12,
        1.030821060811246e-13,
        -1.309970853344648e-15,
        -3.492309740564091e-16,
        2.359593493573206e-17,
        2.163090572446807e-19,
        -1.11984009659375e-19,
        5.041115257677228e-21,
        2.198322396170175e-22,
        -3.413676359340771e-23,
        8.624035672619846e-25,
        1.069762119002366e-25,
        -9.72506284892728e-27,
        4.152682462510556e-29,
        4.237643461901994e-29,
        -2.510163573048056e-30,
        -5.88260602798159e-32,
        1.491251782700889e-32,
        -5.452272890030583e-34,
        -3.995301936152323e-35,
        4.762202795302917e-36,
    ],
    &[
        -33.96681272392438,
        -10.76977227288934,
        -0.7600524335708387,
        -0.04142621901331927,
        -0.001523268715844401,
        -0.00004728591764711968,
        -1.291619046201619e-6,
        -2.376143206174775e-8,
        -5.505691561878175e-10,
        -1.468910909598179e-11,
        3.317032256397716e-13,
        -1.645547012262989e-14,
        -4.240125837042957e-16,
        7.115779442721792e-17,
        -3.666712505235209e-18,
        2.584121797211042e-20,
        1.008932400832691e-20,
        -7.921094549047717e-22,
        2.204922169469725e-23,
        1.117560804166099e-24,
        -1.544373560481407e-25,
        7.136367711278229e-27,
        2.661875927447863e-29,
        -2.680770867356485e-29,
        1.826036267733115e-30,
        -3.63683456576061e-32,
        -3.862764958034629e-33,
        4.074829302931656e-34,
        -1.554912635018304e-35,
        -3.449369638095569e-37,
        8.054992921978588e-38,
    ],
    &[
        -92.3691926353536,
        -54.12530028846092,
        -8.067416797062499,
        -0.8309988520925843,
        -0.06303814691181981,
        -0.003903734203612919,
        -0.000199174042100206,
        -8.692261450501654e-6,
        -3.441747252474181e-7,
        -1.091913511959571e-8,
        -3.803210850013256e-10,
        -1.050010947960599e-11,
        1.775593161039815e-14,
        -3.90227918808664e-14,
        2.347454788675549e-15,
        -8.807829899636972e-17,
        -8.121375788021751e-18,
        1.852723212804478e-18,
        -1.977191036104714e-19,
        1.270601971698901e-20,
        -1.394960274881252e-22,
        -8.976055478083322e-23,
        1.426131003464339e-23,
        -1.288693221827755e-24,
        6.196997822668557e-26,
        2.407126801007013e-27,
        -9.07914842208837e-28,
        1.11707454686559e-28,
        -8.227690337143754e-30,
        1.900692106682524e-31,
        4.563155079454074e-32,
    ],
];

pub const SPLITS: [f64; 8] = [
    0.1049895878400409,
    0.7210226206024592,
    1.337055653364878,
    1.953088686127296,
    2.569121718889714,
    3.185154751652132,
    3.801187784414551,
    5.033253849939387,
];
