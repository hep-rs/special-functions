#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-8)
        * polynomial(
            x2,
            &[
                -410696.1475497741,
                -14667.71955534907,
                -305.577490736439,
                -5.092958178940651,
                -0.07957747154594767,
                -0.001326291192432461,
                -0.00002763106650900961,
                -9.868238038932e-7,
                -9.09641900843396e-8,
                3.478580708258277e-9,
            ],
        )
        + x.powi(8) * x.ln() * polynomial(x2, &[6.167648774332502e-8, -1.713235770647917e-9])
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                20.29225524421666,
                939.785070997784,
                45227.15654176835,
                2.047942182156948e6,
                8.063772342242983e7,
                2.494729568381423e9,
                5.038462753284624e10,
                3.660758094183359e11,
                -2.852340681717867e12,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 13.35176877775662
        + x1 * polynomial(
            x1,
            &[
                31.875,
                0.0,
                153.3984375,
                0.0,
                1863.9404296875,
                0.0,
                -3427.902112688337,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 21] = [
    &[
        -102373.2083293994,
        136187.7098837618,
        -60046.04150354844,
        20608.98803072317,
        -5963.869514985098,
        1523.627320379217,
        -353.8215209827882,
        76.18012537253898,
        -15.42321270829628,
        2.966967310229305,
        -0.5466459614830285,
        0.0970618356946832,
        -0.01669109787693197,
        0.00279095513218496,
        -0.0004552818055447278,
        0.00007265334447391842,
        -0.00001136786156361832,
        1.747428635036335e-6,
        -2.643296292227911e-7,
        3.940460470579973e-8,
        -5.796287999938215e-9,
        8.422358473502874e-10,
        -1.210096335928763e-10,
        1.720607684436256e-11,
        -2.422988884164831e-12,
        3.381623267891998e-13,
        -4.680253594265082e-14,
        6.427261078753883e-15,
        -8.764852435058867e-16,
        1.207675039733346e-16,
        -1.595926043804453e-17,
    ],
    &[
        -4219.231013957923,
        4336.058207523735,
        -1380.224755243509,
        335.2536552573831,
        -68.10619149212842,
        12.1665974292814,
        -1.971357536957893,
        0.2957654089988526,
        -0.04169082243871505,
        0.005580723112986522,
        -0.0007151876270348408,
        0.00008830167441192691,
        -0.00001055634650875749,
        1.226911887468693e-6,
        -1.390950713761087e-7,
        1.542441374292671e-8,
        -1.676921858182577e-9,
        1.790938107282864e-10,
        -1.8821116735751e-11,
        1.94912834390364e-12,
        -1.991664647595754e-13,
        2.010270066047202e-14,
        -2.006221856684254e-15,
        1.981367328076485e-16,
        -1.937965701779699e-17,
        1.87853879314868e-18,
        -1.805736950251561e-19,
        1.722225231322119e-20,
        -1.630706767581252e-21,
        1.546548562105729e-22,
        -1.432438526630649e-23,
    ],
    &[
        -326.8506260540913,
        411.9327505241466,
        -171.3273035671867,
        55.6445045046895,
        -15.28887165715031,
        3.718474393775397,
        -0.8237299805556237,
        0.1694404530218708,
        -0.03281156211489568,
        0.006042652293901277,
        -0.001066558641824314,
        0.000181521627541,
        -0.00002993337891264082,
        4.801398927777374e-6,
        -7.515609458759631e-7,
        1.151095276134227e-7,
        -1.728986095046469e-8,
        2.551764599749975e-9,
        -3.706598828572246e-10,
        5.306599454591835e-11,
        -7.497257576764473e-12,
        1.046421670608627e-12,
        -1.444261194104535e-13,
        1.972824422210132e-14,
        -2.669089703761234e-15,
        3.579014760496475e-16,
        -4.759407818525476e-17,
        6.280161062786094e-18,
        -8.228975644101977e-19,
        1.088112052663492e-19,
        -1.383646850468673e-20,
    ],
    &[
        -12.95971425857699,
        17.2427490071348,
        -8.149293248442301,
        3.091820136494698,
        -1.009522318842764,
        0.2950363153164112,
        -0.07909397359459791,
        0.01978983018716181,
        -0.004678804897786619,
        0.00105492432163828,
        -0.0002284475275904609,
        0.00004778130521902371,
        -9.69580279521856e-6,
        1.915812034744841e-6,
        -3.697257978940991e-7,
        6.986578145872625e-8,
        -1.295501094682075e-8,
        2.361532887377243e-9,
        -4.238546959075368e-10,
        7.500664992728712e-11,
        -1.310267410622081e-11,
        2.261789100624764e-12,
        -3.861692725722777e-13,
        6.526691095373524e-14,
        -1.09273748344712e-14,
        1.813554318730293e-15,
        -2.985335851587027e-16,
        4.876870309068397e-17,
        -7.914883181759027e-18,
        1.306753737088764e-18,
        -2.039975025139015e-19,
    ],
    &[
        -0.8359515337980174,
        0.5300562320305418,
        -0.1397210064569629,
        0.03746924826615768,
        -0.007254789023067306,
        0.001314815573279463,
        -0.0002302231671669074,
        0.00003678800003691713,
        -5.56785301584023e-6,
        8.120893404373448e-7,
        -1.138932109904772e-7,
        1.544133690714917e-8,
        -2.035209188658242e-9,
        2.615686226678909e-10,
        -3.286587023637389e-11,
        4.047039229759168e-12,
        -4.89368863293879e-13,
        5.820780986554765e-14,
        -6.820472145962909e-15,
        7.883076522035607e-16,
        -8.997363967117254e-17,
        1.015090798776969e-17,
        -1.133044741803376e-18,
        1.252224638505873e-19,
        -1.371244190841639e-20,
        1.488736828201624e-21,
        -1.603385006314252e-22,
        1.713947867989513e-23,
        -1.819488676649503e-24,
        1.939270795386238e-25,
        -2.010210703245641e-26,
    ],
    &[
        -0.1961081422406958,
        0.2211582282287634,
        0.003635414191074633,
        -0.0001265188393752125,
        -0.000736140231644883,
        0.00004313015600378209,
        -8.885170672774413e-7,
        6.446410318649886e-7,
        -7.739237783268501e-8,
        5.541071486821553e-9,
        -6.011208436250033e-10,
        6.737305189487613e-11,
        -6.304005286028691e-12,
        5.806917467448573e-13,
        -5.432572585143345e-14,
        4.955251913255033e-15,
        -4.414564489281287e-16,
        3.879516615630723e-17,
        -3.364669723009918e-18,
        2.879518646239373e-19,
        -2.434758319085335e-20,
        2.036186282460172e-21,
        -1.685540703400154e-22,
        1.382062958531138e-23,
        -1.123227999096595e-24,
        9.05346404281097e-26,
        -7.240997666018695e-27,
        5.749469338272003e-28,
        -4.534282197433577e-29,
        3.574198064800704e-30,
        -2.767004549105478e-31,
    ],
    &[
        0.06593683692031857,
        -0.04340264533552651,
        0.0914592869844014,
        0.1587170859717251,
        -0.05859060774306703,
        -0.0429596046785138,
        0.006796620440318705,
        0.005421951584919878,
        -0.0003280803484394681,
        -0.0003829580652498687,
        2.242211466212316e-6,
        0.00001776248170793886,
        4.2070273113403e-7,
        -5.670676808207631e-7,
        -2.639915524734109e-8,
        1.385229662883866e-8,
        7.516643826730492e-10,
        -2.434613053025556e-10,
        -1.885821859029271e-11,
        4.109949187210175e-12,
        1.906435257414256e-13,
        -2.757807957419104e-14,
        -6.939401350017573e-15,
        1.147012487460539e-15,
        -1.050655975733411e-16,
        2.436113121063169e-17,
        -5.879166659717098e-18,
        1.123268256765203e-18,
        -2.124195338069773e-19,
        4.307522478839749e-20,
        -8.078333592557581e-21,
    ],
    &[
        0.04433283406132001,
        -0.05185732771987489,
        0.07497296474516747,
        -0.1070890427713473,
        -0.07168930424809536,
        0.04255107189836351,
        0.01465070460048658,
        -0.005780570035790203,
        -0.001442395929804644,
        0.0004136181342763905,
        0.00008603995811421286,
        -0.00001857759317361023,
        -3.474048341988383e-6,
        5.774869162757713e-7,
        1.014765641901647e-7,
        -1.322555351752922e-8,
        -2.244164766501876e-9,
        2.331235807592489e-10,
        3.886433932866716e-11,
        -3.266916438222415e-12,
        -5.410861592155289e-13,
        3.732277475440744e-14,
        6.185599189518e-15,
        -3.546592719062929e-16,
        -5.908293654462394e-17,
        2.849677452638194e-18,
        4.784641620475603e-19,
        -1.962863743894631e-20,
        -3.326267049333847e-21,
        1.166489278655227e-22,
        2.006265039825917e-23,
    ],
    &[
        -0.04835541432367912,
        0.01281807832769605,
        -0.07017414416321885,
        0.01112166807112073,
        0.0949743287436704,
        -0.007193014291395811,
        -0.02154581577779081,
        0.001207293192672062,
        0.002216979820446247,
        -0.000098045759076342,
        -0.0001333242475540123,
        4.738572281410382e-6,
        5.312385450133175e-6,
        -1.520896226355704e-7,
        -1.513811507285577e-7,
        3.472459816073217e-9,
        3.248702897804763e-9,
        -5.908969871694761e-11,
        -5.450629358336212e-11,
        7.742679089536653e-13,
        7.355144197985666e-13,
        -7.988828897849243e-15,
        -8.162176702573243e-15,
        6.577146270987077e-17,
        7.583820276542125e-17,
        -4.331668862664219e-19,
        -5.987846859369388e-19,
        2.246795312408749e-21,
        4.067928768988387e-21,
        -8.60482171253184e-24,
        -2.403081391527206e-23,
    ],
    &[
        0.03640491129591874,
        0.01987846244975245,
        0.04954015763899196,
        0.0462085796494053,
        -0.078125481600143,
        -0.01880565567949719,
        0.01868482798135619,
        0.002691304208313368,
        -0.001998062063486724,
        -0.0002053551142176351,
        0.0001238033498115866,
        9.89700067434367e-6,
        -5.046824662854656e-6,
        -3.313552108294977e-7,
        1.462333672679856e-7,
        8.195556659988548e-9,
        -3.174368623969039e-9,
        -1.563254964418339e-10,
        5.363859405923953e-11,
        2.373623853613101e-12,
        -7.264077205085331e-13,
        -2.939540704466501e-14,
        8.067828242655639e-15,
        3.026843352409349e-16,
        -7.486611082094293e-17,
        -2.632339414653766e-18,
        5.894341939905499e-19,
        1.9588172172634e-20,
        -3.988577715045746e-21,
        -1.254003380594587e-22,
        2.345092102458169e-23,
    ],
    &[
        -0.0215395112239162,
        -0.03883732900963729,
        -0.02791615051810432,
        -0.07555637249773525,
        0.049221249445852,
        0.03347422056240794,
        -0.01220908219221406,
        -0.005045707565924524,
        0.001343089324787183,
        0.0003999519425625835,
        -0.00008527295747292853,
        -0.00001981404678979017,
        3.551243246002102e-6,
        6.756423860365364e-7,
        -1.048412539922425e-7,
        -1.688108686823081e-8,
        2.313012512903423e-9,
        3.229932192635708e-10,
        -3.962828140225142e-11,
        -4.890975164737022e-12,
        5.429449782213265e-13,
        6.013112501793129e-14,
        -6.088321071157185e-15,
        -6.125852002484885e-16,
        5.693702381383732e-17,
        5.25824332600127e-18,
        -4.510294242627047e-19,
        -3.856155579220239e-20,
        3.066389149041956e-21,
        2.431086598951827e-22,
        -1.809142808136045e-23,
    ],
    &[
        0.007190532712476314,
        0.04641289415612427,
        0.008313975454724349,
        0.08516475697543649,
        -0.01852853404968723,
        -0.03902754394404475,
        0.004884204783944535,
        0.006012208278061876,
        -0.0005614380391485633,
        -0.0004851053228060443,
        0.00003696681864406323,
        0.00002439885380885238,
        -1.58870551341737e-6,
        -8.427756701262315e-7,
        4.821785602996066e-8,
        2.128662524428955e-8,
        -1.090147049654609e-9,
        -4.10943759179158e-10,
        1.908686453336298e-11,
        6.267535582430114e-12,
        -2.665777125939083e-13,
        -7.74831328274602e-14,
        3.040338848421048e-15,
        7.925836891294594e-16,
        -2.885901030760447e-17,
        -6.822258307318496e-18,
        2.316006543961902e-19,
        5.011450792130539e-20,
        -1.592471526063412e-21,
        -3.161668082577562e-22,
        9.48764178801896e-24,
    ],
    &[
        0.00517544704098884,
        -0.04533505671892787,
        0.008037245547776048,
        -0.08055780547903435,
        -0.00917181885530306,
        0.03767110130520168,
        0.001920132907847595,
        -0.005881559774094816,
        -0.0001826404784911426,
        0.0004800209921023408,
        0.00001007940503257369,
        -0.00002439273840525003,
        -3.646467833566396e-7,
        8.505043676947826e-7,
        9.31785166462768e-9,
        -2.166653855300476e-8,
        -1.769001549645504e-10,
        4.215458405376356e-10,
        2.587782901688241e-12,
        -6.474571133792934e-12,
        -2.997208847095957e-14,
        8.05481094296546e-14,
        2.805593463451054e-16,
        -8.285552053641415e-16,
        -2.155312510869619e-18,
        7.167063256273907e-18,
        1.373372235390565e-20,
        -5.287358970674979e-20,
        -7.299052445343278e-23,
        3.348039108215627e-22,
        3.23058147874159e-25,
    ],
    &[
        -0.01476173029484928,
        0.03803652208912832,
        -0.02043410519877788,
        0.06601227016960324,
        0.03129630155980214,
        -0.03135261329046051,
        -0.007453672294398321,
        0.004946043489301853,
        0.0007970153095741202,
        -0.000407311988451345,
        -0.0000494827142802838,
        0.00002086960032475549,
        2.023319485296732e-6,
        -7.333117494375534e-7,
        -5.882985819741544e-8,
        1.88176100224505e-8,
        1.281425863723097e-9,
        -3.686377813704566e-10,
        -2.171896769439834e-11,
        5.698608122957e-12,
        2.948623659770112e-13,
        -7.132489926511521e-14,
        -3.280756522867085e-15,
        7.378407907584886e-16,
        3.047631453740153e-17,
        -6.416050701155755e-18,
        -2.40024443639155e-19,
        4.756463352068779e-20,
        1.623607057798569e-21,
        -3.02539940335014e-22,
        -9.53654909128689e-24,
    ],
    &[
        0.02115562478777303,
        -0.02671221887027644,
        0.0285164122351942,
        -0.04522016346200033,
        -0.04648057401284658,
        0.02183774219205433,
        0.0113143585111861,
        -0.003482884255321558,
        -0.001231462237874054,
        0.0002895356981689458,
        0.0000776938572488454,
        -0.00001496409394007179,
        -3.224991946633911e-6,
        5.301010872989865e-7,
        9.51123432007753e-8,
        -1.370833264289512e-8,
        -2.099836580137454e-9,
        2.705251275113335e-10,
        3.604741900788258e-11,
        -4.211266703286889e-12,
        -4.953255648072753e-13,
        5.306110520854469e-14,
        5.574113793910845e-15,
        -5.523929002933612e-16,
        -5.233466253197784e-17,
        4.832432701103535e-18,
        4.162981500153888e-19,
        -3.602964202273164e-20,
        -2.842191423531806e-21,
        2.304050113771231e-22,
        1.683814699377589e-23,
    ],
    &[
        -0.02425144666721339,
        0.01336079553781262,
        -0.03224679285089511,
        0.02149854342759215,
        0.05424110210930872,
        -0.01074172837229973,
        -0.01334491374515958,
        0.00175013126743315,
        0.001465055455839529,
        -0.0001481039616001011,
        -0.0000931586550464244,
        7.777405542625032e-6,
        3.895496084330014e-6,
        -2.795778143893675e-7,
        -1.156943559946224e-7,
        7.329065708717305e-9,
        2.571377930421487e-9,
        -1.464942492222776e-10,
        -4.442551695071644e-11,
        2.308066175954261e-12,
        6.14191064153591e-13,
        -2.94130161742912e-14,
        -6.952182093958892e-15,
        3.095055575103627e-16,
        6.563662415361223e-17,
        -2.735218279552975e-18,
        -5.248709024717541e-19,
        2.059002635941425e-20,
        3.601417503231248e-21,
        -1.328671249287335e-22,
        -2.143723278321235e-23,
    ],
    &[
        0.02421523920846073,
        0.0002348385821679672,
        0.03190024687583394,
        0.002207244647884823,
        -0.05481640477012123,
        -0.0004905669186090871,
        0.01358291719889297,
        0.00001965791764859557,
        -0.001499840774017545,
        2.480501862999881e-6,
        0.0000958760617370769,
        -3.205235677804111e-7,
        -4.029225598542965e-6,
        1.767872707618777e-8,
        1.202411971296321e-7,
        -6.108870176436321e-10,
        -2.684816242909516e-9,
        1.492641060638796e-11,
        4.659298998941196e-11,
        -2.748327454455124e-13,
        -6.469428112253348e-13,
        3.972789931712107e-15,
        7.353496860588374e-15,
        -4.642684106166985e-17,
        -6.970530362437835e-17,
        4.485300998538196e-19,
        5.595712386859914e-19,
        -3.646454320901993e-21,
        -3.85386266889754e-21,
        2.515942054011269e-23,
        2.302224973920495e-23,
    ],
    &[
        -0.02144864258828953,
        -0.01255994959740274,
        -0.02803403279473265,
        -0.02340384051409364,
        0.04904524145428843,
        0.01063038014595964,
        -0.01222489904613914,
        -0.00162784866093505,
        0.001356381383161044,
        0.0001306289156365376,
        -0.00008708726252377776,
        -6.53399847283054e-6,
        3.675163495156677e-6,
        2.243863758663677e-7,
        -1.101163282721979e-7,
        -5.631989484524407e-9,
        2.468325077386516e-9,
        1.079822810253828e-10,
        -4.299818527633919e-11,
        -1.63452185556193e-12,
        5.992288745933962e-13,
        2.004057065175256e-14,
        -6.835575401253598e-15,
        -2.031557363628065e-16,
        6.502179855296238e-17,
        1.731653816121381e-18,
        -5.237431784401885e-19,
        -1.258683940130702e-20,
        3.618986770455589e-21,
        7.852349508001302e-23,
        -2.168821856358432e-23,
    ],
    &[
        0.01654128749835637,
        0.02242729165411537,
        0.02143441851436199,
        0.04014912927332179,
        -0.03823657659065477,
        -0.01871529631499255,
        0.00959080616848165,
        0.002918187252434383,
        -0.001069533143276613,
        -0.0002380254343944419,
        0.00006898826378163749,
        0.00001209358994748567,
        -2.924139974423289e-6,
        -4.217230690685082e-7,
        8.798336598844809e-8,
        1.074668056781213e-8,
        -1.980253079698572e-9,
        -2.091718954568962e-10,
        3.463285196757549e-11,
        3.214034637029746e-12,
        -4.845130669410081e-13,
        -3.999958723469515e-14,
        5.547789362309211e-15,
        4.115649226003019e-16,
        -5.296574292180791e-17,
        -3.560504663482886e-18,
        4.281596520488417e-19,
        2.62653701069831e-20,
        -2.968837402330458e-21,
        -1.662722209805354e-22,
        1.785238751204882e-23,
    ],
    &[
        -0.0102114135490787,
        -0.02902521815208316,
        -0.01304431547074338,
        -0.05113401995330176,
        0.02402117380324859,
        0.02408959280353864,
        -0.006085097663805454,
        -0.003783427132275206,
        0.0006839480655205883,
        0.0003105891104550957,
        -0.00004443038301225217,
        -0.00001587659494832965,
        1.895758547482428e-6,
        5.569062512773142e-7,
        -5.740201740247157e-8,
        -1.42732237400733e-8,
        1.299807635032596e-9,
        2.793811957384627e-10,
        -2.286570404450083e-11,
        -4.316680111527139e-12,
        3.217035938764574e-13,
        5.401603329811297e-14,
        -3.703799119396536e-15,
        -5.587751439279151e-16,
        3.554900185293541e-17,
        4.859659557868154e-18,
        -2.888514388731889e-19,
        -3.603605020696263e-20,
        2.012919225153812e-21,
        2.292893220696117e-22,
        -1.216309637357931e-23,
    ],
    &[
        0.003238487248842222,
        0.03194324069614641,
        0.003878682069986705,
        0.05572584470171572,
        -0.008189080704666085,
        -0.02642563734850919,
        0.002154935777351876,
        0.004168840660904772,
        -0.0002493100944665373,
        -0.0003435818775134753,
        0.00001660660928808418,
        0.0000176286530029622,
        -7.248380324551674e-7,
        -6.20591596011689e-7,
        2.241232250629899e-8,
        1.596134122749459e-8,
        -5.175256033450083e-10,
        -3.13500128326318e-10,
        9.2728619079033e-12,
        4.860238818597479e-12,
        -1.327422924962632e-13,
        -6.102021860309873e-14,
        1.553535206320635e-15,
        6.332988465396641e-16,
        -1.514452866747421e-17,
        -5.525552284272928e-18,
        1.248887956469913e-19,
        4.110390121702435e-20,
        -8.82650581053931e-22,
        -2.623468842475485e-22,
        5.405488418412242e-24,
    ],
];

pub const SPLITS: [f64; 22] = [
    1.033772415474286,
    1.602593740459377,
    2.171415065444467,
    3.309057715414648,
    5.584343015355009,
    7.85962831529537,
    10.13491361523573,
    19.23605481499718,
    28.33719601475862,
    37.43833721452006,
    46.53947841428151,
    55.64061961404295,
    64.7417608138044,
    73.84290201356584,
    82.94404321332729,
    92.0451844130887,
    101.1463256128502,
    110.2474668126116,
    119.3486080123731,
    128.4497492121345,
    137.550890411896,
    146.6520316116574,
];
