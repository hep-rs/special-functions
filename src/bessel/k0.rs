#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                0.1159315156584124,
                0.2789828789146031,
                0.02524892993216269,
                0.000846035090708223,
                0.00001491471929926043,
                1.627105610481598e-7,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -1.,
                    -0.25,
                    -0.015625,
                    -0.0004340277777777778,
                    -6.781684027777778e-6,
                    -6.781684027777778e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                -0.1566642671644375,
                0.08812365027999611,
                -0.0917954690416626,
                0.1405618119700459,
                -0.2846376692393429,
                0.7175241245408436,
                -2.165385304417903,
                7.61268271084419,
                -30.55646254769404,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 1] = [&[
    -15.66386420750854,
    -24.93864222404013,
    -12.6168175908228,
    -4.926708992310534,
    -1.525753323514705,
    -0.386836127750382,
    -0.08283562665882662,
    -0.01539339775247187,
    -0.002523338368277488,
    -0.0003673154285773852,
    -0.00004823814220541113,
    -5.896073908400966e-6,
    -6.566608821885036e-7,
    -6.032636585984572e-8,
    -5.893715865039515e-9,
    -9.69466712514946e-10,
    -3.638352591541093e-11,
    2.545927480535613e-11,
    -3.18208045344467e-12,
    -1.926559307270169e-12,
    3.443886081837695e-13,
    1.174438486585141e-13,
    -3.296315756819336e-14,
    -6.70580454448271e-15,
    2.833241003537825e-15,
    3.407051407602772e-16,
    -2.286863229307564e-16,
    -1.366464757459087e-17,
    1.775404035547332e-17,
    2.280734061259105e-19,
    -1.317582916592836e-18,
]];

pub const SPLITS: [f64; 2] = [-1.295219660504773, 4.066463343031385];
