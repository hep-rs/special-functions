use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                0.11593151565841242,
                0.2789828789146031,
                0.025248929932162694,
                0.000846035090708223,
                0.00001491471929926043,
                1.6271056104815983e-7,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -1.,
                    -0.25,
                    -0.015625,
                    -0.00043402777777777775,
                    -6.781684027777777e-6,
                    -6.781684027777778e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                -0.15666426716443752,
                0.08812365027999611,
                -0.09179546904166261,
                0.14056181197004586,
                -0.28463766923934286,
                0.7175241245408435,
                -2.1653853044179026,
                7.612682710844189,
                -30.55646254769404,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        0.5268940410980493,
        -0.5915430463609501,
        0.222621056415425,
        -0.07461502343819454,
        0.025581694029268468,
        -0.009332038049891968,
        0.0035880315573770683,
        -0.0014296571343002163,
        0.0005835737445994047,
        -0.00024238749935220636,
        0.00010201898637324256,
        -0.00004339303406483023,
        0.000018616042340015675,
        -8.043806697589704e-6,
        3.4967762874645097e-6,
        -1.528036841943175e-6,
        6.707520225197748e-7,
        -2.956041041220406e-7,
        1.3073136949443245e-7,
        -5.799674456050399e-8,
        2.580129441687551e-8,
        -1.150731256780079e-8,
        5.143967578814238e-9,
        -2.304228975347006e-9,
        1.0341387037897411e-9,
        -4.649324996787227e-10,
        2.0936265526764747e-10,
        -9.441778078125423e-11,
        4.2638948831449906e-11,
        -1.928036197836125e-11,
        8.72854871705614e-12,
        -3.955969826243635e-12,
        1.7948044824825748e-12,
        -8.150919333315673e-13,
        3.705065283344907e-13,
        -1.6856279627150188e-13,
        7.675080754220385e-14,
        -3.49735890475643e-14,
        1.59483712426697e-14,
        -7.277775650007166e-15,
        3.3234584336884687e-15,
        -1.5190229964255228e-15,
        6.955422845292986e-16,
        -3.2049599798565804e-16,
        1.5175274349083057e-16,
        -8.053433969573827e-17,
        3.0493499381107394e-17,
    ],
    &[
        0.04577557787668933,
        -0.04271913528956218,
        0.011199889458230501,
        -0.0021090508122862486,
        0.00032361541564878966,
        -0.00004408361536310984,
        5.687746137573107e-6,
        -7.275624643451836e-7,
        9.463082493641081e-8,
        -1.2614169242173204e-8,
        1.7199629690612684e-9,
        -2.387217397913105e-10,
        3.3577003310639954e-11,
        -4.770603601054041e-12,
        6.831913614291137e-13,
        -9.84697413714805e-14,
        1.426898150756514e-14,
        -2.077150362163811e-15,
        3.0357094527683777e-16,
        -4.4520136447011664e-17,
        6.549121395896912e-18,
        -9.66041846747848e-19,
        1.4284805161304173e-19,
        -2.1169739921049652e-20,
        3.1436303961706314e-21,
        -4.67676989554956e-22,
        6.969356475459892e-23,
        -1.0401913264989457e-23,
        1.5547343676840518e-24,
        -2.326890359947617e-25,
        3.486837059987584e-26,
        -5.23102616201195e-27,
        7.85613232110701e-28,
        -1.181048350284333e-28,
        1.7772014632200462e-29,
        -2.676648156076784e-30,
        4.034681365721393e-31,
        -6.086534926878129e-32,
        9.188723723199597e-33,
        -1.3881846967624073e-33,
        2.098603657140331e-34,
        -3.174607622474086e-35,
        4.805213426329192e-36,
        -7.277641478221778e-37,
        1.1033843937277034e-37,
        -1.7104891305144526e-38,
        2.5362523166073755e-39,
    ],
    &[
        0.003830582644905372,
        -0.005327799971026771,
        0.002317819622401262,
        -0.0007293456987272972,
        0.00018084865280531455,
        -0.00003742194303280891,
        6.7460155519263005e-6,
        -1.0977173127837746e-6,
        1.6634179421119384e-7,
        -2.4135010932092367e-8,
        3.4328952944679035e-9,
        -4.87234472789676e-10,
        6.976003745668222e-11,
        -1.01223263771102e-11,
        1.4890418658407633e-12,
        -2.216803012404994e-13,
        3.3324094612084375e-14,
        -5.048082569149682e-15,
        7.694071290849554e-16,
        -1.1785642234626778e-16,
        1.8128318382426433e-17,
        -2.7983458281989507e-18,
        4.332912289072449e-19,
        -6.727153759278459e-20,
        1.0469474494741542e-20,
        -1.6328728924943792e-21,
        2.551661604256473e-22,
        -3.994475567962391e-23,
        6.263196662224078e-24,
        -9.834998161045207e-25,
        1.5464790800079978e-25,
        -2.4347867252047257e-26,
        3.8378282191829414e-27,
        -6.055956803092762e-28,
        9.56579770600362e-29,
        -1.512420334794302e-29,
        2.393377195791923e-30,
        -3.7906520860427453e-31,
        6.008412394198523e-32,
        -9.530798760056672e-33,
        1.5128817202247891e-33,
        -2.4030928766153e-34,
        3.8195419485229317e-35,
        -6.074631846274163e-36,
        9.672592775038162e-37,
        -1.5781142703249e-37,
        2.4516724060383603e-38,
    ],
    &[
        0.000050877303568477065,
        -0.00008715299322585032,
        0.00005627311426129239,
        -0.000028555025430339915,
        0.000011826760631989097,
        -4.123476621029199e-6,
        1.2406256296589145e-6,
        -3.286670890755013e-7,
        7.796908524043886e-8,
        -1.680512492058067e-8,
        3.3337998883022833e-9,
        -6.160532581821144e-10,
        1.0726170791367096e-10,
        -1.779380522410039e-11,
        2.843551185879575e-12,
        -4.4243665410045765e-13,
        6.769628667259028e-14,
        -1.0275174589756677e-14,
        1.5578927841719044e-15,
        -2.370869823193316e-16,
        3.6315699700971724e-17,
        -5.604662446161115e-18,
        8.714058809849653e-19,
        -1.3639096485256604e-19,
        2.146987520946155e-20,
        -3.3958449600260506e-21,
        5.392540145112893e-22,
        -8.591845982028655e-23,
        1.3728033713016815e-23,
        -2.1988153925745162e-24,
        3.529346482294221e-25,
        -5.675687897218245e-26,
        9.142709810908022e-27,
        -1.4749999922511324e-27,
        2.382920384254169e-28,
        -3.8545713670617543e-29,
        6.242338695362865e-30,
        -1.0120094475279046e-30,
        1.6423049529715209e-31,
        -2.667625934209629e-32,
        4.336817333972487e-33,
        -7.056159311538632e-34,
        1.1489344291283076e-34,
        -1.8721461971179055e-35,
        3.054701891865193e-36,
        -5.113218257301912e-37,
        8.130742484400522e-38,
    ],
    &[
        1.8049994353240123e-8,
        -3.359211245393921e-8,
        2.711982637111313e-8,
        -1.9097539955543124e-8,
        1.181852175359106e-8,
        -6.482214519161583e-9,
        3.1783683615292735e-9,
        -1.4047850488709716e-9,
        5.640291964843961e-10,
        -2.0718697795426333e-10,
        7.008076027344684e-11,
        -2.1956337726008223e-11,
        6.405688058236491e-12,
        -1.7487901032757604e-12,
        4.487747448545491e-13,
        -1.0870550129432816e-13,
        2.4952213683060332e-14,
        -5.447759285596648e-15,
        1.1353629077766555e-15,
        -2.266626890396841e-16,
        4.349719579846874e-17,
        -8.051814309795942e-18,
        1.4428445859243106e-18,
        -2.5120112988881605e-19,
        4.265116020660467e-20,
        -7.089626163317943e-21,
        1.1582526374762457e-21,
        -1.8671120405124353e-22,
        2.9810600597034156e-23,
        -4.7308177276436365e-24,
        7.4854966512336885e-25,
        -1.1839812592181618e-25,
        1.875698998212113e-26,
        -2.98028805120647e-27,
        4.752967170650216e-28,
        -7.610528325544572e-29,
        1.2234684537144207e-29,
        -1.9741957656345858e-30,
        3.1963250014801694e-31,
        -5.190437805607934e-32,
        8.450539960065056e-33,
        -1.3789364417865506e-33,
        2.2545314332644126e-34,
        -3.6925119118016763e-35,
        6.061022073324099e-36,
        -1.0217100186606454e-36,
        1.6358749964414002e-37,
    ],
    &[
        6.4196192314677965e-15,
        -1.1934206989812227e-14,
        9.603672212184545e-15,
        -6.727346187662534e-15,
        4.133560211902681e-15,
        -2.2470017805168677e-15,
        1.0900662746695088e-15,
        -4.758616124905642e-16,
        1.8837793192135718e-16,
        -6.809969014721466e-17,
        2.2624168498169474e-17,
        -6.946734522322185e-18,
        1.9814605288331467e-18,
        -5.274467396076043e-19,
        1.3156931812606487e-19,
        -3.0869875395119845e-20,
        6.835805158835304e-21,
        -1.4330370056569865e-21,
        2.8520772068872574e-22,
        -5.402862568593895e-23,
        9.76517658093441e-24,
        -1.6876712923470066e-24,
        2.7947202085780113e-25,
        -4.442878468817319e-26,
        6.792797379542368e-27,
        -1.000530137073382e-27,
        1.4220382833687753e-28,
        -1.9532755958595169e-29,
        2.5967692148659832e-30,
        -3.3461678931661676e-31,
        4.1852314417418054e-32,
        -5.088065388166447e-33,
        6.020714329548755e-34,
        -6.943975245854607e-35,
        7.817055090961252e-36,
        -8.601532272074454e-37,
        9.265027457721647e-38,
        -9.784054914116837e-39,
        1.0145690660094823e-39,
        -1.0347915263825884e-40,
        1.0398715173827414e-41,
        -1.0314210342772712e-42,
        1.0116186859708126e-43,
        -9.829448224677267e-45,
        9.480082663279454e-46,
        -9.172264389773786e-47,
        8.681051568677797e-48,
    ],
    &[
        2.608341648525968e-21,
        -4.847007210507695e-21,
        3.8958596768040504e-21,
        -2.7238532084480623e-21,
        1.6693920612115325e-21,
        -9.046517814033032e-22,
        4.372686584414181e-22,
        -1.9010086337865182e-22,
        7.491054674816029e-23,
        -2.6944798809279557e-23,
        8.902829248298231e-24,
        -2.7174911524606233e-24,
        7.702038999931083e-25,
        -2.036217020442195e-25,
        5.0420396828574645e-26,
        -1.1737070253379749e-26,
        2.57713943562241e-27,
        -5.3537683962480305e-28,
        1.055176382622927e-28,
        -1.9780200880238282e-29,
        3.534932404686361e-30,
        -6.035314108730544e-31,
        9.863674156258962e-32,
        -1.5459146447122995e-32,
        2.3274012152627073e-33,
        -3.3711350149378722e-34,
        4.7047321891287113e-35,
        -6.334925306628752e-36,
        8.240494622583133e-37,
        -1.0367993424204067e-37,
        1.2631667263032752e-38,
        -1.4918304218190943e-39,
        1.7096824776385983e-40,
        -1.9031441044826436e-41,
        2.059643059958365e-42,
        -2.1690181424400317e-43,
        2.2246268976555562e-44,
        -2.2239892683803697e-45,
        2.16888799635226e-46,
        -2.0649446059262987e-47,
        1.9207757497048483e-48,
        -1.7468918039116073e-49,
        1.5545198758451498e-50,
        -1.3545186286651484e-51,
        1.1565585280794803e-52,
        -9.74708929161029e-54,
        7.955665593935141e-55,
    ],
];

pub const SPLITS: [f64; 8] = [
    0.2738377063957135,
    2.0887250432052,
    3.9036123800146867,
    7.53338705363366,
    14.792936400871605,
    29.312035095347497,
    43.83113378982339,
    58.35023248429928,
];
