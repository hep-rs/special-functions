use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                0.11593151565841242,
                0.2789828789146031,
                0.025248929932162694,
                0.000846035090708223,
                0.00001491471929926043,
                1.6271056104815983e-7,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -1.,
                    -0.25,
                    -0.015625,
                    -0.00043402777777777775,
                    -6.781684027777777e-6,
                    -6.781684027777778e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                -0.15666426716443752,
                0.08812365027999611,
                -0.09179546904166261,
                0.14056181197004586,
                -0.28463766923934286,
                0.7175241245408435,
                -2.1653853044179026,
                7.612682710844189,
                -30.55646254769404,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 20] = [
    &[],
    &[
        6.7362401308525826,
        941.8246556230612,
        27270.570691577905,
        254103.65712887695,
        846833.4403656102,
        882201.8129080946,
        22561.718001304314,
        -107367.14516970403,
        21257.823546895914,
        -1350.0377093582024,
    ],
    &[
        -5.0320182595178194e61,
        -6.967275842349074e63,
        -4.549511119680535e64,
        -4.2739840373092916e64,
        1.286421868472551e64,
        -1.2382973782751137e63,
        4.165131380941128e61,
    ],
    &[
        4.086839104470828,
        23.6300007413821,
        8.924813184493935,
        -8.250347743776885,
        2.2812573667705007,
        -0.35250244137102615,
        0.03493814365394721,
        -0.0023069480571983425,
        0.00009963686353975855,
        -2.578876697227292e-6,
        3.063896224977868e-8,
    ],
    &[
        2.7903281880664594,
        0.7190785640031839,
        -0.5355584620985553,
        0.1142433094172061,
        -0.013557370921999507,
        0.0010370638112993933,
        -0.00005378927103485205,
        1.901797835903825e-6,
        -4.429673490769786e-8,
        6.172706977064835e-10,
        -3.921256392501218e-12,
    ],
    &[
        -0.029639226580462783,
        0.009686947883738212,
        -0.0014353968249489037,
        0.0001265158516345567,
        -7.306542275289892e-6,
        2.8659037161053663e-7,
        -7.630908189027497e-9,
        1.32933132865466e-10,
        -1.3740357481641244e-12,
        6.416935284409714e-15,
    ],
    &[
        -3.816665570178285e-6,
        1.0530111120158607e-6,
        -1.3085576602360762e-7,
        9.609579400408276e-9,
        -4.594132072502831e-10,
        1.4822472443506837e-11,
        -3.22619721903425e-13,
        4.566196292064448e-15,
        -3.8119648109405513e-17,
        1.429586582973707e-19,
    ],
    &[
        -1.7597849921635416e-9,
        4.1759202871048653e-10,
        -4.4457550980947674e-11,
        2.786241499933091e-12,
        -1.1325310125129266e-13,
        3.0953908060084035e-15,
        -5.687193005982039e-17,
        6.771549027711577e-19,
        -4.739960231158762e-21,
        1.4857562048041877e-23,
    ],
    &[
        -1.5209686242117786e-12,
        3.1563865510403823e-13,
        -2.9314568450302664e-14,
        1.5988633964608382e-15,
        -5.642671434230306e-17,
        1.3360199504287371e-18,
        -2.121839863255939e-20,
        2.179254786330884e-22,
        -1.313172893498598e-24,
        3.536530351865465e-27,
    ],
    &[
        -1.8812814772038744e-15,
        3.462779331140142e-16,
        -2.847782302228465e-17,
        1.3732005976627819e-18,
        -4.277997403647577e-20,
        8.928090104371668e-22,
        -1.2480372542442178e-23,
        1.1266633152134932e-25,
        -5.959408929923713e-28,
        1.4070170884693607e-30,
    ],
    &[
        -2.91047962856343e-18,
        4.807945584883874e-19,
        -3.5446536495060957e-20,
        1.5305867887391648e-21,
        -4.2654237581231036e-23,
        7.954894868484045e-25,
        -9.927265682857729e-27,
        7.992996372266702e-29,
        -3.7673325759879373e-31,
        7.918844710495149e-34,
    ],
    &[
        -5.226496591245248e-21,
        7.825718853789244e-22,
        -5.2252288019965437e-23,
        2.041813363193731e-24,
        -5.145385382269426e-26,
        8.67101462622913e-28,
        -9.770971445568017e-30,
        7.09894328666086e-32,
        -3.017224464100788e-34,
        5.715425346755369e-37,
    ],
    &[
        -1.0417498195338639e-23,
        1.425680358657592e-24,
        -8.695386145051614e-26,
        3.1019443966001246e-27,
        -7.13225956186898e-29,
        1.0960620768688187e-30,
        -1.1257225879886172e-32,
        7.450674678916027e-35,
        -2.88339982379298e-37,
        4.970902892855432e-40,
    ],
    &[
        -2.2401727665185604e-26,
        2.822118383442016e-27,
        -1.58372733827176e-28,
        5.1960532364442274e-30,
        -1.0983233899342388e-31,
        1.5510398661913636e-33,
        -1.4632909689946373e-35,
        8.892801980333504e-38,
        -3.1588504430257145e-40,
        4.996699423203937e-43,
    ],
    &[
        -5.099763998094996e-29,
        5.950252726756646e-30,
        -3.091577199276234e-31,
        9.387828902796554e-33,
        -1.835990720317898e-34,
        2.398131182494842e-36,
        -2.0919706637959557e-38,
        1.175188852643029e-40,
        -3.857583889778799e-43,
        5.637203794878706e-46,
    ],
    &[
        -1.2130777967557335e-31,
        1.3178617979576556e-32,
        -6.3736821216587585e-34,
        1.8010870384992622e-35,
        -3.2770717793645887e-37,
        3.981294293122583e-39,
        -3.22950440731551e-41,
        1.6866035975221746e-43,
        -5.145705025061318e-46,
        6.987460184870488e-49,
    ],
    &[
        -2.987052791612249e-34,
        3.0355332027906954e-35,
        -1.372998597506507e-36,
        3.627732862356901e-38,
        -6.1704429661809625e-40,
        7.006414558264878e-42,
        -5.310829714779228e-44,
        2.5912576429351915e-46,
        -7.384684620960513e-49,
        9.365188704416082e-52,
    ],
    &[
        -7.562070464321512e-37,
        7.218034937378083e-38,
        -3.065927427528705e-39,
        7.606038621348224e-41,
        -1.2144976550195845e-42,
        1.2943772791037943e-44,
        -9.207497903995269e-47,
        4.2153668297505625e-49,
        -1.1270297089648159e-51,
        1.340705595173969e-54,
    ],
    &[
        1.853502879772341e-40,
        -1.6440637827684615e-41,
        6.488961855181049e-43,
        -1.4957306597020428e-44,
        2.2189228105696195e-46,
        -2.196986534509736e-48,
        1.451779587336468e-50,
        -6.173901018174028e-53,
        1.5331995356221996e-55,
        -1.693989147634291e-58,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 20] = [
    &[],
    &[
        1.,
        209.69953670650787,
        8479.60783986456,
        113566.70465186618,
        610483.2138278194,
        1.4224988264147574e6,
        1.4851030505642053e6,
        740273.4783484184,
        205635.42434497937,
        33365.66849010063,
        3536.340073606297,
    ],
    &[
        1.,
        -1.871033155189734e63,
        -2.4629307933674482e64,
        -7.154850533905611e64,
        -6.553135038177241e64,
        -2.6306329107604567e64,
        -7.223314670603545e63,
        -1.210575185193706e63,
        -1.922659370911006e62,
        -1.308729637916129e61,
        -1.839803628428581e60,
    ],
    &[
        1.,
        13.879901117233405,
        31.566687725826192,
        19.791720537464116,
        4.98927787162549,
        0.7937043891167054,
        0.06684885810021729,
        0.004562680237950784,
    ],
    &[
        1.,
        3.4050010112511573,
        2.012946054410878,
        0.7399234201213477,
        0.1263276118294037,
        0.023845408694339806,
        0.0015882380359992009,
        0.000251717650771437,
        4.0349111895933186e-6,
        8.973966893860835e-7,
    ],
    &[
        1.,
        -1.081271863782623,
        0.4927352596025295,
        -0.14631503481433453,
        0.02693136366300593,
        -0.003704474643702508,
        0.0003347718125883874,
        -0.000022825462840764107,
        9.058241002113384e-7,
        -2.468665023290276e-8,
    ],
    &[
        1.,
        -0.6718019466725599,
        0.20419752767997118,
        -0.03695204022945834,
        0.0044010398936628345,
        -0.0003593128765317556,
        0.00002022049119912477,
        -7.631961909915451e-7,
        1.7750950237134456e-8,
        -2.011171004711305e-10,
    ],
    &[
        1.,
        -0.4871958313557622,
        0.10682010123293743,
        -0.01385365604848653,
        0.0011732378098853473,
        -0.00006742896077584448,
        2.63719638594568e-6,
        -6.793272649683612e-8,
        1.051285467099207e-9,
        -7.510090755509964e-12,
    ],
    &[
        1.,
        -0.3789025739110036,
        0.06438641624156571,
        -0.006445606044315656,
        0.00041933534668825857,
        -0.000018407346337441797,
        5.459728105598806e-7,
        -1.0569985234033345e-8,
        1.2147527498577518e-10,
        -6.333412992239832e-13,
    ],
    &[
        1.,
        -0.3085840352795083,
        0.042608203965127316,
        -0.0034568874597358384,
        0.0001817213331847966,
        -6.423146633018914e-6,
        1.5277734929117447e-7,
        -2.3602427452192544e-9,
        2.1514876854191535e-11,
        -8.829111415611958e-14,
    ],
    &[
        1.,
        -0.2596108298543715,
        0.030110453486370068,
        -0.0020484756960002445,
        0.00009012111301366346,
        -2.660020818512373e-6,
        5.270084312527098e-8,
        -6.761945441501333e-10,
        5.1018695416856455e-12,
        -1.7259136780501313e-14,
    ],
    &[
        1.,
        -0.2237092231510393,
        0.022333971954089503,
        -0.001306310826501267,
        0.00004934399992269546,
        -1.2486666899901173e-6,
        2.1174811178305807e-8,
        -2.321195718713275e-10,
        1.493128974943983e-12,
        -4.296076014591496e-15,
    ],
    &[
        1.,
        -0.19634186384115856,
        0.017190221938650434,
        -0.000881001268953859,
        0.00002913220961092538,
        -6.446902961578708e-7,
        9.54997802377187e-9,
        -9.133448765180751e-11,
        5.118742769247641e-13,
        -1.2811902043350267e-15,
    ],
    &[
        1.,
        -0.17483042427319126,
        0.013621819972842928,
        -0.0006208775207388218,
        0.000018246656855310898,
        -3.586097958472861e-7,
        4.713983631264627e-9,
        -3.997219508309622e-11,
        1.9843203596384617e-13,
        -4.3947572441636005e-16,
    ],
    &[
        1.,
        -0.15749980159594193,
        0.0110501309325156,
        -0.000453315717537658,
        0.00001198449170661159,
        -2.1176929813099827e-7,
        2.5013756234869727e-9,
        -1.904691652528203e-11,
        8.48512372071782e-14,
        -1.685156090710218e-16,
    ],
    &[
        1.,
        -0.14325226254631773,
        0.009138183699539768,
        -0.0003407254953645576,
        8.183995280893379e-6,
        -1.3133192576192791e-7,
        1.4081715868465476e-9,
        -9.728937220554345e-12,
        3.93045866303522e-14,
        -7.075119666782115e-17,
    ],
    &[
        1.,
        -0.13134022000625004,
        0.0076795066491182505,
        -0.0002623793641559876,
        5.773104175759057e-6,
        -8.483851443252527e-8,
        8.327381919623149e-10,
        -5.264909183286164e-12,
        1.9456908924280916e-14,
        -3.2025158227425314e-17,
    ],
    &[
        1.,
        -0.12123786892694705,
        0.006542123321784425,
        -0.00020623360986959247,
        4.185794465275722e-6,
        -5.6726912350497384e-8,
        5.133517581837557e-10,
        -2.9914682707580165e-12,
        1.0186472497186674e-14,
        -1.544399566305941e-17,
    ],
    &[
        1.,
        -0.12441848659795579,
        0.006974412871448346,
        -0.00023196706546539512,
        5.0695462565651035e-6,
        -7.607212684070479e-8,
        7.937916337712183e-10,
        -5.687676844564597e-12,
        2.678273734098001e-14,
        -7.484668391330426e-17,
        9.426793146563373e-20,
    ],
    &[],
];

pub const SPLITS: [f64; 21] = [
    0.,
    0.18851300290215983,
    0.9116030688598604,
    2.3577832007752617,
    5.250143464606064,
    11.034863992267669,
    16.819584519929276,
    22.604305047590877,
    28.389025575252482,
    34.17374610291409,
    39.95846663057569,
    45.7431871582373,
    51.5279076858989,
    57.31262821356051,
    63.09734874122211,
    68.88206926888371,
    74.66678979654532,
    80.45151032420692,
    86.23623085186853,
    92.74404144548784,
    std::f64::INFINITY,
];
