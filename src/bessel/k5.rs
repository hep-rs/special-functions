use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                384.,
                -24.,
                1.,
                -0.041666666666666664,
                0.0026041666666666665,
                -0.00032749952664715604,
                -0.000019975385369557426,
                -4.1898408185434183e-7,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.00026041666666666666,
                    0.000010850694444444445,
                    1.937624007936508e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                15.509762449279314,
                88.2117739302761,
                275.6617935321128,
                439.3359834418048,
                208.68459213485727,
                -91.29950905900006,
                112.4940379476965,
                -219.71491786659473,
                576.7516593998112,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 20] = [
    &[],
    &[
        -5.889622210707319e26,
        -1.9514755761482046e26,
        -1.2831551300050743e25,
        7.483029675743584e24,
        1.0182361823916349e24,
        -2.128649599168969e23,
        -3.183662584699008e22,
        9.77698454628683e21,
        -8.63907783016083e20,
        2.8093074407903478e19,
    ],
    &[
        451105.04713362834,
        37732.11087170534,
        -8050.282887437769,
        -3912.4113162908748,
        759.9978137581402,
        -4.413997074741653,
        -11.295638797115847,
        1.4435302632654932,
        -0.08748245949351052,
        0.002774507928516874,
        -0.00003740543077868741,
    ],
    &[
        449.8317862988513,
        -156.39531103295965,
        24.637906278821283,
        -2.2995237024695285,
        0.13917525598260358,
        -0.00558764916563503,
        0.00014401583851173378,
        -2.062442176086175e-6,
        5.711416320119315e-9,
        2.71407607279195e-10,
        -2.9974118812388205e-12,
    ],
    &[
        0.00190371790735761,
        -0.0005998439201770464,
        0.00008643650112355896,
        -7.498402982155554e-6,
        4.335144257167687e-7,
        -1.744638624935399e-8,
        4.947578991515345e-10,
        -9.758650078124603e-12,
        1.280670409967777e-13,
        -1.0093328170915326e-15,
        3.626161699787258e-18,
    ],
    &[
        3.688414211329313e-8,
        -9.591352045795024e-9,
        1.1339594808938911e-9,
        -8.024471032453788e-11,
        3.762954326094397e-12,
        -1.2214854909301245e-13,
        2.7788713024064075e-15,
        -4.373763634008882e-17,
        4.556762717619168e-19,
        -2.8368826528086694e-21,
        8.012182754448458e-24,
    ],
    &[
        2.9105116778881e-12,
        -6.408040008488976e-13,
        6.393516222137456e-14,
        -3.806037626540404e-15,
        1.4967719900914355e-16,
        -4.062374687734767e-18,
        7.70478126077405e-20,
        -1.0081466403065794e-21,
        8.708014791631917e-24,
        -4.4828896240990035e-26,
        1.0442940536385193e-28,
    ],
    &[
        4.522836697511746e-16,
        -8.611131269076907e-17,
        7.415074867159124e-18,
        -3.8024408566566904e-19,
        1.285751668078316e-20,
        -2.9951425096038256e-22,
        4.867246610152263e-24,
        -5.447622225180666e-26,
        4.0184851219330244e-28,
        -1.763946916547228e-30,
        3.498509768417631e-33,
    ],
    &[
        1.0286178433398738e-19,
        -1.722595551746783e-20,
        1.3030844090473172e-21,
        -5.863057663464667e-23,
        1.737444434974066e-24,
        -3.54296850606667e-26,
        5.034415956054314e-28,
        -4.921805741810084e-30,
        3.1679834110107405e-32,
        -1.2122036051877724e-34,
        2.093745889972199e-37,
    ],
    &[
        2.9612090512084575e-23,
        -4.422299860411121e-24,
        2.9807050231800696e-25,
        -1.1939747581784647e-26,
        3.1474610508040963e-28,
        -5.705055553086633e-30,
        7.200456431497919e-32,
        -6.247974020261865e-34,
        3.5669493908352306e-36,
        -1.209745945032179e-38,
        1.8508102396648388e-41,
    ],
    &[
        9.965501020718462e-27,
        -1.3421833463098337e-27,
        8.153747063110208e-29,
        -2.9420941252985723e-30,
        6.982340227430808e-32,
        -1.138788432702838e-33,
        1.2925760489823418e-35,
        -1.0081507548554937e-37,
        5.170795910200036e-40,
        -1.574778022871965e-42,
        2.1624629859613238e-45,
    ],
    &[
        3.7393708455538334e-30,
        -4.584531263774365e-31,
        2.5341683088466017e-32,
        -8.316616033154337e-34,
        1.79442320677532e-35,
        -2.6596693980303223e-37,
        2.742415919740609e-39,
        -1.9423699778913108e-41,
        9.043456259796372e-44,
        -2.4992678265023597e-46,
        3.113212666731241e-49,
    ],
    &[
        1.518385965955575e-33,
        -1.7079123206141267e-34,
        8.658682224489782e-36,
        -2.60538087682503e-37,
        5.1525696897258816e-39,
        -6.997950728699891e-41,
        6.609887607089175e-43,
        -4.287330404852261e-45,
        1.8275266452603944e-47,
        -4.622741606393064e-50,
        5.269137911648237e-53,
    ],
    &[
        6.540932593398326e-37,
        -6.795236818532086e-38,
        3.1810018624628884e-39,
        -8.835899552659036e-41,
        1.6127530652112758e-42,
        -2.0210589782881577e-44,
        1.7610370746434487e-46,
        -1.0534948107480889e-48,
        4.140829232323787e-51,
        -9.656302800689825e-54,
        1.0144958567704858e-56,
    ],
    &[
        2.948731121892873e-40,
        -2.8455773045198177e-41,
        1.237129167964257e-42,
        -3.190834843279885e-44,
        5.406833244852155e-46,
        -6.289218760061052e-48,
        5.085712536074665e-50,
        -2.8229692555169526e-52,
        1.0293857782685175e-54,
        -2.226625818788583e-57,
        2.1695132811472099e-60,
    ],
    &[
        1.3776625419980411e-43,
        -1.2411067185864442e-44,
        5.0363637515947e-46,
        -1.2122815121679758e-47,
        1.916790198207871e-49,
        -2.0801640105686058e-51,
        1.5691347324710805e-53,
        -8.123848572763646e-56,
        2.7626263895270794e-58,
        -5.5721394711866454e-61,
        5.061876392215962e-64,
    ],
    &[
        6.623257680475682e-47,
        -5.594501074095905e-48,
        2.128324691431836e-49,
        -4.802188112197136e-51,
        7.116601878310797e-53,
        -7.23780265471149e-55,
        5.115996633872405e-57,
        -2.4816673868906643e-59,
        7.90619649308031e-62,
        -1.4937713294954608e-64,
        1.2709966051929807e-67,
    ],
    &[
        -6.303362160642429e-51,
        4.097479844271296e-52,
        -1.1661306635354792e-53,
        1.8977666292203756e-55,
        -1.9316001597468507e-57,
        1.259117057538756e-59,
        -5.1331648377963615e-62,
        1.1966090816213634e-64,
        -1.2211790993958352e-67,
    ],
    &[
        -5.3371227106134205e-53,
        3.3435501244990296e-54,
        -9.170046425935027e-56,
        1.4380636861071328e-57,
        -1.4103980040226168e-59,
        8.858461150126772e-62,
        -3.4795584372392664e-64,
        7.814791759566755e-67,
        -7.683348422924191e-70,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 20] = [
    &[],
    &[
        1.,
        4.2844311075537095e12,
        -1.010261018630204e14,
        1.1108297644220771e15,
        -7.579259883075701e15,
        -1.5337557480036238e24,
        -5.0819689174914945e23,
        -1.2927488847799098e23,
        -1.2275989344547808e22,
        -1.4325804205642686e21,
    ],
    &[
        1.,
        -5.777069919397436,
        15.794712291592298,
        -27.176633431814263,
        33.00066730784869,
        1144.7081104311735,
        119.50772058403142,
        40.54703868616734,
        1.289207563096177,
        0.2990502383843388,
    ],
    &[
        1.,
        -3.2928500060554096,
        4.9048476330758755,
        -4.482946652797308,
        2.849768521559346,
        -0.17476142242148066,
        0.08341623967123295,
        -0.0034886851835928016,
        0.0007270232260587306,
        -0.000017880440016608963,
        1.7162884285460361e-6,
    ],
    &[
        1.,
        -0.9190059665540581,
        0.3877601795315874,
        -0.09921132573741992,
        0.01711282332908784,
        -0.0020864206490549516,
        0.0001838525523947047,
        -0.000011604144411955033,
        5.148251409844004e-7,
        -1.4556186200907888e-8,
        2.2713301005994388e-10,
    ],
    &[
        1.,
        -0.5812318587405563,
        0.15402574470645977,
        -0.024542228133553477,
        0.0026085331467542543,
        -0.00019367165117262255,
        0.00001020051714390107,
        -3.776992281358551e-7,
        9.456634363973817e-9,
        -1.456364399975397e-10,
        1.0616300236422642e-12,
    ],
    &[
        1.,
        -0.4184626327550658,
        0.079500343712109,
        -0.009036926101597847,
        0.0006812712777453506,
        -0.00003562917833334464,
        1.3107730534307575e-6,
        -3.3548010633240594e-8,
        5.727865652900689e-10,
        -5.905815139225605e-12,
        2.8019538567295248e-14,
    ],
    &[
        1.,
        -0.3245038299863796,
        0.04768379126121916,
        -0.004180137794428939,
        0.00024222070855574844,
        -9.69963800479231e-6,
        2.7202147011271325e-7,
        -5.27947859015939e-9,
        6.792571057039222e-11,
        -5.237016890718632e-13,
        1.8397667437937067e-15,
    ],
    &[
        1.,
        -0.26400005429665163,
        0.03150822908968676,
        -0.002239349944576226,
        0.00010498848135522017,
        -3.393922145744918e-6,
        7.664056411439358e-8,
        -1.1942616727794774e-9,
        1.2295779340461908e-11,
        -7.55701239349164e-14,
        2.106730609233039e-16,
    ],
    &[
        1.,
        -0.22204872660702388,
        0.02226576192380308,
        -0.0013279690324919493,
        0.000052178978696812565,
        -1.4116429016286118e-6,
        2.6636009556875072e-8,
        -3.462127937118867e-10,
        2.967516227906751e-12,
        -1.5150940677533435e-14,
        3.5001617306171206e-17,
    ],
    &[
        1.,
        -0.19136728242975531,
        0.016525250437258547,
        -0.0008480795059800706,
        0.000028648503088050942,
        -6.656989275653679e-7,
        1.0777628506930954e-8,
        -1.200642075361661e-10,
        8.809492611973639e-13,
        -3.845074845958875e-15,
        7.582667310166629e-18,
    ],
    &[
        1.,
        -0.1680075938111055,
        0.01273020779373106,
        -0.000572927888376218,
        0.000016961890755172296,
        -3.4520228422801557e-7,
        4.891439260590336e-9,
        -4.765585354000485e-11,
        3.0555490283900836e-13,
        -1.164386345620941e-15,
        2.0028797070516057e-18,
    ],
    &[
        1.,
        -0.14965658610672877,
        0.010097084940526729,
        -0.00040445559973314614,
        0.000010652745992913104,
        -1.9278434924670082e-7,
        2.427880182163206e-9,
        -2.101198499712402e-11,
        1.1960597272125035e-13,
        -4.043982549032767e-16,
        6.167836726683654e-19,
    ],
    &[
        1.,
        -0.1348748021507703,
        0.008198507902867254,
        -0.0002957846684794216,
        7.01434930266902e-6,
        -1.1425255213183806e-7,
        1.2945794262725929e-9,
        -1.0076410665647271e-11,
        5.156431457613292e-14,
        -1.5666535551727524e-16,
        2.1461599148329287e-19,
    ],
    &[
        1.,
        -0.12272209673756239,
        0.006786052909682898,
        -0.00022266012574519958,
        4.800953480903837e-6,
        -7.108255104997741e-8,
        7.319152649511702e-10,
        -5.175412165906975e-12,
        2.4052531330703496e-14,
        -6.634610922614968e-17,
        8.248718691691447e-20,
    ],
    &[
        1.,
        -0.11255965927723624,
        0.0057076487251543065,
        -0.00017170348450232782,
        3.3937041117734584e-6,
        -4.60499034584262e-8,
        4.3446142762745666e-10,
        -2.8142411382182147e-12,
        1.1978428653476728e-14,
        -3.025305087167816e-17,
        3.443037154379174e-20,
    ],
    &[
        1.,
        -0.10393888155393825,
        0.0048661291400995,
        -0.00013513568515517008,
        2.465246301782162e-6,
        -3.08701412590246e-8,
        2.687261674728567e-10,
        -1.6057988628189192e-12,
        6.304053022448376e-15,
        -1.4682331350975602e-17,
        1.5405842574332685e-20,
    ],
    &[
        1.,
        -0.08649312295181769,
        0.003327254832604006,
        -0.00007471694760136911,
        1.0794064063264486e-6,
        -1.0403625880432427e-8,
        6.689988096700056e-11,
        -2.7677052882996366e-13,
        6.684640608133094e-16,
        -7.181389499373219e-19,
    ],
    &[
        1.,
        -0.08281295860960466,
        0.003049972191290626,
        -0.000065568862401534,
        9.067907195006866e-7,
        -8.366125310316514e-9,
        5.149389044676997e-11,
        -2.038981016440316e-13,
        4.713089611575599e-16,
        -4.845523906257695e-19,
    ],
    &[],
];

pub const SPLITS: [f64; 21] = [
    0.,
    0.37004016932894235,
    2.23048079228891,
    5.9513620382088455,
    13.393124530048716,
    20.834887021888587,
    28.276649513728458,
    35.71841200556833,
    43.1601744974082,
    50.601936989248074,
    58.04369948108794,
    65.48546197292781,
    72.92722446476769,
    80.36898695660756,
    87.81074944844742,
    95.25251194028729,
    102.69427443212717,
    110.13603692396704,
    114.78713848136695,
    119.43824003876688,
    std::f64::INFINITY,
];
