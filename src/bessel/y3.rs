#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-3)
        * polynomial(
            x2,
            &[
                -5.092958178940651,
                -0.6366197723675813,
                -0.07957747154594767,
                -0.01369525874539521,
                0.001374036168631131,
                -0.00004160405917439329,
                6.497900575671194e-7,
            ],
        )
        + x.powi(3)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.01326291192432461,
                    -0.0008289319952702882,
                    0.00002072329988175721,
                    -2.878236094688501e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                2.785211504108168,
                14.1001332395476,
                32.31280534062992,
                -91.8895401874163,
                930.38159439759,
                -18123.05814086973,
                559549.4200993529,
                -2.478629071846352e7,
                1.480636616390439e9,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 5.497787143782138
        + x1 * polynomial(
            x1,
            &[
                4.375,
                0.0,
                1.002604166666667,
                0.0,
                -11.8603515625,
                0.0,
                -24.79629516601562,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 12] = [
    &[
        -54.07130745185645,
        61.89594413066375,
        -26.0306940129599,
        9.35733397305258,
        -3.059395912154622,
        0.938553829338446,
        -0.2750496733500023,
        0.07787405955216189,
        -0.02146293330888176,
        0.00578907874978052,
        -0.001534051154127192,
        0.00040054250316764,
        -0.0001032794827166154,
        0.0000263455114863998,
        -6.658002690647931e-6,
        1.668894036518069e-6,
        -4.153131499491696e-7,
        1.026906173106648e-7,
        -2.524560505866558e-8,
        6.174318581543893e-9,
        -1.502981250369581e-9,
        3.643036644275343e-10,
        -8.795879143560589e-11,
        2.116123790299445e-11,
        -5.074258783597459e-12,
        1.213063405453623e-12,
        -2.891842140496236e-13,
        6.876950387687332e-14,
        -1.635898395691236e-14,
        4.074157677437033e-15,
        -9.11371229184247e-16,
    ],
    &[
        -6.280337092848251,
        3.83709784511482,
        -0.8669893840859305,
        0.1652536746128512,
        -0.0285118383621556,
        0.004607214800264659,
        -0.0007101647642169152,
        0.0001056566322261935,
        -0.00001529203332704526,
        2.164970569439028e-6,
        -3.010195461355954e-7,
        4.122849752831242e-8,
        -5.575248604418078e-9,
        7.457341031639117e-10,
        -9.88071561451607e-11,
        1.298347083925226e-11,
        -1.693612968950303e-12,
        2.194881431708083e-13,
        -2.827993996962923e-14,
        3.624673920923945e-15,
        -4.623798945985059e-16,
        5.872939102235947e-17,
        -7.430213121338959e-18,
        9.36652759732628e-19,
        -1.176827564283801e-19,
        1.474058684843233e-20,
        -1.84112392074571e-21,
        2.293543918384129e-22,
        -2.850772621808908e-23,
        3.587607443538907e-24,
        -4.371692030589686e-25,
    ],
    &[
        -1.771808856958605,
        1.046077400123576,
        -0.2732227757411343,
        0.06271757391886983,
        -0.01269935163630509,
        0.002430723755173304,
        -0.0004455958175794515,
        0.00007887070317530336,
        -0.00001358793001448252,
        2.29087606096749e-6,
        -3.7942870026432e-7,
        6.191645687360915e-8,
        -9.97722968675739e-9,
        1.590431372459223e-9,
        -2.511547191997058e-10,
        3.93363902617738e-11,
        -6.116337262400319e-12,
        9.44887773853807e-13,
        -1.45129106178621e-13,
        2.217502856281314e-14,
        -3.37228032241053e-15,
        5.106441294712594e-16,
        -7.702107177862196e-17,
        1.157546907616727e-17,
        -1.733923325780368e-18,
        2.589366735447014e-19,
        -3.855916938613947e-20,
        5.726956402872738e-21,
        -8.48891889098331e-22,
        1.281480975225018e-22,
        -1.850072910601267e-23,
    ],
    &[
        -0.5151881383448683,
        0.3810290709676227,
        -0.03159358855036965,
        0.01407536344861905,
        -0.004096005398835672,
        0.0007262439024552834,
        -0.0001403279141906005,
        0.00002828418683149329,
        -5.390121880261955e-6,
        9.99197398226576e-7,
        -1.8271535499686e-7,
        3.295229784916742e-8,
        -5.869325746910826e-9,
        1.034447139183391e-9,
        -1.806555898674451e-10,
        3.129651414879379e-11,
        -5.383224379819879e-12,
        9.20083825628758e-13,
        -1.563634841503195e-13,
        2.643682433166553e-14,
        -4.448957840927836e-15,
        7.455272021326361e-16,
        -1.244465498649275e-16,
        2.069926651234212e-17,
        -3.431642127013199e-18,
        5.671948665334466e-19,
        -9.34851258798683e-20,
        1.536832284401173e-20,
        -2.521999865918057e-21,
        4.233244958915046e-22,
        -6.732545290744919e-23,
    ],
    &[
        0.1319632756584337,
        0.1202294764263754,
        -0.1828056189059086,
        -0.007148003216890041,
        0.00984927591099772,
        0.0007780749518321715,
        -0.0003216606696630852,
        -8.138749227134566e-6,
        3.040475178825924e-6,
        4.461029531641499e-7,
        -9.06434361507036e-8,
        7.804170983107224e-9,
        -1.478626171793789e-9,
        3.327035060125148e-10,
        -6.090932172868084e-11,
        1.085425267678246e-11,
        -1.970282790132976e-12,
        3.561135662975384e-13,
        -6.384263219200039e-14,
        1.138798955955427e-14,
        -2.022745875298399e-15,
        3.578179652307988e-16,
        -6.305894827404662e-17,
        1.107469851678372e-17,
        -1.938801178892145e-18,
        3.38417515516518e-19,
        -5.890911005234745e-20,
        1.022856675721725e-20,
        -1.773264138405935e-21,
        3.152946290652339e-22,
        -5.281107555817152e-23,
    ],
    &[
        -0.0259868394680889,
        0.04805683507154834,
        -0.03194810528001732,
        -0.1882402938101566,
        0.03225827472259172,
        0.04076106854319426,
        -0.004973887721563381,
        -0.003614732124256936,
        0.0003419506348452766,
        0.0001805201249215873,
        -0.0000139605016943271,
        -5.804874154341418e-6,
        3.804727321958394e-7,
        1.307383414055138e-7,
        -7.494260335592088e-9,
        -2.170500785608974e-9,
        1.104650517746544e-10,
        2.788925347040439e-11,
        -1.301279173314453e-12,
        -2.794914589868184e-13,
        1.145427886236142e-14,
        2.424624723108639e-15,
        -1.084049905573065e-16,
        -1.29078222243701e-17,
        3.544293521108226e-20,
        1.904288603657612e-19,
        -2.074038010340025e-20,
        2.681503870722432e-21,
        -5.439447248284525e-22,
        1.041642366246376e-22,
        -1.76312392816819e-23,
    ],
    &[
        -0.07161793103405625,
        0.02064517540879286,
        -0.1490157076667507,
        -0.04205712370740147,
        0.08456292256842413,
        0.007711503395940093,
        -0.01216304321266264,
        -0.0005687092984501974,
        0.0008357049930871829,
        0.00002297003351497651,
        -0.000034088531926181,
        -5.871059101762074e-7,
        9.2654450790722e-7,
        1.028185322685382e-8,
        -1.804122851865013e-8,
        -1.288803941001421e-10,
        2.645013213492592e-10,
        1.175171877553794e-12,
        -3.028197118074127e-12,
        -7.624724318132576e-15,
        2.783981878895486e-14,
        3.066516672582631e-17,
        -2.101321044570022e-16,
        -7.176844058057459e-21,
        1.325827397143086e-18,
        -1.039939161788844e-21,
        -7.098242939521588e-21,
        1.008359623567662e-23,
        3.265700318492513e-23,
        -6.23741336092692e-26,
        -1.30511767790815e-25,
    ],
    &[
        -0.04071779253152925,
        -0.003316654278539668,
        -0.08955426731629537,
        0.0981507604417747,
        0.04638711233369518,
        -0.02538028302716077,
        -0.00634942582166478,
        0.002524187907573431,
        0.0004191952905252276,
        -0.0001357623317101574,
        -0.00001649422106599963,
        4.605462710235234e-6,
        4.332297813670513e-7,
        -1.078457386214619e-7,
        -8.160476608933774e-9,
        1.851180905751377e-9,
        1.158503363501376e-10,
        -2.431674867215821e-11,
        -1.285635278318956e-12,
        2.524976685724577e-13,
        1.146915367967892e-14,
        -2.125719424852897e-15,
        -8.409348499971232e-17,
        1.480766258310506e-17,
        5.159753561749837e-19,
        -8.67868171219351e-20,
        -2.689147965747958e-21,
        4.339838576159222e-22,
        1.205573124590117e-23,
        -1.866623176887799e-24,
        -4.699212946680662e-26,
    ],
    &[
        0.02547376763623349,
        -0.01180664019603335,
        0.05021331225415027,
        0.1001472324397514,
        -0.03225854654972369,
        -0.02448703691736902,
        0.005016804038120962,
        0.002340832848264041,
        -0.000368932679611,
        -0.0001218740821401488,
        0.00001598954170633648,
        4.020020866656644e-6,
        -4.585758975157237e-7,
        -9.18238793552991e-8,
        9.36085616062482e-9,
        1.541066778208785e-9,
        -1.430491022246415e-10,
        -1.98283163690561e-11,
        1.698631566692664e-12,
        2.019647270300981e-13,
        -1.612928946605656e-14,
        -1.669880370209069e-15,
        1.252949302150055e-16,
        1.143607620731893e-17,
        -8.111774598457885e-19,
        -6.595573170224208e-20,
        4.444839466626618e-21,
        3.248165416009596e-22,
        -2.088370113924113e-23,
        -1.377005879378548e-24,
        8.507055959981871e-26,
    ],
    &[
        0.04953565589141953,
        -0.00370221152301354,
        0.1038256237740783,
        -0.0119386756783185,
        -0.05949104611232532,
        0.003881809478410481,
        0.008702950566700148,
        -0.0004473889351948292,
        -0.0006098931994033318,
        0.00002704021289663091,
        0.00002537299147243557,
        -1.012172492344502e-6,
        -7.021737160310711e-7,
        2.581543596829125e-8,
        1.388772936450472e-8,
        -4.777250029391116e-10,
        -2.063200125243019e-10,
        6.708379584342307e-12,
        2.388410859619525e-12,
        -7.39335572619028e-14,
        -2.216148795050675e-14,
        6.565829781411193e-16,
        1.685608539205605e-16,
        -4.799066235036493e-18,
        -1.070335072512187e-18,
        2.937647395672061e-20,
        5.760773858071367e-21,
        -1.528059698545731e-22,
        -2.662017863168185e-23,
        6.811656806386844e-25,
        1.067708397236312e-25,
    ],
    &[
        0.01131607423535785,
        0.006544728881669315,
        0.02555842698877136,
        -0.0915372106389457,
        -0.01254637991131023,
        0.02323237513294103,
        0.00164702171674416,
        -0.00229113239868897,
        -0.0001038304415803911,
        0.0001228345027260486,
        3.86681956084151e-6,
        -4.167744702792979e-6,
        -9.49844739094241e-8,
        9.78303265222286e-8,
        1.64830309432302e-9,
        -1.685553996837651e-9,
        -2.11617982221987e-11,
        2.223999256105259e-11,
        2.074952077255264e-13,
        -2.320332879625771e-13,
        -1.586650904263359e-15,
        1.962781647427098e-15,
        9.56042556288358e-18,
        -1.373604824309235e-17,
        -4.521288427230143e-20,
        8.085974618097803e-20,
        1.62251895998467e-22,
        -4.060016990909738e-22,
        -3.856007653933721e-25,
        1.752848620268631e-24,
        1.282582274267756e-28,
    ],
    &[
        -0.03506686337121689,
        0.006400164627397429,
        -0.07226316555908618,
        -0.04972416866419793,
        0.04292357814129062,
        0.0120834490625848,
        -0.006424822184728871,
        -0.001150382350544622,
        0.0004596843362432179,
        0.00005968733858631999,
        -0.00001950921042892362,
        -1.96215134874445e-6,
        5.505117564078658e-7,
        4.46543880202568e-8,
        -1.109756707070225e-8,
        -7.462531947478263e-10,
        1.679673481554136e-10,
        9.5537577092486e-12,
        -1.980032636322172e-12,
        -9.67386164009398e-14,
        1.869879601181496e-14,
        7.94378382795157e-16,
        -1.446691961016346e-16,
        -5.397681275018376e-18,
        9.33862732947617e-19,
        3.085632183207089e-20,
        -5.106442494749258e-21,
        -1.504794096055755e-22,
        2.395792432136935e-23,
        6.31168702166096e-25,
        -9.75027722226032e-26,
    ],
];

pub const SPLITS: [f64; 13] = [
    0.3211738409598139,
    0.7905644744503704,
    1.259955107940927,
    2.19873637492204,
    4.076298908884266,
    7.831423976808718,
    15.34167411265762,
    22.85192424850653,
    30.36217438435543,
    37.87242452020434,
    45.38267465605324,
    52.89292479190215,
    60.40317492775105,
];
