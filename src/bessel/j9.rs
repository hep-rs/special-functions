#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(9)
        * polynomial(
            x2,
            &[
                5.382288910934744e-9,
                -1.345572227733686e-10,
                1.529059349697371e-12,
                -1.061846770623174e-14,
                5.105032551072952e-17,
                -1.823225911097483e-19,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                25.7035233093411,
                1518.114345457959,
                94565.872769152,
                5.6887282837693e6,
                3.110312189150865e8,
                1.446943149661225e10,
                5.206411511727444e11,
                1.208050171080509e13,
                9.98319238601254e13,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 14.92256510455152
        + x1 * polynomial(
            x1,
            &[
                40.375,
                0.0,
                251.5026041666667,
                0.0,
                4360.0583984375,
                0.0,
                36993.98662894113,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 17] = [
    &[
        0.002619474497719237,
        0.004565396951538228,
        0.003001788119019435,
        0.001455780926425794,
        0.0004932738877492536,
        0.0001002685737308124,
        3.96947956355423e-6,
        -3.828052329160505e-6,
        -9.21857724920662e-7,
        -1.320212996057506e-8,
        2.357461612637148e-8,
        2.185441009085665e-9,
        -3.074310029312073e-10,
        -4.384681516499559e-11,
        2.565236682848858e-12,
        4.866379339539514e-13,
        -1.513438884583324e-14,
        -3.64950325129074e-15,
        6.684488230487192e-17,
        2.016719988615879e-17,
        -2.292143920088234e-19,
        -8.639891922081335e-20,
        6.248602534301898e-22,
        2.970006215628378e-22,
        -1.373182118101229e-24,
        -8.401567831337374e-25,
        2.441315611442136e-27,
        1.994351782884188e-27,
        -3.46757731331739e-30,
        -4.028348102139518e-30,
        3.739480574846942e-33,
    ],
    &[
        0.1497821359251344,
        0.1629937723179948,
        0.01597679982005843,
        -0.01359769212569169,
        -0.0042800867811847,
        2.526606990364761e-6,
        0.0001760664849094361,
        0.00001878116242929849,
        -2.920730499281971e-6,
        -6.00189344702118e-7,
        1.721001486116738e-8,
        9.66368043906425e-9,
        1.478818793167012e-10,
        -9.96824835254101e-11,
        -3.877768452810812e-12,
        7.299510810137724e-13,
        3.977639974091232e-14,
        -4.030782459931832e-15,
        -2.662559722033779e-16,
        1.748406731091288e-17,
        1.314780232175333e-18,
        -6.137664613998332e-20,
        -5.073757700843748e-21,
        1.784000714899566e-22,
        1.584949662863973e-23,
        -4.372043306816217e-25,
        -4.107566154286283e-26,
        9.16786062252464e-28,
        8.996995573421815e-29,
        -1.662502484993747e-30,
        -1.690220095692942e-31,
    ],
    &[
        0.1004758834116752,
        -0.07656259426576201,
        0.1819331842372464,
        -0.0569831991174666,
        -0.1165070156079492,
        0.00899695721498096,
        0.02316075625102439,
        0.0005134867316892657,
        -0.002329982917290766,
        -0.0001796055939866087,
        0.0001420430658317884,
        0.0000161821793039845,
        -5.802182450676582e-6,
        -8.328174956980199e-7,
        1.694282239678973e-7,
        2.903680300944734e-8,
        -3.699237441515219e-9,
        -7.434707062626078e-10,
        6.237908134821476e-11,
        1.468398379585058e-11,
        -8.317269945125749e-13,
        -2.314355543193723e-13,
        8.91299859159812e-15,
        2.98521351918735e-15,
        -7.747662212620775e-17,
        -3.213809236487216e-17,
        5.463147434949446e-19,
        2.933963357827437e-19,
        -3.074271881382529e-21,
        -2.28567030037927e-21,
        1.301461082281828e-23,
    ],
    &[
        -0.04160320230018431,
        -0.02849397949983566,
        -0.04619716144182962,
        -0.06451519056812783,
        0.1072580750959129,
        0.02901080458887496,
        -0.02827712802002489,
        -0.004855423186621908,
        0.003273094166658464,
        0.0004537763379136352,
        -0.0002198440845013234,
        -0.00002746398506167383,
        9.77755742376474e-6,
        1.164159740564683e-6,
        -3.113170198571903e-7,
        -3.639769881884061e-8,
        7.474787850395108e-9,
        8.722342652506247e-10,
        -1.404850853021061e-10,
        -1.651047549285987e-11,
        2.126062950815157e-12,
        2.529207332765818e-13,
        -2.649118724280235e-14,
        -3.198560213185385e-15,
        2.767168604572075e-16,
        3.395287252279872e-17,
        -2.459595447322371e-18,
        -3.06785786986868e-19,
        1.883946954840168e-20,
        2.371792724696506e-21,
        -1.2568175864256e-22,
    ],
    &[
        0.0287880007998705,
        0.03190946026558761,
        0.02608684297808317,
        0.05051760024405977,
        -0.0931436302970189,
        -0.02644082921919752,
        0.02749836036225003,
        0.004583229359095461,
        -0.003482109983830063,
        -0.0004218744355432863,
        0.0002523249025766995,
        0.00002463574849217295,
        -0.00001197567131774358,
        -1.004294778138666e-6,
        4.035104685662661e-7,
        3.033855651395583e-8,
        -1.018869055979288e-8,
        -7.074704390922616e-10,
        2.00455814272009e-10,
        1.312223010399887e-11,
        -3.16484510334641e-12,
        -1.981303952014401e-13,
        4.103373381462788e-14,
        2.481055121016244e-15,
        -4.450919327940634e-16,
        -2.616841416031017e-17,
        4.101224204595768e-18,
        2.355374065431903e-19,
        -3.251679862410838e-20,
        -1.817293855846892e-21,
        2.242347389599733e-22,
    ],
    &[
        -0.02570975333147689,
        -0.01456469999791551,
        -0.02144090474347936,
        -0.02339404346653824,
        0.08949781408144456,
        0.01192377637178321,
        -0.02738648696520012,
        -0.002009455446411793,
        0.00357833912714023,
        0.0001792855357278509,
        -0.0002670378960261356,
        -0.00001014839789419492,
        0.00001302799719677571,
        4.024887200370125e-7,
        -4.503062689694031e-7,
        -1.19057521649561e-8,
        1.163905162092276e-8,
        2.739952526662915e-10,
        -2.339105246344306e-10,
        -5.054939501806394e-12,
        3.764913048533448e-12,
        7.644005747497472e-14,
        -4.967380363216972e-14,
        -9.63935501660213e-16,
        5.474076132143507e-16,
        1.027950847903689e-17,
        -5.117002260701263e-18,
        -9.38008608326852e-20,
        4.110418683582493e-20,
        7.348123758179239e-22,
        -2.868478940938169e-22,
    ],
    &[
        0.02318079039528179,
        -0.007745891970267041,
        0.01867646859121612,
        -0.005885637496791591,
        -0.082926222501987,
        0.0059147216502369,
        0.02571168797667461,
        -0.001342012180182286,
        -0.003399293454826223,
        0.0001460428445196168,
        0.0002565868806936169,
        -9.4968197525778e-6,
        -0.0000126574032839932,
        4.130748352091133e-7,
        4.4215797910461e-7,
        -1.28945548641745e-8,
        -1.154338305767541e-8,
        3.033019008281017e-10,
        2.341624293571574e-10,
        -5.572624071161819e-12,
        -3.801550611042562e-12,
        8.222737275824815e-14,
        5.055385743031845e-14,
        -9.96214929676566e-16,
        -5.611119422224014e-16,
        1.009061374120625e-17,
        5.279256622835789e-18,
        -8.674539504071741e-20,
        -4.265688496222212e-20,
        6.369026725953155e-22,
        2.992610296839733e-22,
    ],
    &[
        -0.01902242927467919,
        0.02915047340742463,
        -0.01520216411053831,
        0.03263815363670915,
        0.06853020211572027,
        -0.02291221190750499,
        -0.02132750742688699,
        0.004599952553239211,
        0.002829805507807128,
        -0.0004663059851028845,
        -0.0002143790776576122,
        0.00002898861694528965,
        0.00001061394663624749,
        -1.225821189750317e-6,
        -3.721068525995455e-7,
        3.765523527735558e-8,
        9.74823470764073e-9,
        -8.797473570185851e-10,
        -1.983968134629952e-10,
        1.617403105379082e-11,
        3.230791655724859e-12,
        -2.40248364232348e-13,
        -4.308538811800348e-14,
        2.944667042494974e-15,
        4.794529310474213e-16,
        -3.029958460199916e-17,
        -4.521515890248993e-18,
        2.655293763136591e-19,
        3.661116003746102e-20,
        -1.992940345589474e-21,
        -2.573308857794287e-22,
    ],
    &[
        0.01297237282852169,
        -0.04539919240830107,
        0.01059337613301673,
        -0.05265456765614473,
        -0.04613290178954857,
        0.03579640963186572,
        0.01428965657863881,
        -0.007084992705305098,
        -0.001889728797835439,
        0.000711594928755934,
        0.000142765636587956,
        -0.00004395793221480003,
        -7.051014657721792e-6,
        1.851039303586489e-6,
        2.46640973400556e-7,
        -5.671941860148823e-8,
        -6.447782937225467e-9,
        1.32369687723385e-9,
        1.30964799814009e-10,
        -2.433750241742477e-11,
        -2.128645788153313e-12,
        3.618786605530339e-13,
        2.833561339830361e-14,
        -4.443532940405961e-15,
        -3.147658826394838e-16,
        4.583534263210459e-17,
        2.96343172777924e-18,
        -4.028794762894785e-19,
        -2.395653867045213e-20,
        3.03406161811698e-21,
        1.681256819005624e-22,
    ],
    &[
        -0.005659621062996368,
        0.05343196432258303,
        -0.005204013939342755,
        0.06267498303309551,
        0.01848356274760444,
        -0.04216846212589827,
        -0.005521770294634797,
        0.008305792269241015,
        0.0007093779516034024,
        -0.0008314596917767529,
        -0.00005217526105197462,
        0.00005124025620186033,
        2.511198935306883e-6,
        -2.154027179334511e-6,
        -8.565268329165039e-8,
        6.592761337299428e-8,
        2.184425983640785e-9,
        -1.537527666420263e-9,
        -4.330456662090772e-11,
        2.826029164563078e-11,
        6.873142033323029e-13,
        -4.202143392216228e-13,
        -8.939418972367994e-15,
        5.161329636047699e-15,
        9.70906892555899e-17,
        -5.326681139227836e-17,
        -8.943845926317237e-19,
        4.685264241638868e-19,
        7.080344924311237e-21,
        -3.531400959129467e-21,
        -4.870364037937445e-23,
    ],
    &[
        -0.001820156835037879,
        -0.05181543910254434,
        -0.000250192401949421,
        -0.06117398768797771,
        0.00998503067094869,
        0.04090134302811417,
        -0.003531681441429466,
        -0.008030644922317162,
        0.0005124021840147044,
        0.0008020121643762439,
        -0.00004181435865070401,
        -0.00004933080178687463,
        2.209668002986323e-6,
        2.0704596099132e-6,
        -8.212334446205696e-8,
        -6.328554179749381e-8,
        2.268013272438159e-9,
        1.474265615037726e-9,
        -4.842523187392953e-11,
        -2.707229232097493e-11,
        8.237319667173776e-13,
        4.022381260622259e-13,
        -1.142989770938716e-14,
        -4.937378355749797e-15,
        1.318655989992103e-16,
        5.092883576939771e-17,
        -1.285003659569912e-18,
        -4.477704875763706e-19,
        1.071871199464811e-20,
        3.373795805035666e-21,
        -7.739336240814116e-23,
    ],
    &[
        0.00823535790506671,
        0.04102273886141614,
        0.004945483259639259,
        0.04878014736675063,
        -0.03435993476113323,
        -0.03237242150936028,
        0.01127957093464078,
        0.006329721606901117,
        -0.001557738718696404,
        -0.0006300010169312369,
        0.0001222186272339993,
        0.000038633773071343,
        -6.247788533926497e-6,
        -1.617005185613462e-6,
        2.256248518066139e-7,
        4.929764462576382e-8,
        -6.076009176462886e-9,
        -1.145621337779612e-9,
        1.268725230959212e-10,
        2.098897013704459e-11,
        -2.115864893367266e-12,
        -3.111717212588999e-13,
        2.884627230331403e-14,
        3.811611850088642e-15,
        -3.276028974307591e-16,
        -3.923841674789023e-17,
        3.147871441590034e-18,
        3.44330085627692e-19,
        -2.592968532836265e-20,
        -2.589692543317572e-21,
        1.851300431779377e-22,
    ],
    &[
        -0.01251723831094191,
        -0.02333986795242776,
        -0.008160044261986,
        -0.02820431477557201,
        0.05040166676145655,
        0.01839221761884202,
        -0.01635215163642155,
        -0.003559037153803848,
        0.002239456997504094,
        0.0003510828058520885,
        -0.0001744742466654026,
        -0.00002135103876020525,
        8.863859470139277e-6,
        8.86530594140805e-7,
        -3.183118497989817e-7,
        -2.681864883304681e-8,
        8.52851018221251e-9,
        6.185209113290604e-10,
        -1.772561358617284e-10,
        -1.124782559757524e-11,
        2.943538589910299e-12,
        1.655375118253498e-13,
        -3.99735274224055e-14,
        -2.01314384879943e-15,
        4.523460996542546e-16,
        2.057768731994599e-17,
        -4.332196031800673e-18,
        -1.7931944004869e-19,
        3.55773384372579e-20,
        1.339478277057701e-21,
        -2.533063670441299e-22,
    ],
    &[
        0.01400054962128274,
        0.002391178063828401,
        0.0094393298836976,
        0.003703953735766523,
        -0.05548694302559887,
        -0.001829597004638116,
        0.01790374414935726,
        0.0002851294067375369,
        -0.00244219746550089,
        -0.00002216593707816031,
        0.0001896197915947986,
        1.004291228849105e-6,
        -9.60363569510787e-6,
        -2.779198705787736e-8,
        3.439008166541117e-7,
        4.259263692987286e-10,
        -9.18984996746179e-9,
        -3.390959037672678e-13,
        1.905314569950109e-10,
        -1.652436540327826e-13,
        -3.156693675660683e-12,
        4.941718046002107e-15,
        4.277533642523103e-14,
        -9.04683922334838e-17,
        -4.830654875144744e-16,
        1.233536016224955e-18,
        4.617523600433159e-18,
        -1.3424313053383e-20,
        -3.785194013376996e-20,
        1.19992547829311e-22,
        2.690413360757092e-22,
    ],
    &[
        -0.01256782952945099,
        0.01761702962787415,
        -0.008695454290361416,
        0.0197894514713633,
        0.04917363521067039,
        -0.01398667799296964,
        -0.0157941315455644,
        0.002834154713754085,
        0.002147059364675232,
        -0.0002906399761956051,
        -0.000166202151636311,
        0.00001831435896616912,
        8.394167927655454e-6,
        -7.863435132807522e-7,
        -2.998009162401142e-7,
        2.456139923945571e-8,
        7.991343492994121e-9,
        -5.84166839593058e-10,
        -1.652856061942868e-10,
        1.094337925602014e-11,
        2.732106568042311e-12,
        -1.657499186444132e-13,
        -3.693954274135895e-14,
        2.072550006854597e-15,
        4.16265197211614e-16,
        -2.176291215636026e-17,
        -3.970726797988889e-18,
        1.94656053941591e-19,
        3.248437778022178e-20,
        -1.490958246523641e-21,
        -2.304401652038199e-22,
    ],
    &[
        0.008672460127647177,
        -0.03277082174641171,
        0.006225087884875483,
        -0.03768484205325266,
        -0.0332848679957888,
        0.02595984776088639,
        0.01061476943121833,
        -0.00518712545654393,
        -0.00143507250967991,
        0.0005258942269975451,
        0.000110538605605594,
        -0.0000328037544866007,
        -5.556713237996916e-6,
        1.39538634417747e-6,
        1.975638391932265e-7,
        -4.320784949855227e-8,
        -5.242988255716229e-9,
        1.019305889248983e-9,
        1.079737101293148e-10,
        -1.894866713119921e-11,
        -1.777204349413715e-12,
        2.849188706682878e-13,
        2.392857294505922e-14,
        -3.538174387809846e-15,
        -2.685388453817856e-16,
        3.691057354899485e-17,
        2.551192046633193e-18,
        -3.2809837135306e-19,
        -2.07877188746614e-20,
        2.498355164841733e-21,
        1.46883213184746e-22,
    ],
    &[
        -0.003239086821705455,
        0.04025226920152043,
        -0.002645004998849793,
        0.04666662996744578,
        0.01150608102650321,
        -0.03186108398926868,
        -0.003557703654829789,
        0.006334408510683184,
        0.0004691942689857188,
        -0.0006395396070041514,
        -0.00003530985055596953,
        0.00003974254381398282,
        1.735014706409294e-6,
        -1.684613252650258e-6,
        -6.029893059481429e-8,
        5.199062482793211e-8,
        1.563943822866371e-9,
        -1.222621410666001e-9,
        -3.146823906865059e-11,
        2.265952850358356e-11,
        5.05875566703916e-13,
        -3.397284835853149e-13,
        -6.649553063817401e-15,
        4.207053995257314e-15,
        7.28203404350757e-17,
        -4.37707530321435e-17,
        -6.747544640149705e-19,
        3.880746195918851e-19,
        5.359706973803246e-21,
        -2.947756008180245e-21,
        -3.68981906340674e-23,
    ],
];

pub const SPLITS: [f64; 18] = [
    0.603631718818869,
    5.559208841011044,
    10.51478596320322,
    20.42594020758757,
    30.33709445197192,
    40.24824869635627,
    50.15940294074062,
    60.07055718512497,
    69.98171142950932,
    79.89286567389366,
    89.80401991827801,
    99.7151741626624,
    109.6263284070467,
    119.5374826514311,
    129.4486368958154,
    139.3597911401998,
    149.2709453845841,
    159.1820996289685,
];
