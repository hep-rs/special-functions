use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-4)
        * polynomial(
            x2,
            &[
                48.,
                -4.,
                0.25,
                -0.020833333333333332,
                0.0030145785998048936,
                0.00022885392999024467,
                5.6720147451671345e-6,
                7.521296921999172e-8,
            ],
        )
        + x.powi(4)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.0026041666666666665,
                    -0.00013020833333333333,
                    -2.7126736111111112e-6,
                    -3.229373346560847e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                9.869848831359564,
                33.9276053577985,
                55.132358706422565,
                25.843293143635577,
                -10.98339958604512,
                13.04278700842858,
                -24.455225640803587,
                61.52017700264652,
                -192.2505531332704,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 10] = [
    &[
        260.7605564571732,
        -320.660544611516,
        136.35282764299998,
        -47.64275500233984,
        14.726321553155127,
        -4.184961074009106,
        1.1185625012606473,
        -0.28531549284334995,
        0.07014354273316374,
        -0.016738150942191655,
        0.0038970939194134272,
        -0.0008887911340822324,
        0.00019916544129784262,
        -0.00004395798199475069,
        9.574601021083628e-6,
        -2.0613788510287003e-6,
        4.3926331788771694e-7,
        -9.274798073583414e-8,
        1.942247643610813e-8,
        -4.0371404628473e-9,
        8.335125491508849e-10,
        -1.710328019826593e-10,
        3.489815540032315e-11,
        -7.084030093617438e-12,
        1.4311622346924062e-12,
        -2.8786157925786166e-13,
        5.766386567790385e-14,
        -1.1507295650636099e-14,
        2.2882522423532684e-15,
        -4.535198550915413e-16,
        8.960693054364492e-17,
        -1.7653161417324728e-17,
        3.4682811359810336e-18,
        -6.796507209717454e-19,
        1.3286173865734388e-19,
        -2.5912812336714995e-20,
        5.042928704867824e-21,
        -9.793858391854796e-22,
        1.898335023369428e-22,
        -3.6726701950332947e-23,
        7.092837081291289e-24,
        -1.3674871537112587e-24,
        2.6322440560983405e-25,
        -5.059168432102088e-26,
        9.721445509224628e-27,
        -1.9285530840607244e-27,
        3.560589783636771e-28,
    ],
    &[
        19.26259204235487,
        -15.81850731579599,
        4.11787785680867,
        -0.8561884539730822,
        0.15556518002921213,
        -0.025825933560388276,
        0.00401820594071479,
        -0.0005953191064929122,
        0.00008488566575060217,
        -0.000011736533022649856,
        1.582139983423016e-6,
        -2.088057579638066e-7,
        2.7065628265805023e-8,
        -3.454341546929831e-9,
        4.3497296439452196e-10,
        -5.412842338666261e-11,
        6.665712158516411e-12,
        -8.132436214276149e-13,
        9.839333333118456e-14,
        -1.1815111647769135e-14,
        1.4091047275968689e-15,
        -1.6701174760365867e-16,
        1.9682489976862194e-17,
        -2.3075166259352285e-18,
        2.6922784530872e-19,
        -3.1272578275485756e-20,
        3.6175694231931914e-21,
        -4.1687469739222634e-22,
        4.786772771618975e-23,
        -5.4781090311515604e-24,
        6.249731231822783e-25,
        -7.109163550711805e-26,
        8.064516509722106e-27,
        -9.124526964852714e-28,
        1.029860057326653e-28,
        -1.1596856881157033e-29,
        1.3030177183231837e-30,
        -1.4610255312858367e-31,
        1.6349651530573839e-32,
        -1.8261849687771404e-33,
        2.036131785201946e-34,
        -2.2663572596152387e-35,
        2.5185247673629544e-36,
        -2.7944214174501217e-37,
        3.096401077937121e-38,
        -3.4668965766386e-39,
        3.784205778707105e-40,
    ],
    &[
        2.725442880885127,
        -2.8479432969304725,
        0.9458785723861522,
        -0.24848409423981907,
        0.05668476470374672,
        -0.011775156205647216,
        0.002288276729600537,
        -0.0004229971050288694,
        0.00007520626202183744,
        -0.000012960175751903288,
        2.1769367378522774e-6,
        -3.5792234598153135e-7,
        5.778961598300006e-8,
        -9.186257590028288e-9,
        1.4406048659773085e-9,
        -2.2325073312595472e-10,
        3.423579245700812e-11,
        -5.201234733759691e-12,
        7.835960234580668e-13,
        -1.1716457581713695e-13,
        1.7399097225835017e-14,
        -2.5677327512879124e-15,
        3.7678855355317893e-16,
        -5.500139820475422e-17,
        7.990190742291224e-18,
        -1.1555978836886853e-18,
        1.664423500577041e-19,
        -2.3881126492446212e-20,
        3.4142323661150425e-21,
        -4.864977582693649e-22,
        6.910516908515628e-23,
        -9.787369684064305e-24,
        1.3823675225137962e-24,
        -1.9473892149099191e-25,
        2.7366385353829136e-26,
        -3.836860652054194e-27,
        5.367626690339347e-28,
        -7.493519510030275e-29,
        1.0440767838388603e-29,
        -1.4519928816695368e-30,
        2.0156787089335177e-31,
        -2.7934406051120256e-32,
        3.865030730882824e-33,
        -5.339447497301887e-34,
        7.367932318006492e-35,
        -1.0337197082398222e-35,
        1.3956093052986538e-36,
    ],
    &[
        0.2032092616190919,
        -0.26252759092153216,
        0.10881926688573697,
        -0.03478856586721191,
        0.009437430364859715,
        -0.0022952727873231946,
        0.0005173224450940464,
        -0.0001102988234415008,
        0.0000225436015909183,
        -4.456588427366297e-6,
        8.575315364373887e-7,
        -1.613541580144811e-7,
        2.979345499617247e-8,
        -5.4132938715553255e-9,
        9.699456010884923e-10,
        -1.716888413525449e-10,
        3.006576668667002e-11,
        -5.2150514884365794e-12,
        8.9688834694374e-13,
        -1.5306740187836482e-13,
        2.5942344646627162e-14,
        -4.369099763247969e-15,
        7.315921422596404e-16,
        -1.2185649151632668e-16,
        2.0198264244996427e-17,
        -3.332937524288032e-18,
        5.476864833461881e-19,
        -8.965141558681422e-20,
        1.4622371605782167e-20,
        -2.376937493754396e-21,
        3.8516844672159397e-22,
        -6.22302558404085e-23,
        1.0026460691763393e-23,
        -1.6112367267352628e-24,
        2.5828613902218457e-25,
        -4.130779078506811e-26,
        6.591833889095129e-27,
        -1.0497212376782258e-27,
        1.6683276482800383e-28,
        -2.646495046015943e-29,
        4.1906638344581926e-30,
        -6.62450411116197e-31,
        1.0454833774632527e-31,
        -1.6474491414735894e-32,
        2.5936502862885193e-33,
        -4.172763197372915e-34,
        6.390130887576625e-35,
    ],
    &[
        0.005660676709662835,
        -0.008870529555800429,
        0.0048058550300234424,
        -0.001993563060616956,
        0.0006797339653218291,
        -0.0002003437174343122,
        0.00005296575602108411,
        -0.000012910788950045114,
        2.9614585766093356e-6,
        -6.48788029893993e-7,
        1.3719936589475355e-7,
        -2.8217058437455502e-8,
        5.67408562274488e-9,
        -1.1199038641528872e-9,
        2.175788963826085e-10,
        -4.1702961766487727e-11,
        7.899396133246759e-12,
        -1.4808659651098599e-12,
        2.750692261903029e-13,
        -5.067555856965241e-14,
        9.267132331804243e-15,
        -1.6834092065971006e-15,
        3.0394567415468947e-16,
        -5.457496603515157e-17,
        9.749501914613563e-18,
        -1.7335593813882946e-18,
        3.0691474741574363e-19,
        -5.4119969343347705e-20,
        9.507825964014341e-21,
        -1.6645588973088718e-21,
        2.904762837663142e-22,
        -5.053653479496515e-23,
        8.767278502973533e-24,
        -1.516919835945012e-24,
        2.617980236660388e-25,
        -4.507520063008299e-26,
        7.74342502053407e-27,
        -1.327408653380923e-27,
        2.2709115800795753e-28,
        -3.8776097089312746e-29,
        6.609022243902324e-30,
        -1.1244951298796455e-30,
        1.910120430715328e-31,
        -3.2395805591143464e-32,
        5.490288539474165e-33,
        -9.540628107466301e-34,
        1.5664711205469042e-34,
    ],
    &[
        0.000023411277182432267,
        -0.00004149557435006391,
        0.00002926193580228332,
        -0.000016843690637418692,
        8.131573872955474e-6,
        -3.374435898102802e-6,
        1.2296316501281231e-6,
        -4.0073847455095374e-7,
        1.1867743163371789e-7,
        -3.238652352058269e-8,
        8.245851234613618e-9,
        -1.9805461536460353e-9,
        4.531924369847458e-10,
        -9.965030782512079e-11,
        2.121290958126227e-11,
        -4.3989777964078586e-12,
        8.931661761410738e-13,
        -1.7826972531478637e-13,
        3.508520255147096e-14,
        -6.824695632874382e-15,
        1.3143718290349292e-15,
        -2.509624793376622e-16,
        4.7555938503887964e-17,
        -8.950852075368547e-18,
        1.674483895478197e-18,
        -3.115304923903459e-19,
        5.766780737613855e-20,
        -1.0625805981958556e-20,
        1.949599715115367e-21,
        -3.563074210997304e-22,
        6.488210734391957e-23,
        -1.177489270328873e-23,
        2.1302007237763592e-24,
        -3.842423441874472e-25,
        6.911811356449253e-26,
        -1.2400914093630895e-26,
        2.2195106001412402e-27,
        -3.9633562010690434e-28,
        7.061985278946517e-29,
        -1.2557384316720962e-29,
        2.228573667125845e-30,
        -3.947783566941458e-31,
        6.981011774531432e-32,
        -1.2324535347761513e-32,
        2.174302343437568e-33,
        -3.940839965089989e-34,
        6.718285234596981e-35,
    ],
    &[
        2.525134980753815e-9,
        -4.4347681481362845e-9,
        3.048131826791813e-9,
        -1.685889421408773e-9,
        7.717973056962722e-10,
        -2.9974970674656736e-10,
        1.0081440706226265e-10,
        -2.9865636109603134e-11,
        7.903804974225647e-12,
        -1.8909053475380106e-12,
        4.131126519504295e-13,
        -8.31458372184788e-14,
        1.553594442803389e-14,
        -2.7136715498189725e-15,
        4.458835023944242e-16,
        -6.931673291275671e-17,
        1.0250573172263956e-17,
        -1.4493031750618013e-18,
        1.9686489131347656e-19,
        -2.5809099891670596e-20,
        3.279989717515817e-21,
        -4.0575179967934087e-22,
        4.9046593397355406e-23,
        -5.813658705849489e-24,
        6.778839482114531e-25,
        -7.796965941747129e-26,
        8.867058247613785e-27,
        -9.989853572657641e-28,
        1.1167130846905933e-28,
        -1.2401077305809849e-29,
        1.3693804443160162e-30,
        -1.5047049484229422e-31,
        1.646204547397191e-32,
        -1.7939515052378287e-33,
        1.9479736819134e-34,
        -2.1082641068421943e-35,
        2.2747905465690488e-36,
        -2.44750349568407e-37,
        2.6263420687979475e-38,
        -2.811237914749746e-39,
        3.0021175703329497e-40,
        -3.198903732485191e-41,
        3.4015159115859344e-42,
        -3.6098753920803875e-43,
        3.8243544123013403e-44,
        -4.088447503613129e-45,
        4.2685096489429394e-46,
    ],
    &[
        3.8792927092117596e-13,
        -6.793693209152976e-13,
        4.633580258556364e-13,
        -2.533126209690418e-13,
        1.1424555027118837e-13,
        -4.358047656057973e-14,
        1.435380539726998e-14,
        -4.151417862702513e-15,
        1.06908392714498e-15,
        -2.4798417257359385e-16,
        5.23172183445968e-17,
        -1.012177858382538e-17,
        1.8086105540767394e-18,
        -3.0032773970662603e-19,
        4.6598644059486063e-20,
        -6.788658026550194e-21,
        9.32655726852705e-22,
        -1.2131297608023602e-22,
        1.4994192816555948e-23,
        -1.7670005791164512e-24,
        1.991702652185539e-25,
        -2.1537254110508472e-26,
        2.2406866832443442e-27,
        -2.2490549551596096e-28,
        2.183820707182489e-29,
        -2.0567247855577382e-30,
        1.8836549993613953e-31,
        -1.6818891496502476e-32,
        1.4677383343433228e-33,
        -1.2549146874751096e-34,
        1.053706045289357e-35,
        -8.708539814271185e-37,
        7.099302046202652e-38,
        -5.719846623138093e-39,
        4.562723684966492e-40,
        -3.609256558755235e-41,
        2.835003140299645e-42,
        -2.2137362244730758e-43,
        1.720045085775111e-44,
        -1.330821674235686e-45,
        1.0259373752801599e-46,
        -7.883884743179572e-48,
        6.041296698782219e-49,
        -4.617512631568005e-50,
        3.521114790417084e-51,
        -2.694445135580599e-52,
        2.0342458971612684e-53,
    ],
    &[
        4.6578026617193244e-17,
        -8.757456081785412e-17,
        7.284338503728733e-17,
        -5.378724597144281e-17,
        3.542856768662293e-17,
        -2.093740470748082e-17,
        1.1170375561192149e-17,
        -5.413478729222958e-18,
        2.397411612340793e-18,
        -9.756867776336246e-19,
        3.6681735846509774e-19,
        -1.280121989433882e-19,
        4.165153297660372e-20,
        -1.2686497420890782e-20,
        3.630671557105567e-21,
        -9.79568294562406e-22,
        2.4993764448729315e-22,
        -6.048061551269418e-23,
        1.3916513392851984e-23,
        -3.0523279532166303e-24,
        6.3958721521822465e-25,
        -1.2830715035185669e-25,
        2.4691100727974934e-26,
        -4.566390548894127e-27,
        8.13033004703383e-28,
        -1.3959384464103614e-28,
        2.3149101939543564e-29,
        -3.713385313349706e-30,
        5.770429273624019e-31,
        -8.698875524042522e-32,
        1.273896426267426e-32,
        -1.814715466070805e-33,
        2.518057398054254e-34,
        -3.407844031494454e-35,
        4.504256684376852e-36,
        -5.821953294700677e-37,
        7.36871465027535e-38,
        -9.14473685927411e-39,
        1.1142698558592897e-39,
        -1.3348615659161986e-40,
        1.5743376447198294e-41,
        -1.8304749353815465e-42,
        2.1009594059279106e-43,
        -2.38360319688761e-44,
        2.6768966771976274e-45,
        -3.014262511844149e-46,
        3.287775048279316e-47,
    ],
    &[
        1.6153463673784604e-24,
        -3.0356007742240913e-24,
        2.521224435618276e-24,
        -1.8571619429411254e-24,
        1.2192586641467356e-24,
        -7.17609474942435e-25,
        3.810063782528471e-25,
        -1.8362652725502328e-25,
        8.0817377558867e-26,
        -3.2665698969932493e-26,
        1.2189037316943194e-26,
        -4.219152345146151e-27,
        1.360720776008847e-27,
        -4.10528631252165e-28,
        1.162888005027417e-28,
        -3.1031504977102547e-29,
        7.824630910365489e-30,
        -1.869539245836237e-30,
        4.243542519782105e-31,
        -9.172123402037616e-32,
        1.8919199761435492e-32,
        -3.731641055623742e-33,
        7.05131040924601e-34,
        -1.2786859174546372e-34,
        2.2288539873139333e-35,
        -3.7400398697282855e-36,
        6.050051717050056e-37,
        -9.447215432491325e-38,
        1.4257716933691045e-38,
        -2.082122888018372e-39,
        2.9454648610579046e-40,
        -4.0406216677813094e-41,
        5.3804966432698114e-42,
        -6.961275311175345e-43,
        8.758736213250243e-44,
        -1.0726488353501524e-44,
        1.2796746656176255e-45,
        -1.4883896043537402e-46,
        1.6890643614224173e-47,
        -1.8716107274929393e-48,
        2.0264833559344847e-49,
        -2.145555385431866e-50,
        2.2228515518483414e-51,
        -2.2550469178534306e-52,
        2.2418457226520388e-53,
        -2.204620303367524e-54,
        2.0897235011125422e-55,
    ],
];

pub const SPLITS: [f64; 11] = [
    0.4946254315340674,
    1.02296928934565,
    1.5513131471572323,
    2.608000862780397,
    4.721376294026727,
    8.948127156519387,
    17.401628881504706,
    25.855130606490025,
    34.308632331475344,
    51.21563578144598,
    68.12263923141663,
];
