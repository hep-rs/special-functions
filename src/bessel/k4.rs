#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-4)
        * polynomial(
            x2,
            &[
                48.,
                -4.,
                0.25,
                -0.02083333333333333,
                0.003014578599804894,
                0.0002288539299902447,
                5.672014745167134e-6,
                7.521296921999171e-8,
            ],
        )
        + x.powi(4)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.002604166666666667,
                    -0.0001302083333333333,
                    -2.712673611111111e-6,
                    -3.229373346560847e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                9.86984883135956,
                33.9276053577985,
                55.13235870642257,
                25.84329314363558,
                -10.98339958604512,
                13.04278700842858,
                -24.45522564080359,
                61.52017700264653,
                -192.2505531332704,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 7] = [
    &[
        5.414781027323257,
        -1.255178251947076,
        -0.00355238706051888,
        -0.0003493989317993013,
        -0.00002503538518819919,
        -1.348380297977283e-6,
        -5.278346382115335e-8,
        -1.206542308767748e-9,
        1.169196687075188e-11,
        2.422369220121039e-12,
        8.898042558092514e-14,
        -1.166057974324753e-15,
        -2.94893249839998e-16,
        -1.401921373554635e-17,
        -2.901699819518793e-20,
        3.630535203545892e-20,
        2.194061716295793e-21,
        2.665913709027556e-23,
        -4.625996029792237e-24,
        -3.455788964682093e-25,
        -6.934957437604827e-27,
        5.887657361488583e-28,
        5.436762042274207e-29,
        1.465092990674322e-30,
        -7.262216181547838e-32,
        -8.511500929685889e-33,
        -2.846009823397618e-34,
        8.322297666200723e-36,
        1.322400369229076e-36,
        5.264513443518275e-38,
        -8.065614775589059e-40,
    ],
    &[
        2.856258249811642,
        -1.309724602946389,
        -0.01128838013122894,
        -0.001044046271925846,
        -0.00006678260318689252,
        -2.881568192572215e-6,
        -6.550287797585786e-8,
        8.179511028315467e-10,
        9.93168049965679e-11,
        -7.019380969800652e-13,
        -3.640048597235556e-13,
        -1.359742329454892e-14,
        5.635231511529116e-16,
        6.683195300612346e-17,
        9.32094216245455e-19,
        -1.841277686792469e-19,
        -1.085136464075343e-20,
        1.760911086262325e-22,
        4.486086771267689e-23,
        1.265962980623131e-24,
        -1.042144713949738e-25,
        -8.8335965194518e-27,
        -1.29089056230807e-30,
        3.138956365967921e-29,
        1.323335841428147e-30,
        -5.693399724070536e-32,
        -7.156786316387123e-33,
        -9.59583709593987e-35,
        2.184946057891724e-35,
        1.264120077901907e-36,
        -2.581927398068747e-38,
    ],
    &[
        0.0908057390361452,
        -1.47318521327797,
        -0.03237265758727722,
        -0.002646202816992093,
        -0.0001369375468138379,
        -3.956801905940059e-6,
        -2.438713068751061e-8,
        5.338595059688026e-10,
        -1.843163092557769e-10,
        -1.010078592460059e-11,
        3.504477471172151e-13,
        3.716130319990017e-14,
        -7.598766805208267e-16,
        -1.450801217714528e-16,
        7.988456677784496e-19,
        5.538625615582242e-19,
        4.574430185393486e-21,
        -2.061482052863627e-21,
        -4.597345956986121e-23,
        7.416306920156303e-24,
        2.822666325970977e-25,
        -2.546304796330797e-26,
        -1.470882919868403e-27,
        8.157859738193303e-29,
        7.018633278726569e-30,
        -2.323681323088204e-31,
        -3.15525901904736e-32,
        5.092237377388865e-34,
        1.352995666614575e-34,
        -2.241412951141494e-37,
        -5.560342366555859e-37,
    ],
    &[
        -3.245508380395948,
        -1.90268632413231,
        -0.08000913574500084,
        -0.00551188251548704,
        -0.0002250484383199284,
        -5.213998424135851e-6,
        -1.156962318205997e-7,
        -6.730273229258164e-9,
        -1.330256067629554e-10,
        1.011535098669753e-11,
        -6.949356879614185e-15,
        -3.844380724058806e-14,
        6.696615041782182e-16,
        1.234177458199744e-16,
        -4.773388766294855e-18,
        -3.64941833135753e-19,
        2.481063052518107e-20,
        9.04261247542869e-22,
        -1.121098952598747e-22,
        -1.314762570277462e-24,
        4.600020453468472e-25,
        -3.809613723810453e-27,
        -1.729754073915139e-27,
        4.878119516080449e-29,
        5.892497601213476e-30,
        -3.093357232957742e-31,
        -1.742794838471349e-32,
        1.580428385752058e-33,
        3.88252795363697e-35,
        -7.096809774704438e-36,
        -1.598352051582338e-38,
    ],
    &[
        -7.949663707161251,
        -2.877788220530206,
        -0.1718738590416022,
        -0.01016672605687329,
        -0.0003736333373878536,
        -0.00001046099178909406,
        -3.23218623316745e-7,
        -7.407799552451889e-9,
        -6.909353178156877e-12,
        -4.433559286213985e-12,
        -2.618129424872929e-13,
        1.63469084522657e-14,
        -5.325223440063547e-17,
        -5.00211276447137e-17,
        2.379825771841971e-18,
        5.361127365017353e-20,
        -1.016390586283547e-20,
        2.828014450162754e-22,
        2.096191685260122e-23,
        -1.900001758314209e-24,
        1.578155322144833e-26,
        5.731750437538162e-27,
        -3.1591281176851e-28,
        -5.199355856968247e-30,
        1.327132288719108e-30,
        -4.297115094930802e-32,
        -2.631313926048317e-33,
        2.708662696557775e-34,
        -3.296976552590127e-36,
        -7.961605707087256e-37,
        4.839724155668248e-38,
    ],
    &[
        -15.55073004071099,
        -4.861409219576256,
        -0.3382117557695996,
        -0.01831341694188847,
        -0.000678145068221822,
        -0.00002092168291471952,
        -5.652609494219252e-7,
        -1.107225714017313e-8,
        -2.265196523339756e-10,
        -5.802223678304769e-12,
        4.010686475791619e-14,
        -2.158065598000138e-15,
        -1.768940066616442e-16,
        1.277536239147732e-17,
        -3.355689749283242e-19,
        -1.357774353277003e-20,
        1.670715757110216e-21,
        -6.299794505524289e-23,
        -7.17371579046131e-25,
        2.11852438808344e-25,
        -1.066979979175556e-26,
        5.947849841504801e-29,
        2.565450361627416e-29,
        -1.698051248322942e-30,
        3.083618213397218e-32,
        2.859227007785963e-33,
        -2.574564507271656e-34,
        7.493529739595726e-36,
        2.697766053256891e-37,
        -3.726214001087554e-38,
        1.488225672725275e-39,
    ],
    &[
        -41.7234626920879,
        -24.19169466695999,
        -3.579568975172153,
        -0.3682773612838894,
        -0.02794693714330607,
        -0.001727038614024959,
        -0.00008823558598396537,
        -3.843468822478413e-6,
        -1.514299624959438e-7,
        -4.930650714591021e-9,
        -1.584740124471341e-10,
        -5.046383950987893e-12,
        -1.611034707644021e-14,
        -1.000524479456005e-14,
        2.030776409325412e-16,
        1.71371800080022e-17,
        -4.167660576065355e-18,
        3.909414692260666e-19,
        -1.954626685448595e-20,
        -3.753072887630011e-22,
        1.90985316562543e-22,
        -2.150720980976028e-23,
        1.319367260398667e-24,
        -7.63096604701821e-27,
        -8.918240978745999e-27,
        1.196709654740211e-27,
        -8.566527221075567e-29,
        1.897880010000907e-30,
        4.075459980882498e-31,
        -6.686836031980884e-32,
        5.441409999276929e-33,
    ],
];

pub const SPLITS: [f64; 8] = [
    -0.7039545068299899,
    -0.08829649361384495,
    0.5273615196023,
    1.143019532818445,
    1.75867754603459,
    2.374335559250735,
    2.98999357246688,
    4.22130959889917,
];
