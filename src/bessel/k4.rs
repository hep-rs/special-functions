use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                48.,
                -4.,
                0.25,
                -0.020833333333333332,
                0.0030145785998048936,
                0.00022885392999024467,
                5.6720147451671345e-6,
                7.521296921999172e-8,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.0026041666666666665,
                    -0.00013020833333333333,
                    -2.7126736111111112e-6,
                    -3.229373346560847e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                9.869848831359564,
                33.9276053577985,
                55.132358706422565,
                25.843293143635577,
                -10.98339958604512,
                13.04278700842858,
                -24.455225640803587,
                61.52017700264652,
                -192.2505531332704,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 19] = [
    &[],
    &[
        -1.9482278910734512e14,
        -1.8327804570070053e14,
        -4.116727329670918e13,
        4.0069919724081714e12,
        2.615904738154615e12,
        -1.1366798981495161e11,
        -1.1614625749983028e11,
        2.265866488037026e10,
        -1.7683558040005207e9,
        5.426140820905671e7,
    ],
    &[
        -220154.54676023818,
        -35711.39354788335,
        2474.7458531531083,
        3412.3037925309363,
        -753.7324334715705,
        72.41690337962437,
        -3.754129015978603,
        0.10339913376943176,
        -0.0011941924590305637,
    ],
    &[
        -7.669071968788728e17,
        -1.367688944447215e18,
        5.753286410985973e17,
        -1.0269201823639066e17,
        1.0809069567695536e16,
        -7.470118709945315e14,
        3.525893711206525e13,
        -1.1377397888468828e12,
        2.42066348741394e10,
        -3.080735890537663e8,
        1.7861287938520035e6,
    ],
    &[
        0.0033399028070908274,
        -0.001002933324756513,
        0.00013622297694136312,
        -0.000010980128424693584,
        5.785883673500311e-7,
        -2.066097611206818e-8,
        4.99760586497637e-10,
        -7.892474795093168e-12,
        7.380834536880323e-14,
        -3.1126764515809754e-16,
    ],
    &[
        1.069296889356371e-7,
        -2.6670872194993612e-8,
        2.9905277694693064e-9,
        -1.9778691883714818e-10,
        8.500625017442965e-12,
        -2.4613196878489285e-13,
        4.7997087460911085e-15,
        -6.076636645706318e-17,
        4.530877724303179e-19,
        -1.515447195995723e-21,
    ],
    &[
        1.4023939174823128e-11,
        -2.975967428871032e-12,
        2.829002479320712e-13,
        -1.5808469229388397e-14,
        5.721386285068516e-16,
        -1.390493683408965e-17,
        2.2688272795366337e-19,
        -2.3961504025686173e-21,
        1.4860064065955817e-23,
        -4.12225720860931e-26,
    ],
    &[
        3.682086660955367e-15,
        -6.781576037945441e-16,
        5.583172334008737e-17,
        -2.6963542138988335e-18,
        8.416852239647369e-20,
        -1.7608749586302373e-21,
        2.4685939527493178e-23,
        -2.2359213161548193e-25,
        1.1871086357438275e-27,
        -2.8144444937402537e-30,
    ],
    &[
        1.4375169470986355e-18,
        -2.3353414581807155e-19,
        1.6935405231801594e-20,
        -7.194474657778262e-22,
        1.9729260505260934e-23,
        -3.621415476784472e-25,
        4.448935842744063e-27,
        -3.526999640924943e-29,
        1.637137237099818e-31,
        -3.3896396146031324e-34,
    ],
    &[
        7.201868435499551e-22,
        -1.0456714805081535e-22,
        6.770801207270681e-24,
        -2.565918516885127e-25,
        6.271423719332655e-27,
        -1.0251084774813763e-28,
        1.1205219791145609e-30,
        -7.897521942783137e-33,
        3.2565042237967176e-35,
        -5.985113662453732e-38,
    ],
    &[
        4.266757941404163e-25,
        -5.597028269368939e-26,
        3.2720407876698336e-27,
        -1.118803323079767e-28,
        2.4656631696656044e-30,
        -3.6318429964905e-32,
        3.5752664915919797e-34,
        -2.2680826474282757e-36,
        8.413112648044956e-39,
        -1.3902059255768925e-41,
    ],
    &[
        2.8459982125680815e-28,
        -3.403413946284714e-29,
        1.8129333707120595e-30,
        -5.645653146544389e-32,
        1.1326325737663062e-33,
        -1.5180312236305778e-35,
        1.3591571380977891e-37,
        -7.838674892736093e-40,
        2.6423077880812678e-42,
        -3.966198977687714e-45,
    ],
    &[
        2.0712184187094102e-31,
        -2.275225811837662e-32,
        1.1128795911795134e-33,
        -3.1811180699683347e-35,
        5.85599851442431e-37,
        -7.199299903245612e-39,
        5.910611147469918e-41,
        -3.1247702723910996e-43,
        9.652395023977543e-46,
        -1.3273020995110333e-48,
    ],
    &[
        1.610426728701359e-34,
        -1.6355761827201035e-35,
        7.394363961477863e-37,
        -1.9530677319040634e-38,
        3.3212768747011204e-40,
        -3.7709075845200987e-42,
        2.8584294472307345e-44,
        -1.3949017052859047e-46,
        3.9763526107471084e-49,
        -5.044760791409769e-52,
    ],
    &[
        1.3183237401263267e-37,
        -1.2448220276057383e-38,
        5.231117684222055e-40,
        -1.2840219430936316e-41,
        2.0287494917556166e-43,
        -2.1396686944695122e-45,
        1.5063185749607266e-47,
        -6.825513504916397e-50,
        1.8063206071366293e-52,
        -2.1270942443591205e-55,
    ],
    &[
        1.1243432047202858e-40,
        -9.918555932586116e-42,
        3.893331942866014e-43,
        -8.925004893404142e-45,
        1.3167359458731466e-46,
        -1.2965164763578461e-48,
        8.519975332833385e-51,
        -3.6031082961694566e-53,
        8.897939776783347e-56,
        -9.776148615628465e-59,
    ],
    &[
        9.912808759352422e-44,
        -8.20466518511695e-45,
        3.021235578266354e-46,
        -6.496209111899151e-48,
        8.988302536208393e-50,
        -8.29898497051392e-52,
        5.113227180735807e-54,
        -2.0271556109510482e-56,
        4.692418840217996e-59,
        -4.831905462215857e-62,
    ],
    &[
        4.8799395633614636e-46,
        -4.1897790216625823e-47,
        1.6201859800006913e-48,
        -3.715979793399975e-50,
        5.597881436539254e-52,
        -5.787406406114172e-54,
        4.158558311541283e-56,
        -2.0506910098280232e-58,
        6.6416640066824e-61,
        -1.2757169662383546e-63,
        1.1035284357678472e-66,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 19] = [
    &[],
    &[
        1.,
        -8.832205925737837,
        -126.94953851950456,
        2998.7031434555865,
        -4.0588081350157397e12,
        -3.8182924445166035e12,
        -1.1958863086729219e12,
        -2.3470937393493198e11,
        -2.4027138049038624e10,
        -2.021395147667958e9,
    ],
    &[
        1.,
        -6.353420226882111,
        19.213492875513005,
        -36.82482514368224,
        -4536.313327870272,
        -795.913906643183,
        -288.4456134624332,
        -18.500419443116833,
        -4.739959302145453,
        -0.06841081106257756,
        -0.02506150919450676,
    ],
    &[
        1.,
        1.531018380318233e16,
        -4.211409120912954e16,
        5.56842390999791e16,
        -6.303480608817139e16,
        -6.318533982341233e13,
        -2.3003300006942475e15,
        3.1756807647841754e13,
        -2.4019351076540293e13,
        3.607045455001337e11,
        -7.117310790660548e10,
    ],
    &[
        1.,
        -0.9899993624155495,
        0.44982384300875666,
        -0.12386173625406127,
        0.023025672180205813,
        -0.003019120567800766,
        0.000286934485932691,
        -0.00001947682163356308,
        9.347871073735489e-7,
        -2.8453433819384358e-8,
        4.895708916037787e-10,
    ],
    &[
        1.,
        -0.6306469609441966,
        0.18135720933391708,
        -0.031366261123558586,
        0.003619949955788502,
        -0.0002919748862791056,
        0.000016718112927529203,
        -6.736766602464359e-7,
        1.8385833107635047e-8,
        -3.0943352857879307e-10,
        2.478500953950887e-12,
    ],
    &[
        1.,
        -0.455897823703876,
        0.09438494813833637,
        -0.011695493754011937,
        0.0009615241299267714,
        -0.000054867380227705686,
        2.2039089213963655e-6,
        -6.164055940719263e-8,
        1.1513976388292375e-9,
        -1.300857593240286e-11,
        6.778376447866851e-14,
    ],
    &[
        1.,
        -0.3544119041608295,
        0.05689328507273566,
        -0.005450256381375107,
        0.0003452498942743189,
        -0.000015120456001390869,
        4.6401249278431865e-7,
        -9.860841959468108e-9,
        1.3902625328605512e-10,
        -1.1757487680659814e-12,
        4.536359965833689e-15,
    ],
    &[
        1.,
        -0.28879239732723516,
        0.03771285390098079,
        -0.002933511418746767,
        0.00015057122490785347,
        -5.330786597822127e-6,
        1.3189130918699643e-7,
        -2.252855807890303e-9,
        2.5439616498883897e-11,
        -1.7159862640484246e-13,
        5.254440555469079e-16,
    ],
    &[
        1.,
        -0.2431636612706789,
        0.026707097614142982,
        -0.0017450774790941186,
        0.00007513994607149399,
        -2.2282986118294812e-6,
        4.610325275461274e-8,
        -6.573225618038738e-10,
        6.182760626415242e-12,
        -3.465687686246163e-14,
        8.794998754828303e-17,
    ],
    &[
        1.,
        -0.2097241267224759,
        0.019851131485354268,
        -0.0011168985569813465,
        0.00004137242883874856,
        -1.0544365276147687e-6,
        1.872887629863723e-8,
        -2.2896691118100443e-10,
        1.844248688161177e-12,
        -8.839703137833848e-15,
        1.915105333394825e-17,
    ],
    &[
        1.,
        -0.1842259200601701,
        0.015308906944859549,
        -0.0007557292285748841,
        0.00002454567714097968,
        -5.481415837453729e-7,
        8.524434619701725e-9,
        -9.117064604703384e-11,
        6.418705836889139e-13,
        -2.6865507519991736e-15,
        5.0772076197025615e-18,
    ],
    &[
        1.,
        -0.16417193721348666,
        0.012152293612439842,
        -0.0005341369194217036,
        0.000015439307885083662,
        -3.066850832672537e-7,
        4.240122980337676e-9,
        -4.029307840402291e-11,
        2.5189352389075793e-13,
        -9.355569989279912e-16,
        1.5678158587689207e-18,
    ],
    &[
        1.,
        -0.14800405867630692,
        0.009873452900825436,
        -0.0003909788518899961,
        0.000010178033335759119,
        -1.8201225460029024e-7,
        2.2645672254467083e-9,
        -1.935763442107308e-11,
        1.0880745447927354e-13,
        -3.6318158858451126e-16,
        5.466870483259314e-19,
    ],
    &[
        1.,
        -0.13470247654815562,
        0.008176460370448613,
        -0.00029453091739886633,
        6.972750619298001e-6,
        -1.1336491734850555e-7,
        1.2819455123131245e-9,
        -9.956445369700226e-12,
        5.0831395184930905e-14,
        -1.5405076665328832e-16,
        2.1046589409736437e-19,
    ],
    &[
        1.,
        -0.12357306176438124,
        0.006879813233093122,
        -0.00022725649609961523,
        4.9325395991208114e-6,
        -7.350700346878358e-8,
        7.6173008464854e-10,
        -5.420137103115714e-12,
        2.534544809333003e-14,
        -7.033566987017763e-17,
        8.796562152461733e-20,
    ],
    &[
        1.,
        -0.11412767397259234,
        0.0058673571281786996,
        -0.0001789409042279209,
        3.5852305230716923e-6,
        -4.931181283339103e-8,
        4.715397332938841e-10,
        -3.095551252731245e-12,
        1.3352114042392744e-14,
        -3.417084696394524e-17,
        3.94027495442159e-20,
    ],
    &[
        1.,
        -0.10617174020914245,
        0.005077585264482151,
        -0.00014404517750201,
        2.684460793233626e-6,
        -3.434132745073241e-8,
        3.054108420048999e-10,
        -1.8645614612879796e-12,
        7.478806109066529e-15,
        -1.779716773008792e-17,
        1.9081048265916243e-20,
    ],
    &[],
];

pub const SPLITS: [f64; 20] = [
    0.,
    0.36912720293172957,
    2.0612890756371596,
    5.4456128210480195,
    12.214260311869738,
    18.982907802691457,
    25.751555293513178,
    32.5202027843349,
    39.28885027515661,
    46.05749776597833,
    52.826145256800054,
    59.594792747621774,
    66.36344023844349,
    73.13208772926521,
    79.90073522008693,
    86.66938271090865,
    93.43803020173037,
    100.20667769255209,
    108.66748705607924,
    std::f64::INFINITY,
];
