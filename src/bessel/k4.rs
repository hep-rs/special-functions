#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-4)
        * polynomial(
            x2,
            &[
                48.,
                -4.,
                0.25,
                -0.02083333333333333,
                0.003014578599804894,
                0.0002288539299902447,
                5.672014745167134e-6,
                7.521296921999171e-8,
            ],
        )
        + x.powi(4)
            * x.ln()
            * polynomial(
                x2,
                &[
                    -0.002604166666666667,
                    -0.0001302083333333333,
                    -2.712673611111111e-6,
                    -3.229373346560847e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                9.86984883135956,
                33.9276053577985,
                55.13235870642257,
                25.84329314363558,
                -10.98339958604512,
                13.04278700842858,
                -24.45522564080359,
                61.52017700264653,
                -192.2505531332704,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        1.151699447214797,
        -5.821137696486713,
        -0.4086790139373957,
        -0.1257067911127655,
        -0.02643546226168457,
        -0.003507373365541526,
        -0.0001899535965933658,
        0.00001419114703885264,
        -1.64132898059781e-6,
        -1.717382814134793e-6,
        -1.662824213527705e-7,
        5.8629522192793e-8,
        1.338287199724714e-8,
        -1.604480777194479e-9,
        -8.35163185688906e-10,
        -2.382398772287997e-13,
        4.350313665933349e-11,
        4.329054780436329e-12,
        -1.887908160233135e-12,
        -4.20193092317048e-13,
        6.042976520583243e-14,
        2.890029511384469e-14,
        -4.352527509612608e-16,
        -1.63433206090064e-15,
        -1.386993944607492e-16,
        7.689986136020459e-17,
        1.539466650032504e-17,
        -2.7620743844084e-18,
        -1.142020132845897e-18,
        4.591717274965476e-20,
        6.829284380911301e-20,
    ],
    &[
        -28.91176337472803,
        -30.57547238135926,
        -8.393764468543597,
        -1.722510468748453,
        -0.2545758927985957,
        -0.03116012976173989,
        -0.00323246301682282,
        -0.0002672877829651729,
        -0.00002177376123011006,
        -1.620436456242094e-6,
        -3.387694339864904e-8,
        -1.172718482251074e-8,
        -5.249667114051813e-10,
        2.806601357298664e-10,
        -5.880505071480745e-11,
        3.180293993060764e-12,
        1.344053902436261e-12,
        -4.316741806758071e-13,
        5.2077955922782e-14,
        3.718474547447958e-15,
        -2.821971132516825e-15,
        5.27951825098653e-16,
        -1.849704763886822e-17,
        -1.565643982673914e-17,
        4.426290646857299e-18,
        -4.537681756061858e-19,
        -6.198238482630344e-20,
        3.227465193274395e-20,
        -5.304328615510356e-21,
        -3.170788674987469e-23,
        2.021195102256456e-22,
    ],
];

pub const SPLITS: [f64; 3] = [-0.7039545068299899, 1.75867754603459, 4.22130959889917];
