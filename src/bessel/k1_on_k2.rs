#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);
    let x6 = x2.powi(3);
    let ln = x.ln();
    let ln2 = ln.powi(2);

    x * (polynomial(
        x2,
        &[
            0.5,
            -0.028982878914603105,
            -0.07699143945730155,
            -0.023991518080699402,
            -0.0018112066580244241,
        ],
    ) + x2
        * ln
        * polynomial(
            x2,
            &[0.25, 0.125, 0.01981464013567461, -0.008661410998048933],
        )
        + x6 * ln2 * polynomial(x2, &[0.015625, 0.013020833333333334]))
}

pub fn upper(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            1.,
            -1.5,
            1.875,
            -1.875,
            1.0546875,
            1.40625,
            -7.2509765625,
            21.09375,
            -58.152008056640625,
            177.978515625,
            -645.6587791442871,
        ],
    )
}

pub const COEFFICIENTS: [&[f64]; 11] = [
    &[
        0.02998412995297051,
        0.013023995415972019,
        -0.000033098340101166414,
        -1.3283672321216386e-6,
        5.9545374304713315e-8,
        -3.025819655326773e-9,
        2.2377111149010663e-10,
        -2.1632979089207395e-11,
        2.464027990942592e-12,
        -3.1300946504605116e-13,
        4.30251672102694e-14,
        -6.280252707956417e-15,
        9.612118032593782e-16,
        -1.5287693164398839e-16,
        2.5099479818959173e-17,
        -4.232517321937819e-18,
        7.301983137501594e-19,
        -1.2848094525476303e-19,
        2.299855100566522e-20,
        -4.1795676763216524e-21,
        7.698195550068031e-22,
        -1.434994482262883e-22,
        2.7038795381642595e-23,
        -5.144568853145793e-24,
        9.87520983535019e-25,
        -1.9109176122699715e-25,
        3.7251277360504636e-26,
        -7.311138840795111e-27,
        1.4439256741361356e-27,
        -2.8682536886706717e-28,
        5.728252291784353e-29,
        -1.1497314607928734e-29,
        2.3184332755091088e-30,
        -4.695535539368733e-31,
        9.548801771690811e-32,
        -1.949295244884518e-32,
        3.993675491877924e-33,
        -8.210020519199085e-34,
        1.693204856855385e-34,
        -3.502617971564639e-35,
        7.26648321308075e-36,
        -1.511609838807367e-36,
        3.1526882958259825e-37,
        -6.592137436793252e-38,
        1.384108734250673e-38,
        -3.030242520870504e-39,
        6.107117363041843e-40,
    ],
    &[
        0.05572605928403527,
        0.012708303656768973,
        -0.000044713844070526476,
        -6.854258079104019e-7,
        2.7286683014833416e-8,
        -8.550772682080732e-10,
        3.300385766682848e-11,
        -1.6215720394846392e-12,
        9.456944974343519e-14,
        -6.177483732832326e-15,
        4.370854472077528e-16,
        -3.284050298132399e-17,
        2.586655196282485e-18,
        -2.1165648557915776e-19,
        1.7873722169360082e-20,
        -1.549930524547942e-21,
        1.3747775556685142e-22,
        -1.2434680313837668e-23,
        1.1440279825627008e-24,
        -1.0684449911405647e-25,
        1.0112204851334137e-26,
        -9.685025848334844e-28,
        9.37549422635923e-29,
        -9.163873939794808e-30,
        9.035880764592591e-31,
        -8.981194664656443e-32,
        8.992449724318308e-33,
        -9.064538352625761e-34,
        9.194126989384883e-35,
        -9.379317272890153e-36,
        9.61940944769279e-37,
        -9.914739277637711e-38,
        1.026656911633275e-38,
        -1.0677019989813686e-39,
        1.114903572463271e-40,
        -1.1686373025795497e-41,
        1.2293613424249417e-42,
        -1.2976194462293288e-43,
        1.374045855605555e-44,
        -1.459371879235785e-45,
        1.5544341567605951e-46,
        -1.660184652055755e-47,
        1.7777024988295126e-48,
        -1.9082106633977894e-49,
        2.0533579379084227e-50,
        -2.2397661778794845e-51,
        2.392311505375848e-52,
    ],
    &[
        0.0928265249819687,
        0.024230089323904972,
        -0.00020963200274396547,
        -1.9789865398434686e-6,
        1.9757257327829636e-7,
        -9.432109854666428e-9,
        4.592342796548934e-10,
        -2.630137934121619e-11,
        1.7762340473051436e-12,
        -1.356262108474306e-13,
        1.1285809493315903e-14,
        -9.999103611829599e-16,
        9.297490575822705e-17,
        -8.986236219463195e-18,
        8.966482328105304e-19,
        -9.189088589476533e-20,
        9.634070277936816e-21,
        -1.0300909728873416e-21,
        1.1204072567997156e-22,
        -1.237133084891377e-23,
        1.3843823529071834e-24,
        -1.5677387407773611e-25,
        1.7944998525776967e-26,
        -2.0740344405140798e-27,
        2.418267540192475e-28,
        -2.8423195043783896e-29,
        3.365336508831259e-30,
        -4.011563553622957e-31,
        4.8117275635100737e-32,
        -5.8048192480015966e-33,
        7.040389516568878e-34,
        -8.58151146908382e-35,
        1.0508604890746308e-35,
        -1.2924380159907428e-36,
        1.596023696823952e-37,
        -1.9784556100813726e-38,
        2.4613457433869727e-39,
        -3.0724774449288143e-40,
        3.847622837025258e-41,
        -4.832909125236741e-42,
        6.087903051771363e-43,
        -7.689635868720006e-44,
        9.737861879470684e-45,
        -1.2361984845417702e-45,
        1.5734006704288757e-46,
        -2.0388086091791922e-47,
        2.563613171874979e-48,
    ],
    &[
        0.16098018332223632,
        0.04326602593927773,
        -0.0008651956871211451,
        4.707403382369445e-6,
        8.568865327511706e-7,
        -7.527562508499765e-8,
        5.0692685266675256e-9,
        -3.405977481896699e-10,
        2.492586004883407e-11,
        -2.0307471098374485e-12,
        1.8186303306029957e-13,
        -1.7513506896756386e-14,
        1.7805884570399145e-15,
        -1.8873277963148346e-16,
        2.0681834844006152e-17,
        -2.329525331938136e-18,
        2.6855316764838975e-19,
        -3.158293579975012e-20,
        3.7792210994012794e-21,
        -4.591569182900392e-22,
        5.654203702954637e-23,
        -7.046937436408322e-24,
        8.877967932227326e-25,
        -1.1294194025229553e-25,
        1.4495514791898265e-26,
        -1.8754667328122154e-27,
        2.4444794223253836e-28,
        -3.207782606664687e-29,
        4.235802906595996e-30,
        -5.625685989558253e-31,
        7.511781340962463e-32,
        -1.0080356451836653e-32,
        1.359028526799367e-33,
        -1.8402189488976851e-34,
        2.5019558669412434e-35,
        -3.4146872035329764e-36,
        4.677188715019178e-37,
        -6.428232990651732e-38,
        8.863162320261025e-39,
        -1.2257461471000474e-39,
        1.7000335487675107e-40,
        -2.3642606097830877e-41,
        3.2965129978251114e-42,
        -4.607698176293224e-43,
        6.457923817076134e-44,
        -9.244078606452013e-45,
        1.2754536473501168e-45,
    ],
    &[
        0.27406727177482226,
        0.06781173974935856,
        -0.002782196336508953,
        0.00008676254638549823,
        -3.724610895589116e-7,
        -2.6869364326334036e-7,
        3.433756484526812e-8,
        -3.3040344738507066e-9,
        2.947348813890348e-10,
        -2.6264208721546822e-11,
        2.4286949881752042e-12,
        -2.371840024933745e-13,
        2.4530883317280127e-14,
        -2.6707584471161276e-15,
        3.033174339126564e-16,
        -3.562770010074602e-17,
        4.299254601159938e-18,
        -5.30382720433745e-19,
        6.665674279056753e-20,
        -8.511859921890139e-21,
        1.1021989906634133e-21,
        -1.4449613266909057e-22,
        1.9153244538076955e-23,
        -2.5641253436806746e-24,
        3.4636870168811975e-25,
        -4.717249542700769e-26,
        6.472683879100509e-27,
        -8.942481630833366e-28,
        1.2432963068595417e-28,
        -1.7387055021860896e-29,
        2.4447086271642997e-30,
        -3.4547170806554816e-31,
        4.9049409276519607e-32,
        -6.994510380730431e-33,
        1.0015260676764255e-33,
        -1.4395905240427397e-34,
        2.0767668122589943e-35,
        -3.006197345698998e-36,
        4.36560983085006e-37,
        -6.359069638684941e-38,
        9.289517436206624e-39,
        -1.3607514620862345e-39,
        1.998438285842342e-40,
        -2.942238127613479e-41,
        4.343955540716017e-42,
        -6.563036780131498e-43,
        9.518060776041821e-44,
    ],
    &[
        0.4319561996418794,
        0.0861736838299078,
        -0.006168416422031971,
        0.00040693828318823087,
        -0.00002329425354559666,
        9.282586878557071e-7,
        1.7197510845135536e-8,
        -1.0184847452065285e-8,
        1.6623857182448779e-9,
        -2.1554023988010733e-10,
        2.548257385835018e-11,
        -2.890430266141976e-12,
        3.231095870305567e-13,
        -3.62118038724923e-14,
        4.116614910894955e-15,
        -4.783035261647221e-16,
        5.702394856335736e-17,
        -6.982253618873432e-18,
        8.76892400288384e-19,
        -1.1266259926115735e-19,
        1.4762762762907428e-20,
        -1.967099630818847e-21,
        2.658526983780254e-22,
        -3.636649805708407e-23,
        5.026758415430109e-24,
        -7.011936579975528e-25,
        9.860728473217204e-26,
        -1.3968427626053296e-26,
        1.9918865963910756e-27,
        -2.8577123219941317e-28,
        4.122897558290125e-29,
        -5.979114496669091e-30,
        8.712901667718835e-31,
        -1.2753780602587656e-31,
        1.8747278900243018e-32,
        -2.7665975593916254e-33,
        4.097869466995739e-34,
        -6.090877786349417e-35,
        9.082904684058475e-36,
        -1.3586684577085963e-36,
        2.0383245800215813e-37,
        -3.066460315916145e-38,
        4.625342219277216e-39,
        -6.994245691323193e-40,
        1.0607028864047476e-40,
        -1.647930321317055e-41,
        2.4519532493205753e-42,
    ],
    &[
        0.606609476546119,
        0.0844093734999255,
        -0.008851004232958674,
        0.0009042407062192108,
        -0.00008949281089714166,
        8.493891434377324e-6,
        -7.584540629010454e-7,
        6.112778981772335e-8,
        -3.949600065993916e-9,
        9.401532199815423e-11,
        3.1037147359416404e-11,
        -8.414098270036292e-12,
        1.5282335309108806e-12,
        -2.4081153455634767e-13,
        3.5296872869139316e-14,
        -4.957640947268215e-15,
        6.779610066561924e-16,
        -9.116277706091751e-17,
        1.2136259653908563e-17,
        -1.6078080469537408e-18,
        2.128271032183256e-19,
        -2.824187008729925e-20,
        3.766994582318954e-21,
        -5.061135183354305e-22,
        6.86012660637622e-23,
        -9.390694338725026e-24,
        1.2989100414187062e-24,
        -1.8155984231440948e-25,
        2.5639369314761697e-26,
        -3.656062879464732e-27,
        5.26061254617669e-28,
        -7.631948140649686e-29,
        1.1154837336930884e-29,
        -1.6412911475302255e-30,
        2.429378879453997e-31,
        -3.61508427010381e-32,
        5.405264703303199e-33,
        -8.116837581028488e-34,
        1.2236438501661347e-34,
        -1.8512938011584736e-35,
        2.810116694812252e-36,
        -4.278557294066908e-37,
        6.532884717160063e-38,
        -1.0001739444980098e-38,
        1.5359279229048788e-39,
        -2.4178861136666538e-40,
        3.6414313559558494e-41,
    ],
    &[
        0.7574604888637154,
        0.0646383776693748,
        -0.008544528587986676,
        0.001120165708198851,
        -0.00014556515083105777,
        0.000018736474214625875,
        -2.3862038854958676e-6,
        3.0023446491364227e-7,
        -3.7240902099879085e-8,
        4.5399611459210405e-9,
        -5.414650544608164e-10,
        6.272931699344106e-11,
        -6.9749607185751715e-12,
        7.27881655524311e-13,
        -6.7842085812794e-14,
        4.8485054376609316e-15,
        -4.622060218561908e-17,
        -7.934890861522222e-17,
        2.272410301235512e-17,
        -4.750461906131851e-18,
        8.767458487405799e-19,
        -1.512812916205512e-19,
        2.5026466403233123e-20,
        -4.022765228236366e-21,
        6.333445612837032e-22,
        -9.817787939399779e-23,
        1.5039109570917126e-23,
        -2.282546900002745e-24,
        3.4394489194855484e-25,
        -5.1538270339760425e-26,
        7.689825512949714e-27,
        -1.1437529771550344e-27,
        1.6974378427235954e-28,
        -2.515749699693065e-29,
        3.726307829376971e-30,
        -5.519762416492461e-31,
        8.181936694486981e-32,
        -1.2142923295950865e-32,
        1.8052359049103937e-33,
        -2.689525222341309e-34,
        4.017081999152599e-35,
        -6.016950992718526e-36,
        9.040344299299276e-37,
        -1.3627867512316995e-37,
        2.0624646040285688e-38,
        -3.201894403547835e-39,
        4.766632127602783e-40,
    ],
    &[
        0.8630587739718103,
        0.04123142174492174,
        -0.0061915604688402666,
        0.0009274212500133966,
        -0.00013856328344271992,
        0.000020648766200090417,
        -3.068927533026146e-6,
        4.5487075471441674e-7,
        -6.722798229850404e-8,
        9.906332447808437e-9,
        -1.4551343130169067e-9,
        2.130254396195873e-10,
        -3.107349859567792e-11,
        4.514904070855633e-12,
        -6.532028380873239e-13,
        9.405790387065857e-14,
        -1.347262666429244e-14,
        1.9183300600130984e-15,
        -2.712916020978997e-16,
        3.8064101418026544e-17,
        -5.29103953684508e-18,
        7.27252781019919e-19,
        -9.858539163124641e-20,
        1.313119449081012e-20,
        -1.7090117728189313e-21,
        2.154265468907715e-22,
        -2.59015270977679e-23,
        2.8823061345239325e-24,
        -2.757450691495938e-25,
        1.6945943586005303e-26,
        1.2596629194265847e-27,
        -7.801327093597293e-28,
        2.0885503654228374e-28,
        -4.5580180062396714e-29,
        9.046894438872423e-30,
        -1.6994354780567175e-30,
        3.0793393484588343e-31,
        -5.439533310123235e-32,
        9.428618091990771e-33,
        -1.6105885128223914e-33,
        2.719382578049478e-34,
        -4.548274130951202e-35,
        7.547778717508518e-36,
        -1.2443385770071802e-36,
        2.041318558010454e-37,
        -3.415684651305757e-38,
        5.407409631270142e-39,
    ],
    &[
        0.9268745679999915,
        0.02348220868877637,
        -0.0037676065055135834,
        0.000604059442386866,
        -0.00009677921650528334,
        0.000015494331942188537,
        -2.4788559886725057e-6,
        3.9629272433565903e-7,
        -6.330897053621524e-8,
        1.0106389914588215e-8,
        -1.6121486429351751e-9,
        2.5697342321497334e-10,
        -4.092988666406225e-11,
        6.514129706175711e-12,
        -1.0359273212866882e-12,
        1.6460833571569856e-13,
        -2.6134591081662027e-14,
        4.145831491724417e-15,
        -6.570966718436976e-16,
        1.0405358502845285e-16,
        -1.6461984968776553e-17,
        2.601899761464267e-18,
        -4.10834067047001e-19,
        6.480261172427853e-20,
        -1.0210559312733286e-20,
        1.6070013331670329e-21,
        -2.5262075228946264e-22,
        3.9662646143896477e-23,
        -6.219064511737933e-24,
        9.737929842143716e-25,
        -1.5225447991981035e-25,
        2.3768109209233835e-26,
        -3.7042004181666626e-27,
        5.762591998616535e-28,
        -8.947592093669834e-29,
        1.3864129713356252e-29,
        -2.1433877779770007e-30,
        3.305541539447208e-31,
        -5.084126346808448e-32,
        7.796560739810325e-33,
        -1.1916895704768194e-33,
        1.8148090321059084e-34,
        -2.7523788397969757e-35,
        4.1548845246690825e-36,
        -6.241378956625932e-37,
        9.511575559141867e-38,
        -1.3790450940806657e-38,
    ],
    &[
        0.9621644097156031,
        0.012557001517759573,
        -0.0020833222995281057,
        0.0003455750772033488,
        -0.000057311807095534706,
        9.503022920412904e-6,
        -1.5754173798109384e-6,
        2.6112341234551627e-7,
        -4.327254216046264e-8,
        7.169608903553458e-9,
        -1.1876677742113278e-9,
        1.9670294939789385e-10,
        -3.25718972402557e-11,
        5.3925150769819624e-12,
        -8.925973673321651e-13,
        1.4771870808327264e-13,
        -2.4441663457160197e-14,
        4.043347086391092e-15,
        -6.687532181303514e-16,
        1.10587206410742e-16,
        -1.8283423607020435e-17,
        3.022200171975576e-18,
        -4.994607737278399e-19,
        8.252610173390756e-20,
        -1.3633028313629915e-20,
        2.2516641882879265e-21,
        -3.7181280462701776e-22,
        6.138377599996473e-23,
        -1.0131889228079768e-23,
        1.6719905318375835e-24,
        -2.7585613736999227e-25,
        4.550255507880814e-26,
        -7.50398544712998e-27,
        1.2372285824907056e-27,
        -2.0394275829396803e-28,
        3.360977130128759e-29,
        -5.537582496760462e-30,
        9.121591472417042e-31,
        -1.5021561003714945e-31,
        2.4731573193229945e-32,
        -4.07079038549408e-33,
        6.6987543210189525e-34,
        -1.102035956171153e-34,
        1.8125480109639292e-35,
        -2.98238993256984e-36,
        5.031105475992188e-37,
        -8.0503877031687e-38,
    ],
];

pub const SPLITS: [f64; 12] = [
    0.03392521963364156,
    0.08678808678957256,
    0.13965095394550356,
    0.24537668825736558,
    0.4568281568810896,
    0.8797310941285377,
    1.7255369686234336,
    3.417148717613226,
    6.800372215592811,
    13.566819211551978,
    27.099713203470316,
    54.165501187306994,
];
