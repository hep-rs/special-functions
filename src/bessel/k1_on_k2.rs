#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);
    let x6 = x2.powi(3);
    let ln = x.ln();
    let ln2 = ln.powi(2);

    x * (polynomial(
        x2,
        &[
            0.5,
            -0.02898287891460311,
            -0.07699143945730156,
            -0.02399151808069941,
            -0.001811206658024423,
        ],
    ) + x2
        * ln
        * polynomial(
            x2,
            &[0.25, 0.125, 0.01981464013567461, -0.008661410998048935],
        )
        + x6 * ln2 * polynomial(x2, &[0.015625, 0.01302083333333333]))
}

pub fn upper(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            1.,
            -1.5,
            1.875,
            -1.875,
            1.0546875,
            1.40625,
            -7.2509765625,
            21.09375,
            -58.15200805664062,
            177.978515625,
            -645.6587791442871,
        ],
    )
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        0.02817746557796556,
        0.01255687704560197,
        0.00140462732105812,
        0.0001016709574586964,
        5.026167248835012e-6,
        1.419613629801636e-7,
        -2.276946153705442e-9,
        -6.008390507757357e-10,
        -4.408811975687463e-11,
        -1.934704291798009e-12,
        -3.04336495775522e-14,
        3.276322233189354e-15,
        3.635486251418311e-16,
        2.019804527498447e-17,
        5.75205807197049e-19,
        -1.282130104235964e-20,
        -2.737594828828252e-21,
        -1.845146593740501e-22,
        -6.939563437598175e-24,
        -2.331159657760652e-26,
        1.830797176936024e-26,
        1.546739546002202e-27,
        7.179678054157735e-29,
        1.313225941981269e-30,
        -1.020405010166569e-31,
        -1.204855756099375e-32,
        -6.778055680726043e-34,
        -1.98636595609646e-35,
        3.584712347544425e-37,
        8.676368609766169e-38,
        5.956824276517649e-39,
    ],
    &[
        0.06946095388837226,
        0.03019482789051709,
        0.003166965365493902,
        0.0001924465523022405,
        4.874217301305436e-6,
        -3.316363066802285e-7,
        -4.713018980054809e-8,
        -2.605201573194181e-9,
        -2.50003812641029e-11,
        8.579089732409305e-12,
        8.053642268350515e-13,
        3.049994077713291e-14,
        -8.147581338389862e-16,
        -1.896124452659167e-16,
        -1.191878337862496e-17,
        -1.878407873005523e-19,
        3.305487611399118e-20,
        3.394208034771925e-21,
        1.377933019748513e-22,
        -2.646383866501444e-24,
        -7.636757777339825e-25,
        -5.022514285673235e-26,
        -9.39957092585203e-28,
        1.263747223571649e-28,
        1.38325460651474e-29,
        5.957091291568171e-31,
        -7.948110328607739e-33,
        -3.019259363798194e-33,
        -2.087196025260578e-34,
        -4.481365847091394e-36,
        4.744673768872406e-37,
    ],
    &[
        0.1627841120185522,
        0.06508089524048255,
        0.005467538477060235,
        0.0001355929789470862,
        -0.00001732883781662517,
        -1.897406180743521e-6,
        -3.738043003797326e-8,
        7.637047513220608e-9,
        7.082334018351059e-10,
        5.382846240992421e-12,
        -3.472889583781309e-12,
        -2.543624943773052e-13,
        2.30474927700738e-15,
        1.518647835327268e-15,
        8.506981327437465e-17,
        -2.715296785692201e-18,
        -6.308152557126355e-19,
        -2.575078960774009e-20,
        1.740163470645395e-21,
        2.49301990446781e-22,
        6.586150111690542e-24,
        -9.16367090630369e-25,
        -9.38135326291528e-26,
        -1.075975142521252e-27,
        4.342200999116558e-28,
        3.348509250888716e-29,
        -1.900755518735757e-31,
        -1.916146265934459e-31,
        -1.121254200029626e-32,
        3.1476321370339e-34,
        7.996909303834216e-35,
    ],
    &[
        0.336725441459991,
        0.1079340278988809,
        0.004310714532797161,
        -0.0003852662886449287,
        -0.00003753900006187532,
        1.242412687390789e-6,
        2.718831391508573e-7,
        -2.743532050006909e-10,
        -1.744130242505984e-9,
        -4.497368521118789e-11,
        1.001214599838872e-11,
        5.506172009271397e-13,
        -5.013856674737294e-14,
        -4.835048585354662e-15,
        1.986511290998127e-16,
        3.620615565743817e-17,
        -3.543507548750369e-19,
        -2.421154759996506e-19,
        -3.885918923264164e-21,
        1.459744241062439e-21,
        6.215537215211468e-23,
        -7.816431886854829e-24,
        -5.98889389022812e-25,
        3.509260259768376e-26,
        4.747496554116733e-27,
        -1.052305049257227e-28,
        -3.323697792916029e-29,
        -1.673768641223993e-31,
        2.097153683565809e-31,
        6.336160448048707e-33,
        -1.187151166990493e-33,
    ],
    &[
        0.5676590350020615,
        0.1174593866436165,
        -0.002209867663949223,
        -0.0005382624723288623,
        0.00002381424192996459,
        2.77023292253295e-6,
        -2.103599631358961e-7,
        -1.245218664504027e-8,
        1.628054305851064e-9,
        3.897051852703943e-11,
        -1.133599118003552e-11,
        3.699399662174109e-14,
        7.15623734168362e-14,
        -2.062671969542784e-15,
        -4.061333173023378e-16,
        2.365741926364404e-17,
        2.000779788226017e-18,
        -2.034574683668786e-19,
        -7.627204727216356e-21,
        1.504408111690474e-21,
        1.032966236354572e-23,
        -9.94147286910407e-24,
        1.894532667100552e-25,
        5.907132938664537e-26,
        -2.739204729306649e-27,
        -3.094918514819798e-28,
        2.558748757313587e-29,
        1.332382845495117e-30,
        -1.989101932307681e-31,
        -3.464974413946664e-33,
        1.368419616689445e-33,
    ],
    &[
        0.7705558524131689,
        0.08267044440553683,
        -0.005526999278850427,
        -9.20317376488306e-6,
        0.00002749597629725855,
        -1.601834836716132e-6,
        -4.353645314999408e-8,
        1.09295946342679e-8,
        -4.526788191662516e-10,
        -2.866195889103252e-11,
        4.183663195426493e-12,
        -1.145397540956008e-13,
        -1.482724141544555e-14,
        1.55489193251963e-15,
        -2.064818690916451e-17,
        -6.962592776122434e-18,
        5.564133172443442e-19,
        1.526238516654763e-21,
        -3.072272774209626e-21,
        1.887399229276993e-22,
        4.342739515858112e-24,
        -1.288167683425722e-24,
        5.926967139203988e-26,
        3.098220635802201e-27,
        -5.155830909305199e-28,
        1.6429773461124e-29,
        1.707324819800574e-30,
        -1.972186203331029e-31,
        3.488686942827551e-33,
        8.322041976711964e-34,
        -7.1926175737298e-35,
    ],
    &[
        0.8950077499214571,
        0.04306996743522397,
        -0.004034311491808351,
        0.000188732517346484,
        4.112764873542863e-7,
        -7.489720878596984e-7,
        5.543346195655647e-8,
        -1.383834619179391e-9,
        -1.05390670432778e-10,
        1.350632299258751e-11,
        -6.498456944080291e-13,
        -1.312175275778849e-15,
        2.644171663535843e-15,
        -2.050256770060298e-16,
        5.904373566723787e-18,
        3.412282941898672e-19,
        -5.078290800524461e-20,
        2.703635925498532e-21,
        -1.350496106089595e-23,
        -9.73577586120298e-24,
        8.328900220569057e-25,
        -2.759749891043133e-26,
        -1.130911301952591e-27,
        2.008427467232741e-28,
        -1.150366764103843e-29,
        1.139603757886779e-31,
        3.694145672875701e-32,
        -3.401807791977919e-33,
        1.234975331377701e-34,
        3.804329604150467e-36,
        -7.931804145624697e-37,
    ],
    &[
        0.955621660177903,
        0.01921942628011712,
        -0.002033437448968918,
        0.0001318731030739614,
        -5.055613846955362e-6,
        2.620833060303954e-8,
        1.206734819171618e-8,
        -1.007115039128258e-9,
        4.50131444504934e-11,
        -7.44412806858318e-13,
        -6.558544658931442e-14,
        7.241055252983598e-15,
        -3.930231733944139e-16,
        1.114267750124832e-17,
        2.121850007082989e-19,
        -4.871240793993555e-20,
        3.338555382521103e-21,
        -1.312844763029713e-22,
        1.053819924625466e-24,
        2.941685434483111e-25,
        -2.70238875266922e-26,
        1.345409694694773e-27,
        -3.080955242643334e-29,
        -1.415037552013456e-30,
        2.047467304409781e-31,
        -1.249518592615003e-32,
        4.171645237346361e-34,
        2.534774538244443e-36,
        -1.416150401411431e-36,
        1.072076835003678e-37,
        -4.556484133437208e-39,
    ],
];

pub const SPLITS: [f64; 9] = [
    -3.383596599188084,
    -2.461641499748552,
    -1.53968640030902,
    -0.6177313008694875,
    0.3042237985700447,
    1.226178898009577,
    2.148133997449109,
    3.070089096888641,
    3.992044196328174,
];
