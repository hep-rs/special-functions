#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);
    let x6 = x2.powi(3);
    let ln = x.ln();
    let ln2 = ln.powi(2);

    x * (polynomial(
        x2,
        &[
            0.5,
            -0.02898287891460311,
            -0.07699143945730156,
            -0.02399151808069941,
            -0.001811206658024423,
        ],
    ) + x2
        * ln
        * polynomial(
            x2,
            &[0.25, 0.125, 0.01981464013567461, -0.008661410998048935],
        )
        + x6 * ln2 * polynomial(x2, &[0.015625, 0.01302083333333333]))
}

pub fn upper(x: f64) -> f64 {
    polynomial(
        x.recip(),
        &[
            1.,
            -1.5,
            1.875,
            -1.875,
            1.0546875,
            1.40625,
            -7.2509765625,
            21.09375,
            -58.15200805664062,
            177.978515625,
            -645.6587791442871,
        ],
    )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -2.353340511862703,
        1.661785767476512,
        -0.08394992382745841,
        -0.02364554134349583,
        -0.003196068799036311,
        0.000338979995818129,
        0.0002432611523795617,
        0.00003562846148663003,
        -5.694913996521411e-6,
        -3.245379223614662e-6,
        -3.894859258709742e-7,
        9.84023729679715e-8,
        4.423049988765812e-8,
        4.355311040749975e-9,
        -1.559092441156523e-9,
        -6.171400022417301e-10,
        -5.404791699858352e-11,
        2.376977827490467e-11,
        9.02154339843613e-12,
        7.669281889143547e-13,
        -3.657110827814315e-13,
        -1.390802537198368e-13,
        -1.191372974884606e-14,
        5.827623056526454e-15,
        2.236170609275254e-15,
        1.909508096883917e-16,
        -9.6444968293414e-17,
        -3.688914225379293e-17,
        -3.082705264655875e-18,
        1.688454971072362e-18,
        6.161299205680164e-19,
    ],
    &[
        -0.288469259910318,
        0.3634895568599663,
        -0.1249038902593094,
        0.02434267702864017,
        -0.001422343085901795,
        -0.0006687006910409841,
        0.0002149322938699162,
        -0.00001654794610818656,
        -7.289500469227012e-6,
        2.652015231602935e-6,
        -2.385539024095985e-7,
        -9.36423025627564e-8,
        3.71758076770321e-8,
        -3.652933356643638e-9,
        -1.338680805835814e-9,
        5.57445984751694e-10,
        -5.653195451006484e-11,
        -2.056250596529479e-11,
        8.680355144322075e-12,
        -8.760518084638177e-13,
        -3.300175939634673e-13,
        1.383227870811811e-13,
        -1.362426432737968e-14,
        -5.435162875960698e-15,
        2.240351000299541e-15,
        -2.134027211125597e-16,
        -9.09805034545548e-17,
        3.677238399695633e-17,
        -3.398582565286209e-18,
        -1.594622077442907e-18,
        6.0994197981719e-19,
    ],
];

pub const SPLITS: [f64; 3] = [-3.383596599188084, 0.3042237985700447, 3.992044196328174];
