#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-4)
        * polynomial(
            x2,
            &[
                -30.5577490736439,
                -2.546479089470325,
                -0.1591549430918953,
                -0.01326291192432461,
                -0.001919140341991973,
                0.000145692936815816,
                -3.610916735933866e-6,
                4.788206334392103e-8,
            ],
        )
        + x.powi(4)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.001657863990540576,
                    -0.00008289319952702882,
                    1.7269416568131e-6,
                    -2.055882924777501e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                5.013380707394703,
                51.70048854500788,
                420.066469428189,
                1378.343102811245,
                -5272.162368253013,
                68867.62093530498,
                -1.678648260298059e6,
                6.334274294718456e7,
                -3.36508321906918e9,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 7.068583470577035
        + x1 * polynomial(
            x1,
            &[
                7.875,
                0.0,
                6.3984375,
                0.0,
                -26.1720703125,
                0.0,
                -508.4969787597656,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 12] = [
    &[
        -196.0160223568932,
        210.4497612218457,
        -77.36152411724797,
        23.33978717828658,
        -6.227772866015408,
        1.527642931089689,
        -0.3524094120732486,
        0.07757806873095353,
        -0.01645890132765446,
        0.003389195842786627,
        -0.0006809036268082899,
        0.0001339930671377254,
        -0.0000259071137293255,
        4.933462560445035e-6,
        -9.2711186857577e-7,
        1.72209228741087e-7,
        -3.165933031482765e-8,
        5.767020865090793e-9,
        -1.041873368529497e-9,
        1.86827692482732e-10,
        -3.327599444240409e-11,
        5.890400950609716e-12,
        -1.036835855349414e-12,
        1.815624369363462e-13,
        -3.164236328057618e-14,
        5.490285167162301e-15,
        -9.48731675507123e-16,
        1.63323470700884e-16,
        -2.803857266756417e-17,
        4.928387933771811e-18,
        -8.163350764835117e-19,
    ],
    &[
        -23.72097047322003,
        16.28687747371854,
        -3.736137888834846,
        0.6975639724271212,
        -0.1148452973773788,
        0.01735500428758978,
        -0.002464142261638651,
        0.0003336639355905434,
        -0.0000435251594166374,
        5.508996385514063e-6,
        -6.801390676214346e-7,
        8.223435256205681e-8,
        -9.76759550507352e-9,
        1.142533310294487e-9,
        -1.318734152431496e-10,
        1.504375269578924e-11,
        -1.698431759014099e-12,
        1.899856329575144e-13,
        -2.107592888575885e-14,
        2.320588221296369e-15,
        -2.537801957365104e-16,
        2.758215001488743e-17,
        -2.980836590448637e-18,
        3.204710123974286e-19,
        -3.428917903936507e-20,
        3.652584904707963e-21,
        -3.874881737199412e-22,
        4.095031866034661e-23,
        -4.312800938026503e-24,
        4.575382583557429e-25,
        -4.735475801203535e-26,
    ],
    &[
        -5.086164636763507,
        4.000259828404542,
        -1.146009779721185,
        0.2701363972731555,
        -0.05647740954747412,
        0.01089013002692044,
        -0.00197705155854309,
        0.0003427441242225645,
        -0.00005729267297201497,
        9.29807926308855e-6,
        -1.472540153981841e-6,
        2.284587766809957e-7,
        -3.482809058906275e-8,
        5.229698031748412e-9,
        -7.749823818691119e-10,
        1.13518340297105e-10,
        -1.645781522483175e-11,
        2.364235927754333e-12,
        -3.368440676669693e-13,
        4.763587639631948e-14,
        -6.691230543290177e-15,
        9.34123007589927e-16,
        -1.296746366696347e-16,
        1.790844664477643e-17,
        -2.461435097745603e-18,
        3.368234550084353e-19,
        -4.590274947224504e-20,
        6.231954415797622e-21,
        -8.433430343038145e-22,
        1.157226406465359e-22,
        -1.527972248180612e-23,
    ],
    &[
        -1.047898837863113,
        0.6897871339417689,
        -0.1959983122780571,
        0.05812674765563865,
        -0.01352053898629185,
        0.002941955473542907,
        -0.0006209550948134869,
        0.0001248046356980187,
        -0.00002417877707969863,
        4.558256879261679e-6,
        -8.395633796000193e-7,
        1.515889929552285e-7,
        -2.69091815632058e-8,
        4.706991845354107e-9,
        -8.12824992547433e-10,
        1.387783334987777e-10,
        -2.345674719418268e-11,
        3.929152066015166e-12,
        -6.528427892504402e-13,
        1.076798703703642e-13,
        -1.764281388276927e-14,
        2.873172920526517e-15,
        -4.653049486067218e-16,
        7.497048415533051e-17,
        -1.202241954161359e-17,
        1.919531911771882e-18,
        -3.052371165914906e-19,
        4.835553351009057e-20,
        -7.63790911717168e-21,
        1.230502241399971e-21,
        -1.883909280186178e-22,
    ],
    &[
        -0.04270086368728672,
        0.4290387461391757,
        -0.05102438053359511,
        -0.02009718130503729,
        -0.002930987038404801,
        0.00140448397231405,
        -0.00006092896519047672,
        8.129661012495562e-6,
        -5.637939118336997e-6,
        1.124652021394236e-6,
        -1.865350572398684e-7,
        3.70176903711474e-8,
        -7.35838838698543e-9,
        1.392812708323785e-9,
        -2.602897565163851e-10,
        4.834480924647025e-11,
        -8.89414481531365e-12,
        1.621673272885591e-12,
        -2.934130303369646e-13,
        5.271924380866516e-14,
        -9.41205821514202e-15,
        1.670550256951223e-15,
        -2.949178667422699e-16,
        5.180735906653916e-17,
        -9.05925533821352e-18,
        1.5774248883308e-18,
        -2.735833883670335e-19,
        4.727612644375431e-20,
        -8.147961949163823e-21,
        1.43823068446044e-21,
        -2.391460101974702e-22,
    ],
    &[
        0.0883693164744601,
        -0.06497227367550474,
        0.2467889545769292,
        0.01726925422655487,
        -0.0785554062086572,
        -0.002069085747500592,
        0.00787244394321589,
        0.000223840762244774,
        -0.0004161347152495838,
        -0.00001204849657742878,
        0.00001355652752304181,
        4.028760056895679e-7,
        -3.0434036512543e-7,
        -8.272183850078471e-9,
        4.866348821527254e-9,
        1.374674630928788e-10,
        -6.187842590421112e-11,
        -1.168839426183968e-12,
        5.233679172536303e-13,
        2.369764927035501e-14,
        -6.469755157126456e-15,
        2.723286417998817e-16,
        -3.873381203321032e-17,
        1.289354392579608e-17,
        -2.40628771019356e-18,
        4.072496271964504e-19,
        -7.360358709959598e-20,
        1.342964552325604e-20,
        -2.420877038315153e-21,
        4.474433812467056e-22,
        -7.760884218718547e-23,
    ],
    &[
        0.06876187562576887,
        -0.008284779108472928,
        0.1828063903051904,
        -0.02134268312030962,
        -0.06887342022348552,
        0.005446586762081498,
        0.007584497390715773,
        -0.0004736630987371724,
        -0.0004140617031337148,
        0.00002128973841461127,
        0.00001370151233583432,
        -5.936827454843917e-7,
        -3.061927430318843e-7,
        1.139615691562337e-8,
        4.94472842146941e-9,
        -1.608381414194876e-10,
        -6.046653746138005e-11,
        1.74603312894834e-12,
        5.795383985008643e-13,
        -1.506353546801475e-14,
        -4.471189208215567e-15,
        1.058771684103363e-16,
        2.836511022353803e-17,
        -6.182033252768655e-19,
        -1.505804086662199e-19,
        3.047067247693956e-21,
        6.787139028084641e-22,
        -1.284194738855109e-23,
        -2.630341948366714e-24,
        4.670457773778122e-26,
        8.853262954249332e-27,
    ],
    &[
        0.04816972089150988,
        0.02412610151970988,
        0.1282067092625747,
        -0.07002414674725492,
        -0.04901860645895982,
        0.0143009983617434,
        0.005468360957959638,
        -0.001163000351359512,
        -0.0003009600600464345,
        0.00005160549923254387,
        9.9807666383279e-6,
        -1.450018003259794e-6,
        -2.224967059998357e-7,
        2.820203091689645e-8,
        3.574248543734106e-9,
        -4.030337196414643e-10,
        -4.341785507559232e-11,
        4.417346036049123e-12,
        4.13183606831234e-13,
        -3.834687250623598e-14,
        -3.165209743716651e-15,
        2.703598037974699e-16,
        1.994377731187808e-17,
        -1.579514954776053e-18,
        -1.05193125920542e-19,
        7.773647568616579e-21,
        4.712951790699997e-22,
        -3.267506455628905e-23,
        -1.815954565522278e-24,
        1.183003277983268e-25,
        6.081703787016884e-27,
    ],
    &[
        0.02139634169680801,
        0.04142134671043438,
        0.05915151988263311,
        -0.0978861556085536,
        -0.02150699362318582,
        0.01935240908885622,
        0.002309327104821879,
        -0.001547287371148421,
        -0.0001224277724065095,
        0.0000680216295306803,
        3.906502066534286e-6,
        -1.901898357121851e-6,
        -8.367884192766144e-8,
        3.68957802734794e-8,
        1.290440269825967e-9,
        -5.264830321426586e-10,
        -1.504303057777862e-11,
        5.763606790896608e-12,
        1.374072347140455e-13,
        -4.997263224253843e-14,
        -1.01091852267693e-15,
        3.518233865489478e-16,
        6.122137798612381e-18,
        -2.052019436950448e-18,
        -3.106188023438046e-20,
        1.008003295417443e-20,
        1.33976450202521e-22,
        -4.228211731538657e-23,
        -4.97336341096764e-25,
        1.527488519953821e-25,
        1.605645335954397e-27,
    ],
    &[
        -0.006578162540247516,
        0.04370078640145181,
        -0.01282603716151385,
        -0.0966337548600634,
        0.007506164906830144,
        0.01883650712173855,
        -0.001055549502309466,
        -0.001491824172045358,
        0.0000692852302587848,
        0.00006511516787204352,
        -2.652238430749036e-6,
        -1.810270177495216e-6,
        6.663569936514799e-8,
        3.495112856328456e-8,
        -1.183970260299683e-9,
        -4.966504035575029e-10,
        1.566906061935409e-11,
        5.416162556375435e-12,
        -1.604905890272415e-13,
        -4.678890839386646e-14,
        1.31030728296395e-15,
        3.282407390205013e-16,
        -8.729542232615318e-18,
        -1.907789989531282e-18,
        4.837087080412218e-20,
        9.33918711362474e-21,
        -2.264720313908897e-22,
        -3.904072445295744e-23,
        9.07963435099559e-25,
        1.40564702262488e-25,
        -3.152562233232297e-27,
    ],
    &[
        -0.02871679468796982,
        0.03279242565986759,
        -0.0700976098738277,
        -0.06836629908549496,
        0.03046167309654793,
        0.01311952213073079,
        -0.003708829106453185,
        -0.001026092046295151,
        0.0002199839103565391,
        0.00004428411645183472,
        -7.790699915224318e-6,
        -1.218211046989926e-6,
        1.839644644956612e-7,
        2.328424425988151e-8,
        -3.107494680489871e-9,
        -3.276569334264397e-10,
        3.943874169233348e-11,
        3.539440482566633e-12,
        -3.89991190651589e-13,
        -3.029305056200212e-14,
        3.090221010076978e-15,
        2.105810093651185e-16,
        -2.006459650054159e-17,
        -1.212962059550147e-18,
        1.08716087624145e-19,
        5.885419831739964e-21,
        -4.990730192414399e-22,
        -2.438938674084151e-23,
        1.96611745112773e-24,
        8.706642061731682e-26,
        -6.720171786685261e-27,
    ],
    &[
        -0.03946458634562692,
        0.01350899704540803,
        -0.0985650646089638,
        -0.0233298235685355,
        0.04150192781353713,
        0.004201576816695751,
        -0.00495516172194809,
        -0.000310002115130699,
        0.0002892543492447574,
        0.00001261077637212084,
        -0.00001010364638146915,
        -3.261274347273026e-7,
        2.356993831715213e-7,
        5.839158499304611e-9,
        -3.938545741266084e-9,
        -7.664498379641267e-11,
        4.950337836924507e-11,
        7.685081284456359e-13,
        -4.852492919554055e-13,
        -6.071265101351788e-15,
        3.814601753675005e-15,
        3.870790195584472e-17,
        -2.458892230210468e-17,
        -2.029835784719895e-19,
        1.323453405423443e-19,
        8.889114239272488e-22,
        -6.038158012976794e-22,
        -3.29040324197871e-24,
        2.365181540701571e-24,
        1.036439187410978e-26,
        -8.041069746929365e-27,
    ],
];

pub const SPLITS: [f64; 13] = [
    0.4960067629188495,
    0.926674966755889,
    1.357343170592928,
    2.218679578267007,
    3.941352393615165,
    7.38669802431148,
    14.27738928570411,
    21.16808054709674,
    28.05877180848937,
    34.949463069882,
    41.84015433127463,
    48.73084559266726,
    55.62153685405989,
];
