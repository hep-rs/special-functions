#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(8)
        * polynomial(
            x2,
            &[
                9.68812003968254e-8,
                -2.691144455467372e-9,
                3.363930569334215e-11,
                -2.548432249495618e-13,
                1.327308463278967e-15,
                -5.105032551072952e-18,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                20.29225524421666,
                939.785070997784,
                45227.15654176835,
                2.047942182156948e6,
                8.063772342242983e7,
                2.494729568381423e9,
                5.038462753284624e10,
                3.660758094183359e11,
                -2.852340681717867e12,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 13.35176877775662
        + x1 * polynomial(
            x1,
            &[
                31.875,
                0.0,
                153.3984375,
                0.0,
                1863.9404296875,
                0.0,
                -3427.902112688337,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 16] = [
    &[
        0.1081234321181055,
        0.1688355837060462,
        0.07129289836835641,
        0.0007947876829704856,
        -0.01693281218523776,
        -0.008323016786442416,
        -0.0005753373945239912,
        0.0008731643441708815,
        0.0002680242546343601,
        -0.00002516011279644504,
        -0.00002271745120960687,
        -9.4612360131393e-7,
        1.056129767281731e-6,
        1.019093658639643e-7,
        -3.275996486282962e-8,
        -4.118638832133033e-9,
        7.408723087709468e-10,
        1.055290420452349e-10,
        -1.287211354642131e-11,
        -1.953270558670331e-12,
        1.779866207657677e-13,
        2.78124800403198e-14,
        -2.009815097451014e-15,
        -3.167016448602211e-16,
        1.890608838660284e-17,
        2.963285954117299e-18,
        -1.505438839427029e-19,
        -2.325265707612985e-20,
        1.028219200395465e-21,
        1.54605200616897e-22,
        -6.090718996604985e-24,
    ],
    &[
        0.1061088567364325,
        -0.06417613122628384,
        0.2168554155040378,
        -0.02700411174018128,
        -0.1043262211213931,
        -0.0001902400394886804,
        0.01652638100765887,
        0.001070609082302902,
        -0.001350914501955809,
        -0.0001385634778658581,
        0.00006774719291777349,
        8.776047785667214e-6,
        -2.29890394983149e-6,
        -3.494210092375659e-7,
        5.629197681159531e-8,
        9.74048481500606e-9,
        -1.041256400598191e-9,
        -2.023994258603291e-10,
        1.50584598249391e-11,
        3.269381675794968e-12,
        -1.748751792412003e-13,
        -4.232572624897208e-14,
        1.665993066025644e-15,
        4.495669471401156e-16,
        -1.324837195931682e-17,
        -3.991509856545587e-18,
        8.921246106051067e-20,
        3.007948587865562e-20,
        -5.148297308308293e-22,
        -1.93774803150371e-22,
        2.571568416452008e-24,
    ],
    &[
        -0.01322051846004996,
        -0.04746385657359329,
        -0.01279174205298532,
        -0.1459542918088612,
        0.02768049149316343,
        0.05269928850555573,
        -0.005932971293216353,
        -0.006976668112439409,
        0.0005229117131252503,
        0.000502734078655914,
        -0.00002513478399832764,
        -0.00002319118536552648,
        7.436845135151917e-7,
        7.491272299910374e-7,
        -1.410585636364709e-8,
        -1.794993410883739e-8,
        1.604153857429952e-10,
        3.322591138258597e-10,
        -4.974871117071742e-13,
        -4.897767471160072e-12,
        -2.014578270611997e-14,
        5.887538493175097e-14,
        4.912503897740686e-16,
        -5.882764650310934e-16,
        -6.778959892216097e-18,
        4.963394502190044e-18,
        6.897165520201972e-20,
        -3.583148618168325e-20,
        -5.606261835431091e-22,
        2.226144582356487e-22,
        3.785464809665271e-24,
    ],
    &[
        -0.0289007413446619,
        0.05114126921999635,
        -0.04629975659194368,
        0.1031348327087263,
        0.0502787978396359,
        -0.04370482268332117,
        -0.01061666356899394,
        0.006317697335463695,
        0.001047414311292795,
        -0.0004796260868201112,
        -0.00006152977505060861,
        0.00002274271122839486,
        2.427800833082472e-6,
        -7.424633077913503e-7,
        -6.917964438103329e-8,
        1.777712294660655e-8,
        1.494161619674052e-9,
        -3.263995040603891e-10,
        -2.532526097563813e-11,
        4.750324527384254e-12,
        3.45846444170022e-13,
        -5.622117655673758e-14,
        -3.885342947331075e-15,
        5.522437715537537e-16,
        3.652374222300574e-17,
        -4.577540651651386e-18,
        -2.914034069344179e-19,
        3.246399091300438e-20,
        1.997364938284867e-21,
        -1.982296955138787e-22,
        -1.188398634000738e-23,
    ],
    &[
        0.03996946136241935,
        -0.02368683875333946,
        0.05807610976452604,
        -0.0386974694938896,
        -0.07897705054565643,
        0.01845634500737206,
        0.01798605129425917,
        -0.002865798986543571,
        -0.001855541699347529,
        0.0002298996817234549,
        0.0001116586426153594,
        -0.00001139158356571168,
        -4.441446573331636e-6,
        3.850363691730798e-7,
        1.260444503343493e-7,
        -9.46803354567269e-9,
        -2.688022573147611e-9,
        1.772743553275864e-10,
        4.473341578803445e-11,
        -2.614954238990589e-12,
        -5.978314045158754e-13,
        3.120540295791348e-14,
        6.562538256639976e-15,
        -3.077247582478908e-16,
        -6.025930020321609e-17,
        2.551583277928436e-18,
        4.69852905762505e-19,
        -1.804938462115963e-20,
        -3.150482056416366e-21,
        1.096781137203627e-22,
        1.836109211658368e-23,
    ],
    &[
        -0.0368293496190501,
        -0.004970727083561168,
        -0.05130652833221404,
        -0.01622903473839516,
        0.07704837519675921,
        0.005697886736404565,
        -0.01816917559495948,
        -0.0007230219652509836,
        0.00192388934075198,
        0.00004906873095368945,
        -0.0001182404932093777,
        -2.105342817915613e-6,
        4.784529776893671e-6,
        6.295603254409403e-8,
        -1.376406273413926e-7,
        -1.400725189122067e-9,
        2.966056049171804e-9,
        2.431001370327404e-11,
        -4.973560666951083e-11,
        -3.409142201859578e-13,
        6.680760624296206e-13,
        3.966567936396848e-15,
        -7.355524009513968e-15,
        -3.904959537590571e-17,
        6.762357757155727e-17,
        3.29997180409013e-19,
        -5.271692906797842e-19,
        -2.419482944883648e-21,
        3.530129413856679e-21,
        1.542874614012921e-23,
        -2.052873642446013e-23,
    ],
    &[
        0.02649461389031576,
        0.02659490152251792,
        0.03582551042625132,
        0.05443098208896541,
        -0.05766875467027246,
        -0.02344130680508245,
        0.01392862280991516,
        0.003463887213301587,
        -0.001502898696820292,
        -0.0002696667003507402,
        0.0000938967160673746,
        0.00001312863006676939,
        -3.855667898070706e-6,
        -4.399875039547088e-7,
        1.123880946849364e-7,
        1.080355589169842e-8,
        -2.450447481022943e-9,
        -2.031112125881664e-10,
        4.151763898689816e-11,
        3.021581128455068e-12,
        -5.627613149266461e-13,
        -3.648958508428271e-14,
        6.244676876043699e-15,
        3.651036789871078e-16,
        -5.779538795377282e-17,
        -3.077799960095739e-18,
        4.53089621295072e-19,
        2.216640274070964e-20,
        -3.048218561247756e-21,
        -1.372573533734024e-22,
        1.779362788501905e-23,
    ],
    &[
        -0.01307281864628114,
        -0.03882760952760381,
        -0.01694469326385033,
        -0.07444388607863919,
        0.02997011804318168,
        0.03323003714700265,
        -0.007456167414710353,
        -0.005028303417551268,
        0.000823064391013922,
        0.0003993300273485222,
        -0.00005245021151128048,
        -0.00001978467563707691,
        2.192457840913631e-6,
        6.73438384922307e-7,
        -6.495410477209534e-8,
        -1.676438494472717e-8,
        1.437456703473507e-9,
        3.189868093997176e-10,
        -2.468914170797704e-11,
        -4.794881927820903e-12,
        3.388589832424428e-13,
        5.841701621028894e-14,
        -3.803234633340746e-15,
        -5.888112634658774e-16,
        3.556626876810595e-17,
        4.99342909090467e-18,
        -2.814560467651359e-19,
        -3.613370504425169e-20,
        1.909674194688559e-21,
        2.245533255632437e-22,
        -1.123298751544064e-23,
    ],
    &[
        -0.0005119128950987037,
        0.04167966178776761,
        -0.001637511395220618,
        0.07742170555623731,
        -0.0007963631156422986,
        -0.03521446255712989,
        0.000463341484979981,
        0.005396048370382464,
        -0.0000727420151640161,
        -0.0004331943359974625,
        5.792425197427397e-6,
        0.00002167427585190168,
        -2.845799243022564e-7,
        -7.444748610195938e-7,
        9.55671442516673e-9,
        1.868904981079693e-8,
        -2.34021523821737e-10,
        -3.58383348059361e-10,
        4.371468323979809e-12,
        5.425824913822438e-12,
        -6.441028393803007e-14,
        -6.65402040282005e-14,
        7.682414895194089e-16,
        6.747283083110522e-16,
        -7.572810587385757e-18,
        -5.753328173900771e-18,
        6.274921270744114e-20,
        4.183784396214772e-20,
        -4.433280072124986e-22,
        -2.61146241627617e-22,
        2.702662247092356e-24,
    ],
    &[
        0.01210014045812599,
        -0.03649187371441509,
        0.01720462600838281,
        -0.06626015066723373,
        -0.02471417040829999,
        0.03056486601954043,
        0.005746096427040319,
        -0.004728124490880807,
        -0.0006021162356581923,
        0.0003827114568125755,
        0.00003667588051738201,
        -0.0000192944017944854,
        -1.471929773986161e-6,
        6.674812283526046e-7,
        4.201152593523816e-8,
        -1.687000083149859e-8,
        -8.982576367302904e-10,
        3.255856267075844e-10,
        1.494299913806335e-11,
        -4.959408452848174e-12,
        -1.9908775636228e-13,
        6.117238775680348e-14,
        2.173459810016763e-15,
        -6.236918496119894e-16,
        -1.980681799087151e-17,
        5.34557813836945e-18,
        1.530049131013744e-19,
        -3.90612405816268e-20,
        -1.014973767690576e-21,
        2.449182454266755e-22,
        5.845519362154149e-24,
    ],
    &[
        -0.02022761347232084,
        0.02543413342796936,
        -0.02793052098660541,
        0.04504819905353914,
        0.04302681094496771,
        -0.02110791369082524,
        -0.01026598886965758,
        0.003299313569747879,
        0.001098974390218629,
        -0.0002694684178579219,
        -0.00006827159281180503,
        0.00001369808026321279,
        2.791813730398547e-6,
        -4.775837276296665e-7,
        -8.113451782126569e-8,
        1.216019888184107e-8,
        1.76529036943589e-9,
        -2.363525661092386e-10,
        -2.986660072790978e-11,
        3.624605114940492e-12,
        4.044665027743613e-13,
        -4.499821396523978e-14,
        -4.485738629406249e-15,
        4.616331011768739e-16,
        4.150410974829664e-17,
        -3.980064283740754e-18,
        -3.253275552810746e-19,
        2.92478799927298e-20,
        2.188522980071192e-21,
        -1.843729677982877e-22,
        -1.277435230714827e-23,
    ],
    &[
        0.02412910181802721,
        -0.01111519545165674,
        0.03289264693659551,
        -0.01851027530992652,
        -0.05221916221239757,
        0.00901961016957808,
        0.01259251915641007,
        -0.001445149000760117,
        -0.001359782477373669,
        0.0001204965797576585,
        0.00008514662585452305,
        -6.239619518625814e-6,
        -3.508099537471405e-6,
        2.212716277509378e-7,
        1.02686216723485e-7,
        -5.723762344865489e-9,
        -2.249718504247924e-9,
        1.12910475747186e-10,
        3.831753868796797e-11,
        -1.755858082301267e-12,
        -5.222672119572101e-13,
        2.208712088942586e-14,
        5.828314915098303e-15,
        -2.294277130245236e-16,
        -5.425004886906889e-17,
        2.001511536582561e-18,
        4.276921644631668e-19,
        -1.487358294319224e-20,
        -2.893109065493475e-21,
        9.47542666978139e-23,
        1.697687522978233e-23,
    ],
    &[
        -0.02372055562831311,
        -0.003782973578623526,
        -0.03205415331647701,
        -0.008582731149243244,
        0.05193462629293143,
        0.003472144183825626,
        -0.01261282337086416,
        -0.0004871061678635517,
        0.001369857118544265,
        0.00003592639769817802,
        -0.0000862318907677208,
        -1.648357705053161e-6,
        3.570661245869261e-6,
        5.169791774792557e-8,
        -1.050223715895512e-7,
        -1.177904314278124e-9,
        2.311654523192044e-9,
        2.034341567065311e-11,
        -3.9550958634368e-11,
        -2.747345657423774e-13,
        5.414521088712069e-13,
        2.969386493378942e-15,
        -6.068245366806209e-15,
        -2.613278584769553e-17,
        5.671772745169126e-17,
        1.895609275860103e-19,
        -4.489464795860922e-19,
        -1.141189180536747e-21,
        3.04872950038403e-21,
        5.679077743253547e-24,
        -1.795761466039598e-23,
    ],
    &[
        0.01952697377585022,
        0.01684172655578593,
        0.02617127420000531,
        0.03197989116973551,
        -0.0432160464921742,
        -0.01436436485967092,
        0.01056372503557732,
        0.00218313441511957,
        -0.001153373037385601,
        -0.0001740385228125612,
        0.00007295515787392475,
        8.65200590802015e-6,
        -3.03474203337341e-6,
        -2.953794828292114e-7,
        8.965306769539488e-8,
        7.371717096628561e-9,
        -1.981787892790711e-9,
        -1.405520823973224e-10,
        3.404793740536154e-11,
        2.115892706293963e-12,
        -4.680005291202314e-13,
        -2.580240468462685e-14,
        5.265714303806657e-15,
        2.601635911929215e-16,
        -4.940576052123059e-17,
        -2.205760929523595e-18,
        3.925323825869828e-19,
        1.594777287541405e-20,
        -2.675346782872117e-21,
        -9.89650645574904e-23,
        1.581423790787005e-23,
    ],
    &[
        -0.0125518671842157,
        -0.02618485781541301,
        -0.01662149998527013,
        -0.04842662107632966,
        0.02821059493766395,
        0.0221092538404184,
        -0.006958819577625168,
        -0.003398445511165188,
        0.0007653511323396501,
        0.000273678863271226,
        -0.00004873259580036618,
        -0.00001373698095048705,
        2.039795694320753e-6,
        4.733849643259609e-7,
        -6.061932303573442e-8,
        -1.192297672509928e-8,
        1.347685598622861e-9,
        2.29391248539973e-10,
        -2.32823003228285e-11,
        -3.484238049075594e-12,
        3.217448614694354e-13,
        4.286517009612785e-14,
        -3.639022913041728e-15,
        -4.359919230095944e-16,
        3.431651523267731e-17,
        3.72851217365671e-18,
        -2.739920073901864e-19,
        -2.718813622890696e-20,
        1.876378151862525e-21,
        1.701373899989324e-22,
        -1.114317502759489e-23,
    ],
    &[
        0.004100289520511416,
        0.0306712863991026,
        0.005169320835188134,
        0.0559926464215907,
        -0.00977168093093736,
        -0.02577294722117528,
        0.002490243533784443,
        0.003983822552399699,
        -0.0002808553759476133,
        -0.0003224177711914672,
        0.00001828126956187793,
        0.00001625949679673566,
        -7.807429447547241e-7,
        -5.628577029222823e-7,
        2.364048529624396e-8,
        1.423930364303644e-8,
        -5.348892370475245e-10,
        -2.751456235422782e-10,
        9.39527580256482e-12,
        4.197032838160179e-12,
        -1.318961092854533e-13,
        -5.18510682342629e-14,
        1.514284421290809e-15,
        5.295676174520155e-16,
        -1.4485153153439e-17,
        -4.54715951507024e-18,
        1.17239545957458e-19,
        3.329029990817794e-20,
        -8.134160782072492e-22,
        -2.091386663455668e-22,
        4.89118403033589e-24,
    ],
];

pub const SPLITS: [f64; 17] = [
    0.5784653002285023,
    9.60974097024693,
    18.64101664026535,
    27.67229231028377,
    36.7035679803022,
    45.73484365032062,
    54.76611932033904,
    63.79739499035747,
    72.82867066037589,
    81.85994633039431,
    90.8912220004127,
    99.9224976704312,
    108.9537733404496,
    117.985049010468,
    127.0163246804864,
    136.0476003505049,
    145.0788760205233,
];
