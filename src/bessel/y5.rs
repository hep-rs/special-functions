#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-5)
        * polynomial(
            x2,
            &[
                -244.4619925891512,
                -15.27887453682195,
                -0.6366197723675813,
                -0.02652582384864922,
                -0.001657863990540576,
                -0.0002084926741046031,
                0.00001271672528692236,
                -2.667335508157511e-7,
            ],
        )
        + x.powi(5)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.0001657863990540576,
                    -6.907766627252402e-6,
                    1.2335297548665e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                7.878169683048819,
                134.4212702170205,
                2100.332347140945,
                23431.83274779117,
                100171.0849968072,
                -482073.3465471348,
                7.721781997371071e6,
                -2.262240819542306e8,
                1.009524965720754e10,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 8.639379797371931
        + x1 * polynomial(
            x1,
            &[
                12.375,
                0.0,
                19.3359375,
                0.0,
                -6.3228515625,
                0.0,
                -2268.275089808873,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 13] = [
    &[
        -2921.683450495837,
        3388.856564046984,
        -1313.964298673344,
        408.6711185041645,
        -110.3798279527949,
        27.01279741493668,
        -6.145025540128085,
        1.321282278652784,
        -0.2716332255687369,
        0.05383745193448546,
        -0.0103509676296828,
        0.00193965196275521,
        -0.0003555649831020224,
        0.00006395103202115471,
        -0.00001131222784459539,
        1.971853384513247e-6,
        -3.392638600657042e-7,
        5.769455865774587e-8,
        -9.70899027963083e-9,
        1.618415708410064e-9,
        -2.67459642206513e-10,
        4.385355762694403e-11,
        -7.138634702812469e-12,
        1.15435737479752e-12,
        -1.855249060432057e-13,
        2.964819715222389e-14,
        -4.713079606643081e-15,
        7.455647599211262e-16,
        -1.174681953694555e-16,
        1.885438429079956e-17,
        -2.87452161774943e-18,
    ],
    &[
        -255.8073986983172,
        205.408198452561,
        -52.50035113344531,
        10.62202546757638,
        -1.856374072321365,
        0.2931775688359598,
        -0.04297414991651605,
        0.005948188446738063,
        -0.0007866782248483074,
        0.0001002595116298806,
        -0.00001239090678037158,
        1.492163505786929e-6,
        -1.757502810302887e-7,
        2.030676340615001e-8,
        -2.307289863574721e-9,
        2.583117471956836e-10,
        -2.854203668863868e-11,
        3.116939258713547e-12,
        -3.368113716218681e-13,
        3.604947023053718e-14,
        -3.825104049397369e-15,
        4.026694485103331e-16,
        -4.208261146865152e-17,
        4.368759244026474e-18,
        -4.507528906745237e-19,
        4.624262988340485e-20,
        -4.718971907428754e-21,
        4.791951465832534e-22,
        -4.844207704648474e-23,
        4.923840961281927e-24,
        -4.886813947541703e-25,
    ],
    &[
        -38.97821773888081,
        38.22584287156966,
        -12.47405836056423,
        3.26678581007987,
        -0.7439171020338272,
        0.1536348353535125,
        -0.02951157622154471,
        0.005360321945089458,
        -0.000931162294544464,
        0.0001559758969414917,
        -0.0000253479562837658,
        4.015286614577123e-6,
        -6.222611025695233e-7,
        9.46202841593425e-8,
        -1.415090382996895e-8,
        2.085557456115191e-9,
        -3.033931350144111e-10,
        4.362450067560438e-11,
        -6.20729386003297e-12,
        8.748927942985562e-13,
        -1.222538230852702e-13,
        1.694925582759343e-14,
        -2.332943297189187e-15,
        3.189875201451391e-16,
        -4.334917521310902e-17,
        5.857639875673606e-18,
        -7.873632723538585e-19,
        1.053169309367813e-19,
        -1.402678441145712e-20,
        1.891367054713802e-21,
        -2.454828740736507e-22,
    ],
    &[
        -4.211771422436099,
        4.187574882138598,
        -1.546737390234575,
        0.4667401865574367,
        -0.1235367757076554,
        0.02992557726577943,
        -0.006768895342665254,
        0.001451447505213853,
        -0.0002982319967405852,
        0.00005916683673473371,
        -0.00001139905509520043,
        2.142183158947292e-6,
        -3.940599672022236e-7,
        7.115510733522389e-8,
        -1.264101835836671e-8,
        2.213661107592635e-9,
        -3.827180730963975e-10,
        6.541302407060154e-11,
        -1.106521161401108e-11,
        1.854336867108074e-12,
        -3.081179594369283e-13,
        5.079999238582307e-14,
        -8.315872977690351e-15,
        1.352370567658222e-15,
        -2.185974977500895e-16,
        3.513582962436413e-17,
        -5.618032645180628e-18,
        8.939409937667168e-19,
        -1.416797319873923e-19,
        2.288166016491875e-20,
        -3.508317695436042e-21,
    ],
    &[
        -0.5472915168226122,
        0.5093755355978668,
        -0.08600048699275062,
        0.04331381955988798,
        -0.01355880067637042,
        0.002892422612644868,
        -0.0007148564652771556,
        0.0001745159522824025,
        -0.00003859059628499153,
        8.29420423733153e-6,
        -1.75363844694757e-6,
        3.617533986806796e-7,
        -7.305903042788554e-8,
        1.450330522857578e-8,
        -2.835445846878507e-9,
        5.467904080912754e-10,
        -1.041602050641178e-10,
        1.962467891703457e-11,
        -3.660835587428425e-12,
        6.767527633945292e-13,
        -1.240783294158315e-13,
        2.257765396818499e-14,
        -4.079842341298766e-15,
        7.325271953589527e-16,
        -1.307458631436833e-16,
        2.320821121109679e-17,
        -4.098562833310605e-18,
        7.203742049280838e-19,
        -1.26157599567302e-19,
        2.262161660063861e-20,
        -3.811837288804053e-21,
    ],
    &[
        0.01034441080211221,
        -0.1406111289409602,
        -0.2050200325382152,
        0.07255180408932418,
        0.03235948423365221,
        -0.005015457813126936,
        -0.002495777525407357,
        0.0001968500888487388,
        0.0000926432367169597,
        -2.772196676797142e-6,
        -2.507696166453136e-6,
        7.222418125257383e-8,
        3.249045832949095e-8,
        1.163509254764815e-9,
        -7.633357632246955e-10,
        5.812722180087054e-11,
        -7.157731308527294e-12,
        2.279591875412526e-12,
        -4.743846400842125e-13,
        8.578355887200341e-14,
        -1.63506138569048e-14,
        3.159260095475172e-15,
        -6.005034965174815e-16,
        1.131820729271137e-16,
        -2.12440630524569e-17,
        3.968232969941138e-18,
        -7.375931278009399e-19,
        1.364888003942237e-19,
        -2.517735963452977e-20,
        4.769759450372298e-21,
        -8.440715193794604e-22,
    ],
    &[
        -0.01572787502275527,
        0.08954468937625312,
        -0.06437853650215659,
        0.06961512740304876,
        -0.1116081856040449,
        -0.08157795302720724,
        0.0623728657650412,
        0.02250815709422957,
        -0.01230056141965035,
        -0.00314931412732598,
        0.001327626058063081,
        0.0002745516880542765,
        -0.0000926282045666117,
        -0.00001646701934240801,
        4.570056649895452e-6,
        7.223374591224137e-7,
        -1.687979461132168e-7,
        -2.41830852084985e-8,
        4.855914189252618e-9,
        6.381165760363647e-10,
        -1.120483759943416e-10,
        -1.360940258809266e-11,
        2.121347894487343e-12,
        2.394840675247406e-13,
        -3.356483540680196e-14,
        -3.535428372798963e-15,
        4.503712820478291e-16,
        4.444609503486896e-17,
        -5.195842276573038e-18,
        -4.760841901610619e-19,
        5.19052118385423e-20,
    ],
    &[
        -0.001819618902266336,
        0.08910346746727329,
        0.004976645601870186,
        0.04703768402100904,
        0.02590766271257867,
        -0.10122442356804,
        -0.01075379450363407,
        0.0327012520974682,
        0.001753149052372113,
        -0.004916997478470812,
        -0.000159986973655947,
        0.000441098132571245,
        9.53287691075108e-6,
        -0.00002660784773255435,
        -4.057468416068929e-7,
        1.160242746768044e-6,
        1.308583221481645e-8,
        -3.841119543756819e-8,
        -3.331081513276199e-10,
        1.000491131155777e-9,
        6.889279203440195e-12,
        -2.106687535589587e-11,
        -1.182095908792617e-13,
        3.663615962479708e-13,
        1.709090728207062e-15,
        -5.353880394717266e-15,
        -2.107164252596684e-17,
        6.669684884593536e-17,
        2.236858210017231e-19,
        -7.101998930196166e-19,
        -2.06030654994369e-21,
    ],
    &[
        0.01092585011085844,
        0.0319035885957161,
        0.04531950167233191,
        0.01308437631525917,
        0.08344671677416295,
        -0.04096813746744546,
        -0.04966041827824723,
        0.01441195949421026,
        0.01043923057684845,
        -0.002302503885103115,
        -0.001190280442548103,
        0.0002170429918252763,
        0.00008672072099757217,
        -0.00001365166564967206,
        -4.42025325784269e-6,
        6.168562984275975e-7,
        1.671418313964566e-7,
        -2.105012251131201e-8,
        -4.886849117830578e-9,
        5.626106199765678e-10,
        1.139552825334797e-10,
        -1.210952132785598e-11,
        -2.171072649916274e-12,
        2.14571416313752e-13,
        3.445441517494543e-14,
        -3.186445180294166e-15,
        -4.627380248858516e-16,
        4.024997865224862e-17,
        5.330183898764315e-18,
        -4.337513833771447e-19,
        -5.324038080940724e-20,
    ],
    &[
        0.01243686825049142,
        -0.02495517064654768,
        0.04546537827091255,
        -0.01508059371661437,
        0.07573759256174465,
        0.0265092128815948,
        -0.04774983096827167,
        -0.008086263450736166,
        0.0103955341419662,
        0.001163160076228066,
        -0.001220079105420453,
        -0.0001001686385251233,
        0.0000911937513369848,
        5.80333446584974e-6,
        -4.756748547964042e-6,
        -2.428602969429362e-7,
        1.83672896308678e-7,
        7.706241111881179e-9,
        -5.473337212258113e-9,
        -1.921078652459846e-10,
        1.298543959625645e-10,
        3.866068145306448e-12,
        -2.513013706456814e-12,
        -6.417556761550538e-14,
        4.045073521110764e-14,
        8.942292197318908e-16,
        -5.503052971536802e-16,
        -1.061234159120506e-17,
        6.413369263520003e-18,
        1.076172397238907e-19,
        -6.474497242431536e-20,
    ],
    &[
        0.005804862595874188,
        -0.0549020142009342,
        0.01886361229572454,
        -0.02826116540252362,
        0.02793542328748047,
        0.06431132217600078,
        -0.01893905518349599,
        -0.02125919991676666,
        0.004297550016508964,
        0.003262953656930552,
        -0.000521565891621915,
        -0.0002983326944325085,
        0.00004015240028689493,
        0.00001830805787005456,
        -2.151493679584497e-6,
        -8.104740268210475e-7,
        8.51683732395464e-8,
        2.717957942287428e-8,
        -2.597467236610296e-9,
        -7.155543702674657e-10,
        6.297492813502825e-11,
        1.519792080628781e-11,
        -1.243736320051311e-12,
        -2.661009654694464e-13,
        2.04050805155957e-14,
        3.908899526396345e-15,
        -2.826109747672889e-16,
        -4.88806733315203e-17,
        3.349467591246481e-18,
        5.218461902160397e-19,
        -3.435253144564549e-20,
    ],
    &[
        -0.003157288836966641,
        -0.04958620922490817,
        -0.01381597127633641,
        -0.02411917107099457,
        -0.02641651213053602,
        0.05988337714603966,
        0.0154176615395995,
        -0.02025088462059915,
        -0.003199660077550717,
        0.003163174654861246,
        0.0003604625118343131,
        -0.0002937725487306666,
        -0.00002593623713262149,
        0.00001829386339274983,
        1.304253476767779e-6,
        -8.211993683235147e-7,
        -4.859110270707552e-8,
        2.790960169508931e-8,
        1.397687418915184e-9,
        -7.442860415134184e-10,
        -3.201424580295132e-11,
        1.600545944883513e-11,
        5.981661685611265e-13,
        -2.836130390622865e-13,
        -9.29510404860194e-15,
        4.214485278685754e-15,
        1.220547865813631e-16,
        -5.32912858751507e-17,
        -1.37262358312722e-18,
        5.750035111797764e-19,
        1.336785766624169e-20,
    ],
    &[
        -0.00904047613026518,
        -0.01832732699286319,
        -0.03401614894018928,
        -0.007981463309566538,
        -0.05816673764902823,
        0.02332747622929557,
        0.03621991241614487,
        -0.008183548635546305,
        -0.007838827911526673,
        0.001313362503397054,
        0.000916410864123924,
        -0.0001248694637923857,
        -0.00006830575137232799,
        7.943995501537786e-6,
        3.555716399966944e-6,
        -3.637897023150364e-7,
        -1.370970561044956e-7,
        1.259912234059241e-8,
        4.081090588684705e-9,
        -3.420633028697793e-10,
        -9.67486054735273e-11,
        7.482722445980759e-12,
        1.871234749506817e-12,
        -1.347788644655826e-13,
        -3.01059733058245e-14,
        2.034458023872146e-15,
        4.093954624019251e-16,
        -2.611518702548479e-17,
        -4.769110150132264e-18,
        2.858395942010301e-19,
        4.812283613957227e-20,
    ],
];

pub const SPLITS: [f64; 14] = [
    0.4971116221016192,
    0.865883539987267,
    1.234655457872915,
    1.97219929364421,
    3.447286965186802,
    6.397462308271984,
    12.29781299444235,
    24.09851436678308,
    35.89921573912381,
    47.69991711146454,
    59.50061848380527,
    71.301319856146,
    83.10202122848673,
    94.9027226008275,
];
