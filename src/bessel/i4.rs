#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(4)
        * polynomial(
            x2,
            &[
                0.002604166666666667,
                0.0001302083333333333,
                2.712673611111111e-6,
                3.229373346560847e-8,
                2.522947927000661e-10,
                1.40163773722259e-12,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -3.141670458161282,
                10.79949219992941,
                -17.54917482488529,
                8.226175699164979,
                3.496124672145116,
                4.151648048172325,
                7.78434009032311,
                19.58248053971907,
                61.1952516866221,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -3.588990838678844,
        5.640957042294267,
        0.3025934700185826,
        0.1049576265000946,
        0.02669311261335073,
        0.004846063920524022,
        0.0005111715111446842,
        -0.00001870574303946592,
        -0.00001900679232342597,
        -2.717326109441644e-6,
        4.434786457939354e-7,
        2.926809885486568e-7,
        5.786611394868226e-8,
        -1.487917742160568e-9,
        -4.298629561760143e-9,
        -1.252740705524538e-9,
        -1.040180073260229e-10,
        5.427475324059353e-11,
        2.531011282569811e-11,
        4.5254752836551e-12,
        -3.17761832714843e-13,
        -4.392284332872796e-13,
        -1.265160940155896e-13,
        -1.089652295266717e-14,
        5.654636682226405e-15,
        2.773502852540996e-15,
        5.411391948825383e-16,
        -1.93998638587911e-17,
        -4.722043637293779e-17,
        -1.467193369149028e-17,
        -1.752964862308393e-18,
    ],
    &[
        25.83231774569723,
        30.54961817528946,
        8.83102049985682,
        1.867014684613802,
        0.2764675266456404,
        0.03515698638268955,
        0.003749873696894198,
        0.0002711124079359388,
        0.00003545210280310692,
        1.363036102442757e-6,
        -4.743580225225264e-7,
        2.589767424378959e-7,
        -4.910727788533513e-8,
        -3.244768463120121e-9,
        6.093515370329362e-9,
        -2.143518872659512e-9,
        2.201644964694565e-10,
        1.506805823757286e-10,
        -8.6833291884852e-11,
        1.683821898703478e-11,
        4.046258309586626e-12,
        -3.727105552797529e-12,
        9.17198200903287e-13,
        1.430095654159648e-13,
        -1.758871178062608e-13,
        4.468613320372305e-14,
        8.146148716011234e-15,
        -9.004203612185628e-15,
        1.955986569218941e-15,
        6.801987225996273e-16,
        -4.657323427250453e-16,
    ],
];

pub const SPLITS: [f64; 3] = [-0.7675178477128486, 1.744438595117595, 4.256395037948039];
