#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(1)
        * polynomial(
            x2,
            &[
                0.5,
                -0.0625,
                0.002604166666666667,
                -0.00005425347222222222,
                6.781684027777778e-7,
                -5.651403356481481e-9,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                0.238732414637843,
                -0.2238116387229778,
                0.979175919413028,
                -9.63876295672199,
                166.9915682252085,
                -4477.461423038404,
                171502.7634360246,
                -8.883307199850336e6,
                5.977725469899289e8,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 2.356194490192345
        + x1 * polynomial(
            x1,
            &[
                0.375,
                0.0,
                -0.1640625,
                0.0,
                0.3708984375,
                0.0,
                -2.369397844587054,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        0.1515500247977114,
        -0.1545756607555751,
        0.1363610651883701,
        0.03296453667443496,
        -0.2791543864593717,
        0.03070473341402296,
        0.07283267543637865,
        -0.008195271336456433,
        -0.008627585622920527,
        0.0008908933786929099,
        0.0006018319721240416,
        -0.00005632182281415264,
        -0.00002796708042239953,
        2.37767304115116e-6,
        9.3236402644979e-7,
        -7.241531819616888e-8,
        -2.344565462789211e-8,
        1.673713111859581e-9,
        4.612205519104459e-10,
        -3.043667262753634e-11,
        -7.298089348693514e-12,
        4.475468167510241e-13,
        9.49552930776484e-14,
        -5.436590769715534e-15,
        -1.034184751475414e-15,
        5.551431067067221e-17,
        9.56931647359995e-18,
        -4.83410491082538e-19,
        -7.6175204994084e-20,
        3.60964082122913e-21,
        5.272112380283026e-22,
    ],
    &[
        -0.04208410476391191,
        0.05424100111402629,
        -0.03209590874226853,
        0.04122620743408568,
        0.150913927375884,
        -0.04334120218268853,
        -0.04581342056400016,
        0.01001166334859269,
        0.005866943969159206,
        -0.001097901834428535,
        -0.0004269571697381284,
        0.00007157000699433821,
        0.00002028694289065478,
        -3.116599003725309e-6,
        -6.833525484713553e-7,
        9.751713779907e-8,
        1.723748754363745e-8,
        -2.305223117986529e-9,
        -3.386482065852361e-10,
        4.270726371025909e-11,
        5.33703807558193e-12,
        -6.3768518771316e-13,
        -6.904823935124372e-14,
        7.845496610606889e-15,
        7.470754472472674e-16,
        -8.096768015873245e-17,
        -6.86378826461888e-18,
        7.113798221522812e-19,
        5.424028916198422e-20,
        -5.352001011581069e-21,
        -3.726570038430481e-22,
    ],
    &[
        0.02458812831757537,
        -0.07950981701202916,
        0.02121688580271714,
        -0.08426170324686344,
        -0.08286524015055537,
        0.06282263923158539,
        0.02482349560218755,
        -0.01298691052392663,
        -0.003166995674215571,
        0.001344445380713933,
        0.0002299026563998587,
        -0.00008493862214517462,
        -0.00001087129873009786,
        3.637334965349515e-6,
        3.630571741290485e-7,
        -1.128510884133751e-7,
        -9.0431293969431e-9,
        2.657631221270762e-9,
        1.747789916913807e-10,
        -4.917820713449688e-11,
        -2.701123558560313e-12,
        7.344705872160191e-13,
        3.417867167664207e-14,
        -9.04460104209076e-15,
        -3.609207943674614e-16,
        9.34566757455144e-17,
        3.231066476966147e-18,
        -8.221664318885125e-19,
        -2.484843406342127e-20,
        6.193080897158326e-21,
        1.659918022802056e-22,
    ],
    &[
        -0.00935923188405449,
        0.08559757039729365,
        -0.01046149078515834,
        0.0966493672936386,
        0.02475521020139431,
        -0.06752378939105497,
        -0.006496476913705401,
        0.0135468574909179,
        0.0007263726358697698,
        -0.001373960286665782,
        -0.00004514475176477489,
        0.00008551146826859515,
        1.751509613263603e-6,
        -3.621447748209983e-6,
        -4.459403106583733e-8,
        1.114399126415325e-7,
        7.334046991092797e-10,
        -2.608546652505423e-9,
        -6.245614500610082e-12,
        4.805370543350269e-11,
        -3.596199094762094e-14,
        -7.152638015659447e-13,
        2.255248667756674e-15,
        8.785359945938446e-15,
        -4.408647945512958e-17,
        -9.05922628304264e-17,
        5.869055798728346e-19,
        7.956191292608054e-19,
        -6.070121854369372e-21,
        -5.984383770193049e-21,
        5.143511068293522e-23,
    ],
];

pub const SPLITS: [f64; 5] = [
    0.3488841264349171,
    10.27314565077445,
    20.19740717511398,
    30.1216686994535,
    40.04593022379303,
];
