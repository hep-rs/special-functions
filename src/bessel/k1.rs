#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-1)
        * polynomial(
            x2,
            &[
                1.,
                -0.3079657578292062,
                -0.08537071972865078,
                -0.00464218276647156,
                -0.0001125360703663057,
                -1.559288770203821e-6,
            ],
        )
        + x.powi(1)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.5,
                    0.0625,
                    0.002604166666666667,
                    0.00005425347222222222,
                    6.781684027777778e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155,
                0.4699928014933126,
                -0.1468727504666602,
                0.1285136566583277,
                -0.1807223296757733,
                0.3478904846258636,
                -0.8479830562755424,
                2.49852150509758,
                -8.627707072290082,
                34.15134049448157,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 5] = [
    &[
        1.095242433205591,
        -0.4008151591040047,
        -0.006308835015913904,
        -0.0004969933167669846,
        -0.00002641663657136274,
        -9.62011957045458e-7,
        -2.346784400521485e-8,
        -4.184665914072774e-10,
        -1.220864946962056e-11,
        -5.81885193730799e-13,
        -1.29386997688628e-14,
        3.177809716093256e-16,
        2.069043505791436e-17,
        -2.975321335249548e-19,
        -4.424407317908206e-20,
        -3.270170717901442e-22,
        7.336253852785718e-23,
        1.979567641693399e-24,
        -9.6654747887394e-26,
        -5.475367933838987e-27,
        7.469163344165483e-29,
        1.159689443618264e-29,
        8.143549890477862e-32,
        -2.019558762199311e-32,
        -5.391258231248365e-34,
        2.785585335946895e-35,
        1.556094475429649e-36,
        -2.314209485802085e-38,
        -3.413695556852661e-39,
        -2.122969843610228e-41,
        6.135552917299735e-42,
    ],
    &[
        0.2180800038959163,
        -0.484011875172306,
        -0.01555620343806863,
        -0.001109237315735019,
        -0.00005255858402301878,
        -1.731983194446847e-6,
        -4.429135213641665e-8,
        -1.204266235345994e-9,
        -3.738470583087898e-11,
        -6.664444393773759e-13,
        7.714296017440809e-15,
        1.554299689815804e-16,
        -3.231981268369165e-17,
        -7.17192928901964e-19,
        5.290545107894554e-20,
        1.493384174018831e-21,
        -9.47951821053367e-23,
        -3.20118491401561e-24,
        1.692975939195154e-25,
        6.769038662089552e-27,
        -3.033856472703468e-28,
        -1.424407532721485e-29,
        5.433135876521661e-31,
        2.990157793715398e-32,
        -9.67749534343216e-34,
        -6.266740518953453e-35,
        1.704546705242687e-36,
        1.310987055628005e-37,
        -2.947747920948327e-39,
        -2.730584846492504e-40,
        4.956648909086429e-42,
    ],
    &[
        -1.857385780716331,
        -1.764484377500431,
        -0.2142751823600583,
        -0.02668617291548185,
        -0.002308264001373247,
        -0.0001558572936858398,
        -9.30054593589881e-6,
        -4.907796442106999e-7,
        -1.961692923648845e-8,
        -6.569616566643893e-10,
        -3.819429376554228e-11,
        -1.479819875554232e-12,
        6.569450794720367e-14,
        1.576804420186316e-16,
        -6.842708702435915e-16,
        1.764472877392463e-17,
        3.987333562325126e-18,
        -2.76046301980759e-19,
        -1.776885670090988e-20,
        2.649534274907573e-21,
        2.375500013989691e-23,
        -2.012643497245885e-23,
        6.300445462427698e-25,
        1.229155180232396e-25,
        -9.6095656751955e-27,
        -5.310374224017236e-28,
        9.32827658814408e-29,
        2.662693117758597e-31,
        -7.138368321327277e-31,
        2.600680294401042e-32,
        4.350171631254079e-33,
    ],
    &[
        -8.781620885592958,
        -5.732893073285274,
        -0.914949991818731,
        -0.1070352370785068,
        -0.00927640057389465,
        -0.0006497707401025651,
        -0.00003805959528790284,
        -1.88992810809041e-6,
        -8.306148039503363e-8,
        -3.290740787650496e-9,
        -1.102702164409608e-10,
        -3.575904532520679e-12,
        -1.277467459559053e-13,
        -1.54769101636161e-15,
        -4.377940273517063e-17,
        -1.077128829743372e-17,
        4.495608567021639e-19,
        1.344046449031079e-20,
        -3.539597945852249e-21,
        1.76286839338126e-22,
        5.097261591326235e-24,
        -1.267365917312989e-24,
        7.204052974040608e-26,
        7.801922194779179e-28,
        -4.635108377033411e-28,
        3.650637729717466e-29,
        -3.851824016854622e-31,
        -2.035247189168119e-31,
        2.002060776918489e-32,
        -2.969563536583314e-34,
        -1.051075272291007e-34,
    ],
    &[
        -34.3405699392571,
        -22.14072368974903,
        -3.745491406325189,
        -0.4342220617566006,
        -0.03785107086372485,
        -0.002648323211572716,
        -0.0001544560070194465,
        -7.728728676918347e-6,
        -3.388055469709301e-7,
        -1.318205956517378e-8,
        -4.627723311448446e-10,
        -1.477445028598492e-11,
        -4.282911935101064e-13,
        -1.17873873194886e-14,
        -2.908922509792307e-16,
        -6.2394548486791e-18,
        -2.021050098897681e-19,
        -1.17643072405702e-21,
        2.731420601425442e-24,
        -1.400862552591203e-23,
        7.314003706605403e-25,
        -6.388528743656595e-27,
        -2.416719172236718e-27,
        1.886571802116836e-28,
        -3.879894062381967e-30,
        -3.79741600027706e-31,
        3.029120610132357e-32,
        -5.007406973313847e-35,
        -9.0986056234572e-35,
        4.655577348133265e-37,
        6.95112458707624e-37,
    ],
];

pub const SPLITS: [f64; 6] = [
    -1.541328429516419,
    -0.8391909651017916,
    -0.1370535006871645,
    1.26722142814209,
    2.671496356971344,
    4.075771285800598,
];
