use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-1)
        * polynomial(
            x2,
            &[
                1.,
                -0.3079657578292062,
                -0.08537071972865078,
                -0.004642182766471561,
                -0.00011253607036630566,
                -1.5592887702038207e-6,
            ],
        )
        + x.powi(1)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.5,
                    0.0625,
                    0.0026041666666666665,
                    0.00005425347222222222,
                    6.781684027777778e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                0.4699928014933126,
                -0.14687275046666018,
                0.12851365665832765,
                -0.18072232967577326,
                0.3478904846258635,
                -0.8479830562755424,
                2.49852150509758,
                -8.62770707229008,
                34.15134049448157,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        1.6856200440751639,
        -1.6771327051374885,
        0.6591367908248947,
        -0.25374044635473,
        0.0987366332504477,
        -0.03867449497975133,
        0.015188332825294013,
        -0.005971167949838312,
        0.0023486912010193648,
        -0.0009240785014431066,
        0.0003636303782706797,
        -0.000143104861487711,
        0.000056321860329220643,
        -0.000022167622069149867,
        8.725193999549832e-6,
        -3.4343234925014663e-6,
        1.351807576809865e-6,
        -5.321013012197666e-7,
        2.0944897572190837e-7,
        -8.244525881317298e-8,
        3.245308182197647e-8,
        -1.2774634340695464e-8,
        5.028551107042946e-9,
        -1.979423815358452e-9,
        7.791767571067716e-10,
        -3.0671446385809206e-10,
        1.2073506727880044e-10,
        -4.752623046236352e-11,
        1.870828467231651e-11,
        -7.364362148929092e-12,
        2.8989237748819556e-12,
        -1.1411398784769546e-12,
        4.4920165017722323e-13,
        -1.7682518935511195e-13,
        6.960608543745202e-14,
        -2.739999889825026e-14,
        1.0785843404273442e-14,
        -4.245783987852268e-15,
        1.6713290568925139e-15,
        -6.579105650880204e-16,
        2.589859458910286e-16,
        -1.0195613687622841e-16,
        4.015405436053741e-17,
        -1.5856108017375782e-17,
        6.367856302518512e-18,
        -2.8272150852346038e-18,
        9.63602907072163e-19,
    ],
    &[
        0.27548024051407394,
        -0.1718117454494001,
        0.03192073722853861,
        -0.004833576967921206,
        0.0006880337082456144,
        -0.0000977529367464635,
        0.00001406048687842448,
        -2.042787787754533e-6,
        2.985087237528892e-7,
        -4.37555881552271e-8,
        6.4247119351680466e-9,
        -9.443144225109947e-10,
        1.3888719877428642e-10,
        -2.043611071980414e-11,
        3.007931515865427e-12,
        -4.4282741964342435e-13,
        6.520382786559801e-14,
        -9.602104055323235e-15,
        1.4141714970243344e-15,
        -2.082912660648147e-16,
        3.068079457041839e-17,
        -4.519429266965667e-18,
        6.657606085098289e-19,
        -9.807696916440223e-20,
        1.4448673994741565e-20,
        -2.128624354792838e-21,
        3.136018241740339e-22,
        -4.620249015909234e-23,
        6.807041442999439e-24,
        -1.0028979748377433e-24,
        1.4776097423289432e-25,
        -2.1770418074908113e-26,
        3.2075786825732456e-27,
        -4.7259700477580745e-28,
        6.963175521795604e-29,
        -1.0259498652979993e-29,
        1.511635504361819e-30,
        -2.2272550111521663e-31,
        3.2816670719594704e-32,
        -4.8352689044848784e-33,
        7.124397247918291e-34,
        -1.04972822107466e-34,
        1.5467026876087374e-35,
        -2.278988241201304e-36,
        3.3594959347729915e-37,
        -5.055102332500938e-38,
        7.290135337619726e-39,
    ],
    &[
        0.05680796793323194,
        -0.055259368610864876,
        0.015456278860456144,
        -0.0031827640628931866,
        0.0005495633088883129,
        -0.00008668051110447374,
        0.00001321601205877509,
        -2.009765901789423e-6,
        3.0842079166042673e-7,
        -4.7807963665291194e-8,
        7.465927941687582e-9,
        -1.1715074588590016e-9,
        1.8437369908546877e-10,
        -2.9071964755629744e-11,
        4.589816805644615e-12,
        -7.252630278336136e-13,
        1.1467524570398125e-13,
        -1.814044131135832e-14,
        2.8706594619230438e-15,
        -4.54398214153646e-16,
        7.19428020682673e-17,
        -1.1392392199787377e-17,
        1.8042840774618467e-18,
        -2.8578941962757466e-19,
        4.52720185296686e-20,
        -7.172145658628221e-21,
        1.1363138383634363e-21,
        -1.80041624720317e-22,
        2.852786628319269e-23,
        -4.520477914831016e-24,
        7.163340261139501e-25,
        -1.1351698930318678e-25,
        1.7989472322333883e-26,
        -2.8509313341427907e-27,
        4.5181909583650355e-28,
        -7.160622915967436e-29,
        1.1348657301053982e-29,
        -1.7986422980596175e-30,
        2.8506970173079367e-31,
        -4.518170806210282e-32,
        7.161088114191561e-33,
        -1.1350100645036186e-33,
        1.7989723013227087e-34,
        -2.8514077443568507e-35,
        4.5222838616969467e-36,
        -7.343348906648244e-37,
        1.1354160214476701e-37,
    ],
    &[
        0.004328214768572449,
        -0.0060934479301395965,
        0.0027101695868641906,
        -0.000878299054281981,
        0.00022603363473810298,
        -0.00004899449537947546,
        9.356328129725199e-6,
        -1.633931917068206e-6,
        2.6937779080114496e-7,
        -4.304504930494146e-8,
        6.799142529528803e-9,
        -1.0747130092679504e-9,
        1.7097425455863262e-10,
        -2.741048048363259e-11,
        4.424183270851708e-12,
        -7.177750606419732e-13,
        1.1688318506687933e-13,
        -1.908323246948446e-14,
        3.1214968206811125e-15,
        -5.112895034223395e-16,
        8.383331529596808e-17,
        -1.3756572544065294e-17,
        2.258784947367709e-18,
        -3.710710130930576e-19,
        6.098405443284885e-20,
        -1.0025858614736833e-20,
        1.6487260736322947e-21,
        -2.711925267610496e-22,
        4.4616307788791183e-23,
        -7.341479056707419e-24,
        1.2081952531020558e-24,
        -1.988592046036344e-25,
        3.2734227633923464e-26,
        -5.388902049771034e-27,
        8.872278579830088e-28,
        -1.4608391450681203e-28,
        2.4054606829026358e-29,
        -3.961134369975219e-30,
        6.523243339575267e-31,
        -1.0743057191174025e-31,
        1.7693364269737478e-32,
        -2.914132935698978e-33,
        4.7998020788851314e-34,
        -7.906038280498412e-35,
        1.3031943625520944e-35,
        -2.203268522535058e-36,
        3.533461246526256e-37,
    ],
    &[
        0.00005275748436438381,
        -0.00009064026648287784,
        0.00005896058012610087,
        -0.000030236217398438454,
        0.000012686258998950159,
        -4.490109377136854e-6,
        1.3741918315914988e-6,
        -3.7113628026618474e-7,
        8.998402206596038e-8,
        -1.9881235963104893e-8,
        4.0573497595550645e-9,
        -7.745536479625774e-10,
        1.400004851827607e-10,
        -2.424214885603722e-11,
        4.06694040447324e-12,
        -6.679809151257164e-13,
        1.0840206872554638e-13,
        -1.7509572375181654e-14,
        2.8296803786958076e-15,
        -4.589515951802398e-16,
        7.480821235602884e-17,
        -1.2255974973582737e-17,
        2.0171520859186432e-18,
        -3.3326407561534156e-19,
        5.522840351851483e-20,
        -9.174300460112163e-21,
        1.5268354701754919e-21,
        -2.5447639772560646e-22,
        4.246290345849608e-23,
        -7.092221416654916e-24,
        1.1854748341570035e-24,
        -1.9828219720563584e-25,
        3.318275701656533e-26,
        -5.5557605004086914e-27,
        9.305687958838115e-28,
        -1.559208122847669e-28,
        2.6133104370774895e-29,
        -4.381199634379876e-30,
        7.346771570915996e-31,
        -1.2322245401276557e-31,
        2.0671073617367708e-32,
        -3.468226926298757e-33,
        5.819907656768711e-34,
        -9.767676382415842e-35,
        1.6407556738583274e-35,
        -2.8296678118025583e-36,
        4.620297584087614e-37,
    ],
    &[
        1.6856838779686755e-8,
        -3.140061274837719e-8,
        2.5419102560950683e-8,
        -1.7976835708701306e-8,
        1.1188008445542445e-8,
        -6.1782210435401555e-9,
        3.052889403582872e-9,
        -1.3609332078028358e-9,
        5.515120553605881e-10,
        -2.0460486117514816e-10,
        6.993668809972038e-11,
        -2.215444935935745e-11,
        6.538859829091031e-12,
        -1.8069916427347478e-12,
        4.69667783402274e-13,
        -1.1530342540666212e-13,
        2.6843777115935177e-14,
        -5.9491073473096016e-15,
        1.2597161890487341e-15,
        -2.557912610083658e-16,
        4.998803631757017e-17,
        -9.436369576722504e-18,
        1.7271292821512309e-18,
        -3.0767253941458507e-19,
        5.355488996810844e-20,
        -9.145011352180944e-21,
        1.538043047749223e-21,
        -2.55756699504135e-22,
        4.2201497724468953e-23,
        -6.93217566452879e-24,
        1.1366474743903358e-24,
        -1.8642709780383122e-25,
        3.063101672677189e-26,
        -5.046310551323967e-27,
        8.3392788475575e-28,
        -1.3824550096306453e-28,
        2.298613344315477e-29,
        -3.832149643754658e-30,
        6.403673773089955e-31,
        -1.072201765478406e-31,
        1.798244990150302e-32,
        -3.020158680408421e-33,
        5.0783500739975585e-34,
        -8.547864094635824e-35,
        1.4410973500043174e-35,
        -2.4965739117167134e-36,
        4.0948454897790765e-37,
    ],
    &[
        5.070068969552866e-15,
        -9.433351843087306e-15,
        7.609929147022478e-15,
        -5.351555693587315e-15,
        3.3050400870273664e-15,
        -1.8075885027534674e-15,
        8.829531491166661e-16,
        -3.883575483257547e-16,
        1.5497873344597886e-16,
        -5.650171674205113e-17,
        1.893716992507853e-17,
        -5.867809191865405e-18,
        1.6894347540578381e-18,
        -4.540341969987482e-19,
        1.1436694327624498e-19,
        -2.7101299730667297e-20,
        6.062074572104204e-21,
        -1.2838897111382433e-21,
        2.5818410603714504e-22,
        -4.9425080069551094e-23,
        9.028495636017523e-24,
        -1.5772186849038282e-24,
        2.6403981658815713e-25,
        -4.2440763933103205e-26,
        6.561741448435508e-27,
        -9.775091120559093e-28,
        1.4053879750139565e-28,
        -1.9530968480462678e-29,
        2.6275935859915896e-30,
        -3.4271744835392085e-31,
        4.3399242062327434e-32,
        -5.343346611059586e-33,
        6.405392632461545e-34,
        -7.486853997870377e-35,
        8.544834282726873e-36,
        -9.536802561032453e-37,
        1.0424627881048062e-37,
        -1.1178007376631638e-38,
        1.1776828561257722e-39,
        -1.2212212252999071e-40,
        1.2486216535426237e-41,
        -1.2610393272042721e-42,
        1.260353801036061e-43,
        -1.248905187454912e-44,
        1.2293351670205041e-45,
        -1.2152526793686419e-46,
        1.1749302586668277e-47,
    ],
    &[
        1.760624959041524e-21,
        -3.274448188830953e-21,
        2.6382814419892556e-21,
        -1.8516773938098475e-21,
        1.140552810193955e-21,
        -6.217705214915888e-22,
        3.025677102085631e-22,
        -1.325106531573301e-22,
        5.2627908569063325e-23,
        -1.9086536418406467e-23,
        6.3606231132630585e-24,
        -1.9587296699486766e-24,
        5.601991763212138e-25,
        -1.4947596202179014e-25,
        3.736215812173634e-26,
        -8.780552456184778e-27,
        1.9466445154488467e-27,
        -4.083557635737558e-28,
        8.127802778455919e-29,
        -1.5388000045891094e-29,
        2.7775824265430564e-30,
        -4.790140685907565e-31,
        7.90816254979486e-32,
        -1.2520883705089838e-32,
        1.9043905479818013e-33,
        -2.7868769066941836e-34,
        3.929653043950389e-35,
        -5.346366080625191e-36,
        7.027296775277774e-37,
        -8.934441199780284e-38,
        1.0999957583738889e-38,
        -1.3128883038739582e-39,
        1.5206269006864464e-40,
        -1.7108008525522825e-41,
        1.87138448838828e-42,
        -1.9920557430621256e-43,
        2.065324071375627e-44,
        -2.087294425318678e-45,
        2.0579629287067026e-46,
        -1.981025503546047e-47,
        1.8632632950281718e-48,
        -1.713631256363914e-49,
        1.5422082999382563e-50,
        -1.3591672658113114e-51,
        1.173945969180564e-52,
        -1.0010839793479803e-53,
        8.266329551404132e-55,
    ],
];

pub const SPLITS: [f64; 9] = [
    0.21409650032218755,
    1.1309995024644077,
    2.047902504606628,
    3.8817085088910686,
    7.549320517459949,
    14.884544534597712,
    29.554992568873235,
    44.22544060314876,
    58.895888637424285,
];
