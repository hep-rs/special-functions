use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                1.,
                -0.3079657578292062,
                -0.08537071972865078,
                -0.004642182766471561,
                -0.00011253607036630566,
                -1.5592887702038207e-6,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.5,
                    0.0625,
                    0.0026041666666666665,
                    0.00005425347222222222,
                    6.781684027777778e-7,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    (-x).exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                1.2533141373155001,
                0.4699928014933126,
                -0.14687275046666018,
                0.12851365665832765,
                -0.18072232967577326,
                0.3478904846258635,
                -0.8479830562755424,
                2.49852150509758,
                -8.62770707229008,
                34.15134049448157,
            ],
        )
}

pub const NUMERATORS: [&[f64]; 20] = [
    &[],
    &[
        2.8345973828486595e6,
        1.0712269377168424e8,
        1.1614018200621538e9,
        4.649517134630404e9,
        6.766771987667769e9,
        2.0354023028281686e9,
        -1.089737470684343e9,
        1.3656218833619907e8,
        -5.344904054143329e6,
    ],
    &[
        13843.169902548776,
        80191.66142325423,
        108054.69602023641,
        15560.64343359311,
        -14358.91879415322,
        2503.292159990406,
        -188.11208214232195,
        5.52923483694984,
    ],
    &[
        1588.9218511889417,
        3734.650155474491,
        511.2181497937109,
        -866.5438616885233,
        260.0072486078631,
        -41.668311888037195,
        4.225190495944716,
        -0.28378730294111326,
        0.012432793616424626,
        -0.0003259426723073057,
        3.919345827686994e-6,
    ],
    &[
        30.40376606699917,
        2.243860675132994,
        -3.568719777967358,
        0.8235348035622678,
        -0.10062477057394946,
        0.007810121910476715,
        -0.0004084250236923427,
        0.000014510474680377189,
        -3.3892684907625153e-7,
        4.729791900563324e-9,
        -3.006134772923432e-11,
    ],
    &[
        -0.025365079599895802,
        0.008269068456112463,
        -0.0012220251239822549,
        0.0001074060534956601,
        -6.184544040003752e-6,
        2.418272017370229e-7,
        -6.4180511355283186e-9,
        1.1142415098052031e-10,
        -1.1476236316284533e-12,
        5.339756037312905e-15,
    ],
    &[
        -3.1257814957062727e-6,
        8.589448851240995e-7,
        -1.062974116356104e-7,
        7.772701831804329e-9,
        -3.699560132565677e-10,
        1.1881970414333152e-11,
        -2.574087625344155e-13,
        3.6257370742902375e-15,
        -3.011938353206874e-17,
        1.12385634459067e-19,
    ],
    &[
        -1.3667766961872748e-9,
        3.22692465468692e-10,
        -3.417665356625143e-11,
        2.1305908442533737e-12,
        -8.61350500691713e-14,
        2.341242252333008e-15,
        -4.2774390119477115e-17,
        5.063889674971078e-19,
        -3.5240174581163405e-21,
        1.098085863215647e-23,
    ],
    &[
        -1.1193333215385409e-12,
        2.3093728795473277e-13,
        -2.1321116424621136e-14,
        1.1558978095263075e-15,
        -4.05447670367596e-17,
        9.54039863246094e-19,
        -1.505679444327283e-20,
        1.5365910851592932e-22,
        -9.199577118203643e-25,
        2.461418613568431e-27,
    ],
    &[
        -1.3106813346533554e-15,
        2.3970814532563384e-16,
        -1.9585960557703143e-17,
        9.382503459192837e-19,
        -2.903618378954316e-20,
        6.019224140415834e-22,
        -8.357225613163425e-24,
        7.492936798729777e-26,
        -3.9360096175015363e-28,
        9.228265231525317e-31,
    ],
    &[
        -1.91820714820618e-18,
        3.14711363648907e-19,
        -2.3041997449216166e-20,
        9.880299476035269e-22,
        -2.734093957067122e-23,
        5.062895159130843e-25,
        -6.273102032460224e-27,
        5.0144850417853326e-29,
        -2.346341959852911e-31,
        4.895952329069648e-34,
    ],
    &[
        -3.256788826028081e-21,
        4.8414201149467665e-22,
        -3.209221229800825e-23,
        1.2448962360975445e-24,
        -3.114120834047382e-26,
        5.209143058810656e-28,
        -5.826288464837342e-30,
        4.2013178967568894e-32,
        -1.7722191681134164e-34,
        3.3316344188235706e-37,
    ],
    &[
        -6.1349221093385515e-24,
        8.333247590629977e-25,
        -5.044375609157556e-26,
        1.7859097520340936e-27,
        -4.075122948998203e-29,
        6.214676092517615e-31,
        -6.333835056982662e-33,
        4.159736176481296e-35,
        -1.5973246443517195e-37,
        2.7322823419554607e-40,
    ],
    &[
        -1.2463925383517308e-26,
        1.5580941686459898e-27,
        -8.676147122931067e-29,
        2.8244343022240233e-30,
        -5.923567818190594e-32,
        8.299571454840175e-34,
        -7.768331704742327e-36,
        4.6836591716069713e-38,
        -1.6504827275323651e-40,
        2.5899208081619347e-43,
    ],
    &[
        -2.680049427085174e-29,
        3.1023335857743117e-30,
        -1.5991116061380138e-31,
        4.817204635541546e-33,
        -9.345826549959981e-35,
        1.2109436151788661e-36,
        -1.0478452558959197e-38,
        5.838845648727676e-41,
        -1.901078424438527e-43,
        2.7555075891974835e-46,
    ],
    &[
        -6.020256286313725e-32,
        6.487608562276912e-33,
        -3.112295145905656e-34,
        8.723448277436906e-36,
        -1.5743105336791773e-37,
        1.8970022948536756e-39,
        -1.5261846149873392e-41,
        7.904977209151302e-44,
        -2.3918723125209317e-46,
        3.221123242354461e-49,
    ],
    &[
        -1.3996963230508324e-34,
        1.4107583563475655e-35,
        -6.328535204632092e-37,
        1.658337425053001e-38,
        -2.797356112355194e-40,
        3.150000675999631e-42,
        -2.367829642977344e-44,
        1.1456766192730993e-46,
        -3.237704092220638e-49,
        4.071609296449884e-52,
    ],
    &[
        -3.3453377654886367e-37,
        3.1665870072950604e-38,
        -1.3338210362597858e-39,
        3.281313799982255e-41,
        -5.195531785657983e-43,
        5.4907170829019396e-45,
        -3.872894572172658e-47,
        1.7581118507715447e-49,
        -4.660741424181349e-52,
        5.4973479791360034e-55,
    ],
    &[
        7.627208718722765e-41,
        -6.708955735054721e-42,
        2.625826640994245e-43,
        -6.001912646454711e-45,
        8.829070871982369e-47,
        -8.668182154359104e-49,
        5.679637727297556e-51,
        -2.394917794119968e-53,
        5.897018597919107e-56,
        -6.46010188026628e-59,
    ],
    &[],
];

pub const DENOMINATORS: [&[f64]; 20] = [
    &[],
    &[
        1.,
        2.8344343903565966e6,
        1.0714383029496552e8,
        1.1686357982186635e9,
        4.839707992800399e9,
        8.228002898616939e9,
        5.902915326760353e9,
        2.0650954704900372e9,
        4.8154585420402396e8,
        6.431542548750225e7,
        7.9953724526649015e6,
    ],
    &[
        1.,
        13814.571871580409,
        80824.96503288145,
        130604.0285822157,
        82652.34171725006,
        27151.587963051756,
        5662.973906333737,
        808.5198730020559,
        75.24468845567863,
        5.516419002174684,
    ],
    &[
        1.,
        1574.3498287837108,
        3893.025836052525,
        2435.0470833470013,
        614.5453581277187,
        96.80214622852394,
        8.173116296448097,
        0.5428011067703181,
    ],
    &[
        1.,
        26.201859248286997,
        15.250081256206121,
        5.925926325511097,
        0.9726976747022975,
        0.19343113693112207,
        0.01203158298984291,
        0.0020643797605907357,
        0.00002853205678004553,
        7.36556048874042e-6,
    ],
    &[
        1.,
        -1.05506961630419,
        0.4818290228793614,
        -0.14075579521991055,
        0.02583086839827343,
        -0.003502228228809758,
        0.00031484071891157555,
        -0.00002113117616661346,
        8.334179621849281e-7,
        -2.2154331875724243e-8,
    ],
    &[
        1.,
        -0.6654150570045909,
        0.200293817811019,
        -0.035884832720263514,
        0.004230148903396325,
        -0.0003416845988814705,
        0.000019014476295516294,
        -7.091307167052658e-7,
        1.6280746640770922e-8,
        -1.8153950474471257e-10,
    ],
    &[
        1.,
        -0.48227793388928686,
        0.10465626452533631,
        -0.013430939420831631,
        0.0011252572259040465,
        -0.00006395972951765294,
        2.4730606556227503e-6,
        -6.294940187298726e-8,
        9.619697609834509e-10,
        -6.778762525584954e-12,
    ],
    &[
        1.,
        -0.3749763242863128,
        0.06305010466116708,
        -0.006244542979811614,
        0.00040184880676774067,
        -0.00001744461955724141,
        5.115600860853574e-7,
        -9.78850257748675e-9,
        1.1114009236745514e-10,
        -5.721763767536062e-13,
    ],
    &[
        1.,
        -0.30534895183949345,
        0.04171481697145649,
        -0.003348125204167091,
        0.00017409236975895486,
        -6.085669072074621e-6,
        1.4312799360769276e-7,
        -2.185908900387808e-9,
        1.9692945418148126e-11,
        -7.98449471803496e-14,
    ],
    &[
        1.,
        -0.25687592716039537,
        0.02947672145945818,
        -0.0019838580291021953,
        0.0000863328496598968,
        -2.5202903640943468e-6,
        4.9378590115191415e-8,
        -6.264404957644194e-10,
        4.672464739659189e-12,
        -1.5622596183636213e-14,
    ],
    &[
        1.,
        -0.2213490243291964,
        0.021863585300643737,
        -0.0012651113478541138,
        0.00004727213815879952,
        -1.183216458216177e-6,
        1.984439050957335e-8,
        -2.1511920940327857e-10,
        1.3682221403269738e-12,
        -3.891871800160147e-15,
    ],
    &[
        1.,
        -0.1942708721050193,
        0.016828468860623436,
        -0.0008532562821943076,
        0.000027911644179995297,
        -6.109965352184692e-7,
        8.952188867008274e-9,
        -8.467616115847529e-11,
        4.69294571579897e-13,
        -1.1614580871748689e-15,
    ],
    &[
        1.,
        -0.1729883718626033,
        0.013335607960720768,
        -0.0006013644690479918,
        0.000017484127089600688,
        -3.3992603059860745e-7,
        4.420004191621178e-9,
        -3.707091565760126e-11,
        1.8200927936381996e-13,
        -3.986445054679701e-16,
    ],
    &[
        1.,
        -0.15584290442174115,
        0.010818392728075834,
        -0.00043910108898564585,
        0.000011484990293679056,
        -2.0076997258949615e-7,
        2.34593173642069e-9,
        -1.7669981218127438e-11,
        7.786045251838315e-14,
        -1.5293838747113816e-16,
    ],
    &[
        1.,
        -0.14174786256624994,
        0.008946927321964279,
        -0.00033006595389918695,
        7.843784431887977e-6,
        -1.24530528363779e-7,
        1.3209495930489345e-9,
        -9.02817309350276e-12,
        3.607935795621201e-14,
        -6.424010173118201e-17,
    ],
    &[
        1.,
        -0.129963392832549,
        0.007519103426837181,
        -0.00025418931086507456,
        5.533711983370768e-6,
        -8.045696084523812e-8,
        7.813137101139027e-10,
        -4.88693167770918e-12,
        1.7866053974522157e-14,
        -2.908943965640057e-17,
    ],
    &[
        1.,
        -0.11996920824421749,
        0.006405744709310794,
        -0.00019980993835871938,
        4.012629149677728e-6,
        -5.380465468365291e-8,
        4.817378177112753e-10,
        -2.777344388370142e-12,
        9.356268183089893e-15,
        -1.4033145419725587e-17,
    ],
    &[
        1.,
        -0.12312224351002068,
        0.00682968584724309,
        -0.00022477619163545397,
        4.860858335775032e-6,
        -7.21735114462841e-8,
        7.451697150606653e-10,
        -5.282839899089763e-12,
        2.4612641731865723e-14,
        -6.80507344584464e-17,
        8.479432822405738e-20,
    ],
    &[],
];

pub const SPLITS: [f64; 21] = [
    0.,
    0.14503360419658018,
    0.8754309706465879,
    2.3362257035466034,
    5.257815169346634,
    11.100994100946696,
    16.944173032546757,
    22.78735196414682,
    28.63053089574688,
    34.473709827346944,
    40.316888758947,
    46.160067690547066,
    52.003246622147124,
    57.84642555374719,
    63.68960448534725,
    69.53278341694731,
    75.37596234854738,
    81.21914128014744,
    87.06232021174749,
    93.63589650979756,
    std::f64::INFINITY,
];
