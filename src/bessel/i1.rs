#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(1)
        * polynomial(
            x2,
            &[
                0.5,
                0.0625,
                0.002604166666666667,
                0.00005425347222222222,
                6.781684027777778e-7,
                5.651403356481481e-9,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -0.1496033551505373,
                -0.04675104848454289,
                -0.04090716742397503,
                -0.05752570418996489,
                -0.1107369805656824,
                -0.2699213901288509,
                -0.7953040959153642,
                -2.746284456207742,
                -10.87070930582231,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 16] = [
    &[
        3.531093379732972,
        4.649153742130837,
        1.687541843877481,
        0.472627483343095,
        0.0954782626208587,
        0.01685680966763576,
        0.002356231597027738,
        0.0003035021685722181,
        0.00003242994603131429,
        3.287845171387012e-6,
        2.84352449883621e-7,
        2.376852714662288e-8,
        1.726653736562684e-9,
        1.227820809595533e-10,
        7.689219770323115e-12,
        4.757693483845942e-13,
        2.618438797539931e-14,
        1.433961199212957e-15,
        7.039085301018943e-17,
        3.457584755014441e-18,
        1.53176726729174e-19,
        6.821091055797217e-21,
        2.753398997943665e-22,
        1.121361396845237e-23,
        4.157201686330676e-25,
        1.559830158676199e-26,
        5.346578957091699e-28,
        1.85974184906868e-29,
        5.92754168530894e-31,
        1.923372337001919e-32,
        5.723454778033894e-34,
    ],
    &[
        111.1713646719654,
        144.3860003567757,
        56.47557148485951,
        15.64287603807798,
        3.343054473221328,
        0.5810611581652707,
        0.08506166680289037,
        0.01075500211016397,
        0.001196549859333526,
        0.0001188616273609198,
        0.00001066404494657977,
        8.723852908220841e-7,
        6.557887767539179e-8,
        4.560347471937884e-9,
        2.950044120166514e-10,
        1.78407979115407e-11,
        1.012918180331869e-12,
        5.419705754271307e-14,
        2.741789353390825e-15,
        1.315458222839428e-16,
        6.001172292497728e-18,
        2.609725039885221e-19,
        1.084118218913675e-20,
        4.311059778305311e-22,
        1.643932786262658e-23,
        6.021997985488845e-25,
        2.122266962388263e-26,
        7.20639767136859e-28,
        2.360732490183735e-29,
        7.477359497005132e-31,
        2.286218946483007e-32,
    ],
    &[
        3814.572776836747,
        5018.066204825009,
        1991.715195449001,
        558.9055597798784,
        120.8133593105345,
        21.20519271754572,
        3.130952090046243,
        0.398830021147084,
        0.04466678348673133,
        0.004463034680855931,
        0.0004025290736355681,
        0.00003308428311637904,
        2.497693095560328e-6,
        1.743602153675922e-7,
        1.131941078476594e-8,
        6.867675692569466e-10,
        3.910881270733463e-11,
        2.098284552669118e-12,
        1.064239287973375e-13,
        5.11803956204908e-15,
        2.340072837518311e-16,
        1.019706788671404e-17,
        4.244266666881011e-19,
        1.69078358492029e-20,
        6.458534398213077e-22,
        2.369617069086972e-23,
        8.36374538076217e-25,
        2.844010322365398e-26,
        9.32939412244058e-28,
        2.958722662795776e-29,
        9.05748491177803e-31,
    ],
    &[
        137940.5262727204,
        182617.7753433995,
        73055.7648827252,
        20655.71527909397,
        4495.692613742993,
        793.9663059236242,
        117.8800690151824,
        15.09090177496675,
        1.697720867843276,
        0.1703274172544059,
        0.01541935836050535,
        0.001271649739833888,
        0.000096303146521448,
        6.742137420962182e-6,
        4.38862229349523e-7,
        2.669218393279335e-8,
        1.523504167650685e-9,
        8.191445044794659e-11,
        4.1629549933127e-12,
        2.005752498600658e-13,
        9.1868045833555e-15,
        4.009834180679277e-16,
        1.671584591390819e-17,
        6.668841623045252e-19,
        2.550928484746719e-20,
        9.37157131567388e-22,
        3.311887067708013e-23,
        1.12750665338075e-24,
        3.702792825179846e-26,
        1.175562292241097e-27,
        3.602393300402189e-29,
    ],
    &[
        5.139597651954252e6,
        6.829723690919131e6,
        2.745585754700093e6,
        780059.7353450671,
        170553.3749618532,
        30247.37390588367,
        4508.143661021326,
        579.1702233798063,
        65.36820927566044,
        6.577834046255976,
        0.5971225231835219,
        0.04937132807877733,
        0.003747818796041406,
        0.0002629633921075311,
        0.00001715226055695412,
        1.045237140620157e-6,
        5.976672832116733e-8,
        3.218946912567808e-9,
        1.63850979214597e-10,
        7.906404434112238e-12,
        3.626470723570965e-13,
        1.58500539955437e-14,
        6.615864484389705e-16,
        2.642616887242028e-17,
        1.012002151732515e-18,
        3.721950850360752e-20,
        1.316698267905028e-21,
        4.487055290177209e-23,
        1.474971933013851e-24,
        4.686994786788475e-26,
        1.437527149335641e-27,
    ],
    &[
        1.952234726731395e8,
        2.600588680864892e8,
        1.04891748956741e8,
        2.990181048088191e7,
        6.558890253389026e6,
        1.166734262171492e6,
        174384.1720764846,
        22462.35744953391,
        2541.420046292621,
        256.3192291123987,
        23.31762284848435,
        1.931782816308294,
        0.1469164064104517,
        0.01032632192809602,
        0.0006746603365796259,
        0.00004117662772447272,
        2.357923513269771e-6,
        1.271696854528104e-7,
        6.481662642978565e-9,
        3.131515390097084e-10,
        1.438038890813737e-11,
        6.292206187748684e-13,
        2.629185238721619e-14,
        1.051258385237872e-15,
        4.029741479616446e-17,
        1.483433334867897e-18,
        5.252520167566223e-20,
        1.791473967160763e-21,
        5.893659590921656e-23,
        1.874278399719083e-24,
        5.752800209164103e-26,
    ],
    &[
        7.515719747543702e9,
        1.002912421181565e10,
        4.054806707310913e9,
        1.158776627410582e9,
        2.547855375099631e8,
        4.542626924002769e7,
        6.80419107634718e6,
        878220.0992553542,
        99552.0439103461,
        10058.4541616474,
        916.568566752452,
        76.05494967094484,
        5.79280852692465,
        0.4077354612660332,
        0.02667466649903012,
        0.001630103492953421,
        0.0000934580221480425,
        5.04622852909237e-6,
        2.574791412962767e-7,
        1.245260105732579e-8,
        5.724073437510905e-10,
        2.506958352452823e-11,
        1.048471985096511e-12,
        4.19584694613129e-14,
        1.609703920364556e-15,
        5.930354107326453e-17,
        2.101406805976853e-18,
        7.172484157162251e-20,
        2.361285415820741e-21,
        7.51433830905608e-23,
        2.307900893445937e-24,
    ],
    &[
        2.922212163066556e11,
        3.904488161676266e11,
        1.581446924448175e11,
        4.527979154709796e10,
        9.97434446614108e9,
        1.781514285074732e9,
        2.672969255101944e8,
        3.455556191350329e7,
        3.923060078642781e6,
        396945.7762720252,
        36220.7308616972,
        3009.410095503844,
        229.4965478416389,
        16.17230820591129,
        1.059191213478819,
        0.0647961813062228,
        0.00371867542913277,
        0.0002009815050630229,
        0.00001026431767197484,
        4.968548545344563e-7,
        2.285808175717366e-8,
        1.001916531520164e-9,
        4.19350099539342e-11,
        1.679428731196002e-12,
        6.447588135037298e-14,
        2.377000745083932e-15,
        8.42839682119509e-17,
        2.878590977000016e-18,
        9.48253223390566e-20,
        3.019416404924624e-21,
        9.27888864208462e-23,
    ],
    &[
        1.144871123356486e13,
        1.531234408523317e13,
        6.21075466284589e12,
        1.780905964365774e12,
        3.928808824820758e11,
        7.027241049203518e10,
        1.055802555088934e10,
        1.366699046721288e9,
        1.553529134966768e8,
        1.573763562863568e7,
        1.437656119902385e6,
        119576.4716145356,
        9128.20758614338,
        643.8817699751309,
        42.20989849391669,
        2.584505186036554,
        0.1484525543923692,
        0.008029921026249334,
        0.0004104179723825852,
        0.00001988168262429061,
        9.15330043149737e-7,
        4.014870954692185e-8,
        1.681540714849034e-9,
        6.738634901775993e-11,
        2.588672265341752e-12,
        9.54924019790193e-14,
        3.387934383167887e-15,
        1.157741960255593e-16,
        3.815835747955151e-18,
        1.215666440659951e-19,
        3.737706621548008e-21,
    ],
    &[
        4.512508222667285e14,
        6.040146687373806e14,
        2.452684322931998e14,
        7.041436041950523e13,
        1.555256247703996e13,
        2.78504831713876e12,
        4.189084000874888e11,
        5.428476896048025e10,
        6.176940681492405e9,
        6.263587440165765e8,
        5.727298320047453e7,
        4.767975954605766e6,
        364292.901080112,
        25717.72081661113,
        1687.279248580388,
        103.3909160819156,
        5.943082715039873,
        0.3216933276610238,
        0.01645326461380707,
        0.0007975587561053614,
        0.00003674181617875078,
        1.612567588078213e-6,
        6.757837802457635e-8,
        2.709676503160618e-9,
        1.041500040208233e-10,
        3.84396769134717e-12,
        1.364479396573823e-13,
        4.665064049358198e-15,
        1.538305066141681e-16,
        4.903068714063192e-18,
        1.508177882222229e-19,
    ],
    &[
        1.787323058528995e16,
        2.393939377149306e16,
        9.72994812515108e15,
        2.79615732143886e15,
        6.182075465132166e14,
        1.108121962097721e14,
        1.668334006226694e13,
        2.163895359189591e12,
        2.464398580268014e11,
        2.501065582105822e10,
        2.288768126674716e9,
        1.906875525664496e8,
        1.458015621612976e7,
        1.030041361305691e6,
        67625.11969125187,
        4146.590541939119,
        238.5050680934598,
        12.91798849487085,
        0.6610927343816359,
        0.03206427324831371,
        0.00147794801051733,
        0.00006490051336080128,
        2.721208937061655e-6,
        1.091661816998887e-7,
        4.197971675760442e-9,
        1.550111015372636e-10,
        5.504863487522348e-12,
        1.882901544705841e-13,
        6.211508886119408e-15,
        1.980624027083968e-16,
        6.094809588210536e-18,
    ],
    &[
        7.107979723350426e17,
        9.52553342394954e17,
        3.874569092427105e17,
        1.114388254930338e17,
        2.465887505141002e16,
        4.423683241147468e15,
        6.665412160275272e14,
        8.652000098208226e13,
        9.86088217882389e12,
        1.001481252866288e12,
        9.17109339631926e10,
        7.645964703878499e9,
        5.849951236996854e8,
        4.135374313044997e7,
        2.716619019531244e6,
        166672.2366210647,
        9592.07297875053,
        519.8095548354894,
        26.61573111401763,
        1.291565972757759,
        0.05956160755227653,
        0.002616740542508352,
        0.0001097673632079717,
        4.405468581717645e-6,
        1.69484603071724e-7,
        6.260869996298065e-9,
        2.224304303419802e-10,
        7.611073021142366e-12,
        2.511777131560111e-13,
        8.012117802484334e-15,
        2.466389391783056e-16,
    ],
    &[
        2.836408212706132e19,
        3.802843639260012e19,
        1.547846871292319e19,
        4.455015139392817e18,
        9.8649940566286e17,
        1.770981354440761e17,
        2.670274089367594e16,
        3.468449902246489e15,
        3.95562878862284e14,
        4.019889908652333e13,
        3.683451157118067e12,
        3.072696779660625e11,
        2.352256898959775e10,
        1.663735301255517e9,
        1.093521189124346e8,
        6.71248443502087e6,
        386497.6890547416,
        20954.93135509653,
        1073.448980284687,
        52.11399707683135,
        2.404324158513808,
        0.1056745468991848,
        0.004434663145372145,
        0.0001780540987279169,
        6.852634881395059e-6,
        2.532355816462248e-7,
        8.999997076205527e-9,
        3.080688551042651e-10,
        1.017027141068878e-11,
        3.24522282988645e-13,
        9.99309944116554e-15,
    ],
    &[
        1.135150577535392e21,
        1.522514064663217e21,
        6.200487496662262e20,
        1.785715822848406e20,
        3.956658705323174e19,
        7.107407999406516e18,
        1.072291370873791e18,
        1.39362255683471e17,
        1.59026920454779e16,
        1.616989358796444e15,
        1.482444294283611e14,
        1.237275449456465e13,
        9.47649304696704e11,
        6.70589225446277e10,
        4.409633352428006e9,
        2.708041189766386e8,
        1.55994607983529e7,
        846123.7875560931,
        43361.9249229342,
        2105.987310503287,
        97.1993955663984,
        4.273712320760105,
        0.1794135508907554,
        0.007206126028490796,
        0.000277433232531713,
        0.00001025587075220955,
        3.646138614903018e-7,
        1.248469176491511e-8,
        4.12285604572509e-10,
        1.315959416885599e-11,
        4.053467621191974e-13,
    ],
    &[
        4.554364054925421e22,
        6.110559249457853e22,
        2.489763356495793e22,
        7.174232692192024e21,
        1.590472129053806e21,
        2.85851826542418e20,
        4.314895628037035e19,
        5.610800893059582e18,
        6.405699282873599e17,
        6.516480958545687e16,
        5.977069571825154e15,
        4.990847329484309e14,
        3.824262214075792e13,
        2.707341621995482e12,
        1.781024905146664e11,
        1.094204636652406e10,
        6.305559038152991e8,
        3.421478269408128e7,
        1.754081002886017e6,
        85222.36366577916,
        3934.719904932757,
        173.0628471581,
        7.267719089966554,
        0.2920016196843698,
        0.01124549914703836,
        0.0004158398575067921,
        0.00001478824626133152,
        5.065099491622094e-7,
        1.673138289684696e-8,
        5.341913557000269e-10,
        1.645880929288587e-11,
    ],
    &[
        1.831268597265341e24,
        2.457719026853742e24,
        1.001833499303435e24,
        2.888122844771963e23,
        6.40578756975871e22,
        1.151840417435232e22,
        1.739494202203448e21,
        2.26294710304158e20,
        2.584687383062558e19,
        2.630519094162993e18,
        2.4137839833441e17,
        2.016327707296127e16,
        1.545632830146621e15,
        1.094633676082964e14,
        7.203742793949886e12,
        4.427359233614512e11,
        2.552251782439366e10,
        1.385362007689998e9,
        7.104683117318881e7,
        3.452950741097959e6,
        159473.5542072487,
        7016.381260150474,
        294.7396243162132,
        11.84550034260564,
        0.456322057952011,
        0.01687875271843882,
        0.0006004121457746947,
        0.00002057010386235984,
        6.796624925496979e-7,
        2.170545164422825e-8,
        6.689257870371219e-10,
    ],
];

pub const SPLITS: [f64; 17] = [
    0.3497403882990906,
    4.075826307233277,
    7.801912226167464,
    11.52799814510165,
    15.25408406403584,
    18.98016998297002,
    22.70625590190421,
    26.4323418208384,
    30.15842773977258,
    33.88451365870677,
    37.61059957764096,
    41.33668549657514,
    45.06277141550933,
    48.78885733444351,
    52.5149432533777,
    56.24102917231189,
    59.96711509124607,
];
