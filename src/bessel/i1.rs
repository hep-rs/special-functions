#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(1)
        * polynomial(
            x2,
            &[
                0.5,
                0.0625,
                0.002604166666666667,
                0.00005425347222222222,
                6.781684027777778e-7,
                5.651403356481481e-9,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -0.1496033551505373,
                -0.04675104848454289,
                -0.04090716742397503,
                -0.05752570418996489,
                -0.1107369805656824,
                -0.2699213901288509,
                -0.7953040959153642,
                -2.746284456207742,
                -10.87070930582231,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        -1.02166951702157,
        0.7273721687980646,
        0.02487954478333992,
        0.004942351867417833,
        0.0007149786344834813,
        0.00007600469284278472,
        5.328200073209225e-6,
        7.464112158320193e-8,
        -4.20590435061322e-8,
        -6.74259645634802e-9,
        -4.575437698366037e-10,
        2.492218693416755e-11,
        1.147098203776799e-11,
        1.654612839653585e-12,
        1.155244962941898e-13,
        -5.807428803347896e-15,
        -2.988962529865736e-15,
        -4.626046980060563e-16,
        -3.68769491047046e-17,
        8.486200550990121e-19,
        7.893741406099268e-19,
        1.362086652623395e-19,
        1.252930770812915e-20,
        5.825893012184486e-23,
        -2.053640837677838e-22,
        -4.059148954893354e-23,
        -4.2672268930473e-24,
        -1.178860782347665e-25,
        5.16574487871981e-26,
        1.213957486462716e-26,
        1.43591124623924e-27,
    ],
    &[
        1.052681679698329,
        1.503392516250971,
        0.2162530710330236,
        0.03163266558332513,
        0.002451364833186921,
        0.0000382081905012488,
        9.51281106924572e-7,
        3.192608990106527e-6,
        3.457918362129128e-7,
        -7.225520588787441e-8,
        -1.639372825555294e-8,
        1.106687373388966e-9,
        6.578528149284636e-10,
        2.478375879598594e-11,
        -1.991492153729659e-11,
        -2.859266227847275e-12,
        3.746271870324613e-13,
        1.344614744025229e-13,
        1.614459068364726e-15,
        -4.257828545462905e-15,
        -4.930093378636978e-16,
        8.811311429065029e-17,
        2.489663874132e-17,
        -3.708885085867144e-19,
        -8.430244545925036e-19,
        -6.973461699145759e-20,
        2.082199662507552e-20,
        4.270818950079296e-21,
        -2.837965728014354e-22,
        -1.642225563228756e-22,
        -6.495712313973908e-24,
    ],
    &[
        7.582536268615229,
        5.609154056805898,
        0.925734914649699,
        0.0999502400734107,
        0.007791501272591541,
        0.0005271883258407761,
        0.00002415424285196337,
        1.550353081601247e-6,
        7.818239632660021e-8,
        -2.178818264295608e-8,
        5.337317822079829e-9,
        -1.488835454113752e-10,
        -2.368196583451809e-10,
        5.723633739451116e-11,
        1.205782195738422e-12,
        -3.040039379557826e-12,
        3.982183169046922e-13,
        9.08571857855691e-14,
        -2.911416454175149e-14,
        -1.082396044551193e-15,
        1.374455314906819e-15,
        -5.856718673788713e-17,
        -5.381910812411971e-17,
        5.200700126212992e-18,
        1.966259887759364e-18,
        -2.685031889946271e-19,
        -7.254730374190448e-20,
        1.169658025988731e-20,
        2.78764389994089e-21,
        -4.561495183403079e-22,
        -1.087100180881623e-22,
    ],
    &[
        32.21035873149474,
        21.02424231182641,
        3.371243644773293,
        0.3585414301481567,
        0.02864535102271968,
        0.001837798208151358,
        0.0000980841992199193,
        4.509171023559933e-6,
        1.799264252765548e-7,
        6.515553006682421e-9,
        1.999551953760815e-10,
        6.821121274121075e-12,
        7.205691351053673e-14,
        1.52136220428672e-14,
        -1.419651411191693e-15,
        2.239423460302049e-16,
        -3.570532412641947e-17,
        6.308314198476489e-18,
        -1.198563258282988e-18,
        2.353202200270309e-19,
        -4.447119329966726e-20,
        7.0860881969179e-21,
        -5.714972232804824e-22,
        -1.849195938841397e-22,
        1.19354849354723e-22,
        -4.022542792823754e-23,
        9.41842364311165e-24,
        -1.317081325842634e-24,
        -6.747992643494205e-26,
        1.132265457836861e-25,
        -3.534635562082116e-26,
    ],
];

pub const SPLITS: [f64; 5] = [
    -1.050564147446509,
    0.2355259719545671,
    1.521616091355643,
    2.80770621075672,
    4.093796330157796,
];
