#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(2)
        * polynomial(
            x2,
            &[
                0.125,
                -0.01041666666666667,
                0.0003255208333333333,
                -5.425347222222222e-6,
                5.651403356481481e-8,
                -4.036716683201058e-10,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                1.193662073189215,
                1.566681471060845,
                -2.937527758239084,
                21.20527850478839,
                -310.1271981325302,
                7462.435705064007,
                -265049.7253102198,
                1.29832951382428e7,
                -8.368815657859004e8,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 3.926990816987242
        + x1 * polynomial(
            x1,
            &[
                1.875,
                0.0,
                -0.3515625,
                0.0,
                -1.4501953125,
                0.0,
                8.307429722377232,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 6] = [
    &[
        0.05629517230125741,
        -0.1569050547622351,
        -0.04346452188329965,
        0.02335118918531755,
        -0.2284773642303267,
        0.02552575742441016,
        0.1457191948405741,
        -0.01353327751454462,
        -0.03428537794455716,
        0.002767178074165956,
        0.004399296413783653,
        -0.0003172788222560746,
        -0.0003616625849546706,
        0.00002367635867261872,
        0.00002084758995532218,
        -1.251802911996977e-6,
        -8.932815128844338e-7,
        4.957778776307337e-8,
        2.964603932830532e-8,
        -1.530208724168463e-9,
        -7.858205960509158e-10,
        3.791473871128641e-11,
        1.703816938102365e-11,
        -7.717911182173607e-13,
        -3.080157325045915e-13,
        1.314881930617592e-14,
        4.716207499193644e-15,
        -1.903673487665683e-16,
        -6.197809345922709e-17,
        2.346551254052427e-18,
        7.066582370201943e-19,
    ],
    &[
        -0.04305808637150608,
        0.0285058677362968,
        -0.1094696581990848,
        0.02040171506042884,
        -0.1134543181347774,
        -0.02048795807083287,
        0.1016582547804098,
        0.003194119324585986,
        -0.02664311375566514,
        0.00005527284839120205,
        0.003633170736318234,
        -0.00005862785470013872,
        -0.0003111004572705535,
        7.214177884895151e-6,
        0.00001846793164002915,
        -4.98063428571998e-7,
        -8.089719488247613e-7,
        2.346430143386461e-8,
        2.730744031548228e-8,
        -8.201647395560669e-10,
        -7.334938107273669e-10,
        2.233644322156947e-11,
        1.607118723247417e-11,
        -4.899374539003269e-13,
        -2.929724480555705e-13,
        8.869055796717007e-15,
        4.516047163232853e-15,
        -1.350347550742573e-16,
        -5.966942735295565e-17,
        1.7360010900413e-18,
        6.833172853181227e-19,
    ],
    &[
        -0.04605763890469827,
        0.01705288681780994,
        -0.1433704630324318,
        -0.01003587003357299,
        0.04551531335306534,
        0.0008980173866814683,
        -0.004409603090679003,
        -0.00002103345896881312,
        0.0002118956024211753,
        -5.024406938191676e-7,
        -6.122132784539968e-6,
        3.932722281697692e-8,
        1.18360351724879e-7,
        -1.056413290479362e-9,
        -1.640602334428028e-9,
        1.728706104092157e-11,
        1.711427551390954e-11,
        -1.984168290772155e-13,
        -1.39294515852517e-13,
        1.711167841542422e-15,
        9.09597805521018e-16,
        -1.157465846838419e-17,
        -4.872677231527597e-18,
        6.329317667661014e-20,
        2.180595462744142e-20,
        -2.862571469416818e-22,
        -8.276191222934299e-23,
        1.090283010892683e-24,
        2.698217997722849e-25,
        -3.538849795774155e-27,
        -7.639182091866341e-28,
    ],
    &[
        -0.0417497023026818,
        0.01190875248572396,
        -0.1301590667621293,
        -0.006580696117551836,
        0.04136256643697096,
        0.0005266718457237882,
        -0.004016657771712324,
        -5.740218877234106e-6,
        0.0001936545139629375,
        -7.78362577798438e-7,
        -5.617760268400925e-6,
        4.020926197942506e-8,
        1.091012700245968e-7,
        -9.96448883711595e-10,
        -1.519501556270994e-9,
        1.586007640833387e-11,
        1.592794887058268e-11,
        -1.802846567860659e-13,
        -1.302580839740373e-13,
        1.552198138346963e-15,
        8.544962311908676e-16,
        -1.052383508634036e-17,
        -4.597376230460603e-18,
        5.780148015644356e-20,
        2.065732653075603e-20,
        -2.628558872350304e-22,
        -7.86961935419959e-23,
        1.007147759512426e-24,
        2.574489659307066e-25,
        -3.289032509213865e-27,
        -7.311759984389533e-28,
    ],
    &[
        -0.03846843363413557,
        0.007778306154543868,
        -0.1200854704131805,
        -0.003310095682086727,
        0.03816582307685861,
        0.0001204920453832242,
        -0.003709978481699165,
        0.00001505971281265385,
        0.0001791642671329448,
        -1.347351277440225e-6,
        -5.208685658919574e-6,
        4.952737302245507e-8,
        1.014170092864621e-7,
        -1.091047540306486e-9,
        -1.416528979608973e-9,
        1.640396800012773e-11,
        1.48939586673814e-11,
        -1.806979965680245e-13,
        -1.221866693701363e-13,
        1.527542445375884e-15,
        8.040949480905774e-16,
        -1.024598892417368e-17,
        -4.339776457938495e-18,
        5.593439377967981e-20,
        1.955928335594224e-20,
        -2.535856801239241e-22,
        -7.473094516532911e-23,
        9.70582955115892e-25,
        2.451557986172708e-25,
        -3.170440652271098e-27,
        -6.980835232936233e-28,
    ],
    &[
        -0.03583543269571327,
        0.004311187141607703,
        -0.1119873552911383,
        -0.0002777730450877346,
        0.03558455018277635,
        -0.0002837957437687957,
        -0.003460521585634114,
        0.00003762616756188613,
        0.0001672605461230073,
        -2.039370618975029e-6,
        -4.868547423660265e-6,
        6.285453801312363e-8,
        9.49385602423981e-8,
        -1.26553089668161e-9,
        -1.328386191349173e-9,
        1.803737303863705e-11,
        1.399452280693241e-11,
        -1.919786143353496e-13,
        -1.150481315708431e-13,
        1.585815217400616e-15,
        7.587665657108193e-16,
        -1.046865350937572e-17,
        -4.104229413114385e-18,
        5.651881657743405e-20,
        1.853884361528258e-20,
        -2.542632186194e-22,
        -7.098786970281542e-23,
        9.68030818742814e-25,
        2.333767436858822e-25,
        -3.150984059039985e-27,
        -6.659229540512834e-28,
    ],
];

pub const SPLITS: [f64; 7] = [
    0.3916912264068128,
    13.04729187195921,
    25.70289251751162,
    32.03069284028782,
    38.35849316306402,
    44.68629348584022,
    51.01409380861642,
];
