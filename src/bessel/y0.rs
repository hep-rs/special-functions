#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-0)
        * polynomial(
            x2,
            &[
                -0.07380429510868723,
                0.1776060168690671,
                -0.01607396802593843,
                0.000538602666861655,
                -9.49500520522155e-6,
                1.03584760336281e-7,
            ],
        )
        + x.powi(0)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.6366197723675813,
                    -0.1591549430918953,
                    0.00994718394324346,
                    -0.0002763106650900961,
                    4.317354142032751e-6,
                    -4.317354142032751e-8,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                -0.07957747154594767,
                0.1342869832337867,
                -0.6994113710093057,
                7.496815633005995,
                -136.6294649115343,
                3788.621204109419,
                -148635.7283112213,
                7.838212235162061e6,
                -5.34849120990989e8,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 0.7853981633974483
        + x1 * polynomial(
            x1,
            &[
                -0.125,
                0.0,
                0.06510416666666667,
                0.0,
                -0.2095703125,
                0.0,
                1.638065883091518,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        -0.4085148874033197,
        0.406053088307425,
        -0.04812675115427577,
        0.008180722775441878,
        -0.001798409704329003,
        0.0004016176635592909,
        -0.0000925443330570411,
        0.00002190845528038313,
        -5.290382696018026e-6,
        1.297217832782155e-6,
        -3.219799849354684e-7,
        8.071357884393139e-8,
        -2.039991381714909e-8,
        5.191702526311046e-9,
        -1.329077268586414e-9,
        3.419786247033817e-10,
        -8.838377826672628e-11,
        2.293183152311864e-11,
        -5.970418528411559e-12,
        1.559225856875441e-12,
        -4.083331282125818e-13,
        1.072024254651602e-13,
        -2.820839314411109e-14,
        7.437869318311271e-15,
        -1.964893757274677e-15,
        5.199764809062069e-16,
        -1.37826360858203e-16,
        3.659800828619843e-17,
        -9.77385707177599e-18,
        2.772237578185687e-18,
        -6.896875938931477e-19,
    ],
    &[
        0.1674752275947547,
        0.1944714637932363,
        -0.016231883336416,
        0.0005715341790498174,
        -0.00007003497679546086,
        8.759261147060545e-6,
        -9.41009696715315e-7,
        1.038483023284496e-7,
        -1.175423148163783e-8,
        1.348661503449927e-9,
        -1.56477226828358e-10,
        1.832637018255546e-11,
        -2.163308240247644e-12,
        2.570746333242798e-13,
        -3.072475115337948e-14,
        3.690412949890579e-15,
        -4.451935943302728e-16,
        5.391221299980227e-17,
        -6.550939313775297e-18,
        7.984381800181233e-19,
        -9.75813830891284e-20,
        1.195546098164585e-20,
        -1.468049604351667e-21,
        1.806360671138953e-22,
        -2.226807137112169e-23,
        2.74985155238335e-24,
        -3.401153209530394e-25,
        4.212920518022076e-26,
        -5.226772387713636e-27,
        6.590206214128094e-28,
        -8.069406885612543e-29,
    ],
    &[
        0.4631492300661863,
        0.06927864533764404,
        -0.04607466384791911,
        0.00162662785659391,
        0.00007056255329363891,
        0.00001290790844166808,
        -2.430673762587809e-6,
        2.604416941750325e-7,
        -3.269110618903065e-8,
        4.379551534358256e-9,
        -5.842233591285293e-10,
        7.835595226813684e-11,
        -1.059109517582287e-11,
        1.440526365475999e-12,
        -1.969767386724215e-13,
        2.706100437706532e-14,
        -3.733103609356618e-15,
        5.168824552407363e-16,
        -7.180234171177559e-17,
        1.000380233337635e-17,
        -1.397482817060193e-18,
        1.956928426573028e-19,
        -2.746356027180514e-20,
        3.861982661323221e-21,
        -5.440809217458851e-22,
        7.678084825899997e-23,
        -1.085231334352045e-23,
        1.536119445129947e-24,
        -2.178125141056197e-25,
        3.15227131638769e-26,
        -4.390071377534558e-27,
    ],
    &[
        0.103427977549578,
        -0.4079254851831705,
        -0.0001791501524567934,
        0.02258062611867514,
        -0.0008152316607870359,
        -0.0002791134470585344,
        6.068279686987699e-6,
        2.415714890370246e-6,
        -1.090041608942343e-7,
        -2.015728952023989e-10,
        -9.72769472458895e-10,
        1.922587723119101e-10,
        -2.537931572219966e-11,
        3.626152436815673e-12,
        -5.419693964488971e-13,
        8.066381559391819e-14,
        -1.201191363275083e-14,
        1.795438049642903e-15,
        -2.691883962584628e-16,
        4.046449495112502e-17,
        -6.09726402422506e-18,
        9.20778372752318e-19,
        -1.393337098207973e-19,
        2.112364219103932e-20,
        -3.20797514575031e-21,
        4.879634797493903e-22,
        -7.433410124994331e-23,
        1.13394946099159e-23,
        -1.732950745051906e-24,
        2.710823243073218e-25,
        -4.0550780664254e-26,
    ],
    &[
        -0.02586637813490137,
        0.3315228266810532,
        -0.03267539844863167,
        -0.1044402207475342,
        0.00970018728922131,
        0.006882559860217752,
        -0.0005857514936409681,
        -0.0001988124886918914,
        0.00001523414639851765,
        3.347309500544641e-6,
        -2.340091448444504e-7,
        -3.64859884635556e-8,
        2.298333656756436e-9,
        2.92191276986963e-10,
        -1.759355035911509e-11,
        -1.538212742419759e-12,
        6.904988288175767e-14,
        1.08936329064577e-14,
        -8.981464642262828e-16,
        5.402166174669623e-17,
        -1.155564714051374e-17,
        2.106459384133905e-18,
        -3.234014073114587e-19,
        5.039219961261518e-20,
        -8.005979975659708e-21,
        1.271551327088776e-21,
        -2.01874517299848e-22,
        3.20922906306981e-23,
        -5.111097122458703e-24,
        8.345121854995812e-25,
        -1.297831348892305e-25,
    ],
    &[
        -0.03262322183813297,
        -0.07898234518461642,
        -0.03054985716652017,
        -0.1484202883327424,
        0.1001428137918585,
        0.06357444974448387,
        -0.02796158549034245,
        -0.00908816246647906,
        0.003286899357537081,
        0.0006761200184014737,
        -0.0002173270347147199,
        -0.0000313411698971032,
        9.2883284730294e-6,
        1.001405472766554e-6,
        -2.791231570768718e-7,
        -2.352420752230608e-8,
        6.240264276747862e-9,
        4.249379587503978e-10,
        -1.080898576584306e-10,
        -6.100115374196205e-12,
        1.495498216619986e-12,
        7.138457126139509e-14,
        -1.692759188372346e-14,
        -6.945861224963449e-16,
        1.597507493789784e-16,
        5.716643095677235e-18,
        -1.277611905938066e-18,
        -4.023501721301724e-20,
        8.756841389314577e-21,
        2.462557283626811e-22,
        -5.242604686586917e-23,
    ],
    &[
        0.01541077492115536,
        0.07539726147446357,
        0.0140498332636435,
        0.1302228146541481,
        -0.04892747015710698,
        -0.06117473934100052,
        0.01411132978006853,
        0.00950019910027007,
        -0.001726995880426206,
        -0.0007670105538555928,
        0.0001195118723359755,
        0.00003840735227476703,
        -5.351330406465741e-6,
        -1.316093693309461e-6,
        1.681158084866521e-7,
        3.289729733061188e-8,
        -3.914757991362162e-9,
        -6.275689795218453e-10,
        7.032957892344867e-11,
        9.4504989016903e-12,
        -1.005058406830929e-12,
        -1.153245031509222e-13,
        1.170455239088592e-14,
        1.1645322007513e-15,
        -1.132717662475732e-16,
        -9.89848276406504e-18,
        9.25774775867782e-19,
        7.183720738182478e-20,
        -6.477480519018731e-21,
        -4.480515719539034e-22,
        3.924557069238366e-23,
    ],
    &[
        -0.003042416379989402,
        -0.07007289340944054,
        -0.0003674772018995278,
        -0.1171578085263412,
        0.01529091084918682,
        0.05678977719034634,
        -0.005036163270393544,
        -0.00905215435085927,
        0.0006697856406373722,
        0.000750335940784852,
        -0.00004947659636247967,
        -0.00003859719057596279,
        2.342338179464519e-6,
        1.358854654972892e-6,
        -7.731690498753873e-8,
        -3.48817765968748e-8,
        1.882683667938081e-9,
        6.827162633045992e-10,
        -3.522671632821175e-11,
        -1.053427854971466e-11,
        5.224352704804323e-13,
        1.31516362430437e-13,
        -6.293381492279906e-15,
        -1.356478695330435e-15,
        6.281100152620562e-17,
        1.175777207715224e-17,
        -5.279700937600132e-19,
        -8.687890437686088e-20,
        3.78974604021947e-21,
        5.508278140767892e-22,
        -2.350189048028722e-23,
    ],
];

pub const SPLITS: [f64; 9] = [
    0.2724573827598798,
    0.8450299936409431,
    1.417602604522006,
    2.562747826284133,
    4.853038269808386,
    9.43361915685689,
    18.5947809309539,
    27.75594270505092,
    36.91710447914793,
];
