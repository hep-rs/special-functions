#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(4)
        * polynomial(
            x2,
            &[
                0.002604166666666667,
                -0.0001302083333333333,
                2.712673611111111e-6,
                -3.229373346560847e-8,
                2.522947927000661e-10,
                -1.40163773722259e-12,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                5.013380707394703,
                51.70048854500788,
                420.066469428189,
                1378.343102811245,
                -5272.162368253013,
                68867.62093530498,
                -1.678648260298059e6,
                6.334274294718456e7,
                -3.36508321906918e9,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 7.068583470577035
        + x1 * polynomial(
            x1,
            &[
                7.875,
                0.0,
                6.3984375,
                0.0,
                -26.1720703125,
                0.0,
                -508.4969787597656,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        0.1427842848214631,
        0.0954398189568263,
        -0.1412982298651254,
        -0.1085469486146849,
        0.000949012627618468,
        0.01898058356916381,
        0.002312160989337494,
        -0.001516065976832848,
        -0.0002127296103662666,
        0.00006928894744674345,
        9.20703776182383e-6,
        -2.041816333856862e-6,
        -2.453302178510257e-7,
        4.194489186901111e-8,
        4.513044996235569e-9,
        -6.347496427645042e-10,
        -6.126382684310942e-11,
        7.371012153596677e-12,
        6.416849144500788e-13,
        -6.777506685405362e-14,
        -5.356436066968936e-15,
        5.058092492698569e-16,
        3.652668346922267e-17,
        -3.125907370229027e-18,
        -2.075134539408044e-19,
        1.626343389262673e-20,
        9.97999805150721e-22,
        -7.222889470936525e-23,
        -4.117673349492206e-24,
        2.761417635380821e-25,
        1.473991294913743e-26,
    ],
    &[
        -0.02235854307436714,
        0.1170561460162517,
        -0.01428825535160003,
        -0.1774809250099653,
        0.0148664724175294,
        0.03047225124840275,
        -0.001489074107172425,
        -0.002319939576597178,
        0.0000656933614669773,
        0.0001018233303421823,
        -1.682543806994932e-6,
        -2.916517896500064e-6,
        2.85590027397514e-8,
        5.878743013772966e-8,
        -3.488442795735604e-10,
        -8.784694179565476e-10,
        3.257540652673454e-12,
        1.011477027792425e-11,
        -2.446461716039659e-14,
        -9.24592273418001e-14,
        1.54720485268045e-16,
        6.871631670906047e-16,
        -8.578850287465884e-19,
        -4.233774571495448e-18,
        4.292928837800722e-21,
        2.197686691127817e-20,
        -1.963253515712925e-23,
        -9.74283895782201e-23,
        8.189831974361858e-26,
        3.71946665141411e-25,
        -3.089663677894835e-28,
    ],
    &[
        -0.04219997770538479,
        0.05875651983722771,
        -0.0922910124248067,
        -0.1194528672305341,
        0.04480323183313975,
        0.0227536386068472,
        -0.005676608404775034,
        -0.001787789995345499,
        0.0003435218197178101,
        0.00007865460335285862,
        -0.00001234585936660667,
        -2.235592962137309e-6,
        2.962954666543886e-7,
        4.461017689416208e-8,
        -5.108838256596636e-9,
        -6.601961963377111e-10,
        6.651850861248804e-11,
        7.537126846483509e-12,
        -6.780682436801853e-13,
        -6.839451406252235e-14,
        5.5621956684748e-15,
        5.051101509582808e-16,
        -3.752110344024934e-17,
        -3.09490715377868e-18,
        2.118390774221143e-19,
        1.598588209756679e-20,
        -1.015749698505106e-21,
        -7.055088558146779e-23,
        4.187846020836186e-24,
        2.682250621884198e-25,
        -1.500405765322973e-26,
    ],
    &[
        -0.0587471399494094,
        0.02308878472932483,
        -0.1387893333558717,
        -0.03616407369737481,
        0.06302811288201613,
        0.00626479726809162,
        -0.007881675252522652,
        -0.0004484443585081284,
        0.0004785326471727511,
        0.00001788668492184433,
        -0.00001734585087752889,
        -4.597175733410912e-7,
        4.19873293898772e-7,
        8.304833148396406e-9,
        -7.287904712036473e-9,
        -1.116660703785431e-10,
        9.5306655843535e-11,
        1.163277905337278e-12,
        -9.73815065517075e-13,
        -9.66998549777044e-15,
        7.99423351753915e-15,
        6.560993672444047e-17,
        -5.39035693463952e-17,
        -3.699315013268419e-19,
        3.039428817578693e-19,
        1.75900708113956e-21,
        -1.454668938291615e-21,
        -7.140820541498515e-24,
        5.984014415178469e-24,
        2.493269836218861e-26,
        -2.138601855509253e-26,
    ],
    &[
        -0.04900536366754859,
        -0.00875293975872819,
        -0.1184586292440465,
        0.04641820751246348,
        0.05234198377296147,
        -0.01060387242987168,
        -0.006456940893701564,
        0.000949050929622993,
        0.0003883844153638534,
        -0.000046103728609749,
        -0.00001397560158749716,
        1.413191006363512e-6,
        3.36135883092415e-7,
        -2.988374162379531e-8,
        -5.799004632602298e-9,
        4.627834402860189e-10,
        7.537672614337055e-11,
        -5.47910563040735e-12,
        -7.654646067355901e-13,
        5.12336663258543e-14,
        6.245063618483428e-15,
        -3.881287166214423e-16,
        -4.184927022875996e-17,
        2.431449742608891e-18,
        2.345287374294005e-19,
        -1.280942378858098e-20,
        -1.115696533755639e-21,
        5.755386314538126e-23,
        4.562591680658072e-24,
        -2.224372442620765e-25,
        -1.621269658751046e-26,
    ],
    &[
        -0.01781876887961687,
        -0.02779586659091327,
        -0.04528747264220967,
        0.0926396596711286,
        0.0184776095136987,
        -0.01989817411314546,
        -0.002152163695548771,
        0.00170867678140447,
        0.000122628884241024,
        -0.0000804203574796913,
        -4.181184411132795e-6,
        2.403868336378359e-6,
        9.52245973934848e-8,
        -4.980574529291846e-8,
        -1.554017738336214e-9,
        7.583894598422515e-10,
        1.908672084164842e-11,
        -8.8521220679847e-12,
        -1.829528957596233e-13,
        8.176808456627234e-14,
        1.407403381074654e-15,
        -6.128441951093294e-16,
        -8.883804197750033e-18,
        3.802641486936613e-18,
        4.684880018792202e-20,
        -1.98601699185159e-20,
        -2.094996594195215e-22,
        8.852541553236717e-23,
        8.044306386483526e-25,
        -3.396255538943608e-25,
        -2.680537374907936e-27,
    ],
    &[
        0.01770258149298367,
        -0.02822605067362547,
        0.03942854140178562,
        0.08435220725726388,
        -0.01991027968209764,
        -0.01774498119397135,
        0.002672759167566655,
        0.001499786274797411,
        -0.0001727438584834937,
        -0.00006962990578586488,
        6.629673881040182e-6,
        2.056008828788111e-6,
        -1.690726597065422e-7,
        -4.212564339656714e-8,
        3.076873069833976e-9,
        6.348671146380343e-10,
        -4.199056327560294e-11,
        -7.339422356685991e-12,
        4.45792864066589e-13,
        6.718459116772968e-14,
        -3.787429041839765e-15,
        -4.992453824592026e-16,
        2.633723690785212e-17,
        3.072580151637737e-18,
        -1.526832229861394e-19,
        -1.592234060932823e-20,
        7.492824205208353e-22,
        7.044215000435467e-23,
        -3.153163814398941e-24,
        -2.683101144904375e-25,
        1.150485396283318e-26,
    ],
    &[
        0.03899245437053448,
        -0.01308114101834367,
        0.0911313408340841,
        0.03204520801773311,
        -0.04269407050452122,
        -0.006417465574261059,
        0.005484426866535709,
        0.0005196879963557394,
        -0.000342122844647428,
        -0.00002314611425342162,
        0.00001273663773660887,
        6.556227686136285e-7,
        -3.162426404933748e-7,
        -1.287894087030999e-8,
        5.619941283898362e-9,
        1.85939279371702e-10,
        -7.50811483735097e-11,
        -2.05728216751384e-12,
        7.819740970325585e-13,
        1.800507843131445e-14,
        -6.52947229449994e-15,
        -1.277773772071347e-16,
        4.469558882141198e-17,
        7.501623292064991e-19,
        -2.554123238758145e-19,
        -3.703786914897635e-21,
        1.23699956414953e-21,
        1.559227662152005e-23,
        -5.142745289088918e-24,
        -5.644807454205898e-26,
        1.855448942618795e-26,
    ],
];

pub const SPLITS: [f64; 9] = [
    0.463386475800676,
    7.554993581964793,
    14.64660068812891,
    21.73820779429303,
    28.82981490045714,
    35.92142200662126,
    43.01302911278538,
    50.1046362189495,
    57.19624332511361,
];
