#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(7)
        * polynomial(
            x2,
            &[
                1.550099206349206e-6,
                4.84406001984127e-8,
                6.72786113866843e-10,
                5.606550948890359e-12,
                3.185540311869522e-14,
                1.327308463278967e-16,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -9.72421808478492,
                113.6517988659238,
                -809.7690669197069,
                3719.876651162403,
                -10694.64537209191,
                16710.38339389361,
                -8056.791993484419,
                -3650.733872047627,
                -4715.531251394852,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 2] = [
    &[
        -7.922862736233765,
        9.84204981942539,
        0.3477630997255819,
        0.1271351291808454,
        0.03483750815450199,
        0.007132285913165955,
        0.000990170205025758,
        0.00004458576163814873,
        -0.00001985361375164382,
        -5.86788917816851e-6,
        -4.352288145821539e-7,
        2.125608370393772e-7,
        9.003282880740878e-8,
        1.497454547488419e-8,
        -9.10966002871691e-10,
        -1.265377176682914e-9,
        -3.577070427866202e-10,
        -3.442908858254592e-11,
        1.290414917956011e-11,
        6.840646504509911e-12,
        1.463862281784857e-12,
        2.418903816378288e-14,
        -9.70174757518263e-14,
        -3.6247859993077e-14,
        -5.861772721079947e-15,
        5.622008062084835e-16,
        6.3727567024636e-16,
        1.894720854526464e-16,
        2.133205057001814e-17,
        -7.355445118039873e-18,
        -3.950291760207714e-18,
    ],
    &[
        37.46328791431508,
        45.81579056904879,
        13.37123030342581,
        2.985607464231147,
        0.4569548877344604,
        0.05952046529265997,
        0.006957353647807272,
        0.0004921549921080912,
        0.00005473361073118261,
        8.534250968791848e-6,
        -1.786002754695606e-6,
        3.114591421287759e-7,
        5.915252983348202e-8,
        -4.499299372785391e-8,
        1.066120084876405e-8,
        3.43923834657217e-10,
        -1.141820018384738e-9,
        3.803075639540785e-10,
        -2.203137865221621e-11,
        -3.213446901669608e-11,
        1.428551007566081e-11,
        -1.702881222005428e-12,
        -1.007341077147489e-12,
        5.747136603634926e-13,
        -9.24205983837815e-14,
        -3.621953285694214e-14,
        2.491081426435484e-14,
        -4.555049127547257e-15,
        -1.501344680449566e-15,
        1.079008987091135e-15,
        -2.098053823965277e-16,
    ],
];

pub const SPLITS: [f64; 3] = [-0.5925721197401655, 2.024154077670329, 4.640880275080823];
