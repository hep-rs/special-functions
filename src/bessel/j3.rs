#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(3)
        * polynomial(
            x2,
            &[
                0.02083333333333333,
                -0.001302083333333333,
                0.00003255208333333333,
                -4.521122685185185e-7,
                4.036716683201058e-9,
                -2.522947927000661e-11,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                2.785211504108168,
                14.1001332395476,
                32.31280534062992,
                -91.8895401874163,
                930.38159439759,
                -18123.05814086973,
                559549.4200993529,
                -2.478629071846352e7,
                1.480636616390439e9,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 5.497787143782138
        + x1 * polynomial(
            x1,
            &[
                4.375,
                0.0,
                1.002604166666667,
                0.0,
                -11.8603515625,
                0.0,
                -24.79629516601562,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 8] = [
    &[
        0.0466652245291466,
        -0.1538794571738583,
        -0.2755235225340758,
        -0.003675012902811355,
        0.0972673631387221,
        0.01354426955077795,
        -0.01335796067952208,
        -0.001768016228571277,
        0.000940656599645323,
        0.0001054450369314447,
        -0.00004001884476541377,
        -3.77891843798312e-6,
        1.139834187862875e-6,
        9.18698455120682e-8,
        -2.328054598223647e-8,
        -1.626565493011184e-9,
        3.579996169902916e-10,
        2.199298615144884e-11,
        -4.297841873757714e-12,
        -2.350342497670506e-13,
        4.1423531421091e-14,
        2.037900374992376e-15,
        -3.277421250369306e-16,
        -1.463628002051847e-17,
        2.167553764403939e-18,
        8.854892627318329e-20,
        -1.216431686802081e-20,
        -4.576265902804745e-22,
        5.86677221967279e-23,
        2.036325006160314e-24,
        -2.458064829161011e-25,
    ],
    &[
        -0.0810695089359602,
        0.02018224431000935,
        -0.1798841014397767,
        0.1128747554712715,
        0.08768465274478548,
        -0.0305287384211477,
        -0.0118286529550326,
        0.003025880009922427,
        0.000802927830580751,
        -0.0001630079105021087,
        -0.0000332236204726382,
        5.602404367984632e-6,
        9.2749764796027e-7,
        -1.342045110751609e-7,
        -1.865569243977451e-8,
        2.372964533171619e-9,
        2.833165601971674e-10,
        -3.226265197480798e-11,
        -3.364901030505721e-12,
        3.478734842485083e-13,
        3.21226977296e-14,
        -3.048030406964979e-15,
        -2.519488465548999e-16,
        2.213308782084624e-17,
        1.65294226755172e-18,
        -1.353800943888042e-19,
        -9.20718526353561e-21,
        7.071265413125608e-22,
        4.409619002671866e-23,
        -3.178471775388365e-24,
        -1.835466184226142e-25,
    ],
    &[
        0.01914063180753807,
        -0.007628149292403439,
        0.03051630767057869,
        0.1466563639437956,
        -0.02805096593712556,
        -0.03739808953060062,
        0.004973868847686794,
        0.003692472194235512,
        -0.0003972073818770108,
        -0.0001984411816444539,
        0.00001828094655401131,
        6.77179970656153e-6,
        -5.505806175819082e-7,
        -1.605174602103728e-7,
        1.174075199768352e-8,
        2.80384648211277e-9,
        -1.870277508793506e-10,
        -3.76404121400637e-11,
        2.31368437332978e-12,
        4.007981946570986e-13,
        -2.289092425988005e-14,
        -3.469516849092762e-15,
        1.853602538042841e-16,
        2.490529768639387e-17,
        -1.251609508723647e-18,
        -1.506879864688212e-19,
        7.156740596146051e-21,
        7.790549346203891e-22,
        -3.51070239117557e-23,
        -3.468280367597266e-24,
        1.493795350128857e-25,
    ],
    &[
        0.06208038948187149,
        -0.008956340518883573,
        0.1243968451659275,
        -0.005314298624621045,
        -0.07775470574122923,
        0.00321745896923838,
        0.01195873991615364,
        -0.0004655586431434573,
        -0.000874736126770396,
        0.00003222698454801489,
        0.00003787975556310158,
        -1.32648543119274e-6,
        -1.090046157369185e-6,
        3.638987363547381e-8,
        2.241488583161309e-8,
        -7.149883697297751e-10,
        -3.463441155720945e-10,
        1.057666284510395e-11,
        4.172593630828993e-12,
        -1.222114983835844e-13,
        -4.032224646987867e-14,
        1.134646347712042e-15,
        3.196533584184369e-16,
        -8.655883957530099e-18,
        -2.117069758373743e-18,
        5.525229759866289e-20,
        1.189275795683831e-20,
        -2.995750344684488e-22,
        -5.739397113701037e-23,
        1.391579849645398e-24,
        2.405468690139528e-25,
    ],
    &[
        0.00910924851051257,
        -0.001266054244904584,
        0.02133346949538989,
        -0.1123577263775158,
        -0.00933128993568939,
        0.03037884823899047,
        0.001076850221558944,
        -0.003147422949754042,
        -0.00005622469661286221,
        0.0001764799091982725,
        1.533945587082158e-6,
        -6.248838983666121e-6,
        -1.97125014746507e-8,
        1.528894776010683e-7,
        -7.122108116785431e-11,
        -2.743940184567426e-9,
        8.096996825145727e-12,
        3.770248793738151e-11,
        -1.776085815335638e-13,
        -4.096082699630241e-13,
        2.450615340487879e-15,
        3.60847936943478e-15,
        -2.494861346302755e-17,
        -2.630546870579291e-17,
        1.999140231326338e-19,
        1.61352928330761e-19,
        -1.307794033158111e-21,
        -8.44458376200567e-22,
        7.157411458414342e-24,
        3.800877659368852e-24,
        -3.336395942485428e-26,
    ],
    &[
        -0.0463470530471463,
        0.003989578947649513,
        -0.0914926741944485,
        -0.03471399979532139,
        0.05943589255281386,
        0.008465732851953495,
        -0.00937999515108731,
        -0.0008042693035587251,
        0.0007028653999225997,
        0.00004146056535483142,
        -0.00003115531908823969,
        -1.348555387559849e-6,
        9.16861074414617e-7,
        3.023706860317324e-8,
        -1.925885179409485e-8,
        -4.956301254236719e-10,
        3.035724281050265e-10,
        6.193508687216668e-12,
        -3.725731761903256e-12,
        -6.088560082183781e-14,
        3.662617626215452e-14,
        4.824267746110435e-16,
        -2.949726632110857e-16,
        -3.140484539898924e-18,
        1.982188279429048e-18,
        1.705365980303185e-20,
        -1.128481326675007e-20,
        -7.818378249371077e-23,
        5.513398679116884e-23,
        3.043945555001215e-25,
        -2.337090844502874e-25,
    ],
    &[
        -0.02287199946557402,
        0.002448540313891015,
        -0.0470746109842812,
        0.08218491754001718,
        0.02797922610105656,
        -0.02261351149726667,
        -0.004185200563696519,
        0.002378895809092908,
        0.0002990587416170792,
        -0.0001353990193897617,
        -0.00001267007349260698,
        4.8663981522121e-6,
        3.567810124439629e-7,
        -1.208482563374879e-7,
        -7.175566367488491e-9,
        2.200920800916463e-9,
        1.08338702476852e-10,
        -3.067770409645995e-11,
        -1.273893920248769e-12,
        3.379502313860859e-13,
        1.199991561134736e-14,
        -3.017252385437271e-15,
        -9.26126246819887e-17,
        2.227846637008968e-17,
        5.964195929880802e-19,
        -1.383258438427974e-19,
        -3.254028143785983e-21,
        7.323570494453173e-22,
        1.5235426411858e-23,
        -3.33243476358345e-24,
        -6.188687119087641e-26,
    ],
    &[
        0.03229777221096273,
        -0.001580035461899197,
        0.06327575817544102,
        0.05650369405391964,
        -0.04186953275713581,
        -0.01484634904108507,
        0.006686230564778184,
        0.001506121325490169,
        -0.0005066034269809914,
        -0.0000829266642050355,
        0.00002270487204818933,
        2.887938704001857e-6,
        -6.756299365760795e-7,
        -6.95652885506748e-8,
        1.43508410328966e-8,
        1.229955554821631e-9,
        -2.287443543121597e-10,
        -1.665492693632232e-11,
        2.838643534052444e-12,
        1.783503078200067e-13,
        -2.821258666482683e-14,
        -1.548732824490006e-15,
        2.296675136390409e-16,
        1.112805351704165e-17,
        -1.559629140999788e-18,
        -6.726953301971921e-20,
        8.970237039742341e-21,
        3.469130838616825e-22,
        -4.426122271800718e-23,
        -1.538432980874208e-24,
        1.894200181519045e-25,
    ],
];

pub const SPLITS: [f64; 9] = [
    0.4292910642842872,
    8.122606326063709,
    15.81592158784313,
    23.50923684962255,
    31.20255211140198,
    38.8958673731814,
    46.58918263496082,
    54.28249789674024,
    61.97581315851966,
];
