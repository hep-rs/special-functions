#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(6)
        * polynomial(
            x2,
            &[
                0.00002170138888888889,
                -7.750496031746032e-7,
                1.211015004960317e-8,
                -1.121310189778072e-10,
                7.008188686112948e-13,
                -3.185540311869522e-15,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                11.37957843107052,
                288.0455790364724,
                7141.129980279213,
                148401.6074026774,
                2.103592784932952e6,
                1.10876869705841e7,
                -6.434818331142559e7,
                1.221610042552845e9,
                -4.182317715128838e10,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 10.21017612416683
        + x1 * polynomial(
            x1,
            &[
                17.875,
                0.0,
                44.31510416666667,
                0.0,
                150.6248046875,
                0.0,
                -5859.212659563337,
            ],
        );

    amp * phase.cos()
}

pub const COEFFICIENTS: [&[f64]; 16] = [
    &[
        0.1339474189387292,
        0.1958909801337207,
        0.06083255662255404,
        -0.01548786762406765,
        -0.01916129837305393,
        -0.004187877413237913,
        0.00115214444521981,
        0.0005758936613028496,
        -9.37219272207716e-6,
        -0.00003247893431334144,
        -1.362885168089952e-6,
        1.077245936292954e-6,
        6.498426558964057e-8,
        -2.394563700141109e-8,
        -1.563039054267426e-9,
        3.838528998401062e-10,
        2.49429044910319e-11,
        -4.659595350540789e-12,
        -2.91593546289482e-13,
        4.438255406516966e-14,
        2.636418998062289e-15,
        -3.408681044720604e-16,
        -1.910249310141944e-17,
        2.157047078137554e-18,
        1.138031643989951e-19,
        -1.144667056294458e-20,
        -5.685374497520562e-22,
        5.168917643994849e-23,
        2.419565764509546e-24,
        -2.004077107540339e-25,
        -8.885562433782035e-27,
    ],
    &[
        0.08198851875286786,
        -0.134889577255266,
        0.2376421040528699,
        0.05926968377928262,
        -0.05686369946517646,
        -0.01137450161527878,
        0.004932828315944657,
        0.001000439865949564,
        -0.0002277260531921603,
        -0.00004890753804617986,
        6.577948018362379e-6,
        1.515942770875162e-6,
        -1.306917989460849e-7,
        -3.244445807992266e-8,
        1.903121780267743e-9,
        5.082698039062174e-10,
        -2.126124460060025e-11,
        -6.080530774166595e-12,
        1.885926897352643e-13,
        5.736793949029048e-14,
        -1.364037129483816e-15,
        -4.378122582424207e-16,
        8.215828296997884e-18,
        2.758647502673929e-18,
        -4.191770865197365e-20,
        -1.459608142730749e-20,
        1.837097841431131e-22,
        6.577607157323811e-23,
        -6.9968889559952e-25,
        -2.546591415057976e-25,
        2.338571758007475e-27,
    ],
    &[
        0.06609078542608984,
        -0.04906957440400302,
        0.1681516522092908,
        0.05169666858043173,
        -0.06484819641943709,
        -0.008484998462809145,
        0.007187527146382471,
        0.0006490580791653879,
        -0.0003952883804819641,
        -0.00002969929439536295,
        0.0000132480815977315,
        8.997887437589011e-7,
        -3.016421726323738e-7,
        -1.921395449133327e-8,
        4.992339515881893e-9,
        3.029794611498599e-10,
        -6.291435641184674e-11,
        -3.660248537472664e-12,
        6.245835951490624e-13,
        3.489681761383685e-14,
        -5.013510266961058e-15,
        -2.690017911568917e-16,
        3.321860245185605e-17,
        1.710467784346226e-18,
        -1.847677597708505e-19,
        -9.12312134887549e-21,
        8.749244746641155e-22,
        4.14001794703177e-23,
        -3.569313012776152e-24,
        -1.612436562834077e-25,
        1.267347479112417e-26,
    ],
    &[
        0.05981876662523073,
        -0.005775365178867056,
        0.1504303549700025,
        -0.01345946278907525,
        -0.06209924749109616,
        0.003646733955839201,
        0.007314585737145269,
        -0.0003336594950379788,
        -0.0004237317935746139,
        0.00001560751104603528,
        0.00001479732303198465,
        -4.459283125099285e-7,
        -3.478932979715172e-7,
        8.627138957353801e-9,
        5.904606667150562e-9,
        -1.209612689981988e-10,
        -7.591218003231992e-11,
        1.289811494081741e-12,
        7.657671038568788e-13,
        -1.084195047265578e-14,
        -6.226484790851276e-15,
        7.387071327615489e-17,
        4.168788259287227e-17,
        -4.171181326454578e-19,
        -2.33845533306103e-19,
        1.987637377452566e-21,
        1.114964141683299e-21,
        -8.114286786382137e-24,
        -4.574102460072873e-24,
        2.865279680490276e-26,
        1.631527900683952e-26,
    ],
    &[
        0.03945461135617877,
        0.02227954066455239,
        0.0998405472287528,
        -0.07303192356781005,
        -0.04130315266110845,
        0.01545687505147883,
        0.004891938189871715,
        -0.00130276146056794,
        -0.0002850879421136118,
        0.00006001912263454921,
        0.0000100071885995732,
        -1.753540557714528e-6,
        -2.361937841349467e-7,
        3.549755243383327e-8,
        4.01971204125766e-9,
        -5.283544843735659e-10,
        -5.177391758165298e-11,
        6.034707750338916e-12,
        5.229183188824028e-13,
        -5.462548447916937e-14,
        -4.255556981146737e-15,
        4.018638587299376e-16,
        2.851022621925294e-17,
        -2.451753905033538e-18,
        -1.600050230150904e-19,
        1.261168338865492e-20,
        7.631905341088108e-22,
        -5.545718841924172e-23,
        -3.131888083575948e-24,
        2.102117022661677e-25,
        1.117339752394306e-26,
    ],
    &[
        0.006954095845961514,
        0.03423466562580927,
        0.02038480714314328,
        -0.0977800815197088,
        -0.006749393967591735,
        0.02032266804594314,
        0.0006643454515881883,
        -0.001698929368529862,
        -0.00003195134241035249,
        0.00007804877040620271,
        9.11794643607586e-7,
        -2.281598144845512e-6,
        -1.718765523954216e-8,
        4.631334457690848e-8,
        2.292329540651008e-10,
        -6.920902609139601e-10,
        -2.268426327772541e-12,
        7.941219777975543e-12,
        1.723402445804865e-14,
        -7.222544219470038e-14,
        -1.029979701141789e-16,
        5.338033850466974e-16,
        4.918418639057789e-19,
        -3.270788741525397e-18,
        -1.886591932769984e-21,
        1.689057474760107e-20,
        5.742816629147861e-24,
        -7.452939924381538e-23,
        -1.311310496412293e-26,
        2.833476309679607e-25,
        1.731081297664288e-29,
    ],
    &[
        -0.02440579106781965,
        0.02873114124682186,
        -0.05620227334187785,
        -0.07667864650146911,
        0.0267765915761801,
        0.01573104356928957,
        -0.003462205629765184,
        -0.001303248590401648,
        0.0002165188144275255,
        0.00005944768994568851,
        -8.05889749041353e-6,
        -1.72774037140607e-6,
        1.996427430370373e-7,
        3.489872062608253e-8,
        -3.53421320338539e-9,
        -5.192967541384393e-10,
        4.697939084924866e-11,
        5.936049011350565e-12,
        -4.864263041767712e-13,
        -5.380342899335091e-14,
        4.035578446267891e-15,
        3.963904344078962e-16,
        -2.743793392945507e-17,
        -2.421595492981808e-18,
        1.557132600271829e-19,
        1.247001780938971e-20,
        -7.489500657925012e-22,
        -5.487531830237598e-23,
        3.09264205306599e-24,
        2.080863246835213e-25,
        -1.108467601383966e-26,
    ],
    &[
        -0.04048203638975765,
        0.01063226591355847,
        -0.0960806843246213,
        -0.0218611461874805,
        0.04385352759974907,
        0.004170000208721874,
        -0.005534928029531156,
        -0.0003240943596916604,
        0.0003398545974351435,
        0.00001389391520697953,
        -0.00001246457067562505,
        -3.795670705199673e-7,
        3.050915398190881e-7,
        7.204716129540761e-9,
        -5.347802852806829e-9,
        -1.007094179382106e-10,
        7.050995941393044e-11,
        1.081166807819833e-12,
        -7.251585869293641e-13,
        -9.20265733761169e-15,
        5.982586504500835e-15,
        6.367716238081415e-17,
        -4.048530533583887e-17,
        -3.654645546415986e-19,
        2.288482587637599e-19,
        1.76881638366885e-21,
        -1.096973232897688e-21,
        -7.319773408577732e-24,
        4.51630820265724e-24,
        2.612214707941065e-26,
        -1.614479595129125e-26,
    ],
    &[
        -0.03469079067007488,
        -0.01001043406902571,
        -0.08341295465561992,
        0.03775175375482532,
        0.03733809105981258,
        -0.008295685969574054,
        -0.004655726017142607,
        0.000725500729039256,
        0.0002829903637881994,
        -0.00003471272396033967,
        -0.00001028638401839948,
        1.053505048432746e-6,
        2.497424712537329e-7,
        -2.213803863253616e-8,
        -4.345238119436941e-9,
        3.415355612811065e-10,
        5.690056973295134e-11,
        -4.034876580893647e-12,
        -5.814914569385201e-13,
        3.768476122189454e-14,
        4.76903709888695e-15,
        -2.852991520033546e-16,
        -3.209469984900501e-17,
        1.786444532793593e-18,
        1.804761626131422e-19,
        -9.40693119681238e-21,
        -8.608533362615169e-22,
        4.224032555569181e-23,
        3.527663659736891e-24,
        -1.631202472735631e-25,
        -1.255462091471364e-26,
    ],
    &[
        -0.01167389606135589,
        -0.02274519934923955,
        -0.0291376508466593,
        0.07191389283989859,
        0.01228039656730438,
        -0.01532327160059558,
        -0.001467375691464873,
        0.001309476906158504,
        0.00008573475912122744,
        -0.00006143724350514408,
        -2.99809875361783e-6,
        1.832737316412407e-6,
        7.003970323762956e-8,
        -3.792656454545179e-8,
        -1.172442997752857e-9,
        5.771261344413793e-10,
        1.476839943317696e-11,
        -6.734285138159236e-12,
        -1.451430942138077e-13,
        6.219775794490597e-14,
        1.144504750012765e-15,
        -4.661388764726576e-16,
        -7.403877259536936e-18,
        2.892101186608688e-18,
        4.001295728605744e-20,
        -1.510204395165845e-20,
        -1.833970393635546e-22,
        6.729619380285179e-23,
        7.2205508395427e-25,
        -2.580652700901224e-25,
        -2.468618882683977e-27,
    ],
    &[
        0.01534198309860266,
        -0.02192739340251711,
        0.03526024352890714,
        0.06503209816709287,
        -0.01697273854706479,
        -0.01367653422585009,
        0.002217864154458077,
        0.001156626843819698,
        -0.0001403877133777198,
        -0.00005376166312041832,
        5.296232730127395e-6,
        1.589970657812664e-6,
        -1.331315143357605e-7,
        -3.263723841179815e-8,
        2.393282330333216e-9,
        4.928538835454149e-10,
        -3.232104112810488e-11,
        -5.709388718126727e-12,
        3.400571755315741e-13,
        5.236962228573447e-14,
        -2.866625474555553e-15,
        -3.899138909781769e-16,
        1.979843931194614e-17,
        2.404062619280954e-18,
        -1.140859674517748e-19,
        -1.247862485517621e-20,
        5.568584305804184e-22,
        5.528796746501219e-23,
        -2.331987322626222e-24,
        -2.108571977463145e-25,
        8.470663508975104e-27,
    ],
    &[
        0.03182105081421371,
        -0.00933539558769549,
        0.07503446352848108,
        0.02388137030831959,
        -0.03468781731365516,
        -0.004846654736447021,
        0.004420570104878219,
        0.0003975722713819992,
        -0.0002739919827821904,
        -0.00001794823135206964,
        0.00001014429191405457,
        5.157413773993589e-7,
        -2.506680136913971e-7,
        -1.028657556321838e-8,
        4.43571796174343e-9,
        1.509196534658935e-10,
        -5.903597942715959e-11,
        -1.698289423043224e-12,
        6.127705143140409e-13,
        1.512881355150532e-14,
        -5.100818428362654e-15,
        -1.093702590083528e-16,
        3.481720719197433e-17,
        6.546070281290514e-19,
        -1.984392791594789e-19,
        -3.297655230001006e-21,
        9.58697896894422e-22,
        1.417664329861471e-23,
        -3.976374479777249e-24,
        -5.245439437071258e-26,
        1.431400912796686e-26,
    ],
    &[
        0.02970688089368207,
        0.007211067066274267,
        0.07073785930740904,
        -0.02698296551521757,
        -0.03219286972429303,
        0.005936778130709942,
        0.00406073630946642,
        -0.0005206606956321338,
        -0.0002494380130989533,
        0.00002501190756140488,
        9.15850275623411e-6,
        -7.629134978906128e-7,
        -2.245282773093505e-7,
        1.612606376535436e-8,
        3.943283145723726e-9,
        -2.504275931838547e-10,
        -5.210318682344165e-11,
        2.97975555643509e-12,
        5.370531157765324e-13,
        -2.804220131527393e-14,
        -4.440584644463203e-15,
        2.139851365428411e-16,
        3.01145840950376e-17,
        -1.35084015347342e-18,
        -1.705645840816498e-19,
        7.172106784644431e-21,
        8.190521207428837e-22,
        -3.247334343837129e-23,
        -3.377310061717396e-24,
        1.264391864249806e-25,
        1.208870707734188e-26,
    ],
    &[
        0.01143608139906112,
        0.01837818334476309,
        0.02785828609968357,
        -0.05927496347101911,
        -0.0122116321593732,
        0.01269253968665316,
        0.001500633648098039,
        -0.001089674359443389,
        -0.00008998708831986605,
        0.00005136588470822629,
        3.227446541031801e-6,
        -1.539771683452502e-6,
        -7.730296777196015e-8,
        3.202414953601812e-8,
        1.326372190468288e-9,
        -4.898177030075068e-10,
        -1.712009090314255e-11,
        5.745397627883647e-12,
        1.723551303952537e-13,
        -5.334408736361258e-14,
        -1.391654266136155e-15,
        4.018938686043043e-16,
        9.21434732195878e-18,
        -2.506571693179644e-18,
        -5.094264878494653e-20,
        1.315664525516134e-20,
        2.387346782806466e-22,
        -5.892542894477269e-23,
        -9.60486489288699e-25,
        2.270843680079853e-25,
        3.353681549181333e-27,
    ],
    &[
        -0.01190988979536621,
        0.01843071325039214,
        -0.02746580836948444,
        -0.05650056531894075,
        0.01317235558825947,
        0.01197236985464836,
        -0.001719304573976041,
        -0.001019096371308036,
        0.0001088261921738315,
        0.00004766352384359654,
        -4.108850681590073e-6,
        -1.418198242968411e-6,
        1.034400523826565e-7,
        2.928565239535683e-8,
        -1.86346584262891e-9,
        -4.448490346135187e-10,
        2.523268751368213e-11,
        5.183110184346924e-12,
        -2.66306115542477e-13,
        -4.781146403639637e-14,
        2.252802903390127e-15,
        3.579399450615533e-16,
        -1.56189497344916e-17,
        -2.218734569498495e-18,
        9.03738275970573e-20,
        1.157622015582252e-20,
        -4.430399678283245e-22,
        -5.154514502576572e-23,
        1.863755843027897e-24,
        1.975186678788497e-25,
        -6.801467925647319e-27,
    ],
    &[
        -0.02710174879994545,
        0.008128153337426318,
        -0.06381468440293485,
        -0.02237680312239316,
        0.02959083731081637,
        0.004625756179733133,
        -0.00378017092007827,
        -0.0003855349579765085,
        0.0002348795364399923,
        0.00001767253082567617,
        -8.718869567494468e-6,
        -5.155206853540708e-7,
        2.16037879787474e-7,
        1.043725587948798e-8,
        -3.83393742101842e-9,
        -1.554328651604923e-10,
        5.117981050553323e-11,
        1.775293415489774e-12,
        -5.328723713255455e-13,
        -1.605082308036275e-14,
        4.449823933715335e-15,
        1.1775740414943e-16,
        -3.047194951398323e-17,
        -7.151841455053797e-19,
        1.742427938604105e-19,
        3.655374436285817e-21,
        -8.445776665819776e-22,
        -1.594120450654514e-23,
        3.514619117021494e-24,
        5.982111637074654e-26,
        -1.269349557022024e-26,
    ],
];

pub const SPLITS: [f64; 17] = [
    0.524324152227032,
    7.5993974384639,
    14.67447072470077,
    21.74954401093764,
    28.82461729717451,
    35.89969058341137,
    42.97476386964824,
    50.04983715588511,
    57.12491044212198,
    64.19998372835885,
    71.27505701459572,
    78.35013030083259,
    85.42520358706945,
    92.5002768733063,
    99.5753501595432,
    106.6504234457801,
    113.7254967320169,
];
