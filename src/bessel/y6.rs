#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(-6)
        * polynomial(
            x2,
            &[
                -2444.619925891512,
                -122.2309962945756,
                -3.819718634205488,
                -0.1061032953945969,
                -0.003315727981081153,
                -0.0001657863990540576,
                -0.00001852568394659233,
                9.43581227776355e-7,
                -1.715269448647917e-8,
            ],
        )
        + x.powi(6)
            * x.ln()
            * polynomial(
                x2,
                &[
                    0.0000138155332545048,
                    -4.934119019466001e-7,
                    7.709560967915627e-9,
                ],
            )
}

pub fn upper(x: f64) -> f64 {
    let x1 = x.recip();
    let amp = x1
        * polynomial(
            x.powi(-2),
            &[
                0.6366197723675813,
                11.37957843107052,
                288.0455790364724,
                7141.129980279213,
                148401.6074026774,
                2.103592784932952e6,
                1.10876869705841e7,
                -6.434818331142559e7,
                1.221610042552845e9,
                -4.182317715128838e10,
            ],
        );
    let amp = amp.sqrt();
    let phase = x - 10.21017612416683
        + x1 * polynomial(
            x1,
            &[
                17.875,
                0.0,
                44.31510416666667,
                0.0,
                150.6248046875,
                0.0,
                -5859.212659563337,
            ],
        );

    amp * phase.sin()
}

pub const COEFFICIENTS: [&[f64]; 20] = [
    &[
        -6248.214502160536,
        7415.390656555075,
        -2892.962473257189,
        890.4113007493926,
        -234.7279066638684,
        55.43515934373275,
        -12.05628202119314,
        2.458970742871232,
        -0.4763435508078911,
        0.08845528809333574,
        -0.01585531172908246,
        0.002757998797616017,
        -0.0004675302327818456,
        0.00007749755514534068,
        -0.00001259573805169117,
        2.011884423842836e-6,
        -3.164101753161739e-7,
        4.907515558396415e-8,
        -7.516741865187421e-9,
        1.138318095152089e-9,
        -1.706100227802108e-10,
        2.533007494448122e-11,
        -3.728174356142492e-12,
        5.443530620245953e-13,
        -7.889563038597276e-14,
        1.135657361497622e-14,
        -1.624326506935097e-15,
        2.30952213008544e-16,
        -3.266773403585066e-17,
        4.682956342566212e-18,
        -6.429692139302209e-19,
    ],
    &[
        -475.5721915021223,
        410.2868343341685,
        -110.6479261298338,
        23.22783649843983,
        -4.154582884210958,
        0.6640401921610016,
        -0.0976021066622619,
        0.01344195503188735,
        -0.001757302705575921,
        0.0002201384320439346,
        -0.00002661140987033637,
        3.1211469755099e-6,
        -3.566843644083891e-7,
        3.985280091612552e-8,
        -4.365603179044896e-9,
        4.699320778421579e-10,
        -4.98037409965489e-11,
        5.205059717762999e-12,
        -5.371841692343398e-13,
        5.481090763055354e-14,
        -5.534782432659235e-15,
        5.536179844915558e-16,
        -5.489521437606202e-17,
        5.39972785219887e-18,
        -5.272137766079604e-19,
        5.112278293772511e-20,
        -4.925672422923935e-21,
        4.717686546958659e-22,
        -4.493746103188416e-23,
        4.295196470329907e-24,
        -4.014346746542204e-25,
    ],
    &[
        -60.60656442910583,
        64.7143002064773,
        -22.72690976691014,
        6.320750262281689,
        -1.510506192327604,
        0.3241000630948639,
        -0.06413544284455868,
        0.01191480119284034,
        -0.002103917295436288,
        0.0003563236333728154,
        -0.00005827529532640364,
        9.25179568477017e-6,
        -1.431747437852305e-6,
        2.16695236042607e-7,
        -3.216271618411184e-8,
        4.691916432849871e-9,
        -6.739947642007057e-10,
        9.54904164075773e-11,
        -1.3361248604138e-11,
        1.848514976505991e-12,
        -2.531189665434811e-13,
        3.433470462844904e-14,
        -4.617247789181852e-15,
        6.159836609531355e-16,
        -8.157419638283025e-17,
        1.072918929516543e-17,
        -1.402232014300185e-18,
        1.821799771152086e-19,
        -2.354439928636939e-20,
        3.074747316941223e-21,
        -3.869903388323931e-22,
    ],
    &[
        -4.953259897566269,
        5.43606862734838,
        -2.177503945928976,
        0.7061666280266169,
        -0.1992689080891996,
        0.05103002303113325,
        -0.01211508705858571,
        0.00271007283004119,
        -0.0005777878825477857,
        0.0001183748198967567,
        -0.00002345240739627287,
        4.515285115973106e-6,
        -8.480935038028251e-7,
        1.558940069764759e-7,
        -2.811658638058112e-8,
        4.986243817123933e-9,
        -8.710502314257605e-10,
        1.50118376625324e-10,
        -2.555711706685212e-11,
        4.302941450815014e-12,
        -7.171639183773041e-13,
        1.184243947019111e-13,
        -1.938916588225591e-14,
        3.14963232702906e-15,
        -5.079239791799344e-16,
        8.135859914302496e-17,
        -1.295025289792259e-17,
        2.049331647526362e-18,
        -3.227058252565446e-19,
        5.171788643452715e-20,
        -7.868460346476764e-21,
    ],
    &[
        -0.469936805517804,
        0.5286639652524145,
        -0.08026590159118108,
        0.04615944498200288,
        -0.01689451933047413,
        0.003507731279980069,
        -0.00090826880938212,
        0.0002434369584143592,
        -0.00005567775070411417,
        0.00001234119054083878,
        -2.724819170854065e-6,
        5.834249296581798e-7,
        -1.216344529205967e-7,
        2.488741963580529e-8,
        -5.005425347233011e-9,
        9.90789439311015e-10,
        -1.933533237962002e-10,
        3.725405873768838e-11,
        -7.09502102056783e-12,
        1.337012265450275e-12,
        -2.495218628393696e-13,
        4.615466192721221e-14,
        -8.46756444887723e-15,
        1.541720821289556e-15,
        -2.787382344312099e-16,
        5.006626795845944e-17,
        -8.938090038153317e-18,
        1.586645952250046e-18,
        -2.803981611360523e-19,
        5.071363453717799e-20,
        -8.605697197613988e-21,
    ],
    &[
        0.01531710135673843,
        -0.1681089312546296,
        -0.04580765584084427,
        0.1571880301206225,
        0.01150501666951395,
        -0.02218304084708356,
        -0.002276968820105226,
        0.001538029111222372,
        0.0001690668911225832,
        -0.00006009382574926321,
        -7.638634592555699e-6,
        1.647407113993149e-6,
        1.995702119286662e-7,
        -2.872058035707949e-8,
        -4.391598482950311e-9,
        5.067816458776039e-10,
        4.279187979848131e-11,
        -1.733902519618613e-12,
        -1.256622891756644e-12,
        1.648589897078268e-13,
        -1.837616750450699e-14,
        4.380452546029118e-15,
        -9.50871842162426e-16,
        1.772838115322961e-16,
        -3.332861075647044e-17,
        6.378519512196976e-18,
        -1.210249285343555e-18,
        2.276796026148035e-19,
        -4.269131341581135e-20,
        8.225994445225899e-21,
        -1.476745040953149e-21,
    ],
    &[
        0.003782922560330375,
        -0.0704319299340687,
        -0.007633773069340186,
        0.1417768711083019,
        -0.002632797374282643,
        -0.02668485853509168,
        0.0004265142882860765,
        0.002078945505350142,
        -0.00001793974459190889,
        -0.0000912078852222769,
        1.613055232305826e-7,
        2.59892347603032e-6,
        9.48379939666093e-9,
        -5.22357085473229e-8,
        -3.996536184564089e-10,
        7.819993624010128e-10,
        8.189923534779148e-12,
        -9.06541641701047e-12,
        -1.12240100876404e-13,
        8.380676233823988e-14,
        1.139614333760971e-15,
        -6.322352620381319e-16,
        -9.04857143928825e-18,
        3.965804589173122e-18,
        5.810781467762952e-20,
        -2.100283372230107e-20,
        -3.097172300580953e-22,
        9.51858745263847e-23,
        1.39140598639451e-24,
        -3.71560433697783e-25,
        -5.399362107731207e-27,
    ],
    &[
        0.03464644032106733,
        -0.04448971589725608,
        0.07743022266037543,
        0.1018470026536844,
        -0.03721047918797543,
        -0.02016642558464111,
        0.004742630572044528,
        0.00163469159796181,
        -0.0002897367945042767,
        -0.00007379288724855748,
        0.00001049792687742889,
        2.145030324174763e-6,
        -2.532100502059275e-7,
        -4.373827479805269e-8,
        4.375618565946794e-9,
        6.619431566656136e-10,
        -5.700138610895362e-11,
        -7.739756539544623e-12,
        5.810433330667255e-13,
        7.2050731249111e-14,
        -4.768171326579515e-15,
        -5.467036172427311e-16,
        3.22124073517806e-17,
        3.445786152126399e-18,
        -1.824111849980462e-19,
        -1.832476123423406e-20,
        8.787852579590707e-22,
        8.33146264300505e-23,
        -3.646895863160679e-24,
        -3.263892047179184e-25,
        1.317505896009876e-26,
    ],
    &[
        0.05222403555402301,
        -0.01644332673967538,
        0.1227173999947505,
        0.02826236612008797,
        -0.0565317975021498,
        -0.005128886629741112,
        0.007159019825117942,
        0.0003865719471171889,
        -0.0004404660424106971,
        -0.0000163636906900242,
        0.00001618980267701183,
        4.501889427669356e-7,
        -3.975662231608751e-7,
        -8.781991982211748e-9,
        7.003294295052765e-9,
        1.286074778269181e-10,
        -9.29836928776495e-11,
        -1.470845072091517e-12,
        9.65068892945823e-13,
        1.351707589651418e-14,
        -8.052182176277799e-15,
        -1.019888472121664e-16,
        5.522011348497142e-17,
        6.425865698145894e-19,
        -3.168970725835894e-19,
        -3.428063813334318e-21,
        1.544685888011723e-21,
        1.566789536428501e-23,
        -6.476034710294757e-24,
        -6.176512538526219e-26,
        2.360237358715797e-26,
    ],
    &[
        0.04260426050451274,
        0.01031546525813509,
        0.1017266712062198,
        -0.04887597096275853,
        -0.04600709980473181,
        0.01105563454707691,
        0.005778433293935847,
        -0.000985222671363333,
        -0.0003538554580141119,
        0.00004780542325880734,
        0.0000129715115677584,
        -1.467043311800674e-6,
        -3.180731596149284e-7,
        3.111459276135209e-8,
        5.59882410796051e-9,
        -4.839796650603343e-10,
        -7.430854625300489e-11,
        5.762409265325515e-12,
        7.71072998960637e-13,
        -5.424344282890213e-14,
        -6.432336110863209e-15,
        4.140680183079213e-16,
        4.410145758941337e-17,
        -2.616046578729269e-18,
        -2.530123871333744e-19,
        1.391103002556095e-20,
        1.23279973354681e-21,
        -6.314076958381643e-23,
        -5.165940458922451e-24,
        2.467062015136972e-25,
        1.881670210261989e-26,
    ],
    &[
        0.01110183558160636,
        0.02506710793154407,
        0.028398604437895,
        -0.08885743966318489,
        -0.01149292483686185,
        0.01934371051722666,
        0.001332729594979151,
        -0.001681452702385593,
        -0.00007575106026878043,
        0.00008012318411005282,
        2.581628548862134e-6,
        -2.425929140701478e-6,
        -5.890443423195162e-8,
        5.094157656840359e-8,
        9.65686748114577e-10,
        -7.866319840857055e-10,
        -1.195222518275781e-11,
        9.3169045323132e-12,
        1.158560182003283e-13,
        -8.737833088532453e-14,
        -9.0475383648453e-16,
        6.652827013746916e-16,
        5.821393759473098e-18,
        -4.195726846739774e-18,
        -3.142683980248758e-20,
        2.228375038578688e-20,
        1.444951194605649e-22,
        -1.010561279947803e-22,
        -5.729538943918839e-25,
        3.945946200659164e-25,
        1.980060299779777e-27,
    ],
    &[
        -0.0229728841590565,
        0.02227306147626641,
        -0.05169764256522816,
        -0.07171720746690381,
        0.02575875216599103,
        0.01534763007828493,
        -0.003438179210681532,
        -0.001317085602325853,
        0.0002215857394599504,
        0.00006208159356395004,
        -8.497613627539571e-6,
        -1.861782862175889e-6,
        2.169158067348736e-7,
        3.876237501499596e-8,
        -3.957282826971299e-9,
        -5.939578360557639e-10,
        5.421233684386438e-11,
        6.985548931627485e-12,
        -5.784590574252625e-13,
        -6.509220474070662e-14,
        4.944978417900897e-15,
        4.926525628104625e-16,
        -3.463515456904849e-17,
        -3.089813544081367e-18,
        2.024306838165467e-19,
        1.632522125681224e-20,
        -1.002417121016938e-21,
        -7.367375439960629e-23,
        4.260098464576042e-24,
        2.863538257921265e-25,
        -1.570911332655671e-26,
    ],
    &[
        -0.03911900554489117,
        0.006195576864978541,
        -0.0904356757498468,
        -0.01252191452641833,
        0.04320470701507638,
        0.002354042335100954,
        -0.005626582279776317,
        -0.0001790446746944855,
        0.0003555475633387853,
        7.441981531070898e-6,
        -0.00001340784581629703,
        -1.948094650151196e-7,
        3.372925195261171e-7,
        3.490449079934377e-9,
        -6.07489706287129e-9,
        -4.516758155951765e-11,
        8.228470334708124e-11,
        4.373542190698552e-13,
        -8.692240878182503e-13,
        -3.23717627745133e-15,
        7.364484360553079e-15,
        1.84326589686406e-17,
        -5.1171380503531e-17,
        -7.926803082070024e-20,
        2.969428926585981e-19,
        2.358013400148173e-22,
        -1.460948710373277e-21,
        -2.778685579953013e-25,
        6.172409805578465e-24,
        -1.817211423221483e-27,
        -2.263892348795332e-26,
    ],
    &[
        -0.0289053817248732,
        -0.01163750676718957,
        -0.06777789300580956,
        0.04850987749713046,
        0.03164000988269961,
        -0.01087647561745027,
        -0.004059975752377001,
        0.000968928259213544,
        0.0002532941937109075,
        -0.00004723525877902033,
        -9.44049600945629e-6,
        1.461519254807274e-6,
        2.348953258893761e-7,
        -3.133235711223078e-8,
        -4.18696837849114e-9,
        4.934698792508538e-10,
        5.61562975736614e-11,
        -5.955046345713855e-12,
        -5.876667969939648e-13,
        5.684335994519129e-14,
        4.934521300921328e-15,
        -4.400186289799806e-16,
        -3.399393791926165e-17,
        2.81827910525742e-18,
        1.956476217506045e-19,
        -1.518467543755222e-20,
        -9.55010818527559e-22,
        6.978494286840369e-23,
        4.004367920050118e-24,
        -2.758516401943035e-25,
        -1.458028981452699e-26,
    ],
    &[
        -0.001005347847408982,
        -0.01978451304006867,
        -0.003513448071271565,
        0.0724990223014963,
        0.0007239084414964887,
        -0.01591613806638048,
        -0.00001361391793099732,
        0.001394969979311534,
        -3.614065401119186e-6,
        -0.00006704163797028557,
        2.935222489660817e-7,
        2.047706615224587e-6,
        -1.114420653400699e-8,
        -4.338066425168711e-8,
        2.656283452509035e-10,
        6.75756372764341e-10,
        -4.443726366070163e-12,
        -8.072007661469521e-12,
        5.554930745193479e-14,
        7.632180418910079e-14,
        -5.409297513879551e-16,
        -5.855836589096641e-16,
        4.229280404050214e-18,
        3.719650489223583e-18,
        -2.717335899952221e-20,
        -1.988623244176627e-20,
        1.461564604736128e-22,
        9.07289030956523e-23,
        -6.68178774306172e-25,
        -3.562012486510679e-25,
        2.629486036602358e-27,
    ],
    &[
        0.02513933431821622,
        -0.01399478110366328,
        0.05734050444765842,
        0.04686507409423161,
        -0.02805694189506094,
        -0.01011400241923318,
        0.003712913842796408,
        0.0008741288478015053,
        -0.0002380398745952761,
        -0.0000414724494087152,
        9.1011741650194e-6,
        1.251281770185564e-6,
        -2.32026770774888e-7,
        -2.619661183900046e-8,
        4.233491324213753e-9,
        4.034162503202802e-10,
        -5.80692637863114e-11,
        -4.765322843587065e-12,
        6.20954587770175e-13,
        4.456853897479738e-14,
        -5.323485065031159e-15,
        -3.383385211430474e-16,
        3.741299195641795e-17,
        2.126941181867991e-18,
        -2.194919066506856e-19,
        -1.125642408084206e-20,
        1.091274965053898e-21,
        5.084968457985702e-23,
        -4.657020315336677e-24,
        -1.977168453987431e-25,
        1.724498747013466e-26,
    ],
    &[
        0.03250431603052433,
        0.0006149628628887887,
        0.07509107063789892,
        -0.007844854323407108,
        -0.03596744753804776,
        0.001947710408288108,
        0.004695768005916718,
        -0.0001868980431437944,
        -0.00029755501296007,
        9.70116341858533e-6,
        0.00001125532706140243,
        -3.172793019372893e-7,
        -2.840760259458294e-7,
        7.1511111628115e-9,
        5.134139019513558e-9,
        -1.179012992610716e-10,
        -6.979001809148783e-11,
        1.484098577292536e-12,
        7.398952100329036e-13,
        -1.473122560207939e-14,
        -6.291298095357759e-15,
        1.182604276201246e-16,
        4.386912765337155e-17,
        -7.836453278111711e-19,
        -2.554439529888667e-19,
        4.358845716537444e-21,
        1.260929838577388e-21,
        -2.063995229184216e-23,
        -5.344106072149491e-24,
        8.390491433313103e-26,
        1.965907189351265e-26,
    ],
    &[
        0.0175307047905929,
        0.01356085007991178,
        0.04108749216834204,
        -0.05324122853756959,
        -0.01920073867379803,
        0.01183688179010259,
        0.00246574404844436,
        -0.001048433301857641,
        -0.0001539407923306237,
        0.00005088796189710462,
        5.740890119569741e-6,
        -1.56925095998666e-6,
        -1.429054929774426e-7,
        3.355678796709021e-8,
        2.547885028281929e-9,
        -5.27538837238082e-10,
        -3.417293282097388e-11,
        6.358431550790767e-12,
        3.575208335202096e-13,
        -6.065178869613356e-14,
        -3.000348739296814e-15,
        4.693848497033685e-16,
        2.06511809130291e-17,
        -3.00677831036142e-18,
        -1.18710138525467e-19,
        1.620766385991661e-20,
        5.785489861042379e-22,
        -7.4539689582343e-23,
        -2.421204207382056e-24,
        2.949184708337307e-25,
        8.795830387108465e-27,
    ],
    &[
        -0.008252372324863734,
        0.01626661484092897,
        -0.01831994184954181,
        -0.05951591583304078,
        0.00938981985100722,
        0.01306879857802778,
        -0.00127914183011004,
        -0.001146012054948739,
        0.00008407874545654033,
        0.00005511813383261562,
        -3.289125400342018e-6,
        -1.685098445540029e-6,
        8.567738086517831e-8,
        3.57378997008927e-8,
        -1.595511671659101e-9,
        -5.573814216060628e-10,
        2.231621787267205e-11,
        6.666762897858314e-12,
        -2.431374727535817e-13,
        -6.312231291578724e-14,
        2.122178387285446e-15,
        4.850011311838824e-16,
        -1.517403897396616e-17,
        -3.08520517781333e-18,
        9.05122523440931e-20,
        1.651817319463019e-20,
        -4.572620161875309e-22,
        -7.546996391089763e-23,
        1.981644589022992e-24,
        2.967052678066067e-25,
        -7.447702020506302e-27,
    ],
    &[
        -0.02674918779238136,
        0.007642734838935927,
        -0.06134274106010737,
        -0.02489844332045597,
        0.02976556431035819,
        0.005342636665766826,
        -0.003919994518317691,
        -0.0004594808926625581,
        0.0002503586632671541,
        0.0000216955149445166,
        -9.54178089240162e-6,
        -6.514220968347185e-7,
        2.426080842070019e-7,
        1.357035195595927e-8,
        -4.416564896596468e-9,
        -2.07900929850081e-10,
        6.046616968145765e-11,
        2.442609952619918e-12,
        -6.455798564087758e-13,
        -2.271629271070316e-14,
        5.52762676203621e-15,
        1.714294918922854e-16,
        -3.88089965652363e-17,
        -1.070985355884773e-18,
        2.275086006782004e-19,
        5.630982652362511e-21,
        -1.130506361127714e-21,
        -2.526292914009691e-23,
        4.822648095877109e-24,
        9.75244796149588e-26,
        -1.785450311272038e-26,
    ],
];

pub const SPLITS: [f64; 21] = [
    0.7217461906378703,
    1.169311399877692,
    1.616876609117514,
    2.512007027597158,
    4.302267864556445,
    7.88278953847502,
    15.04383288631217,
    22.20487623414932,
    29.36591958198647,
    36.52696292982362,
    43.68800627766077,
    50.84904962549792,
    58.01009297333507,
    65.17113632117222,
    72.33217966900937,
    79.49322301684652,
    86.65426636468366,
    93.8153097125208,
    100.976353060358,
    108.1373964081951,
    115.2984397560323,
];
