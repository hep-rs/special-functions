#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(0)
        * polynomial(
            x2,
            &[
                1.,
                0.25,
                0.015625,
                0.0004340277777777778,
                6.781684027777778e-6,
                6.781684027777778e-8,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                0.04986778505017908,
                0.02805062909072574,
                0.02921940530283931,
                0.04474221436997269,
                0.0906029840991947,
                0.22839502241672,
                0.6892635497933156,
                2.423192167242125,
                9.72642411573575,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 16] = [
    &[
        4.215111882076442,
        4.614678486286361,
        1.786732015821688,
        0.447065924453472,
        0.0955158127249897,
        0.01538288071097485,
        0.002266495024454337,
        0.0002688109538466455,
        0.00003021779584967623,
        2.835430135241233e-6,
        2.576454285576298e-7,
        1.99968342103001e-8,
        1.524756643922293e-9,
        1.008963167068195e-10,
        6.627257042358604e-12,
        3.821880415232498e-13,
        2.204829903974991e-14,
        1.126711236135807e-15,
        5.794708673608273e-17,
        2.65845494225235e-18,
        1.233425107716553e-19,
        5.133725025518811e-21,
        2.169510928617551e-22,
        8.26334361130738e-24,
        3.206246106338631e-25,
        1.125654732940814e-26,
        4.037178938588762e-28,
        1.314520964854486e-29,
        4.382944237625444e-31,
        1.331722475215696e-32,
        4.144830787432842e-34,
    ],
    &[
        107.6374700956235,
        137.5338424133309,
        52.91109532967178,
        14.42036317414256,
        3.036258172227402,
        0.520269347759619,
        0.07514793421795204,
        0.00937862276762213,
        0.001030497156762718,
        0.0001011214628080047,
        8.965629644418784e-6,
        7.2490369452803e-7,
        5.387388888318482e-8,
        3.704115917228068e-9,
        2.36968094814015e-10,
        1.417305713764851e-11,
        7.959690309442982e-13,
        4.212811674414362e-14,
        2.108517800435797e-15,
        1.000832469621281e-16,
        4.517779721339593e-18,
        1.943914575658854e-19,
        7.991154288248814e-21,
        3.144504722722419e-22,
        1.186696505106532e-23,
        4.301952122336852e-25,
        1.500522854898759e-26,
        5.042642982173601e-28,
        1.635044019692008e-29,
        5.12558857856521e-31,
        1.551261321803399e-32,
    ],
    &[
        3453.656913868894,
        4502.83388326973,
        1766.060573028312,
        489.4655860847809,
        104.50318787685,
        18.12067021154494,
        2.643766381858806,
        0.3328440170897554,
        0.03684903446195262,
        0.003640259714496352,
        0.0003246557615213418,
        0.00002638920316888146,
        1.970472599624125e-6,
        1.360653698747251e-7,
        8.738362339029115e-9,
        5.245112331879469e-10,
        2.955204801899819e-11,
        1.568813073924895e-12,
        7.873416466204538e-14,
        3.746843305984192e-15,
        1.695305834227294e-16,
        7.310848136785834e-18,
        3.011510231903316e-19,
        1.187334123884238e-20,
        4.48884893845855e-22,
        1.630072695592143e-23,
        5.694664960775317e-25,
        1.916668407258981e-26,
        6.223387227682259e-28,
        1.953600182076818e-29,
        5.919987610060185e-31,
    ],
    &[
        118763.675780747,
        156118.5980886446,
        61827.37345581272,
        17291.02651366638,
        3721.613284032985,
        649.9482370335714,
        95.4288488127671,
        12.08229355895294,
        1.344407282284384,
        0.133418046590964,
        0.01194799134121567,
        0.000974822008642083,
        0.00007303912384308705,
        5.059358573337338e-6,
        3.258607368199732e-7,
        1.961168768253687e-8,
        1.107696224943002e-9,
        5.893877967420297e-11,
        2.964297595663565e-12,
        1.413485640682529e-13,
        6.407458250799591e-15,
        2.76800673238549e-16,
        1.142088339069918e-17,
        4.50985577541268e-19,
        1.707500935236045e-20,
        6.20918050653632e-22,
        2.172024564060413e-23,
        7.319530410190843e-25,
        2.379443606223293e-26,
        7.477771283107893e-28,
        2.268402539390621e-29,
    ],
    &[
        4.232756406754548e6,
        5.589153017908101e6,
        2.226166099188022e6,
        626078.8604530232,
        135454.3250604663,
        23768.28921544664,
        3504.866190320723,
        445.4992636315023,
        49.74922264436701,
        4.953327972983942,
        0.4449271632126854,
        0.03640227556384921,
        0.002734494389284495,
        0.000189869041536829,
        0.00001225618780182955,
        7.391589784154647e-7,
        4.182966114160058e-8,
        2.229730992842048e-9,
        1.123343534329504e-10,
        5.365099411456654e-12,
        2.435721864407814e-13,
        1.053726573924422e-14,
        4.353571994791051e-16,
        1.721325430975272e-17,
        6.525098132094641e-19,
        2.375525965665816e-20,
        8.318886766412079e-22,
        2.806312499103835e-23,
        9.1318654032543e-25,
        2.872556716131867e-26,
        8.721862672307826e-28,
    ],
    &[
        1.542159959897854e8,
        2.04214464026763e8,
        8.164593270487641e7,
        2.304910056521307e7,
        5.004745678820612e6,
        881140.0050894713,
        130337.4773889562,
        16614.80204837887,
        1860.341499365243,
        185.6855638553366,
        16.71741883072165,
        1.370692319702497,
        0.1031711036767362,
        0.007177100988823951,
        0.0004641021516616445,
        0.00002803582136605234,
        1.589040796281123e-6,
        8.482816195410665e-8,
        4.279587127515605e-9,
        2.0466162506405e-10,
        9.30306216252058e-12,
        4.029380308448394e-13,
        1.666643587206228e-14,
        6.596644933458095e-16,
        2.503158872411991e-17,
        9.12183146419981e-19,
        3.19734432572366e-20,
        1.079554225214297e-21,
        3.515892791047272e-23,
        1.106872312510273e-24,
        3.363374594479045e-26,
    ],
    &[
        5.70342063495397e9,
        7.567358170075941e9,
        3.03354444637448e9,
        8.587335144378896e8,
        1.869534082097762e8,
        3.299749480528865e7,
        4.892419245018869e6,
        625033.4161524244,
        70128.37006245284,
        7013.196865621239,
        632.5462353531828,
        51.95182780488212,
        3.916637041099491,
        0.2728719588547905,
        0.01767020134243082,
        0.001068871925476327,
        0.00006065979780078831,
        3.242133823261796e-6,
        1.637537751816906e-7,
        7.83970971757748e-9,
        3.567310506935084e-10,
        1.546619869500414e-11,
        6.403224949805844e-13,
        2.536714057567635e-14,
        9.63412101332744e-16,
        3.513702577185692e-17,
        1.232584317070561e-18,
        4.164874297712573e-20,
        1.357406899338542e-21,
        4.27638722845535e-23,
        1.300310508950853e-24,
    ],
    &[
        2.132310525688323e11,
        2.83323649042799e11,
        1.138023413244726e11,
        3.228169881972627e10,
        7.042185413333621e9,
        1.245353359987566e9,
        1.849819767983498e8,
        2.367333914999245e7,
        2.660472043893049e6,
        266471.17560139,
        24069.05099650983,
        1979.547202098615,
        149.4324944078876,
        10.42384617705094,
        0.6758040223094956,
        0.0409251163239437,
        0.002325020441214525,
        0.000124393173332059,
        6.288925502478264e-6,
        3.013600817106004e-7,
        1.372491344588806e-8,
        5.955506941475728e-10,
        2.467657586303992e-11,
        9.7834975885376e-13,
        3.718412786665257e-14,
        1.357127269586097e-15,
        4.763983483786815e-17,
        1.610802084906278e-18,
        5.253228598823462e-20,
        1.655997071575685e-21,
        5.038316377888685e-23,
    ],
    &[
        8.037780720981784e12,
        1.069165032716273e13,
        4.301104789442441e12,
        1.222041821427835e12,
        2.670101729647417e11,
        4.729102850007746e10,
        7.034799888733536e9,
        9.0154503647061e8,
        1.014523795313891e8,
        1.017421226744082e7,
        920088.329194658,
        75758.44536108978,
        5725.074487535675,
        399.7724039602315,
        25.94380003408093,
        1.572575004951036,
        0.08942083873694584,
        0.004788307968284234,
        0.0002422811680339722,
        0.00001161907930402412,
        5.295712487319258e-7,
        2.299583384573484e-8,
        9.53495372718565e-10,
        3.782852791613528e-11,
        1.438677680171281e-12,
        5.254080293777857e-14,
        1.84546911536939e-15,
        6.243524718755183e-17,
        2.037306047176004e-18,
        6.425751384563931e-20,
        1.956029759676757e-21,
    ],
    &[
        3.049461999790795e14,
        4.059826530141368e14,
        1.635211260147439e14,
        4.652029105049436e13,
        1.017753112071572e13,
        1.804825183345028e12,
        2.687998189060267e11,
        3.448762775211623e10,
        3.885212111932325e9,
        3.900394430073986e8,
        3.530791754673795e7,
        2.909974413609294e6,
        220108.376389404,
        15383.26051681146,
        999.155733926101,
        60.61216511299336,
        3.449226533736441,
        0.184835829669773,
        0.00935905909797956,
        0.0004491389871055108,
        0.00002048418476882081,
        8.900574913777111e-7,
        3.692768200193263e-8,
        1.465912162502717e-9,
        5.578251058509156e-11,
        2.038303094087145e-12,
        7.16321934114601e-14,
        2.424672152583026e-15,
        7.915782962687207e-17,
        2.497867175850502e-18,
        7.607139392366883e-20,
    ],
    &[
        1.162966531129226e16,
        1.54937092119081e16,
        6.246758717567891e15,
        1.779035679957732e15,
        3.89623547701471e14,
        6.916512897668216e13,
        1.031134116619174e13,
        1.324241369105757e12,
        1.493205315392694e11,
        1.500368553205569e10,
        1.359347297944777e9,
        1.121247198379811e8,
        8.487667763649269e6,
        593644.2541925025,
        38585.51749842161,
        2342.35170223348,
        133.3840003406187,
        7.152322096610738,
        0.3623779196007255,
        0.01740080037352426,
        0.0007940665333190566,
        0.00003452210670132134,
        1.433058866356312e-6,
        5.691737088161141e-8,
        2.166967394150321e-9,
        7.921974209199621e-11,
        2.785328968098468e-12,
        9.4323177651049e-14,
        3.080706305221861e-15,
        9.72548455762308e-17,
        2.963074363117466e-18,
    ],
    &[
        4.454188087308608e17,
        5.937555856796728e17,
        2.395889074238845e17,
        6.829389106494013e16,
        1.497023836034747e16,
        2.659801835551026e15,
        3.968666343295801e14,
        5.100953728110524e13,
        5.756330058528843e12,
        5.788330258504343e11,
        5.248105921005462e10,
        4.331900259275769e9,
        3.281398573104548e8,
        2.296569399953538e7,
        1.493654015058818e6,
        90727.7955373398,
        5169.460869001391,
        277.353078873347,
        14.05994630845828,
        0.6754903948730858,
        0.03084091589538695,
        0.001341469668220906,
        0.00005571266172803964,
        2.213780017032589e-6,
        8.432095440658643e-8,
        3.083927110372502e-9,
        1.084748429870047e-10,
        3.674915659117653e-12,
        1.200744139002823e-13,
        3.792084178444386e-15,
        1.155767527437858e-16,
    ],
    &[
        1.712084762604139e19,
        2.28336410448179e19,
        9.2201440746633e18,
        2.630142782231649e18,
        5.76972167974596e17,
        1.025885093673971e17,
        1.531823899211563e16,
        1.970247282099098e15,
        2.224897586444459e14,
        2.238734102620346e13,
        2.031078858417745e12,
        1.677521318670088e11,
        1.271466092883436e10,
        8.903745787623776e8,
        5.794048695330572e7,
        3.521303006688984e6,
        200738.8943150882,
        10775.44433848212,
        546.5058359448023,
        26.268338960132,
        1.199876769094049,
        0.05221317719585952,
        0.002169388190666594,
        0.00008623754796602996,
        3.286024060406901e-6,
        1.202285378247671e-7,
        4.23054081671868e-9,
        1.433748588647082e-10,
        4.686303742887227e-12,
        1.480499498424826e-13,
        4.513843759693308e-15,
    ],
    &[
        6.60090606202123e20,
        8.807100373142538e20,
        3.55840255725432e20,
        1.015726736407447e20,
        2.229643598743906e19,
        3.966966839141082e18,
        5.927089226832659e17,
        7.628137075757634e16,
        8.619157770666304e15,
        8.677731980647727e14,
        7.877191250407727e13,
        6.509471460140886e12,
        4.936373227087673e11,
        3.458551285358068e10,
        2.251722680482151e9,
        1.369117667326511e8,
        7.808491263363972e6,
        419336.7231027146,
        21276.9205036219,
        1023.121566422203,
        46.75268716735933,
        2.035261569685412,
        0.08459460231374591,
        0.003364049281577358,
        0.0001282309180200272,
        4.693332470639359e-6,
        1.652027387330855e-7,
        5.600644129112875e-9,
        1.831197605141007e-10,
        5.786945762064558e-12,
        1.764899753668385e-13,
    ],
    &[
        2.551635883172276e22,
        3.40567181681657e22,
        1.376732205942453e22,
        3.932007781110181e21,
        8.63613025493453e20,
        1.537396727868385e20,
        2.29830390546126e19,
        2.959490735952693e18,
        3.345717765480106e17,
        3.370156248563732e16,
        3.060750533296627e15,
        2.530512931186818e14,
        1.919865700459079e13,
        1.345708699764689e12,
        8.76516092994987e10,
        5.331732068313401e9,
        3.04208848426786e8,
        1.634329496691041e7,
        829569.0645811507,
        39905.55182687041,
        1824.191401367103,
        79.43966969525298,
        3.303003413271678,
        0.1313934932446147,
        0.005010090016565104,
        0.0001834305400253305,
        6.458646829351666e-6,
        2.190245529464909e-7,
        7.16336791420099e-9,
        2.264413356389314e-10,
        6.90791668336825e-12,
    ],
    &[
        9.88603657744105e23,
        1.319899994416616e24,
        5.338064869556914e23,
        1.525322372625902e23,
        3.351835180596974e22,
        5.969855852806617e21,
        8.928855963813744e20,
        1.150299391122039e20,
        1.301018298906304e19,
        1.31110916154341e18,
        1.191258433657018e17,
        9.85304509141299e15,
        7.478446062209481e14,
        5.244029106096317e13,
        3.41698070946662e12,
        2.079288760594563e11,
        1.186800222956107e10,
        6.378231647394696e8,
        3.238648987109176e7,
        1.558444171536905e6,
        71264.13489231281,
        3104.394931908799,
        129.1171295473445,
        5.137839352801983,
        0.1959659697626836,
        0.007176819438815145,
        0.0002527691381886014,
        8.574216666384422e-6,
        2.805014838970167e-7,
        8.869257867354425e-9,
        2.706382982700054e-10,
    ],
];

pub const SPLITS: [f64; 17] = [
    0.2975562749381294,
    3.987130720660048,
    7.676705166381966,
    11.36627961210388,
    15.0558540578258,
    18.74542850354772,
    22.43500294926964,
    26.12457739499156,
    29.81415184071348,
    33.50372628643539,
    37.19330073215731,
    40.88287517787923,
    44.57244962360115,
    48.26202406932307,
    51.95159851504499,
    55.64117296076691,
    59.33074740648882,
];
