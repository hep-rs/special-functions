#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(0)
        * polynomial(
            x2,
            &[
                1.,
                0.25,
                0.015625,
                0.0004340277777777778,
                6.781684027777778e-6,
                6.781684027777778e-8,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                0.04986778505017908,
                0.02805062909072574,
                0.02921940530283931,
                0.04474221436997269,
                0.0906029840991947,
                0.22839502241672,
                0.6892635497933156,
                2.423192167242125,
                9.72642411573575,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 4] = [
    &[
        0.1180536725179769,
        0.1271738647278525,
        0.03751335082364511,
        0.007270562967788182,
        0.000970162188928509,
        0.00008097781478345916,
        1.150545585989362e-6,
        -8.28790601660403e-7,
        -1.282897851983708e-7,
        -4.219312503604946e-9,
        1.893934116029214e-9,
        4.330987332657911e-10,
        4.097692895869613e-11,
        -1.395748164203381e-12,
        -1.13169439780746e-12,
        -1.861775825239591e-13,
        -1.144272309426745e-14,
        1.80940967353626e-15,
        5.97313217497099e-16,
        7.632326404057875e-17,
        1.769580293057008e-18,
        -1.328640092520768e-18,
        -2.975985431131299e-19,
        -2.869824228564813e-20,
        9.87852567886017e-22,
        8.307905308628664e-22,
        1.406104929568902e-22,
        8.986393776488591e-24,
        -1.387883770801066e-24,
        -4.763927288480958e-25,
        -6.210292540942286e-26,
    ],
    &[
        1.192716679332387,
        1.125066888487343,
        0.2511646045018327,
        0.02923280533473878,
        0.001561805770884433,
        0.0001144427645239605,
        0.00003620177464831678,
        1.349100816604338e-6,
        -1.126580526346954e-6,
        -6.632748901163925e-8,
        4.2664445474361e-8,
        4.299332795401516e-9,
        -1.401230188297739e-9,
        -2.190946282449928e-10,
        3.969013661934891e-11,
        9.16435029661872e-12,
        -9.9549699018238e-13,
        -3.348835631171831e-13,
        2.482420696570645e-14,
        1.168951304064104e-14,
        -7.137476943677783e-16,
        -4.274483214800019e-16,
        2.204211028308018e-17,
        1.676929289687412e-17,
        -5.350101443255689e-19,
        -6.698521231186395e-19,
        2.482971257915419e-21,
        2.586995928515919e-20,
        6.725180767810197e-22,
        -9.21217869614345e-22,
        -5.111534291087273e-23,
    ],
    &[
        7.113084324448048,
        5.348036594139029,
        0.927691769268068,
        0.1007290558841261,
        0.00839102742864835,
        0.0005376502523553784,
        0.0000314899623004521,
        1.566231556082507e-6,
        -7.481972267238762e-8,
        3.890387772042799e-8,
        -3.069832012128069e-9,
        -1.266506120668048e-9,
        4.714057978539727e-10,
        -2.90003617900091e-11,
        -1.93567926221902e-11,
        4.538362200028431e-12,
        3.323786510393472e-13,
        -2.588080417726404e-13,
        1.058839670862751e-14,
        1.116550971791005e-14,
        -1.310796581113743e-15,
        -4.267911298879447e-16,
        8.158291896040712e-17,
        1.525340800777833e-17,
        -4.125974454587945e-18,
        -5.189394027131489e-19,
        1.838728757826015e-19,
        1.731308016553027e-20,
        -7.363191368783852e-21,
        -5.816205960031951e-22,
        2.639918718805108e-22,
    ],
    &[
        31.42707119858507,
        21.05485673750693,
        3.476970449509858,
        0.3800089825972174,
        0.0312812995605048,
        0.00206217356510648,
        0.000113520920507694,
        5.350880560717855e-6,
        2.215779704982276e-7,
        8.080959732757228e-9,
        2.73618326909584e-10,
        7.443442931106573e-12,
        3.07361884308515e-13,
        -6.593668421248591e-15,
        2.047504399330042e-15,
        -3.219749652661145e-16,
        6.005806666369977e-17,
        -1.187131707943798e-17,
        2.426013447834611e-18,
        -4.795640175354902e-19,
        8.135285561853151e-20,
        -7.879773486732418e-21,
        -1.716318891499104e-21,
        1.328431851067239e-21,
        -4.81914407939489e-22,
        1.208565108928632e-22,
        -1.885834128419573e-23,
        -2.865314162373853e-25,
        1.338301694162203e-24,
        -4.925551135237376e-25,
        9.34604071375824e-26,
    ],
];

pub const SPLITS: [f64; 5] = [
    -1.21215191242895,
    0.1116679850876634,
    1.435487882604276,
    2.759307780120889,
    4.083127677637502,
];
