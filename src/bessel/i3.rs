#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(3)
        * polynomial(
            x2,
            &[
                0.02083333333333333,
                0.001302083333333333,
                0.00003255208333333333,
                4.521122685185185e-7,
                4.036716683201058e-9,
                2.522947927000661e-11,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -1.745372476756268,
                2.945316054526202,
                -1.349936524991176,
                -0.5484117132776653,
                -0.6169631774373734,
                -1.092538960045349,
                -2.594780030107703,
                -7.662709776411811,
                -26.92591074211373,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 3] = [
    &[
        -4.461037379425162,
        1.944768837683745,
        0.0178033946893639,
        0.003541882631601573,
        0.000525242833663965,
        0.00006038090149239073,
        5.345743949513521e-6,
        3.281830529004367e-7,
        5.546070410580294e-9,
        -1.852196798647987e-9,
        -3.06592894776553e-10,
        -2.640448001388026e-11,
        -7.388446111137817e-13,
        1.863971071895088e-13,
        3.996421918101415e-14,
        4.506951268030946e-15,
        2.773484793863371e-16,
        -8.878251592469874e-18,
        -5.130269492867255e-18,
        -7.941078740601304e-19,
        -7.433531751948603e-20,
        -2.82287808546002e-21,
        4.829113573742053e-22,
        1.254518512817663e-22,
        1.630401599118386e-23,
        1.274156530669638e-24,
        1.115541486811242e-26,
        -1.537202702380153e-26,
        -2.980057344110186e-27,
        -3.371440537245335e-28,
        -2.128298920789551e-29,
    ],
    &[
        -0.0977146524241719,
        2.548192515484705,
        0.1787725424799425,
        0.03027028492368049,
        0.003248221622314654,
        0.0001704815042581953,
        -5.954888613930402e-6,
        -1.020494392161259e-6,
        1.871525558238473e-7,
        4.761719937078257e-8,
        7.508657712331498e-10,
        -1.101166321329783e-9,
        -1.510832462431347e-10,
        1.040134006985942e-11,
        5.467653209344272e-12,
        4.48267115136234e-13,
        -9.08498136145342e-14,
        -2.538658253994231e-14,
        -1.054147004788288e-15,
        5.690316956517158e-16,
        1.132047343462717e-16,
        4.38185872984907e-19,
        -3.16841535966673e-18,
        -4.844853821462312e-19,
        1.806382651017261e-20,
        1.653342566020579e-20,
        1.965342247011111e-21,
        -1.760761313510825e-22,
        -8.236593082231813e-23,
        -6.958169671253256e-24,
        1.240649625641187e-24,
    ],
    &[
        23.97523776042364,
        28.05653398073745,
        8.236224611356444,
        1.719257740433248,
        0.2568699408727341,
        0.03274338632361985,
        0.003376038212140536,
        0.0002724702553051842,
        0.00003187261288042664,
        -4.298593423146004e-8,
        1.529304162892595e-7,
        1.22179837742996e-7,
        -5.559271324903e-8,
        1.34413816235918e-8,
        -1.123434157330949e-10,
        -1.458499048083959e-9,
        6.671953893330421e-10,
        -1.16994763479142e-10,
        -3.348101974570048e-11,
        2.963121734264504e-11,
        -8.007300577220253e-12,
        -7.247841439844992e-13,
        1.391009396095169e-12,
        -4.420248284171666e-13,
        -2.723320411702331e-14,
        7.232141846808319e-14,
        -2.194361557962652e-14,
        -2.701519869341009e-15,
        3.992633681264768e-15,
        -7.005843613811382e-16,
        -2.847328368155111e-16,
    ],
];

pub const SPLITS: [f64; 4] = [
    -0.8438068339181895,
    0.4121104998973549,
    1.668027833712899,
    4.179862501343988,
];
