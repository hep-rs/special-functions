#![allow(clippy::all)]

use crate::approximations::polynomial;

pub fn lower(x: f64) -> f64 {
    let x2 = x.powi(2);

    x.powi(3)
        * polynomial(
            x2,
            &[
                0.02083333333333333,
                0.001302083333333333,
                0.00003255208333333333,
                4.521122685185185e-7,
                4.036716683201058e-9,
                2.522947927000661e-11,
            ],
        )
}

pub fn upper(x: f64) -> f64 {
    x.exp() / x.sqrt()
        * polynomial(
            x.recip(),
            &[
                0.3989422804014327,
                -1.745372476756268,
                2.945316054526202,
                -1.349936524991176,
                -0.5484117132776653,
                -0.6169631774373734,
                -1.092538960045349,
                -2.594780030107703,
                -7.662709776411811,
                -26.92591074211373,
            ],
        )
}

pub const COEFFICIENTS: [&[f64]; 17] = [
    &[
        0.1458192778219265,
        0.2070601147236091,
        0.07621815175239642,
        0.01495060439392043,
        0.001844904962176648,
        0.0002100428808651508,
        0.00001610935143647411,
        1.297186392376988e-6,
        7.300965212777528e-8,
        4.556578442286293e-9,
        2.035054561144933e-10,
        1.037890787177865e-11,
        3.850792907627356e-13,
        1.661306625006115e-14,
        5.277912823792226e-16,
        1.973643993660126e-17,
        5.486168857238277e-19,
        1.810730230015378e-20,
        4.475885448900916e-22,
        1.3222955633436e-23,
        2.943506528428801e-25,
        7.870995359077851e-27,
        1.593970086150362e-28,
        3.893289212496924e-30,
        7.232621462502672e-32,
        1.625902107763259e-33,
        2.790130320736401e-35,
        5.809851337445661e-37,
        9.26429284261218e-39,
        1.797180911404193e-40,
        2.675749392823739e-42,
    ],
    &[
        2.442565078754826,
        2.581650034834698,
        0.6903615737538031,
        0.1189022189605754,
        0.01516110754406876,
        0.001534737758081534,
        0.0001284872125676525,
        9.22008622053448e-6,
        5.757422902021614e-7,
        3.204248710996852e-8,
        1.597518717563077e-9,
        7.267742373008326e-11,
        3.017920515669894e-12,
        1.161675221643164e-13,
        4.135212675713399e-15,
        1.37996693927767e-16,
        4.300012054766772e-18,
        1.266775547741783e-19,
        3.510619250439585e-21,
        9.25882024039621e-23,
        2.310669585398906e-24,
        5.516933015627841e-26,
        1.252405133495996e-27,
        2.731777524141151e-29,
        5.687932327084133e-31,
        1.142041213035083e-32,
        2.196179440998837e-34,
        4.085053877766762e-36,
        7.298353918040914e-38,
        1.264884645462204e-39,
        2.109644355195853e-41,
    ],
    &[
        123.8966981059504,
        176.4147881037604,
        77.83411302456288,
        24.34189794382541,
        5.852882095441035,
        1.13960384837492,
        0.1861875828471087,
        0.02618710209948318,
        0.003232394991404155,
        0.0003554374128700845,
        0.00003523531320478213,
        3.179809099580128e-6,
        2.633479791363709e-7,
        2.015250860417774e-8,
        1.433222585696733e-9,
        9.52077724913272e-11,
        5.933317559324694e-12,
        3.48233685101177e-13,
        1.93136959262495e-14,
        1.015344897618538e-15,
        5.073342850098685e-17,
        2.415398461605965e-18,
        1.098148869050834e-19,
        4.777572374088607e-21,
        1.992642316074096e-22,
        7.981449150568696e-24,
        3.074981251636064e-25,
        1.141183955068001e-26,
        4.085093221688517e-28,
        1.413859071171949e-29,
        4.721313539129298e-31,
    ],
    &[
        7172.524941006974,
        10047.65289876848,
        4367.660246508762,
        1352.077433210436,
        322.91970201409,
        62.60670218965643,
        10.20179352082191,
        1.43272260792099,
        0.1767210733457477,
        0.0194288828512541,
        0.001926420162860694,
        0.0001739291451928717,
        0.0000144139606403509,
        1.103861477704604e-6,
        7.857278877315142e-8,
        5.22423811064743e-9,
        3.25880720801886e-10,
        1.914453488960852e-11,
        1.0628178453566e-12,
        5.592681094486399e-14,
        2.797136682083772e-15,
        1.332938862894026e-16,
        6.065704853680912e-18,
        2.641268705086733e-19,
        1.102592288579551e-20,
        4.420112272171454e-22,
        1.704332768945274e-23,
        6.33014086239746e-25,
        2.267774487687423e-26,
        7.854715887299216e-28,
        2.624864930867957e-29,
    ],
    &[
        396067.3696786522,
        553152.3106200829,
        239766.0417843921,
        74080.92508337542,
        17673.61934070991,
        3424.910181935849,
        558.0818449688854,
        78.39986255148636,
        9.67544329220151,
        1.06445531702508,
        0.1056267446934281,
        0.00954484971181178,
        0.0007917227296578563,
        0.00006068876297184396,
        4.323889538828417e-6,
        2.877626553210709e-7,
        1.796702904020482e-8,
        1.056484879071659e-9,
        5.870447687927218e-11,
        3.091848692472632e-12,
        1.547706957141051e-13,
        7.381637362281032e-15,
        3.361874082581381e-16,
        1.46507740680151e-17,
        6.120696762959177e-19,
        2.455541759849629e-20,
        9.47516662513202e-22,
        3.521719723434168e-23,
        1.262527884937749e-24,
        4.375854591254314e-26,
        1.463257321957763e-27,
    ],
    &[
        2.169633802133209e7,
        3.028873548687197e7,
        1.312619619377195e7,
        4.056107527209204e6,
        968039.110090373,
        187699.8434898977,
        30606.84227194382,
        4303.104361803079,
        531.507837816864,
        58.52677696581115,
        5.812970971278024,
        0.5257674642631902,
        0.04365131880048068,
        0.003349103588885872,
        0.0002388279977950171,
        0.00001590846451801497,
        9.9413437447192e-7,
        5.850570473529223e-8,
        3.25359092882544e-9,
        1.71497268017617e-10,
        8.591427182344294e-12,
        4.100693055657824e-13,
        1.868979110227194e-14,
        8.150657542202684e-16,
        3.40747620261707e-17,
        1.3679500315441e-18,
        5.281922260760462e-20,
        1.96441724183067e-21,
        7.046696298929317e-23,
        2.443800319874006e-24,
        8.176606636640369e-26,
    ],
    &[
        1.189546863833169e9,
        1.661035613840997e9,
        7.202014870226453e8,
        2.22695838872772e8,
        5.318970465773872e7,
        1.032187423674978e7,
        1.684573006431192e6,
        237049.2914047833,
        29305.90641547255,
        3229.892338339962,
        321.0819930300517,
        29.06633308685003,
        2.415269612790221,
        0.1854643886763519,
        0.0132364719770866,
        0.0008823914284436486,
        0.00005518421395932165,
        3.250090134326738e-6,
        1.808748786351581e-7,
        9.54072590326119e-9,
        4.78287892415398e-10,
        2.284401014106631e-11,
        1.041842111538968e-12,
        4.546362898145806e-14,
        1.901823209929567e-15,
        7.639510494534527e-17,
        2.951465281877461e-18,
        1.098303679901892e-19,
        3.941941679615229e-21,
        1.367791607536812e-22,
        4.578775613048869e-24,
    ],
    &[
        6.542388728618025e10,
        9.13917151512215e10,
        3.96524123115031e10,
        1.227052479062494e10,
        2.933163347517839e9,
        5.696848655539021e8,
        9.30542546474053e7,
        1.310550849786868e7,
        1.621567241688047e6,
        178865.4207463982,
        17795.31083733558,
        1612.215645472148,
        134.0705070059737,
        10.30277325051341,
        0.735839238431461,
        0.04908854738332478,
        0.003072084489941654,
        0.0001810524583837977,
        0.00001008252970665289,
        5.321653978441335e-7,
        2.669442089587766e-8,
        1.275738174515191e-9,
        5.821590312778194e-11,
        2.541833145475136e-12,
        1.063871621432898e-13,
        4.275766045264025e-15,
        1.652756313438339e-16,
        6.153326891982618e-18,
        2.209571384252234e-19,
        7.670481161551794e-21,
        2.568918602769901e-22,
    ],
    &[
        3.611054170353034e12,
        5.046441678775479e12,
        2.190963940749353e12,
        6.785056517128145e11,
        1.623173913100014e11,
        3.155044008602554e10,
        5.157594428793132e9,
        7.269431634481699e8,
        9.001417673625216e7,
        9.93629479639262e6,
        989277.133009014,
        89689.52325684493,
        7463.624455533454,
        573.9318886352471,
        41.0176392827591,
        2.738049876651941,
        0.1714588504298436,
        0.01011088278519897,
        0.0005633841080998485,
        0.00002975259889475205,
        1.493258384998971e-6,
        7.14011844685909e-8,
        3.259930680363947e-9,
        1.424066624779247e-10,
        5.963248996306511e-12,
        2.397795980824675e-13,
        9.27269616118396e-15,
        3.453827513723707e-16,
        1.240757440899736e-17,
        4.309084056595864e-19,
        1.443745223765757e-20,
    ],
    &[
        1.999925131567344e14,
        2.795981203057951e14,
        1.21464488081491e14,
        3.764126581317589e13,
        9.01119860686561e12,
        1.752794195062369e12,
        2.867330238707212e11,
        4.04418341433698e10,
        5.011120183829256e9,
        5.535220318263981e8,
        5.51451922890949e7,
        5.002685699709463e6,
        416558.1878149146,
        32051.12644458235,
        2291.94098688317,
        153.0794517363526,
        9.59116483694006,
        0.5658870517075323,
        0.0315477247022131,
        0.001666882052569944,
        0.00008369998713125303,
        4.00405902781102e-6,
        1.828952425823719e-7,
        7.993148874830826e-9,
        3.348565836165587e-10,
        1.347011713389355e-11,
        5.211269611355867e-13,
        1.941832759794114e-14,
        6.97858220839602e-16,
        2.424545723470034e-17,
        8.126362082610058e-19,
    ],
    &[
        1.111078016159367e16,
        1.553881115642938e16,
        6.754153558651812e15,
        2.094359600474523e15,
        5.01699066028698e14,
        9.76485720877335e13,
        1.598394156266853e13,
        2.255814420880176e12,
        2.796841958764589e11,
        3.09116618957389e10,
        3.081363771583458e9,
        2.796918999261546e8,
        2.330167901108461e7,
        1.793838408947969e6,
        128341.076647885,
        8576.207345584803,
        537.6008272977124,
        31.7338511022963,
        1.769945716347627,
        0.093560012500862,
        0.004700013257281452,
        0.0002249352017137482,
        0.00001027869013647316,
        4.493937120001146e-7,
        1.883376444316729e-8,
        7.579045320209725e-10,
        2.933238001898882e-11,
        1.093382576905491e-12,
        3.930792947563343e-14,
        1.366131536544125e-15,
        4.580397798041629e-17,
    ],
    &[
        6.189907959876583e17,
        8.659512769105993e17,
        3.765809756543748e17,
        1.16835438011493e17,
        2.800333316390517e16,
        5.453506504342379e15,
        8.931710085856083e14,
        1.261219421480252e14,
        1.564540167098905e13,
        1.730084156955857e12,
        1.725473666428707e11,
        1.566967931479105e10,
        1.306100808903732e9,
        1.005950385951806e8,
        7.200411155148035e6,
        481371.1044765949,
        30187.88587967838,
        1782.701499157324,
        99.4704501277937,
        5.260149117532376,
        0.2643480013188391,
        0.01265607975781398,
        0.0005785490565405726,
        0.00002530381475807319,
        1.060837407643104e-6,
        4.270464362801603e-8,
        1.653305687065533e-9,
        6.164810625374298e-11,
        2.217002020487423e-12,
        7.707504007181385e-14,
        2.584973009522682e-15,
    ],
    &[
        3.456997815439456e19,
        4.83759088188613e19,
        2.104660822499541e19,
        6.5329277659582e18,
        1.566603142234692e18,
        3.052400906931503e17,
        5.001664503380815e16,
        7.066122540737112e15,
        8.769674912199088e14,
        9.70209704869197e13,
        9.68062791129079e12,
        8.795231417026721e11,
        7.334170928283522e10,
        5.651104356253496e9,
        4.046614826071098e8,
        2.706374424666853e7,
        1.697889657231482e6,
        100304.4103572834,
        5598.813299945751,
        296.1804968458465,
        14.88973799499843,
        0.7131142270045122,
        0.03260958960754994,
        0.001426700719709853,
        0.00005983207306604426,
        2.40932501583111e-6,
        9.33050901631649e-8,
        3.480172229766615e-9,
        1.25190950520976e-10,
        4.35355307171374e-12,
        1.460515043954544e-13,
    ],
    &[
        1.934952600854079e21,
        2.708368090210034e21,
        1.178766954873818e21,
        3.660498330106513e20,
        8.781805066773927e19,
        1.711825156866715e19,
        2.806231986727961e18,
        3.966233776839136e17,
        4.924533571330335e16,
        5.450391669962085e15,
        5.440539957539464e14,
        4.94490528778705e13,
        4.125055893847386e12,
        3.179626972727101e11,
        2.277690763207652e10,
        1.523866516088651e9,
        9.56358826933219e7,
        5.65171318756323e6,
        315573.9681047775,
        16699.49253252248,
        839.7927904850457,
        40.23270193603194,
        1.840336715520256,
        0.08054037397469423,
        0.003378630193560623,
        0.0001360896137389626,
        5.271754031402291e-6,
        1.966835617494169e-7,
        7.077097664778376e-9,
        2.461720471098504e-10,
        8.260582177163946e-12,
    ],
    &[
        1.085160819178778e23,
        1.519242605679536e23,
        6.614494973577772e22,
        2.054828509379076e22,
        4.931638749248383e21,
        9.61700110045477e20,
        1.577157823086039e20,
        2.229968147805873e19,
        2.769817212972803e18,
        3.066733117712082e17,
        3.062309036630319e16,
        2.784326528548358e15,
        2.323505193192934e14,
        1.791587795197665e13,
        1.283811763511323e12,
        8.592010814540154e10,
        5.393948211727376e9,
        3.18860580016738e8,
        1.780957666536236e7,
        942723.622815055,
        47421.90755881806,
        2272.526721644796,
        103.979387781881,
        4.551778323413863,
        0.1909954525662932,
        0.007695197075153253,
        0.0002981672003682708,
        0.00001112705916306086,
        4.004726288498053e-7,
        1.393348331972239e-8,
        4.676622860753611e-10,
    ],
    &[
        6.096500829671807e24,
        8.536881936294667e24,
        3.717941983096623e24,
        1.155396295351763e24,
        2.773966296475862e23,
        5.411341267965482e22,
        8.877579837061178e21,
        1.255654422237715e21,
        1.560170198132518e20,
        1.727998440802878e19,
        1.726075733645185e18,
        1.569897838961099e17,
        1.310485435698168e16,
        1.010789990658202e15,
        7.245285206875885e13,
        4.850397382571992e12,
        3.045894035784659e11,
        1.801074079216536e10,
        1.006246435424909e9,
        5.327856582582332e7,
        2.680784914249816e6,
        128500.3399748671,
        5881.017134663711,
        257.5098566869673,
        10.80789382528031,
        0.4355528580533039,
        0.01688036848736521,
        0.0006300881390779246,
        0.00002268248211704558,
        7.893552639811061e-7,
        2.649951452594974e-8,
    ],
    &[
        3.430460024673549e26,
        4.804497104111421e26,
        2.093011634744859e26,
        6.506308474748014e25,
        1.562587036504054e25,
        3.049215980894255e24,
        5.00399857375656e23,
        7.079951183636387e22,
        8.799690649636351e21,
        9.74925830840851e20,
        9.74133035191126e19,
        8.862522506466132e18,
        7.400192707734562e17,
        5.709446299219021e16,
        4.093626089348656e15,
        2.741240116712127e14,
        1.721865096095537e13,
        1.018422635972459e12,
        5.691288240788879e10,
        3.014159270651466e9,
        1.516983424089066e8,
        7.273210293221871e6,
        332947.0626106243,
        14581.94333725992,
        612.1521997679242,
        24.67482349702103,
        0.956506780950638,
        0.03571071399781071,
        0.001285810927467679,
        0.00004475553911306376,
        1.502788572956256e-6,
    ],
];

pub const SPLITS: [f64; 18] = [
    0.4300701973710523,
    2.459032569794304,
    4.487994942217555,
    8.545919687064058,
    12.60384443191056,
    16.66176917675706,
    20.71969392160357,
    24.77761866645007,
    28.83554341129657,
    32.89346815614308,
    36.95139290098958,
    41.00931764583608,
    45.06724239068258,
    49.12516713552909,
    53.18309188037559,
    57.24101662522209,
    61.2989413700686,
    65.3568661149151,
];
